<!DOCTYPE html>

<html lang="en">
<head><meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>data_integration</title><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<style type="text/css">
    pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: var(--jp-cell-editor-active-background) }
.highlight { background: var(--jp-cell-editor-background); color: var(--jp-mirror-editor-variable-color) }
.highlight .c { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment */
.highlight .err { color: var(--jp-mirror-editor-error-color) } /* Error */
.highlight .k { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword */
.highlight .o { color: var(--jp-mirror-editor-operator-color); font-weight: bold } /* Operator */
.highlight .p { color: var(--jp-mirror-editor-punctuation-color) } /* Punctuation */
.highlight .ch { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Multiline */
.highlight .cp { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Preproc */
.highlight .cpf { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Single */
.highlight .cs { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Special */
.highlight .kc { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Pseudo */
.highlight .kr { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Type */
.highlight .m { color: var(--jp-mirror-editor-number-color) } /* Literal.Number */
.highlight .s { color: var(--jp-mirror-editor-string-color) } /* Literal.String */
.highlight .ow { color: var(--jp-mirror-editor-operator-color); font-weight: bold } /* Operator.Word */
.highlight .pm { color: var(--jp-mirror-editor-punctuation-color) } /* Punctuation.Marker */
.highlight .w { color: var(--jp-mirror-editor-variable-color) } /* Text.Whitespace */
.highlight .mb { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Bin */
.highlight .mf { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Float */
.highlight .mh { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Hex */
.highlight .mi { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Integer */
.highlight .mo { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Oct */
.highlight .sa { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Affix */
.highlight .sb { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Backtick */
.highlight .sc { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Char */
.highlight .dl { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Delimiter */
.highlight .sd { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Doc */
.highlight .s2 { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Double */
.highlight .se { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Escape */
.highlight .sh { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Heredoc */
.highlight .si { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Interpol */
.highlight .sx { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Other */
.highlight .sr { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Regex */
.highlight .s1 { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Single */
.highlight .ss { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Symbol */
.highlight .il { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Integer.Long */
  </style>
<style type="text/css">
/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*
 * Mozilla scrollbar styling
 */

/* use standard opaque scrollbars for most nodes */
[data-jp-theme-scrollbars='true'] {
  scrollbar-color: rgb(var(--jp-scrollbar-thumb-color))
    var(--jp-scrollbar-background-color);
}

/* for code nodes, use a transparent style of scrollbar. These selectors
 * will match lower in the tree, and so will override the above */
[data-jp-theme-scrollbars='true'] .CodeMirror-hscrollbar,
[data-jp-theme-scrollbars='true'] .CodeMirror-vscrollbar {
  scrollbar-color: rgba(var(--jp-scrollbar-thumb-color), 0.5) transparent;
}

/* tiny scrollbar */

.jp-scrollbar-tiny {
  scrollbar-color: rgba(var(--jp-scrollbar-thumb-color), 0.5) transparent;
  scrollbar-width: thin;
}

/* tiny scrollbar */

.jp-scrollbar-tiny::-webkit-scrollbar,
.jp-scrollbar-tiny::-webkit-scrollbar-corner {
  background-color: transparent;
  height: 4px;
  width: 4px;
}

.jp-scrollbar-tiny::-webkit-scrollbar-thumb {
  background: rgba(var(--jp-scrollbar-thumb-color), 0.5);
}

.jp-scrollbar-tiny::-webkit-scrollbar-track:horizontal {
  border-left: 0 solid transparent;
  border-right: 0 solid transparent;
}

.jp-scrollbar-tiny::-webkit-scrollbar-track:vertical {
  border-top: 0 solid transparent;
  border-bottom: 0 solid transparent;
}

/*
 * Lumino
 */

.lm-ScrollBar[data-orientation='horizontal'] {
  min-height: 16px;
  max-height: 16px;
  min-width: 45px;
  border-top: 1px solid #a0a0a0;
}

.lm-ScrollBar[data-orientation='vertical'] {
  min-width: 16px;
  max-width: 16px;
  min-height: 45px;
  border-left: 1px solid #a0a0a0;
}

.lm-ScrollBar-button {
  background-color: #f0f0f0;
  background-position: center center;
  min-height: 15px;
  max-height: 15px;
  min-width: 15px;
  max-width: 15px;
}

.lm-ScrollBar-button:hover {
  background-color: #dadada;
}

.lm-ScrollBar-button.lm-mod-active {
  background-color: #cdcdcd;
}

.lm-ScrollBar-track {
  background: #f0f0f0;
}

.lm-ScrollBar-thumb {
  background: #cdcdcd;
}

.lm-ScrollBar-thumb:hover {
  background: #bababa;
}

.lm-ScrollBar-thumb.lm-mod-active {
  background: #a0a0a0;
}

.lm-ScrollBar[data-orientation='horizontal'] .lm-ScrollBar-thumb {
  height: 100%;
  min-width: 15px;
  border-left: 1px solid #a0a0a0;
  border-right: 1px solid #a0a0a0;
}

.lm-ScrollBar[data-orientation='vertical'] .lm-ScrollBar-thumb {
  width: 100%;
  min-height: 15px;
  border-top: 1px solid #a0a0a0;
  border-bottom: 1px solid #a0a0a0;
}

.lm-ScrollBar[data-orientation='horizontal']
  .lm-ScrollBar-button[data-action='decrement'] {
  background-image: var(--jp-icon-caret-left);
  background-size: 17px;
}

.lm-ScrollBar[data-orientation='horizontal']
  .lm-ScrollBar-button[data-action='increment'] {
  background-image: var(--jp-icon-caret-right);
  background-size: 17px;
}

.lm-ScrollBar[data-orientation='vertical']
  .lm-ScrollBar-button[data-action='decrement'] {
  background-image: var(--jp-icon-caret-up);
  background-size: 17px;
}

.lm-ScrollBar[data-orientation='vertical']
  .lm-ScrollBar-button[data-action='increment'] {
  background-image: var(--jp-icon-caret-down);
  background-size: 17px;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-Widget {
  box-sizing: border-box;
  position: relative;
  overflow: hidden;
}

.lm-Widget.lm-mod-hidden {
  display: none !important;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

.lm-AccordionPanel[data-orientation='horizontal'] > .lm-AccordionPanel-title {
  /* Title is rotated for horizontal accordion panel using CSS */
  display: block;
  transform-origin: top left;
  transform: rotate(-90deg) translate(-100%);
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-CommandPalette {
  display: flex;
  flex-direction: column;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.lm-CommandPalette-search {
  flex: 0 0 auto;
}

.lm-CommandPalette-content {
  flex: 1 1 auto;
  margin: 0;
  padding: 0;
  min-height: 0;
  overflow: auto;
  list-style-type: none;
}

.lm-CommandPalette-header {
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}

.lm-CommandPalette-item {
  display: flex;
  flex-direction: row;
}

.lm-CommandPalette-itemIcon {
  flex: 0 0 auto;
}

.lm-CommandPalette-itemContent {
  flex: 1 1 auto;
  overflow: hidden;
}

.lm-CommandPalette-itemShortcut {
  flex: 0 0 auto;
}

.lm-CommandPalette-itemLabel {
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}

.lm-close-icon {
  border: 1px solid transparent;
  background-color: transparent;
  position: absolute;
  z-index: 1;
  right: 3%;
  top: 0;
  bottom: 0;
  margin: auto;
  padding: 7px 0;
  display: none;
  vertical-align: middle;
  outline: 0;
  cursor: pointer;
}
.lm-close-icon:after {
  content: 'X';
  display: block;
  width: 15px;
  height: 15px;
  text-align: center;
  color: #000;
  font-weight: normal;
  font-size: 12px;
  cursor: pointer;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-DockPanel {
  z-index: 0;
}

.lm-DockPanel-widget {
  z-index: 0;
}

.lm-DockPanel-tabBar {
  z-index: 1;
}

.lm-DockPanel-handle {
  z-index: 2;
}

.lm-DockPanel-handle.lm-mod-hidden {
  display: none !important;
}

.lm-DockPanel-handle:after {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  content: '';
}

.lm-DockPanel-handle[data-orientation='horizontal'] {
  cursor: ew-resize;
}

.lm-DockPanel-handle[data-orientation='vertical'] {
  cursor: ns-resize;
}

.lm-DockPanel-handle[data-orientation='horizontal']:after {
  left: 50%;
  min-width: 8px;
  transform: translateX(-50%);
}

.lm-DockPanel-handle[data-orientation='vertical']:after {
  top: 50%;
  min-height: 8px;
  transform: translateY(-50%);
}

.lm-DockPanel-overlay {
  z-index: 3;
  box-sizing: border-box;
  pointer-events: none;
}

.lm-DockPanel-overlay.lm-mod-hidden {
  display: none !important;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-Menu {
  z-index: 10000;
  position: absolute;
  white-space: nowrap;
  overflow-x: hidden;
  overflow-y: auto;
  outline: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.lm-Menu-content {
  margin: 0;
  padding: 0;
  display: table;
  list-style-type: none;
}

.lm-Menu-item {
  display: table-row;
}

.lm-Menu-item.lm-mod-hidden,
.lm-Menu-item.lm-mod-collapsed {
  display: none !important;
}

.lm-Menu-itemIcon,
.lm-Menu-itemSubmenuIcon {
  display: table-cell;
  text-align: center;
}

.lm-Menu-itemLabel {
  display: table-cell;
  text-align: left;
}

.lm-Menu-itemShortcut {
  display: table-cell;
  text-align: right;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-MenuBar {
  outline: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.lm-MenuBar-content {
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: row;
  list-style-type: none;
}

.lm-MenuBar-item {
  box-sizing: border-box;
}

.lm-MenuBar-itemIcon,
.lm-MenuBar-itemLabel {
  display: inline-block;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-ScrollBar {
  display: flex;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.lm-ScrollBar[data-orientation='horizontal'] {
  flex-direction: row;
}

.lm-ScrollBar[data-orientation='vertical'] {
  flex-direction: column;
}

.lm-ScrollBar-button {
  box-sizing: border-box;
  flex: 0 0 auto;
}

.lm-ScrollBar-track {
  box-sizing: border-box;
  position: relative;
  overflow: hidden;
  flex: 1 1 auto;
}

.lm-ScrollBar-thumb {
  box-sizing: border-box;
  position: absolute;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-SplitPanel-child {
  z-index: 0;
}

.lm-SplitPanel-handle {
  z-index: 1;
}

.lm-SplitPanel-handle.lm-mod-hidden {
  display: none !important;
}

.lm-SplitPanel-handle:after {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  content: '';
}

.lm-SplitPanel[data-orientation='horizontal'] > .lm-SplitPanel-handle {
  cursor: ew-resize;
}

.lm-SplitPanel[data-orientation='vertical'] > .lm-SplitPanel-handle {
  cursor: ns-resize;
}

.lm-SplitPanel[data-orientation='horizontal'] > .lm-SplitPanel-handle:after {
  left: 50%;
  min-width: 8px;
  transform: translateX(-50%);
}

.lm-SplitPanel[data-orientation='vertical'] > .lm-SplitPanel-handle:after {
  top: 50%;
  min-height: 8px;
  transform: translateY(-50%);
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-TabBar {
  display: flex;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.lm-TabBar[data-orientation='horizontal'] {
  flex-direction: row;
  align-items: flex-end;
}

.lm-TabBar[data-orientation='vertical'] {
  flex-direction: column;
  align-items: flex-end;
}

.lm-TabBar-content {
  margin: 0;
  padding: 0;
  display: flex;
  flex: 1 1 auto;
  list-style-type: none;
}

.lm-TabBar[data-orientation='horizontal'] > .lm-TabBar-content {
  flex-direction: row;
}

.lm-TabBar[data-orientation='vertical'] > .lm-TabBar-content {
  flex-direction: column;
}

.lm-TabBar-tab {
  display: flex;
  flex-direction: row;
  box-sizing: border-box;
  overflow: hidden;
  touch-action: none; /* Disable native Drag/Drop */
}

.lm-TabBar-tabIcon,
.lm-TabBar-tabCloseIcon {
  flex: 0 0 auto;
}

.lm-TabBar-tabLabel {
  flex: 1 1 auto;
  overflow: hidden;
  white-space: nowrap;
}

.lm-TabBar-tabInput {
  user-select: all;
  width: 100%;
  box-sizing: border-box;
}

.lm-TabBar-tab.lm-mod-hidden {
  display: none !important;
}

.lm-TabBar-addButton.lm-mod-hidden {
  display: none !important;
}

.lm-TabBar.lm-mod-dragging .lm-TabBar-tab {
  position: relative;
}

.lm-TabBar.lm-mod-dragging[data-orientation='horizontal'] .lm-TabBar-tab {
  left: 0;
  transition: left 150ms ease;
}

.lm-TabBar.lm-mod-dragging[data-orientation='vertical'] .lm-TabBar-tab {
  top: 0;
  transition: top 150ms ease;
}

.lm-TabBar.lm-mod-dragging .lm-TabBar-tab.lm-mod-dragging {
  transition: none;
}

.lm-TabBar-tabLabel .lm-TabBar-tabInput {
  user-select: all;
  width: 100%;
  box-sizing: border-box;
  background: inherit;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-TabPanel-tabBar {
  z-index: 1;
}

.lm-TabPanel-stackedPanel {
  z-index: 0;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-Collapse {
  display: flex;
  flex-direction: column;
  align-items: stretch;
}

.jp-Collapse-header {
  padding: 1px 12px;
  background-color: var(--jp-layout-color1);
  border-bottom: solid var(--jp-border-width) var(--jp-border-color2);
  color: var(--jp-ui-font-color1);
  cursor: pointer;
  display: flex;
  align-items: center;
  font-size: var(--jp-ui-font-size0);
  font-weight: 600;
  text-transform: uppercase;
  user-select: none;
}

.jp-Collapser-icon {
  height: 16px;
}

.jp-Collapse-header-collapsed .jp-Collapser-icon {
  transform: rotate(-90deg);
  margin: auto 0;
}

.jp-Collapser-title {
  line-height: 25px;
}

.jp-Collapse-contents {
  padding: 0 12px;
  background-color: var(--jp-layout-color1);
  color: var(--jp-ui-font-color1);
  overflow: auto;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/* This file was auto-generated by ensureUiComponents() in @jupyterlab/buildutils */

/**
 * (DEPRECATED) Support for consuming icons as CSS background images
 */

/* Icons urls */

:root {
  --jp-icon-add-above: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAxNCAxNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzEzN18xOTQ5MikiPgo8cGF0aCBjbGFzcz0ianAtaWNvbjMiIGQ9Ik00Ljc1IDQuOTMwNjZINi42MjVWNi44MDU2NkM2LjYyNSA3LjAxMTkxIDYuNzkzNzUgNy4xODA2NiA3IDcuMTgwNjZDNy4yMDYyNSA3LjE4MDY2IDcuMzc1IDcuMDExOTEgNy4zNzUgNi44MDU2NlY0LjkzMDY2SDkuMjVDOS40NTYyNSA0LjkzMDY2IDkuNjI1IDQuNzYxOTEgOS42MjUgNC41NTU2NkM5LjYyNSA0LjM0OTQxIDkuNDU2MjUgNC4xODA2NiA5LjI1IDQuMTgwNjZINy4zNzVWMi4zMDU2NkM3LjM3NSAyLjA5OTQxIDcuMjA2MjUgMS45MzA2NiA3IDEuOTMwNjZDNi43OTM3NSAxLjkzMDY2IDYuNjI1IDIuMDk5NDEgNi42MjUgMi4zMDU2NlY0LjE4MDY2SDQuNzVDNC41NDM3NSA0LjE4MDY2IDQuMzc1IDQuMzQ5NDEgNC4zNzUgNC41NTU2NkM0LjM3NSA0Ljc2MTkxIDQuNTQzNzUgNC45MzA2NiA0Ljc1IDQuOTMwNjZaIiBmaWxsPSIjNjE2MTYxIiBzdHJva2U9IiM2MTYxNjEiIHN0cm9rZS13aWR0aD0iMC43Ii8+CjwvZz4KPHBhdGggY2xhc3M9ImpwLWljb24zIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTExLjUgOS41VjExLjVMMi41IDExLjVWOS41TDExLjUgOS41Wk0xMiA4QzEyLjU1MjMgOCAxMyA4LjQ0NzcyIDEzIDlWMTJDMTMgMTIuNTUyMyAxMi41NTIzIDEzIDEyIDEzTDIgMTNDMS40NDc3MiAxMyAxIDEyLjU1MjMgMSAxMlY5QzEgOC40NDc3MiAxLjQ0NzcxIDggMiA4TDEyIDhaIiBmaWxsPSIjNjE2MTYxIi8+CjxkZWZzPgo8Y2xpcFBhdGggaWQ9ImNsaXAwXzEzN18xOTQ5MiI+CjxyZWN0IGNsYXNzPSJqcC1pY29uMyIgd2lkdGg9IjYiIGhlaWdodD0iNiIgZmlsbD0id2hpdGUiIHRyYW5zZm9ybT0ibWF0cml4KC0xIDAgMCAxIDEwIDEuNTU1NjYpIi8+CjwvY2xpcFBhdGg+CjwvZGVmcz4KPC9zdmc+Cg==);
  --jp-icon-add-below: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAxNCAxNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzEzN18xOTQ5OCkiPgo8cGF0aCBjbGFzcz0ianAtaWNvbjMiIGQ9Ik05LjI1IDEwLjA2OTNMNy4zNzUgMTAuMDY5M0w3LjM3NSA4LjE5NDM0QzcuMzc1IDcuOTg4MDkgNy4yMDYyNSA3LjgxOTM0IDcgNy44MTkzNEM2Ljc5Mzc1IDcuODE5MzQgNi42MjUgNy45ODgwOSA2LjYyNSA4LjE5NDM0TDYuNjI1IDEwLjA2OTNMNC43NSAxMC4wNjkzQzQuNTQzNzUgMTAuMDY5MyA0LjM3NSAxMC4yMzgxIDQuMzc1IDEwLjQ0NDNDNC4zNzUgMTAuNjUwNiA0LjU0Mzc1IDEwLjgxOTMgNC43NSAxMC44MTkzTDYuNjI1IDEwLjgxOTNMNi42MjUgMTIuNjk0M0M2LjYyNSAxMi45MDA2IDYuNzkzNzUgMTMuMDY5MyA3IDEzLjA2OTNDNy4yMDYyNSAxMy4wNjkzIDcuMzc1IDEyLjkwMDYgNy4zNzUgMTIuNjk0M0w3LjM3NSAxMC44MTkzTDkuMjUgMTAuODE5M0M5LjQ1NjI1IDEwLjgxOTMgOS42MjUgMTAuNjUwNiA5LjYyNSAxMC40NDQzQzkuNjI1IDEwLjIzODEgOS40NTYyNSAxMC4wNjkzIDkuMjUgMTAuMDY5M1oiIGZpbGw9IiM2MTYxNjEiIHN0cm9rZT0iIzYxNjE2MSIgc3Ryb2tlLXdpZHRoPSIwLjciLz4KPC9nPgo8cGF0aCBjbGFzcz0ianAtaWNvbjMiIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMi41IDUuNUwyLjUgMy41TDExLjUgMy41TDExLjUgNS41TDIuNSA1LjVaTTIgN0MxLjQ0NzcyIDcgMSA2LjU1MjI4IDEgNkwxIDNDMSAyLjQ0NzcyIDEuNDQ3NzIgMiAyIDJMMTIgMkMxMi41NTIzIDIgMTMgMi40NDc3MiAxMyAzTDEzIDZDMTMgNi41NTIyOSAxMi41NTIzIDcgMTIgN0wyIDdaIiBmaWxsPSIjNjE2MTYxIi8+CjxkZWZzPgo8Y2xpcFBhdGggaWQ9ImNsaXAwXzEzN18xOTQ5OCI+CjxyZWN0IGNsYXNzPSJqcC1pY29uMyIgd2lkdGg9IjYiIGhlaWdodD0iNiIgZmlsbD0id2hpdGUiIHRyYW5zZm9ybT0ibWF0cml4KDEgMS43NDg0NmUtMDcgMS43NDg0NmUtMDcgLTEgNCAxMy40NDQzKSIvPgo8L2NsaXBQYXRoPgo8L2RlZnM+Cjwvc3ZnPgo=);
  --jp-icon-add: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTE5IDEzaC02djZoLTJ2LTZINXYtMmg2VjVoMnY2aDZ2MnoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-bell: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDE2IDE2IiB2ZXJzaW9uPSIxLjEiPgogICA8cGF0aCBjbGFzcz0ianAtaWNvbjIganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjMzMzMzMzIgogICAgICBkPSJtOCAwLjI5Yy0xLjQgMC0yLjcgMC43My0zLjYgMS44LTEuMiAxLjUtMS40IDMuNC0xLjUgNS4yLTAuMTggMi4yLTAuNDQgNC0yLjMgNS4zbDAuMjggMS4zaDVjMC4wMjYgMC42NiAwLjMyIDEuMSAwLjcxIDEuNSAwLjg0IDAuNjEgMiAwLjYxIDIuOCAwIDAuNTItMC40IDAuNi0xIDAuNzEtMS41aDVsMC4yOC0xLjNjLTEuOS0wLjk3LTIuMi0zLjMtMi4zLTUuMy0wLjEzLTEuOC0wLjI2LTMuNy0xLjUtNS4yLTAuODUtMS0yLjItMS44LTMuNi0xLjh6bTAgMS40YzAuODggMCAxLjkgMC41NSAyLjUgMS4zIDAuODggMS4xIDEuMSAyLjcgMS4yIDQuNCAwLjEzIDEuNyAwLjIzIDMuNiAxLjMgNS4yaC0xMGMxLjEtMS42IDEuMi0zLjQgMS4zLTUuMiAwLjEzLTEuNyAwLjMtMy4zIDEuMi00LjQgMC41OS0wLjcyIDEuNi0xLjMgMi41LTEuM3ptLTAuNzQgMTJoMS41Yy0wLjAwMTUgMC4yOCAwLjAxNSAwLjc5LTAuNzQgMC43OS0wLjczIDAuMDAxNi0wLjcyLTAuNTMtMC43NC0wLjc5eiIgLz4KPC9zdmc+Cg==);
  --jp-icon-bug-dot: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyBqcC1pY29uLXNlbGVjdGFibGUiIGZpbGw9IiM2MTYxNjEiPgogICAgICAgIDxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTcuMTkgOEgyMFYxMEgxNy45MUMxNy45NiAxMC4zMyAxOCAxMC42NiAxOCAxMVYxMkgyMFYxNEgxOC41SDE4VjE0LjAyNzVDMTUuNzUgMTQuMjc2MiAxNCAxNi4xODM3IDE0IDE4LjVDMTQgMTkuMjA4IDE0LjE2MzUgMTkuODc3OSAxNC40NTQ5IDIwLjQ3MzlDMTMuNzA2MyAyMC44MTE3IDEyLjg3NTcgMjEgMTIgMjFDOS43OCAyMSA3Ljg1IDE5Ljc5IDYuODEgMThINFYxNkg2LjA5QzYuMDQgMTUuNjcgNiAxNS4zNCA2IDE1VjE0SDRWMTJINlYxMUM2IDEwLjY2IDYuMDQgMTAuMzMgNi4wOSAxMEg0VjhINi44MUM3LjI2IDcuMjIgNy44OCA2LjU1IDguNjIgNi4wNEw3IDQuNDFMOC40MSAzTDEwLjU5IDUuMTdDMTEuMDQgNS4wNiAxMS41MSA1IDEyIDVDMTIuNDkgNSAxMi45NiA1LjA2IDEzLjQyIDUuMTdMMTUuNTkgM0wxNyA0LjQxTDE1LjM3IDYuMDRDMTYuMTIgNi41NSAxNi43NCA3LjIyIDE3LjE5IDhaTTEwIDE2SDE0VjE0SDEwVjE2Wk0xMCAxMkgxNFYxMEgxMFYxMloiIGZpbGw9IiM2MTYxNjEiLz4KICAgICAgICA8cGF0aCBkPSJNMjIgMTguNUMyMiAyMC40MzMgMjAuNDMzIDIyIDE4LjUgMjJDMTYuNTY3IDIyIDE1IDIwLjQzMyAxNSAxOC41QzE1IDE2LjU2NyAxNi41NjcgMTUgMTguNSAxNUMyMC40MzMgMTUgMjIgMTYuNTY3IDIyIDE4LjVaIiBmaWxsPSIjNjE2MTYxIi8+CiAgICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-bug: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIj4KICAgIDxwYXRoIGQ9Ik0yMCA4aC0yLjgxYy0uNDUtLjc4LTEuMDctMS40NS0xLjgyLTEuOTZMMTcgNC40MSAxNS41OSAzbC0yLjE3IDIuMTdDMTIuOTYgNS4wNiAxMi40OSA1IDEyIDVjLS40OSAwLS45Ni4wNi0xLjQxLjE3TDguNDEgMyA3IDQuNDFsMS42MiAxLjYzQzcuODggNi41NSA3LjI2IDcuMjIgNi44MSA4SDR2MmgyLjA5Yy0uMDUuMzMtLjA5LjY2LS4wOSAxdjFINHYyaDJ2MWMwIC4zNC4wNC42Ny4wOSAxSDR2MmgyLjgxYzEuMDQgMS43OSAyLjk3IDMgNS4xOSAzczQuMTUtMS4yMSA1LjE5LTNIMjB2LTJoLTIuMDljLjA1LS4zMy4wOS0uNjYuMDktMXYtMWgydi0yaC0ydi0xYzAtLjM0LS4wNC0uNjctLjA5LTFIMjBWOHptLTYgOGgtNHYtMmg0djJ6bTAtNGgtNHYtMmg0djJ6Ii8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-build: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIHZpZXdCb3g9IjAgMCAyNCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTE0LjkgMTcuNDVDMTYuMjUgMTcuNDUgMTcuMzUgMTYuMzUgMTcuMzUgMTVDMTcuMzUgMTMuNjUgMTYuMjUgMTIuNTUgMTQuOSAxMi41NUMxMy41NCAxMi41NSAxMi40NSAxMy42NSAxMi40NSAxNUMxMi40NSAxNi4zNSAxMy41NCAxNy40NSAxNC45IDE3LjQ1Wk0yMC4xIDE1LjY4TDIxLjU4IDE2Ljg0QzIxLjcxIDE2Ljk1IDIxLjc1IDE3LjEzIDIxLjY2IDE3LjI5TDIwLjI2IDE5LjcxQzIwLjE3IDE5Ljg2IDIwIDE5LjkyIDE5LjgzIDE5Ljg2TDE4LjA5IDE5LjE2QzE3LjczIDE5LjQ0IDE3LjMzIDE5LjY3IDE2LjkxIDE5Ljg1TDE2LjY0IDIxLjdDMTYuNjIgMjEuODcgMTYuNDcgMjIgMTYuMyAyMkgxMy41QzEzLjMyIDIyIDEzLjE4IDIxLjg3IDEzLjE1IDIxLjdMMTIuODkgMTkuODVDMTIuNDYgMTkuNjcgMTIuMDcgMTkuNDQgMTEuNzEgMTkuMTZMOS45NjAwMiAxOS44NkM5LjgxMDAyIDE5LjkyIDkuNjIwMDIgMTkuODYgOS41NDAwMiAxOS43MUw4LjE0MDAyIDE3LjI5QzguMDUwMDIgMTcuMTMgOC4wOTAwMiAxNi45NSA4LjIyMDAyIDE2Ljg0TDkuNzAwMDIgMTUuNjhMOS42NTAwMSAxNUw5LjcwMDAyIDE0LjMxTDguMjIwMDIgMTMuMTZDOC4wOTAwMiAxMy4wNSA4LjA1MDAyIDEyLjg2IDguMTQwMDIgMTIuNzFMOS41NDAwMiAxMC4yOUM5LjYyMDAyIDEwLjEzIDkuODEwMDIgMTAuMDcgOS45NjAwMiAxMC4xM0wxMS43MSAxMC44NEMxMi4wNyAxMC41NiAxMi40NiAxMC4zMiAxMi44OSAxMC4xNUwxMy4xNSA4LjI4OTk4QzEzLjE4IDguMTI5OTggMTMuMzIgNy45OTk5OCAxMy41IDcuOTk5OThIMTYuM0MxNi40NyA3Ljk5OTk4IDE2LjYyIDguMTI5OTggMTYuNjQgOC4yODk5OEwxNi45MSAxMC4xNUMxNy4zMyAxMC4zMiAxNy43MyAxMC41NiAxOC4wOSAxMC44NEwxOS44MyAxMC4xM0MyMCAxMC4wNyAyMC4xNyAxMC4xMyAyMC4yNiAxMC4yOUwyMS42NiAxMi43MUMyMS43NSAxMi44NiAyMS43MSAxMy4wNSAyMS41OCAxMy4xNkwyMC4xIDE0LjMxTDIwLjE1IDE1TDIwLjEgMTUuNjhaIi8+CiAgICA8cGF0aCBkPSJNNy4zMjk2NiA3LjQ0NDU0QzguMDgzMSA3LjAwOTU0IDguMzM5MzIgNi4wNTMzMiA3LjkwNDMyIDUuMjk5ODhDNy40NjkzMiA0LjU0NjQzIDYuNTA4MSA0LjI4MTU2IDUuNzU0NjYgNC43MTY1NkM1LjM5MTc2IDQuOTI2MDggNS4xMjY5NSA1LjI3MTE4IDUuMDE4NDkgNS42NzU5NEM0LjkxMDA0IDYuMDgwNzEgNC45NjY4MiA2LjUxMTk4IDUuMTc2MzQgNi44NzQ4OEM1LjYxMTM0IDcuNjI4MzIgNi41NzYyMiA3Ljg3OTU0IDcuMzI5NjYgNy40NDQ1NFpNOS42NTcxOCA0Ljc5NTkzTDEwLjg2NzIgNC45NTE3OUMxMC45NjI4IDQuOTc3NDEgMTEuMDQwMiA1LjA3MTMzIDExLjAzODIgNS4xODc5M0wxMS4wMzg4IDYuOTg4OTNDMTEuMDQ1NSA3LjEwMDU0IDEwLjk2MTYgNy4xOTUxOCAxMC44NTUgNy4yMTA1NEw5LjY2MDAxIDcuMzgwODNMOS4yMzkxNSA4LjEzMTg4TDkuNjY5NjEgOS4yNTc0NUM5LjcwNzI5IDkuMzYyNzEgOS42NjkzNCA5LjQ3Njk5IDkuNTc0MDggOS41MzE5OUw4LjAxNTIzIDEwLjQzMkM3LjkxMTMxIDEwLjQ5MiA3Ljc5MzM3IDEwLjQ2NzcgNy43MjEwNSAxMC4zODI0TDYuOTg3NDggOS40MzE4OEw2LjEwOTMxIDkuNDMwODNMNS4zNDcwNCAxMC4zOTA1QzUuMjg5MDkgMTAuNDcwMiA1LjE3MzgzIDEwLjQ5MDUgNS4wNzE4NyAxMC40MzM5TDMuNTEyNDUgOS41MzI5M0MzLjQxMDQ5IDkuNDc2MzMgMy4zNzY0NyA5LjM1NzQxIDMuNDEwNzUgOS4yNTY3OUwzLjg2MzQ3IDguMTQwOTNMMy42MTc0OSA3Ljc3NDg4TDMuNDIzNDcgNy4zNzg4M0wyLjIzMDc1IDcuMjEyOTdDMi4xMjY0NyA3LjE5MjM1IDIuMDQwNDkgNy4xMDM0MiAyLjA0MjQ1IDYuOTg2ODJMMi4wNDE4NyA1LjE4NTgyQzIuMDQzODMgNS4wNjkyMiAyLjExOTA5IDQuOTc5NTggMi4yMTcwNCA0Ljk2OTIyTDMuNDIwNjUgNC43OTM5M0wzLjg2NzQ5IDQuMDI3ODhMMy40MTEwNSAyLjkxNzMxQzMuMzczMzcgMi44MTIwNCAzLjQxMTMxIDIuNjk3NzYgMy41MTUyMyAyLjYzNzc2TDUuMDc0MDggMS43Mzc3NkM1LjE2OTM0IDEuNjgyNzYgNS4yODcyOSAxLjcwNzA0IDUuMzU5NjEgMS43OTIzMUw2LjExOTE1IDIuNzI3ODhMNi45ODAwMSAyLjczODkzTDcuNzI0OTYgMS43ODkyMkM3Ljc5MTU2IDEuNzA0NTggNy45MTU0OCAxLjY3OTIyIDguMDA4NzkgMS43NDA4Mkw5LjU2ODIxIDIuNjQxODJDOS42NzAxNyAyLjY5ODQyIDkuNzEyODUgMi44MTIzNCA5LjY4NzIzIDIuOTA3OTdMOS4yMTcxOCA0LjAzMzgzTDkuNDYzMTYgNC4zOTk4OEw5LjY1NzE4IDQuNzk1OTNaIi8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-caret-down-empty-thin: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIwIDIwIj4KCTxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSIgc2hhcGUtcmVuZGVyaW5nPSJnZW9tZXRyaWNQcmVjaXNpb24iPgoJCTxwb2x5Z29uIGNsYXNzPSJzdDEiIHBvaW50cz0iOS45LDEzLjYgMy42LDcuNCA0LjQsNi42IDkuOSwxMi4yIDE1LjQsNi43IDE2LjEsNy40ICIvPgoJPC9nPgo8L3N2Zz4K);
  --jp-icon-caret-down-empty: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDE4IDE4Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiIHNoYXBlLXJlbmRlcmluZz0iZ2VvbWV0cmljUHJlY2lzaW9uIj4KICAgIDxwYXRoIGQ9Ik01LjIsNS45TDksOS43bDMuOC0zLjhsMS4yLDEuMmwtNC45LDVsLTQuOS01TDUuMiw1Ljl6Ii8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-caret-down: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDE4IDE4Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiIHNoYXBlLXJlbmRlcmluZz0iZ2VvbWV0cmljUHJlY2lzaW9uIj4KICAgIDxwYXRoIGQ9Ik01LjIsNy41TDksMTEuMmwzLjgtMy44SDUuMnoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-caret-left: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDE4IDE4Ij4KCTxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSIgc2hhcGUtcmVuZGVyaW5nPSJnZW9tZXRyaWNQcmVjaXNpb24iPgoJCTxwYXRoIGQ9Ik0xMC44LDEyLjhMNy4xLDlsMy44LTMuOGwwLDcuNkgxMC44eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-caret-right: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDE4IDE4Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiIHNoYXBlLXJlbmRlcmluZz0iZ2VvbWV0cmljUHJlY2lzaW9uIj4KICAgIDxwYXRoIGQ9Ik03LjIsNS4yTDEwLjksOWwtMy44LDMuOFY1LjJINy4yeiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-caret-up-empty-thin: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIwIDIwIj4KCTxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSIgc2hhcGUtcmVuZGVyaW5nPSJnZW9tZXRyaWNQcmVjaXNpb24iPgoJCTxwb2x5Z29uIGNsYXNzPSJzdDEiIHBvaW50cz0iMTUuNCwxMy4zIDkuOSw3LjcgNC40LDEzLjIgMy42LDEyLjUgOS45LDYuMyAxNi4xLDEyLjYgIi8+Cgk8L2c+Cjwvc3ZnPgo=);
  --jp-icon-caret-up: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDE4IDE4Ij4KCTxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSIgc2hhcGUtcmVuZGVyaW5nPSJnZW9tZXRyaWNQcmVjaXNpb24iPgoJCTxwYXRoIGQ9Ik01LjIsMTAuNUw5LDYuOGwzLjgsMy44SDUuMnoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-case-sensitive: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIwIDIwIj4KICA8ZyBjbGFzcz0ianAtaWNvbjIiIGZpbGw9IiM0MTQxNDEiPgogICAgPHJlY3QgeD0iMiIgeT0iMiIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2Ii8+CiAgPC9nPgogIDxnIGNsYXNzPSJqcC1pY29uLWFjY2VudDIiIGZpbGw9IiNGRkYiPgogICAgPHBhdGggZD0iTTcuNiw4aDAuOWwzLjUsOGgtMS4xTDEwLDE0SDZsLTAuOSwySDRMNy42LDh6IE04LDkuMUw2LjQsMTNoMy4yTDgsOS4xeiIvPgogICAgPHBhdGggZD0iTTE2LjYsOS44Yy0wLjIsMC4xLTAuNCwwLjEtMC43LDAuMWMtMC4yLDAtMC40LTAuMS0wLjYtMC4yYy0wLjEtMC4xLTAuMi0wLjQtMC4yLTAuNyBjLTAuMywwLjMtMC42LDAuNS0wLjksMC43Yy0wLjMsMC4xLTAuNywwLjItMS4xLDAuMmMtMC4zLDAtMC41LDAtMC43LTAuMWMtMC4yLTAuMS0wLjQtMC4yLTAuNi0wLjNjLTAuMi0wLjEtMC4zLTAuMy0wLjQtMC41IGMtMC4xLTAuMi0wLjEtMC40LTAuMS0wLjdjMC0wLjMsMC4xLTAuNiwwLjItMC44YzAuMS0wLjIsMC4zLTAuNCwwLjQtMC41QzEyLDcsMTIuMiw2LjksMTIuNSw2LjhjMC4yLTAuMSwwLjUtMC4xLDAuNy0wLjIgYzAuMy0wLjEsMC41LTAuMSwwLjctMC4xYzAuMiwwLDAuNC0wLjEsMC42LTAuMWMwLjIsMCwwLjMtMC4xLDAuNC0wLjJjMC4xLTAuMSwwLjItMC4yLDAuMi0wLjRjMC0xLTEuMS0xLTEuMy0xIGMtMC40LDAtMS40LDAtMS40LDEuMmgtMC45YzAtMC40LDAuMS0wLjcsMC4yLTFjMC4xLTAuMiwwLjMtMC40LDAuNS0wLjZjMC4yLTAuMiwwLjUtMC4zLDAuOC0wLjNDMTMuMyw0LDEzLjYsNCwxMy45LDQgYzAuMywwLDAuNSwwLDAuOCwwLjFjMC4zLDAsMC41LDAuMSwwLjcsMC4yYzAuMiwwLjEsMC40LDAuMywwLjUsMC41QzE2LDUsMTYsNS4yLDE2LDUuNnYyLjljMCwwLjIsMCwwLjQsMCwwLjUgYzAsMC4xLDAuMSwwLjIsMC4zLDAuMmMwLjEsMCwwLjIsMCwwLjMsMFY5Ljh6IE0xNS4yLDYuOWMtMS4yLDAuNi0zLjEsMC4yLTMuMSwxLjRjMCwxLjQsMy4xLDEsMy4xLTAuNVY2Ljl6Ii8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-check: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIj4KICAgIDxwYXRoIGQ9Ik05IDE2LjE3TDQuODMgMTJsLTEuNDIgMS40MUw5IDE5IDIxIDdsLTEuNDEtMS40MXoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-circle-empty: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTEyIDJDNi40NyAyIDIgNi40NyAyIDEyczQuNDcgMTAgMTAgMTAgMTAtNC40NyAxMC0xMFMxNy41MyAyIDEyIDJ6bTAgMThjLTQuNDEgMC04LTMuNTktOC04czMuNTktOCA4LTggOCAzLjU5IDggOC0zLjU5IDgtOCA4eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-circle: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMTggMTgiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPGNpcmNsZSBjeD0iOSIgY3k9IjkiIHI9IjgiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-clear: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8bWFzayBpZD0iZG9udXRIb2xlIj4KICAgIDxyZWN0IHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgZmlsbD0id2hpdGUiIC8+CiAgICA8Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSI4IiBmaWxsPSJibGFjayIvPgogIDwvbWFzaz4KCiAgPGcgY2xhc3M9ImpwLWljb24zIiBmaWxsPSIjNjE2MTYxIj4KICAgIDxyZWN0IGhlaWdodD0iMTgiIHdpZHRoPSIyIiB4PSIxMSIgeT0iMyIgdHJhbnNmb3JtPSJyb3RhdGUoMzE1LCAxMiwgMTIpIi8+CiAgICA8Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIxMCIgbWFzaz0idXJsKCNkb251dEhvbGUpIi8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-close: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbi1ub25lIGpwLWljb24tc2VsZWN0YWJsZS1pbnZlcnNlIGpwLWljb24zLWhvdmVyIiBmaWxsPSJub25lIj4KICAgIDxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjExIi8+CiAgPC9nPgoKICA8ZyBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIGpwLWljb24tYWNjZW50Mi1ob3ZlciIgZmlsbD0iIzYxNjE2MSI+CiAgICA8cGF0aCBkPSJNMTkgNi40MUwxNy41OSA1IDEyIDEwLjU5IDYuNDEgNSA1IDYuNDEgMTAuNTkgMTIgNSAxNy41OSA2LjQxIDE5IDEyIDEzLjQxIDE3LjU5IDE5IDE5IDE3LjU5IDEzLjQxIDEyeiIvPgogIDwvZz4KCiAgPGcgY2xhc3M9ImpwLWljb24tbm9uZSBqcC1pY29uLWJ1c3kiIGZpbGw9Im5vbmUiPgogICAgPGNpcmNsZSBjeD0iMTIiIGN5PSIxMiIgcj0iNyIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-code-check: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIiBzaGFwZS1yZW5kZXJpbmc9Imdlb21ldHJpY1ByZWNpc2lvbiI+CiAgICA8cGF0aCBkPSJNNi41OSwzLjQxTDIsOEw2LjU5LDEyLjZMOCwxMS4xOEw0LjgyLDhMOCw0LjgyTDYuNTksMy40MU0xMi40MSwzLjQxTDExLDQuODJMMTQuMTgsOEwxMSwxMS4xOEwxMi40MSwxMi42TDE3LDhMMTIuNDEsMy40MU0yMS41OSwxMS41OUwxMy41LDE5LjY4TDkuODMsMTZMOC40MiwxNy40MUwxMy41LDIyLjVMMjMsMTNMMjEuNTksMTEuNTlaIiAvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-code: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9IjAgMCAyOCAyOCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KCTxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CgkJPHBhdGggZD0iTTExLjQgMTguNkw2LjggMTRMMTEuNCA5LjRMMTAgOEw0IDE0TDEwIDIwTDExLjQgMTguNlpNMTYuNiAxOC42TDIxLjIgMTRMMTYuNiA5LjRMMTggOEwyNCAxNEwxOCAyMEwxNi42IDE4LjZWMTguNloiLz4KCTwvZz4KPC9zdmc+Cg==);
  --jp-icon-collapse-all: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGgKICAgICAgICAgICAgZD0iTTggMmMxIDAgMTEgMCAxMiAwczIgMSAyIDJjMCAxIDAgMTEgMCAxMnMwIDItMiAyQzIwIDE0IDIwIDQgMjAgNFMxMCA0IDYgNGMwLTIgMS0yIDItMnoiIC8+CiAgICAgICAgPHBhdGgKICAgICAgICAgICAgZD0iTTE4IDhjMC0xLTEtMi0yLTJTNSA2IDQgNnMtMiAxLTIgMmMwIDEgMCAxMSAwIDEyczEgMiAyIDJjMSAwIDExIDAgMTIgMHMyLTEgMi0yYzAtMSAwLTExIDAtMTJ6bS0yIDB2MTJINFY4eiIgLz4KICAgICAgICA8cGF0aCBkPSJNNiAxM3YyaDh2LTJ6IiAvPgogICAgPC9nPgo8L3N2Zz4K);
  --jp-icon-console: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIwMCAyMDAiPgogIDxnIGNsYXNzPSJqcC1jb25zb2xlLWljb24tYmFja2dyb3VuZC1jb2xvciBqcC1pY29uLXNlbGVjdGFibGUiIGZpbGw9IiMwMjg4RDEiPgogICAgPHBhdGggZD0iTTIwIDE5LjhoMTYwdjE1OS45SDIweiIvPgogIDwvZz4KICA8ZyBjbGFzcz0ianAtY29uc29sZS1pY29uLWNvbG9yIGpwLWljb24tc2VsZWN0YWJsZS1pbnZlcnNlIiBmaWxsPSIjZmZmIj4KICAgIDxwYXRoIGQ9Ik0xMDUgMTI3LjNoNDB2MTIuOGgtNDB6TTUxLjEgNzdMNzQgOTkuOWwtMjMuMyAyMy4zIDEwLjUgMTAuNSAyMy4zLTIzLjNMOTUgOTkuOSA4NC41IDg5LjQgNjEuNiA2Ni41eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-copy: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMTggMTgiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTExLjksMUgzLjJDMi40LDEsMS43LDEuNywxLjcsMi41djEwLjJoMS41VjIuNWg4LjdWMXogTTE0LjEsMy45aC04Yy0wLjgsMC0xLjUsMC43LTEuNSwxLjV2MTAuMmMwLDAuOCwwLjcsMS41LDEuNSwxLjVoOCBjMC44LDAsMS41LTAuNywxLjUtMS41VjUuNEMxNS41LDQuNiwxNC45LDMuOSwxNC4xLDMuOXogTTE0LjEsMTUuNWgtOFY1LjRoOFYxNS41eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-copyright: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDI0IDI0IiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCI+CiAgPGcgY2xhc3M9ImpwLWljb24zIiBmaWxsPSIjNjE2MTYxIj4KICAgIDxwYXRoIGQ9Ik0xMS44OCw5LjE0YzEuMjgsMC4wNiwxLjYxLDEuMTUsMS42MywxLjY2aDEuNzljLTAuMDgtMS45OC0xLjQ5LTMuMTktMy40NS0zLjE5QzkuNjQsNy42MSw4LDksOCwxMi4xNCBjMCwxLjk0LDAuOTMsNC4yNCwzLjg0LDQuMjRjMi4yMiwwLDMuNDEtMS42NSwzLjQ0LTIuOTVoLTEuNzljLTAuMDMsMC41OS0wLjQ1LDEuMzgtMS42MywxLjQ0QzEwLjU1LDE0LjgzLDEwLDEzLjgxLDEwLDEyLjE0IEMxMCw5LjI1LDExLjI4LDkuMTYsMTEuODgsOS4xNHogTTEyLDJDNi40OCwyLDIsNi40OCwyLDEyczQuNDgsMTAsMTAsMTBzMTAtNC40OCwxMC0xMFMxNy41MiwyLDEyLDJ6IE0xMiwyMGMtNC40MSwwLTgtMy41OS04LTggczMuNTktOCw4LThzOCwzLjU5LDgsOFMxNi40MSwyMCwxMiwyMHoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-cut: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTkuNjQgNy42NGMuMjMtLjUuMzYtMS4wNS4zNi0xLjY0IDAtMi4yMS0xLjc5LTQtNC00UzIgMy43OSAyIDZzMS43OSA0IDQgNGMuNTkgMCAxLjE0LS4xMyAxLjY0LS4zNkwxMCAxMmwtMi4zNiAyLjM2QzcuMTQgMTQuMTMgNi41OSAxNCA2IDE0Yy0yLjIxIDAtNCAxLjc5LTQgNHMxLjc5IDQgNCA0IDQtMS43OSA0LTRjMC0uNTktLjEzLTEuMTQtLjM2LTEuNjRMMTIgMTRsNyA3aDN2LTFMOS42NCA3LjY0ek02IDhjLTEuMSAwLTItLjg5LTItMnMuOS0yIDItMiAyIC44OSAyIDItLjkgMi0yIDJ6bTAgMTJjLTEuMSAwLTItLjg5LTItMnMuOS0yIDItMiAyIC44OSAyIDItLjkgMi0yIDJ6bTYtNy41Yy0uMjggMC0uNS0uMjItLjUtLjVzLjIyLS41LjUtLjUuNS4yMi41LjUtLjIyLjUtLjUuNXpNMTkgM2wtNiA2IDIgMiA3LTdWM3oiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-delete: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjE2cHgiIGhlaWdodD0iMTZweCI+CiAgICA8cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIiAvPgogICAgPHBhdGggY2xhc3M9ImpwLWljb24zIiBmaWxsPSIjNjI2MjYyIiBkPSJNNiAxOWMwIDEuMS45IDIgMiAyaDhjMS4xIDAgMi0uOSAyLTJWN0g2djEyek0xOSA0aC0zLjVsLTEtMWgtNWwtMSAxSDV2MmgxNFY0eiIgLz4KPC9zdmc+Cg==);
  --jp-icon-download: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTE5IDloLTRWM0g5djZINWw3IDcgNy03ek01IDE4djJoMTR2LTJINXoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-duplicate: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAxNCAxNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggY2xhc3M9ImpwLWljb24zIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTIuNzk5OTggMC44NzVIOC44OTU4MkM5LjIwMDYxIDAuODc1IDkuNDQ5OTggMS4xMzkxNCA5LjQ0OTk4IDEuNDYxOThDOS40NDk5OCAxLjc4NDgyIDkuMjAwNjEgMi4wNDg5NiA4Ljg5NTgyIDIuMDQ4OTZIMy4zNTQxNUMzLjA0OTM2IDIuMDQ4OTYgMi43OTk5OCAyLjMxMzEgMi43OTk5OCAyLjYzNTk0VjkuNjc5NjlDMi43OTk5OCAxMC4wMDI1IDIuNTUwNjEgMTAuMjY2NyAyLjI0NTgyIDEwLjI2NjdDMS45NDEwMyAxMC4yNjY3IDEuNjkxNjUgMTAuMDAyNSAxLjY5MTY1IDkuNjc5NjlWMi4wNDg5NkMxLjY5MTY1IDEuNDAzMjggMi4xOTA0IDAuODc1IDIuNzk5OTggMC44NzVaTTUuMzY2NjUgMTEuOVY0LjU1SDExLjA4MzNWMTEuOUg1LjM2NjY1Wk00LjE0MTY1IDQuMTQxNjdDNC4xNDE2NSAzLjY5MDYzIDQuNTA3MjggMy4zMjUgNC45NTgzMiAzLjMyNUgxMS40OTE3QzExLjk0MjcgMy4zMjUgMTIuMzA4MyAzLjY5MDYzIDEyLjMwODMgNC4xNDE2N1YxMi4zMDgzQzEyLjMwODMgMTIuNzU5NCAxMS45NDI3IDEzLjEyNSAxMS40OTE3IDEzLjEyNUg0Ljk1ODMyQzQuNTA3MjggMTMuMTI1IDQuMTQxNjUgMTIuNzU5NCA0LjE0MTY1IDEyLjMwODNWNC4xNDE2N1oiIGZpbGw9IiM2MTYxNjEiLz4KPHBhdGggY2xhc3M9ImpwLWljb24zIiBkPSJNOS40MzU3NCA4LjI2NTA3SDguMzY0MzFWOS4zMzY1QzguMzY0MzEgOS40NTQzNSA4LjI2Nzg4IDkuNTUwNzggOC4xNTAwMiA5LjU1MDc4QzguMDMyMTcgOS41NTA3OCA3LjkzNTc0IDkuNDU0MzUgNy45MzU3NCA5LjMzNjVWOC4yNjUwN0g2Ljg2NDMxQzYuNzQ2NDUgOC4yNjUwNyA2LjY1MDAyIDguMTY4NjQgNi42NTAwMiA4LjA1MDc4QzYuNjUwMDIgNy45MzI5MiA2Ljc0NjQ1IDcuODM2NSA2Ljg2NDMxIDcuODM2NUg3LjkzNTc0VjYuNzY1MDdDNy45MzU3NCA2LjY0NzIxIDguMDMyMTcgNi41NTA3OCA4LjE1MDAyIDYuNTUwNzhDOC4yNjc4OCA2LjU1MDc4IDguMzY0MzEgNi42NDcyMSA4LjM2NDMxIDYuNzY1MDdWNy44MzY1SDkuNDM1NzRDOS41NTM2IDcuODM2NSA5LjY1MDAyIDcuOTMyOTIgOS42NTAwMiA4LjA1MDc4QzkuNjUwMDIgOC4xNjg2NCA5LjU1MzYgOC4yNjUwNyA5LjQzNTc0IDguMjY1MDdaIiBmaWxsPSIjNjE2MTYxIiBzdHJva2U9IiM2MTYxNjEiIHN0cm9rZS13aWR0aD0iMC41Ii8+Cjwvc3ZnPgo=);
  --jp-icon-edit: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTMgMTcuMjVWMjFoMy43NUwxNy44MSA5Ljk0bC0zLjc1LTMuNzVMMyAxNy4yNXpNMjAuNzEgNy4wNGMuMzktLjM5LjM5LTEuMDIgMC0xLjQxbC0yLjM0LTIuMzRjLS4zOS0uMzktMS4wMi0uMzktMS40MSAwbC0xLjgzIDEuODMgMy43NSAzLjc1IDEuODMtMS44M3oiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-ellipses: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPGNpcmNsZSBjeD0iNSIgY3k9IjEyIiByPSIyIi8+CiAgICA8Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIyIi8+CiAgICA8Y2lyY2xlIGN4PSIxOSIgY3k9IjEyIiByPSIyIi8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-error: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KPGcgY2xhc3M9ImpwLWljb24zIiBmaWxsPSIjNjE2MTYxIj48Y2lyY2xlIGN4PSIxMiIgY3k9IjE5IiByPSIyIi8+PHBhdGggZD0iTTEwIDNoNHYxMmgtNHoiLz48L2c+CjxwYXRoIGZpbGw9Im5vbmUiIGQ9Ik0wIDBoMjR2MjRIMHoiLz4KPC9zdmc+Cg==);
  --jp-icon-expand-all: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGgKICAgICAgICAgICAgZD0iTTggMmMxIDAgMTEgMCAxMiAwczIgMSAyIDJjMCAxIDAgMTEgMCAxMnMwIDItMiAyQzIwIDE0IDIwIDQgMjAgNFMxMCA0IDYgNGMwLTIgMS0yIDItMnoiIC8+CiAgICAgICAgPHBhdGgKICAgICAgICAgICAgZD0iTTE4IDhjMC0xLTEtMi0yLTJTNSA2IDQgNnMtMiAxLTIgMmMwIDEgMCAxMSAwIDEyczEgMiAyIDJjMSAwIDExIDAgMTIgMHMyLTEgMi0yYzAtMSAwLTExIDAtMTJ6bS0yIDB2MTJINFY4eiIgLz4KICAgICAgICA8cGF0aCBkPSJNMTEgMTBIOXYzSDZ2MmgzdjNoMnYtM2gzdi0yaC0zeiIgLz4KICAgIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-extension: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTIwLjUgMTFIMTlWN2MwLTEuMS0uOS0yLTItMmgtNFYzLjVDMTMgMi4xMiAxMS44OCAxIDEwLjUgMVM4IDIuMTIgOCAzLjVWNUg0Yy0xLjEgMC0xLjk5LjktMS45OSAydjMuOEgzLjVjMS40OSAwIDIuNyAxLjIxIDIuNyAyLjdzLTEuMjEgMi43LTIuNyAyLjdIMlYyMGMwIDEuMS45IDIgMiAyaDMuOHYtMS41YzAtMS40OSAxLjIxLTIuNyAyLjctMi43IDEuNDkgMCAyLjcgMS4yMSAyLjcgMi43VjIySDE3YzEuMSAwIDItLjkgMi0ydi00aDEuNWMxLjM4IDAgMi41LTEuMTIgMi41LTIuNVMyMS44OCAxMSAyMC41IDExeiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-fast-forward: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGggZD0iTTQgMThsOC41LTZMNCA2djEyem05LTEydjEybDguNS02TDEzIDZ6Ii8+CiAgICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-file-upload: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTkgMTZoNnYtNmg0bC03LTctNyA3aDR6bS00IDJoMTR2Mkg1eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-file: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8cGF0aCBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIiBkPSJNMTkuMyA4LjJsLTUuNS01LjVjLS4zLS4zLS43LS41LTEuMi0uNUgzLjljLS44LjEtMS42LjktMS42IDEuOHYxNC4xYzAgLjkuNyAxLjYgMS42IDEuNmgxNC4yYy45IDAgMS42LS43IDEuNi0xLjZWOS40Yy4xLS41LS4xLS45LS40LTEuMnptLTUuOC0zLjNsMy40IDMuNmgtMy40VjQuOXptMy45IDEyLjdINC43Yy0uMSAwLS4yIDAtLjItLjJWNC43YzAtLjIuMS0uMy4yLS4zaDcuMnY0LjRzMCAuOC4zIDEuMWMuMy4zIDEuMS4zIDEuMS4zaDQuM3Y3LjJzLS4xLjItLjIuMnoiLz4KPC9zdmc+Cg==);
  --jp-icon-filter-dot: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiNGRkYiPgogICAgPHBhdGggZD0iTTE0LDEyVjE5Ljg4QzE0LjA0LDIwLjE4IDEzLjk0LDIwLjUgMTMuNzEsMjAuNzFDMTMuMzIsMjEuMSAxMi42OSwyMS4xIDEyLjMsMjAuNzFMMTAuMjksMTguN0MxMC4wNiwxOC40NyA5Ljk2LDE4LjE2IDEwLDE3Ljg3VjEySDkuOTdMNC4yMSw0LjYyQzMuODcsNC4xOSAzLjk1LDMuNTYgNC4zOCwzLjIyQzQuNTcsMy4wOCA0Ljc4LDMgNSwzVjNIMTlWM0MxOS4yMiwzIDE5LjQzLDMuMDggMTkuNjIsMy4yMkMyMC4wNSwzLjU2IDIwLjEzLDQuMTkgMTkuNzksNC42MkwxNC4wMywxMkgxNFoiIC8+CiAgPC9nPgogIDxnIGNsYXNzPSJqcC1pY29uLWRvdCIgZmlsbD0iI0ZGRiI+CiAgICA8Y2lyY2xlIGN4PSIxOCIgY3k9IjE3IiByPSIzIj48L2NpcmNsZT4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-filter-list: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTEwIDE4aDR2LTJoLTR2MnpNMyA2djJoMThWNkgzem0zIDdoMTJ2LTJINnYyeiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-filter: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiNGRkYiPgogICAgPHBhdGggZD0iTTE0LDEyVjE5Ljg4QzE0LjA0LDIwLjE4IDEzLjk0LDIwLjUgMTMuNzEsMjAuNzFDMTMuMzIsMjEuMSAxMi42OSwyMS4xIDEyLjMsMjAuNzFMMTAuMjksMTguN0MxMC4wNiwxOC40NyA5Ljk2LDE4LjE2IDEwLDE3Ljg3VjEySDkuOTdMNC4yMSw0LjYyQzMuODcsNC4xOSAzLjk1LDMuNTYgNC4zOCwzLjIyQzQuNTcsMy4wOCA0Ljc4LDMgNSwzVjNIMTlWM0MxOS4yMiwzIDE5LjQzLDMuMDggMTkuNjIsMy4yMkMyMC4wNSwzLjU2IDIwLjEzLDQuMTkgMTkuNzksNC42MkwxNC4wMywxMkgxNFoiIC8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-folder-favorite: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjRweCIgdmlld0JveD0iMCAwIDI0IDI0IiB3aWR0aD0iMjRweCIgZmlsbD0iIzAwMDAwMCI+CiAgPHBhdGggZD0iTTAgMGgyNHYyNEgwVjB6IiBmaWxsPSJub25lIi8+PHBhdGggY2xhc3M9ImpwLWljb24zIGpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iIzYxNjE2MSIgZD0iTTIwIDZoLThsLTItMkg0Yy0xLjEgMC0yIC45LTIgMnYxMmMwIDEuMS45IDIgMiAyaDE2YzEuMSAwIDItLjkgMi0yVjhjMC0xLjEtLjktMi0yLTJ6bS0yLjA2IDExTDE1IDE1LjI4IDEyLjA2IDE3bC43OC0zLjMzLTIuNTktMi4yNCAzLjQxLS4yOUwxNSA4bDEuMzQgMy4xNCAzLjQxLjI5LTIuNTkgMi4yNC43OCAzLjMzeiIvPgo8L3N2Zz4K);
  --jp-icon-folder: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8cGF0aCBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIiBkPSJNMTAgNEg0Yy0xLjEgMC0xLjk5LjktMS45OSAyTDIgMThjMCAxLjEuOSAyIDIgMmgxNmMxLjEgMCAyLS45IDItMlY4YzAtMS4xLS45LTItMi0yaC04bC0yLTJ6Ii8+Cjwvc3ZnPgo=);
  --jp-icon-home: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjRweCIgdmlld0JveD0iMCAwIDI0IDI0IiB3aWR0aD0iMjRweCIgZmlsbD0iIzAwMDAwMCI+CiAgPHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPjxwYXRoIGNsYXNzPSJqcC1pY29uMyBqcC1pY29uLXNlbGVjdGFibGUiIGZpbGw9IiM2MTYxNjEiIGQ9Ik0xMCAyMHYtNmg0djZoNXYtOGgzTDEyIDMgMiAxMmgzdjh6Ii8+Cjwvc3ZnPgo=);
  --jp-icon-html5: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDUxMiA1MTIiPgogIDxwYXRoIGNsYXNzPSJqcC1pY29uMCBqcC1pY29uLXNlbGVjdGFibGUiIGZpbGw9IiMwMDAiIGQ9Ik0xMDguNCAwaDIzdjIyLjhoMjEuMlYwaDIzdjY5aC0yM1Y0NmgtMjF2MjNoLTIzLjJNMjA2IDIzaC0yMC4zVjBoNjMuN3YyM0gyMjl2NDZoLTIzbTUzLjUtNjloMjQuMWwxNC44IDI0LjNMMzEzLjIgMGgyNC4xdjY5aC0yM1YzNC44bC0xNi4xIDI0LjgtMTYuMS0yNC44VjY5aC0yMi42bTg5LjItNjloMjN2NDYuMmgzMi42VjY5aC01NS42Ii8+CiAgPHBhdGggY2xhc3M9ImpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iI2U0NGQyNiIgZD0iTTEwNy42IDQ3MWwtMzMtMzcwLjRoMzYyLjhsLTMzIDM3MC4yTDI1NS43IDUxMiIvPgogIDxwYXRoIGNsYXNzPSJqcC1pY29uLXNlbGVjdGFibGUiIGZpbGw9IiNmMTY1MjkiIGQ9Ik0yNTYgNDgwLjVWMTMxaDE0OC4zTDM3NiA0NDciLz4KICA8cGF0aCBjbGFzcz0ianAtaWNvbi1zZWxlY3RhYmxlLWludmVyc2UiIGZpbGw9IiNlYmViZWIiIGQ9Ik0xNDIgMTc2LjNoMTE0djQ1LjRoLTY0LjJsNC4yIDQ2LjVoNjB2NDUuM0gxNTQuNG0yIDIyLjhIMjAybDMuMiAzNi4zIDUwLjggMTMuNnY0Ny40bC05My4yLTI2Ii8+CiAgPHBhdGggY2xhc3M9ImpwLWljb24tc2VsZWN0YWJsZS1pbnZlcnNlIiBmaWxsPSIjZmZmIiBkPSJNMzY5LjYgMTc2LjNIMjU1Ljh2NDUuNGgxMDkuNm0tNC4xIDQ2LjVIMjU1Ljh2NDUuNGg1NmwtNS4zIDU5LTUwLjcgMTMuNnY0Ny4ybDkzLTI1LjgiLz4KPC9zdmc+Cg==);
  --jp-icon-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8cGF0aCBjbGFzcz0ianAtaWNvbi1icmFuZDQganAtaWNvbi1zZWxlY3RhYmxlLWludmVyc2UiIGZpbGw9IiNGRkYiIGQ9Ik0yLjIgMi4yaDE3LjV2MTcuNUgyLjJ6Ii8+CiAgPHBhdGggY2xhc3M9ImpwLWljb24tYnJhbmQwIGpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iIzNGNTFCNSIgZD0iTTIuMiAyLjJ2MTcuNWgxNy41bC4xLTE3LjVIMi4yem0xMi4xIDIuMmMxLjIgMCAyLjIgMSAyLjIgMi4ycy0xIDIuMi0yLjIgMi4yLTIuMi0xLTIuMi0yLjIgMS0yLjIgMi4yLTIuMnpNNC40IDE3LjZsMy4zLTguOCAzLjMgNi42IDIuMi0zLjIgNC40IDUuNEg0LjR6Ii8+Cjwvc3ZnPgo=);
  --jp-icon-info: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDUwLjk3OCA1MC45NzgiPgoJPGcgY2xhc3M9ImpwLWljb24zIiBmaWxsPSIjNjE2MTYxIj4KCQk8cGF0aCBkPSJNNDMuNTIsNy40NThDMzguNzExLDIuNjQ4LDMyLjMwNywwLDI1LjQ4OSwwQzE4LjY3LDAsMTIuMjY2LDIuNjQ4LDcuNDU4LDcuNDU4CgkJCWMtOS45NDMsOS45NDEtOS45NDMsMjYuMTE5LDAsMzYuMDYyYzQuODA5LDQuODA5LDExLjIxMiw3LjQ1NiwxOC4wMzEsNy40NThjMCwwLDAuMDAxLDAsMC4wMDIsMAoJCQljNi44MTYsMCwxMy4yMjEtMi42NDgsMTguMDI5LTcuNDU4YzQuODA5LTQuODA5LDcuNDU3LTExLjIxMiw3LjQ1Ny0xOC4wM0M1MC45NzcsMTguNjcsNDguMzI4LDEyLjI2Niw0My41Miw3LjQ1OHoKCQkJIE00Mi4xMDYsNDIuMTA1Yy00LjQzMiw0LjQzMS0xMC4zMzIsNi44NzItMTYuNjE1LDYuODcyaC0wLjAwMmMtNi4yODUtMC4wMDEtMTIuMTg3LTIuNDQxLTE2LjYxNy02Ljg3MgoJCQljLTkuMTYyLTkuMTYzLTkuMTYyLTI0LjA3MSwwLTMzLjIzM0MxMy4zMDMsNC40NCwxOS4yMDQsMiwyNS40ODksMmM2LjI4NCwwLDEyLjE4NiwyLjQ0LDE2LjYxNyw2Ljg3MgoJCQljNC40MzEsNC40MzEsNi44NzEsMTAuMzMyLDYuODcxLDE2LjYxN0M0OC45NzcsMzEuNzcyLDQ2LjUzNiwzNy42NzUsNDIuMTA2LDQyLjEwNXoiLz4KCQk8cGF0aCBkPSJNMjMuNTc4LDMyLjIxOGMtMC4wMjMtMS43MzQsMC4xNDMtMy4wNTksMC40OTYtMy45NzJjMC4zNTMtMC45MTMsMS4xMS0xLjk5NywyLjI3Mi0zLjI1MwoJCQljMC40NjgtMC41MzYsMC45MjMtMS4wNjIsMS4zNjctMS41NzVjMC42MjYtMC43NTMsMS4xMDQtMS40NzgsMS40MzYtMi4xNzVjMC4zMzEtMC43MDcsMC40OTUtMS41NDEsMC40OTUtMi41CgkJCWMwLTEuMDk2LTAuMjYtMi4wODgtMC43NzktMi45NzljLTAuNTY1LTAuODc5LTEuNTAxLTEuMzM2LTIuODA2LTEuMzY5Yy0xLjgwMiwwLjA1Ny0yLjk4NSwwLjY2Ny0zLjU1LDEuODMyCgkJCWMtMC4zMDEsMC41MzUtMC41MDMsMS4xNDEtMC42MDcsMS44MTRjLTAuMTM5LDAuNzA3LTAuMjA3LDEuNDMyLTAuMjA3LDIuMTc0aC0yLjkzN2MtMC4wOTEtMi4yMDgsMC40MDctNC4xMTQsMS40OTMtNS43MTkKCQkJYzEuMDYyLTEuNjQsMi44NTUtMi40ODEsNS4zNzgtMi41MjdjMi4xNiwwLjAyMywzLjg3NCwwLjYwOCw1LjE0MSwxLjc1OGMxLjI3OCwxLjE2LDEuOTI5LDIuNzY0LDEuOTUsNC44MTEKCQkJYzAsMS4xNDItMC4xMzcsMi4xMTEtMC40MSwyLjkxMWMtMC4zMDksMC44NDUtMC43MzEsMS41OTMtMS4yNjgsMi4yNDNjLTAuNDkyLDAuNjUtMS4wNjgsMS4zMTgtMS43MywyLjAwMgoJCQljLTAuNjUsMC42OTctMS4zMTMsMS40NzktMS45ODcsMi4zNDZjLTAuMjM5LDAuMzc3LTAuNDI5LDAuNzc3LTAuNTY1LDEuMTk5Yy0wLjE2LDAuOTU5LTAuMjE3LDEuOTUxLTAuMTcxLDIuOTc5CgkJCUMyNi41ODksMzIuMjE4LDIzLjU3OCwzMi4yMTgsMjMuNTc4LDMyLjIxOHogTTIzLjU3OCwzOC4yMnYtMy40ODRoMy4wNzZ2My40ODRIMjMuNTc4eiIvPgoJPC9nPgo8L3N2Zz4K);
  --jp-icon-inspector: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8cGF0aCBjbGFzcz0ianAtaW5zcGVjdG9yLWljb24tY29sb3IganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIiBkPSJNMjAgNEg0Yy0xLjEgMC0xLjk5LjktMS45OSAyTDIgMThjMCAxLjEuOSAyIDIgMmgxNmMxLjEgMCAyLS45IDItMlY2YzAtMS4xLS45LTItMi0yem0tNSAxNEg0di00aDExdjR6bTAtNUg0VjloMTF2NHptNSA1aC00VjloNHY5eiIvPgo8L3N2Zz4K);
  --jp-icon-json: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8ZyBjbGFzcz0ianAtanNvbi1pY29uLWNvbG9yIGpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iI0Y5QTgyNSI+CiAgICA8cGF0aCBkPSJNMjAuMiAxMS44Yy0xLjYgMC0xLjcuNS0xLjcgMSAwIC40LjEuOS4xIDEuMy4xLjUuMS45LjEgMS4zIDAgMS43LTEuNCAyLjMtMy41IDIuM2gtLjl2LTEuOWguNWMxLjEgMCAxLjQgMCAxLjQtLjggMC0uMyAwLS42LS4xLTEgMC0uNC0uMS0uOC0uMS0xLjIgMC0xLjMgMC0xLjggMS4zLTItMS4zLS4yLTEuMy0uNy0xLjMtMiAwLS40LjEtLjguMS0xLjIuMS0uNC4xLS43LjEtMSAwLS44LS40LS43LTEuNC0uOGgtLjVWNC4xaC45YzIuMiAwIDMuNS43IDMuNSAyLjMgMCAuNC0uMS45LS4xIDEuMy0uMS41LS4xLjktLjEgMS4zIDAgLjUuMiAxIDEuNyAxdjEuOHpNMS44IDEwLjFjMS42IDAgMS43LS41IDEuNy0xIDAtLjQtLjEtLjktLjEtMS4zLS4xLS41LS4xLS45LS4xLTEuMyAwLTEuNiAxLjQtMi4zIDMuNS0yLjNoLjl2MS45aC0uNWMtMSAwLTEuNCAwLTEuNC44IDAgLjMgMCAuNi4xIDEgMCAuMi4xLjYuMSAxIDAgMS4zIDAgMS44LTEuMyAyQzYgMTEuMiA2IDExLjcgNiAxM2MwIC40LS4xLjgtLjEgMS4yLS4xLjMtLjEuNy0uMSAxIDAgLjguMy44IDEuNC44aC41djEuOWgtLjljLTIuMSAwLTMuNS0uNi0zLjUtMi4zIDAtLjQuMS0uOS4xLTEuMy4xLS41LjEtLjkuMS0xLjMgMC0uNS0uMi0xLTEuNy0xdi0xLjl6Ii8+CiAgICA8Y2lyY2xlIGN4PSIxMSIgY3k9IjEzLjgiIHI9IjIuMSIvPgogICAgPGNpcmNsZSBjeD0iMTEiIGN5PSI4LjIiIHI9IjIuMSIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-julia: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDMyNSAzMDAiPgogIDxnIGNsYXNzPSJqcC1icmFuZDAganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjY2IzYzMzIj4KICAgIDxwYXRoIGQ9Ik0gMTUwLjg5ODQzOCAyMjUgQyAxNTAuODk4NDM4IDI2Ni40MjE4NzUgMTE3LjMyMDMxMiAzMDAgNzUuODk4NDM4IDMwMCBDIDM0LjQ3NjU2MiAzMDAgMC44OTg0MzggMjY2LjQyMTg3NSAwLjg5ODQzOCAyMjUgQyAwLjg5ODQzOCAxODMuNTc4MTI1IDM0LjQ3NjU2MiAxNTAgNzUuODk4NDM4IDE1MCBDIDExNy4zMjAzMTIgMTUwIDE1MC44OTg0MzggMTgzLjU3ODEyNSAxNTAuODk4NDM4IDIyNSIvPgogIDwvZz4KICA8ZyBjbGFzcz0ianAtYnJhbmQwIGpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iIzM4OTgyNiI+CiAgICA8cGF0aCBkPSJNIDIzNy41IDc1IEMgMjM3LjUgMTE2LjQyMTg3NSAyMDMuOTIxODc1IDE1MCAxNjIuNSAxNTAgQyAxMjEuMDc4MTI1IDE1MCA4Ny41IDExNi40MjE4NzUgODcuNSA3NSBDIDg3LjUgMzMuNTc4MTI1IDEyMS4wNzgxMjUgMCAxNjIuNSAwIEMgMjAzLjkyMTg3NSAwIDIzNy41IDMzLjU3ODEyNSAyMzcuNSA3NSIvPgogIDwvZz4KICA8ZyBjbGFzcz0ianAtYnJhbmQwIGpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iIzk1NThiMiI+CiAgICA8cGF0aCBkPSJNIDMyNC4xMDE1NjIgMjI1IEMgMzI0LjEwMTU2MiAyNjYuNDIxODc1IDI5MC41MjM0MzggMzAwIDI0OS4xMDE1NjIgMzAwIEMgMjA3LjY3OTY4OCAzMDAgMTc0LjEwMTU2MiAyNjYuNDIxODc1IDE3NC4xMDE1NjIgMjI1IEMgMTc0LjEwMTU2MiAxODMuNTc4MTI1IDIwNy42Nzk2ODggMTUwIDI0OS4xMDE1NjIgMTUwIEMgMjkwLjUyMzQzOCAxNTAgMzI0LjEwMTU2MiAxODMuNTc4MTI1IDMyNC4xMDE1NjIgMjI1Ii8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-jupyter-favicon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTUyIiBoZWlnaHQ9IjE2NSIgdmlld0JveD0iMCAwIDE1MiAxNjUiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgPGcgY2xhc3M9ImpwLWp1cHl0ZXItaWNvbi1jb2xvciIgZmlsbD0iI0YzNzcyNiI+CiAgICA8cGF0aCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjA3ODk0NywgMTEwLjU4MjkyNykiIGQ9Ik03NS45NDIyODQyLDI5LjU4MDQ1NjEgQzQzLjMwMjM5NDcsMjkuNTgwNDU2MSAxNC43OTY3ODMyLDE3LjY1MzQ2MzQgMCwwIEM1LjUxMDgzMjExLDE1Ljg0MDY4MjkgMTUuNzgxNTM4OSwyOS41NjY3NzMyIDI5LjM5MDQ5NDcsMzkuMjc4NDE3MSBDNDIuOTk5Nyw0OC45ODk4NTM3IDU5LjI3MzcsNTQuMjA2NzgwNSA3NS45NjA1Nzg5LDU0LjIwNjc4MDUgQzkyLjY0NzQ1NzksNTQuMjA2NzgwNSAxMDguOTIxNDU4LDQ4Ljk4OTg1MzcgMTIyLjUzMDY2MywzOS4yNzg0MTcxIEMxMzYuMTM5NDUzLDI5LjU2Njc3MzIgMTQ2LjQxMDI4NCwxNS44NDA2ODI5IDE1MS45MjExNTgsMCBDMTM3LjA4Nzg2OCwxNy42NTM0NjM0IDEwOC41ODI1ODksMjkuNTgwNDU2MSA3NS45NDIyODQyLDI5LjU4MDQ1NjEgTDc1Ljk0MjI4NDIsMjkuNTgwNDU2MSBaIiAvPgogICAgPHBhdGggdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMzczNjgsIDAuNzA0ODc4KSIgZD0iTTc1Ljk3ODQ1NzksMjQuNjI2NDA3MyBDMTA4LjYxODc2MywyNC42MjY0MDczIDEzNy4xMjQ0NTgsMzYuNTUzNDQxNSAxNTEuOTIxMTU4LDU0LjIwNjc4MDUgQzE0Ni40MTAyODQsMzguMzY2MjIyIDEzNi4xMzk0NTMsMjQuNjQwMTMxNyAxMjIuNTMwNjYzLDE0LjkyODQ4NzggQzEwOC45MjE0NTgsNS4yMTY4NDM5IDkyLjY0NzQ1NzksMCA3NS45NjA1Nzg5LDAgQzU5LjI3MzcsMCA0Mi45OTk3LDUuMjE2ODQzOSAyOS4zOTA0OTQ3LDE0LjkyODQ4NzggQzE1Ljc4MTUzODksMjQuNjQwMTMxNyA1LjUxMDgzMjExLDM4LjM2NjIyMiAwLDU0LjIwNjc4MDUgQzE0LjgzMzA4MTYsMzYuNTg5OTI5MyA0My4zMzg1Njg0LDI0LjYyNjQwNzMgNzUuOTc4NDU3OSwyNC42MjY0MDczIEw3NS45Nzg0NTc5LDI0LjYyNjQwNzMgWiIgLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-jupyter: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzkiIGhlaWdodD0iNTEiIHZpZXdCb3g9IjAgMCAzOSA1MSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTYzOCAtMjI4MSkiPgogICAgIDxnIGNsYXNzPSJqcC1qdXB5dGVyLWljb24tY29sb3IiIGZpbGw9IiNGMzc3MjYiPgogICAgICA8cGF0aCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNjM5Ljc0IDIzMTEuOTgpIiBkPSJNIDE4LjI2NDYgNy4xMzQxMUMgMTAuNDE0NSA3LjEzNDExIDMuNTU4NzIgNC4yNTc2IDAgMEMgMS4zMjUzOSAzLjgyMDQgMy43OTU1NiA3LjEzMDgxIDcuMDY4NiA5LjQ3MzAzQyAxMC4zNDE3IDExLjgxNTIgMTQuMjU1NyAxMy4wNzM0IDE4LjI2OSAxMy4wNzM0QyAyMi4yODIzIDEzLjA3MzQgMjYuMTk2MyAxMS44MTUyIDI5LjQ2OTQgOS40NzMwM0MgMzIuNzQyNCA3LjEzMDgxIDM1LjIxMjYgMy44MjA0IDM2LjUzOCAwQyAzMi45NzA1IDQuMjU3NiAyNi4xMTQ4IDcuMTM0MTEgMTguMjY0NiA3LjEzNDExWiIvPgogICAgICA8cGF0aCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNjM5LjczIDIyODUuNDgpIiBkPSJNIDE4LjI3MzMgNS45MzkzMUMgMjYuMTIzNSA1LjkzOTMxIDMyLjk3OTMgOC44MTU4MyAzNi41MzggMTMuMDczNEMgMzUuMjEyNiA5LjI1MzAzIDMyLjc0MjQgNS45NDI2MiAyOS40Njk0IDMuNjAwNEMgMjYuMTk2MyAxLjI1ODE4IDIyLjI4MjMgMCAxOC4yNjkgMEMgMTQuMjU1NyAwIDEwLjM0MTcgMS4yNTgxOCA3LjA2ODYgMy42MDA0QyAzLjc5NTU2IDUuOTQyNjIgMS4zMjUzOSA5LjI1MzAzIDAgMTMuMDczNEMgMy41Njc0NSA4LjgyNDYzIDEwLjQyMzIgNS45MzkzMSAxOC4yNzMzIDUuOTM5MzFaIi8+CiAgICA8L2c+CiAgICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgICA8cGF0aCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNjY5LjMgMjI4MS4zMSkiIGQ9Ik0gNS44OTM1MyAyLjg0NEMgNS45MTg4OSAzLjQzMTY1IDUuNzcwODUgNC4wMTM2NyA1LjQ2ODE1IDQuNTE2NDVDIDUuMTY1NDUgNS4wMTkyMiA0LjcyMTY4IDUuNDIwMTUgNC4xOTI5OSA1LjY2ODUxQyAzLjY2NDMgNS45MTY4OCAzLjA3NDQ0IDYuMDAxNTEgMi40OTgwNSA1LjkxMTcxQyAxLjkyMTY2IDUuODIxOSAxLjM4NDYzIDUuNTYxNyAwLjk1NDg5OCA1LjE2NDAxQyAwLjUyNTE3IDQuNzY2MzMgMC4yMjIwNTYgNC4yNDkwMyAwLjA4MzkwMzcgMy42Nzc1N0MgLTAuMDU0MjQ4MyAzLjEwNjExIC0wLjAyMTIzIDIuNTA2MTcgMC4xNzg3ODEgMS45NTM2NEMgMC4zNzg3OTMgMS40MDExIDAuNzM2ODA5IDAuOTIwODE3IDEuMjA3NTQgMC41NzM1MzhDIDEuNjc4MjYgMC4yMjYyNTkgMi4yNDA1NSAwLjAyNzU5MTkgMi44MjMyNiAwLjAwMjY3MjI5QyAzLjYwMzg5IC0wLjAzMDcxMTUgNC4zNjU3MyAwLjI0OTc4OSA0Ljk0MTQyIDAuNzgyNTUxQyA1LjUxNzExIDEuMzE1MzEgNS44NTk1NiAyLjA1Njc2IDUuODkzNTMgMi44NDRaIi8+CiAgICAgIDxwYXRoIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE2MzkuOCAyMzIzLjgxKSIgZD0iTSA3LjQyNzg5IDMuNTgzMzhDIDcuNDYwMDggNC4zMjQzIDcuMjczNTUgNS4wNTgxOSA2Ljg5MTkzIDUuNjkyMTNDIDYuNTEwMzEgNi4zMjYwNyA1Ljk1MDc1IDYuODMxNTYgNS4yODQxMSA3LjE0NDZDIDQuNjE3NDcgNy40NTc2MyAzLjg3MzcxIDcuNTY0MTQgMy4xNDcwMiA3LjQ1MDYzQyAyLjQyMDMyIDcuMzM3MTIgMS43NDMzNiA3LjAwODcgMS4yMDE4NCA2LjUwNjk1QyAwLjY2MDMyOCA2LjAwNTIgMC4yNzg2MSA1LjM1MjY4IDAuMTA1MDE3IDQuNjMyMDJDIC0wLjA2ODU3NTcgMy45MTEzNSAtMC4wMjYyMzYxIDMuMTU0OTQgMC4yMjY2NzUgMi40NTg1NkMgMC40Nzk1ODcgMS43NjIxNyAwLjkzMTY5NyAxLjE1NzEzIDEuNTI1NzYgMC43MjAwMzNDIDIuMTE5ODMgMC4yODI5MzUgMi44MjkxNCAwLjAzMzQzOTUgMy41NjM4OSAwLjAwMzEzMzQ0QyA0LjU0NjY3IC0wLjAzNzQwMzMgNS41MDUyOSAwLjMxNjcwNiA2LjIyOTYxIDAuOTg3ODM1QyA2Ljk1MzkzIDEuNjU4OTYgNy4zODQ4NCAyLjU5MjM1IDcuNDI3ODkgMy41ODMzOEwgNy40Mjc4OSAzLjU4MzM4WiIvPgogICAgICA8cGF0aCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNjM4LjM2IDIyODYuMDYpIiBkPSJNIDIuMjc0NzEgNC4zOTYyOUMgMS44NDM2MyA0LjQxNTA4IDEuNDE2NzEgNC4zMDQ0NSAxLjA0Nzk5IDQuMDc4NDNDIDAuNjc5MjY4IDMuODUyNCAwLjM4NTMyOCAzLjUyMTE0IDAuMjAzMzcxIDMuMTI2NTZDIDAuMDIxNDEzNiAyLjczMTk4IC0wLjA0MDM3OTggMi4yOTE4MyAwLjAyNTgxMTYgMS44NjE4MUMgMC4wOTIwMDMxIDEuNDMxOCAwLjI4MzIwNCAxLjAzMTI2IDAuNTc1MjEzIDAuNzEwODgzQyAwLjg2NzIyMiAwLjM5MDUxIDEuMjQ2OTEgMC4xNjQ3MDggMS42NjYyMiAwLjA2MjA1OTJDIDIuMDg1NTMgLTAuMDQwNTg5NyAyLjUyNTYxIC0wLjAxNTQ3MTQgMi45MzA3NiAwLjEzNDIzNUMgMy4zMzU5MSAwLjI4Mzk0MSAzLjY4NzkyIDAuNTUxNTA1IDMuOTQyMjIgMC45MDMwNkMgNC4xOTY1MiAxLjI1NDYyIDQuMzQxNjkgMS42NzQzNiA0LjM1OTM1IDIuMTA5MTZDIDQuMzgyOTkgMi42OTEwNyA0LjE3Njc4IDMuMjU4NjkgMy43ODU5NyAzLjY4NzQ2QyAzLjM5NTE2IDQuMTE2MjQgMi44NTE2NiA0LjM3MTE2IDIuMjc0NzEgNC4zOTYyOUwgMi4yNzQ3MSA0LjM5NjI5WiIvPgogICAgPC9nPgogIDwvZz4+Cjwvc3ZnPgo=);
  --jp-icon-jupyterlab-wordmark: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMDAiIHZpZXdCb3g9IjAgMCAxODYwLjggNDc1Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjIiIGZpbGw9IiM0RTRFNEUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQ4MC4xMzY0MDEsIDY0LjI3MTQ5MykiPgogICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMDAwMDAsIDU4Ljg3NTU2NikiPgogICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjA4NzYwMywgMC4xNDAyOTQpIj4KICAgICAgICA8cGF0aCBkPSJNLTQyNi45LDE2OS44YzAsNDguNy0zLjcsNjQuNy0xMy42LDc2LjRjLTEwLjgsMTAtMjUsMTUuNS0zOS43LDE1LjVsMy43LDI5IGMyMi44LDAuMyw0NC44LTcuOSw2MS45LTIzLjFjMTcuOC0xOC41LDI0LTQ0LjEsMjQtODMuM1YwSC00Mjd2MTcwLjFMLTQyNi45LDE2OS44TC00MjYuOSwxNjkuOHoiLz4KICAgICAgPC9nPgogICAgPC9nPgogICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTU1LjA0NTI5NiwgNTYuODM3MTA0KSI+CiAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEuNTYyNDUzLCAxLjc5OTg0MikiPgogICAgICAgIDxwYXRoIGQ9Ik0tMzEyLDE0OGMwLDIxLDAsMzkuNSwxLjcsNTUuNGgtMzEuOGwtMi4xLTMzLjNoLTAuOGMtNi43LDExLjYtMTYuNCwyMS4zLTI4LDI3LjkgYy0xMS42LDYuNi0yNC44LDEwLTM4LjIsOS44Yy0zMS40LDAtNjktMTcuNy02OS04OVYwaDM2LjR2MTEyLjdjMCwzOC43LDExLjYsNjQuNyw0NC42LDY0LjdjMTAuMy0wLjIsMjAuNC0zLjUsMjguOS05LjQgYzguNS01LjksMTUuMS0xNC4zLDE4LjktMjMuOWMyLjItNi4xLDMuMy0xMi41LDMuMy0xOC45VjAuMmgzNi40VjE0OEgtMzEyTC0zMTIsMTQ4eiIvPgogICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzOTAuMDEzMzIyLCA1My40Nzk2MzgpIj4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMS43MDY0NTgsIDAuMjMxNDI1KSI+CiAgICAgICAgPHBhdGggZD0iTS00NzguNiw3MS40YzAtMjYtMC44LTQ3LTEuNy02Ni43aDMyLjdsMS43LDM0LjhoMC44YzcuMS0xMi41LDE3LjUtMjIuOCwzMC4xLTI5LjcgYzEyLjUtNywyNi43LTEwLjMsNDEtOS44YzQ4LjMsMCw4NC43LDQxLjcsODQuNywxMDMuM2MwLDczLjEtNDMuNywxMDkuMi05MSwxMDkuMmMtMTIuMSwwLjUtMjQuMi0yLjItMzUtNy44IGMtMTAuOC01LjYtMTkuOS0xMy45LTI2LjYtMjQuMmgtMC44VjI5MWgtMzZ2LTIyMEwtNDc4LjYsNzEuNEwtNDc4LjYsNzEuNHogTS00NDIuNiwxMjUuNmMwLjEsNS4xLDAuNiwxMC4xLDEuNywxNS4xIGMzLDEyLjMsOS45LDIzLjMsMTkuOCwzMS4xYzkuOSw3LjgsMjIuMSwxMi4xLDM0LjcsMTIuMWMzOC41LDAsNjAuNy0zMS45LDYwLjctNzguNWMwLTQwLjctMjEuMS03NS42LTU5LjUtNzUuNiBjLTEyLjksMC40LTI1LjMsNS4xLTM1LjMsMTMuNGMtOS45LDguMy0xNi45LDE5LjctMTkuNiwzMi40Yy0xLjUsNC45LTIuMywxMC0yLjUsMTUuMVYxMjUuNkwtNDQyLjYsMTI1LjZMLTQ0Mi42LDEyNS42eiIvPgogICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSg2MDYuNzQwNzI2LCA1Ni44MzcxMDQpIj4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC43NTEyMjYsIDEuOTg5Mjk5KSI+CiAgICAgICAgPHBhdGggZD0iTS00NDAuOCwwbDQzLjcsMTIwLjFjNC41LDEzLjQsOS41LDI5LjQsMTIuOCw0MS43aDAuOGMzLjctMTIuMiw3LjktMjcuNywxMi44LTQyLjQgbDM5LjctMTE5LjJoMzguNUwtMzQ2LjksMTQ1Yy0yNiw2OS43LTQzLjcsMTA1LjQtNjguNiwxMjcuMmMtMTIuNSwxMS43LTI3LjksMjAtNDQuNiwyMy45bC05LjEtMzEuMSBjMTEuNy0zLjksMjIuNS0xMC4xLDMxLjgtMTguMWMxMy4yLTExLjEsMjMuNy0yNS4yLDMwLjYtNDEuMmMxLjUtMi44LDIuNS01LjcsMi45LTguOGMtMC4zLTMuMy0xLjItNi42LTIuNS05LjdMLTQ4MC4yLDAuMSBoMzkuN0wtNDQwLjgsMEwtNDQwLjgsMHoiLz4KICAgICAgPC9nPgogICAgPC9nPgogICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoODIyLjc0ODEwNCwgMC4wMDAwMDApIj4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMS40NjQwNTAsIDAuMzc4OTE0KSI+CiAgICAgICAgPHBhdGggZD0iTS00MTMuNywwdjU4LjNoNTJ2MjguMmgtNTJWMTk2YzAsMjUsNywzOS41LDI3LjMsMzkuNWM3LjEsMC4xLDE0LjItMC43LDIxLjEtMi41IGwxLjcsMjcuN2MtMTAuMywzLjctMjEuMyw1LjQtMzIuMiw1Yy03LjMsMC40LTE0LjYtMC43LTIxLjMtMy40Yy02LjgtMi43LTEyLjktNi44LTE3LjktMTIuMWMtMTAuMy0xMC45LTE0LjEtMjktMTQuMS01Mi45IFY4Ni41aC0zMVY1OC4zaDMxVjkuNkwtNDEzLjcsMEwtNDEzLjcsMHoiLz4KICAgICAgPC9nPgogICAgPC9nPgogICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOTc0LjQzMzI4NiwgNTMuNDc5NjM4KSI+CiAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAuOTkwMDM0LCAwLjYxMDMzOSkiPgogICAgICAgIDxwYXRoIGQ9Ik0tNDQ1LjgsMTEzYzAuOCw1MCwzMi4yLDcwLjYsNjguNiw3MC42YzE5LDAuNiwzNy45LTMsNTUuMy0xMC41bDYuMiwyNi40IGMtMjAuOSw4LjktNDMuNSwxMy4xLTY2LjIsMTIuNmMtNjEuNSwwLTk4LjMtNDEuMi05OC4zLTEwMi41Qy00ODAuMiw0OC4yLTQ0NC43LDAtMzg2LjUsMGM2NS4yLDAsODIuNyw1OC4zLDgyLjcsOTUuNyBjLTAuMSw1LjgtMC41LDExLjUtMS4yLDE3LjJoLTE0MC42SC00NDUuOEwtNDQ1LjgsMTEzeiBNLTMzOS4yLDg2LjZjMC40LTIzLjUtOS41LTYwLjEtNTAuNC02MC4xIGMtMzYuOCwwLTUyLjgsMzQuNC01NS43LDYwLjFILTMzOS4yTC0zMzkuMiw4Ni42TC0zMzkuMiw4Ni42eiIvPgogICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMjAxLjk2MTA1OCwgNTMuNDc5NjM4KSI+CiAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEuMTc5NjQwLCAwLjcwNTA2OCkiPgogICAgICAgIDxwYXRoIGQ9Ik0tNDc4LjYsNjhjMC0yMy45LTAuNC00NC41LTEuNy02My40aDMxLjhsMS4yLDM5LjloMS43YzkuMS0yNy4zLDMxLTQ0LjUsNTUuMy00NC41IGMzLjUtMC4xLDcsMC40LDEwLjMsMS4ydjM0LjhjLTQuMS0wLjktOC4yLTEuMy0xMi40LTEuMmMtMjUuNiwwLTQzLjcsMTkuNy00OC43LDQ3LjRjLTEsNS43LTEuNiwxMS41LTEuNywxNy4ydjEwOC4zaC0zNlY2OCBMLTQ3OC42LDY4eiIvPgogICAgICA8L2c+CiAgICA8L2c+CiAgPC9nPgoKICA8ZyBjbGFzcz0ianAtaWNvbi13YXJuMCIgZmlsbD0iI0YzNzcyNiI+CiAgICA8cGF0aCBkPSJNMTM1Mi4zLDMyNi4yaDM3VjI4aC0zN1YzMjYuMnogTTE2MDQuOCwzMjYuMmMtMi41LTEzLjktMy40LTMxLjEtMy40LTQ4Ljd2LTc2IGMwLTQwLjctMTUuMS04My4xLTc3LjMtODMuMWMtMjUuNiwwLTUwLDcuMS02Ni44LDE4LjFsOC40LDI0LjRjMTQuMy05LjIsMzQtMTUuMSw1My0xNS4xYzQxLjYsMCw0Ni4yLDMwLjIsNDYuMiw0N3Y0LjIgYy03OC42LTAuNC0xMjIuMywyNi41LTEyMi4zLDc1LjZjMCwyOS40LDIxLDU4LjQsNjIuMiw1OC40YzI5LDAsNTAuOS0xNC4zLDYyLjItMzAuMmgxLjNsMi45LDI1LjZIMTYwNC44eiBNMTU2NS43LDI1Ny43IGMwLDMuOC0wLjgsOC0yLjEsMTEuOGMtNS45LDE3LjItMjIuNywzNC00OS4yLDM0Yy0xOC45LDAtMzQuOS0xMS4zLTM0LjktMzUuM2MwLTM5LjUsNDUuOC00Ni42LDg2LjItNDUuOFYyNTcuN3ogTTE2OTguNSwzMjYuMiBsMS43LTMzLjZoMS4zYzE1LjEsMjYuOSwzOC43LDM4LjIsNjguMSwzOC4yYzQ1LjQsMCw5MS4yLTM2LjEsOTEuMi0xMDguOGMwLjQtNjEuNy0zNS4zLTEwMy43LTg1LjctMTAzLjcgYy0zMi44LDAtNTYuMywxNC43LTY5LjMsMzcuNGgtMC44VjI4aC0zNi42djI0NS43YzAsMTguMS0wLjgsMzguNi0xLjcsNTIuNUgxNjk4LjV6IE0xNzA0LjgsMjA4LjJjMC01LjksMS4zLTEwLjksMi4xLTE1LjEgYzcuNi0yOC4xLDMxLjEtNDUuNCw1Ni4zLTQ1LjRjMzkuNSwwLDYwLjUsMzQuOSw2MC41LDc1LjZjMCw0Ni42LTIzLjEsNzguMS02MS44LDc4LjFjLTI2LjksMC00OC4zLTE3LjYtNTUuNS00My4zIGMtMC44LTQuMi0xLjctOC44LTEuNy0xMy40VjIwOC4yeiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-kernel: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICAgIDxwYXRoIGNsYXNzPSJqcC1pY29uMiIgZmlsbD0iIzYxNjE2MSIgZD0iTTE1IDlIOXY2aDZWOXptLTIgNGgtMnYtMmgydjJ6bTgtMlY5aC0yVjdjMC0xLjEtLjktMi0yLTJoLTJWM2gtMnYyaC0yVjNIOXYySDdjLTEuMSAwLTIgLjktMiAydjJIM3YyaDJ2MkgzdjJoMnYyYzAgMS4xLjkgMiAyIDJoMnYyaDJ2LTJoMnYyaDJ2LTJoMmMxLjEgMCAyLS45IDItMnYtMmgydi0yaC0ydi0yaDJ6bS00IDZIN1Y3aDEwdjEweiIvPgo8L3N2Zz4K);
  --jp-icon-keyboard: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8cGF0aCBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIiBkPSJNMjAgNUg0Yy0xLjEgMC0xLjk5LjktMS45OSAyTDIgMTdjMCAxLjEuOSAyIDIgMmgxNmMxLjEgMCAyLS45IDItMlY3YzAtMS4xLS45LTItMi0yem0tOSAzaDJ2MmgtMlY4em0wIDNoMnYyaC0ydi0yek04IDhoMnYySDhWOHptMCAzaDJ2Mkg4di0yem0tMSAySDV2LTJoMnYyem0wLTNINVY4aDJ2MnptOSA3SDh2LTJoOHYyem0wLTRoLTJ2LTJoMnYyem0wLTNoLTJWOGgydjJ6bTMgM2gtMnYtMmgydjJ6bTAtM2gtMlY4aDJ2MnoiLz4KPC9zdmc+Cg==);
  --jp-icon-launch: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMzIgMzIiIHdpZHRoPSIzMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIj4KICAgIDxwYXRoIGQ9Ik0yNiwyOEg2YTIuMDAyNywyLjAwMjcsMCwwLDEtMi0yVjZBMi4wMDI3LDIuMDAyNywwLDAsMSw2LDRIMTZWNkg2VjI2SDI2VjE2aDJWMjZBMi4wMDI3LDIuMDAyNywwLDAsMSwyNiwyOFoiLz4KICAgIDxwb2x5Z29uIHBvaW50cz0iMjAgMiAyMCA0IDI2LjU4NiA0IDE4IDEyLjU4NiAxOS40MTQgMTQgMjggNS40MTQgMjggMTIgMzAgMTIgMzAgMiAyMCAyIi8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-launcher: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8cGF0aCBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIiBkPSJNMTkgMTlINVY1aDdWM0g1YTIgMiAwIDAwLTIgMnYxNGEyIDIgMCAwMDIgMmgxNGMxLjEgMCAyLS45IDItMnYtN2gtMnY3ek0xNCAzdjJoMy41OWwtOS44MyA5LjgzIDEuNDEgMS40MUwxOSA2LjQxVjEwaDJWM2gtN3oiLz4KPC9zdmc+Cg==);
  --jp-icon-line-form: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICAgIDxwYXRoIGZpbGw9IndoaXRlIiBkPSJNNS44OCA0LjEyTDEzLjc2IDEybC03Ljg4IDcuODhMOCAyMmwxMC0xMEw4IDJ6Ii8+Cjwvc3ZnPgo=);
  --jp-icon-link: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTMuOSAxMmMwLTEuNzEgMS4zOS0zLjEgMy4xLTMuMWg0VjdIN2MtMi43NiAwLTUgMi4yNC01IDVzMi4yNCA1IDUgNWg0di0xLjlIN2MtMS43MSAwLTMuMS0xLjM5LTMuMS0zLjF6TTggMTNoOHYtMkg4djJ6bTktNmgtNHYxLjloNGMxLjcxIDAgMy4xIDEuMzkgMy4xIDMuMXMtMS4zOSAzLjEtMy4xIDMuMWgtNFYxN2g0YzIuNzYgMCA1LTIuMjQgNS01cy0yLjI0LTUtNS01eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-list: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICAgIDxwYXRoIGNsYXNzPSJqcC1pY29uMiBqcC1pY29uLXNlbGVjdGFibGUiIGZpbGw9IiM2MTYxNjEiIGQ9Ik0xOSA1djE0SDVWNWgxNG0xLjEtMkgzLjljLS41IDAtLjkuNC0uOS45djE2LjJjMCAuNC40LjkuOS45aDE2LjJjLjQgMCAuOS0uNS45LS45VjMuOWMwLS41LS41LS45LS45LS45ek0xMSA3aDZ2MmgtNlY3em0wIDRoNnYyaC02di0yem0wIDRoNnYyaC02ek03IDdoMnYySDd6bTAgNGgydjJIN3ptMCA0aDJ2Mkg3eiIvPgo8L3N2Zz4K);
  --jp-icon-markdown: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8cGF0aCBjbGFzcz0ianAtaWNvbi1jb250cmFzdDAganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjN0IxRkEyIiBkPSJNNSAxNC45aDEybC02LjEgNnptOS40LTYuOGMwLTEuMy0uMS0yLjktLjEtNC41LS40IDEuNC0uOSAyLjktMS4zIDQuM2wtMS4zIDQuM2gtMkw4LjUgNy45Yy0uNC0xLjMtLjctMi45LTEtNC4zLS4xIDEuNi0uMSAzLjItLjIgNC42TDcgMTIuNEg0LjhsLjctMTFoMy4zTDEwIDVjLjQgMS4yLjcgMi43IDEgMy45LjMtMS4yLjctMi42IDEtMy45bDEuMi0zLjdoMy4zbC42IDExaC0yLjRsLS4zLTQuMnoiLz4KPC9zdmc+Cg==);
  --jp-icon-move-down: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAxNCAxNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggY2xhc3M9ImpwLWljb24zIiBkPSJNMTIuNDcxIDcuNTI4OTlDMTIuNzYzMiA3LjIzNjg0IDEyLjc2MzIgNi43NjMxNiAxMi40NzEgNi40NzEwMVY2LjQ3MTAxQzEyLjE3OSA2LjE3OTA1IDExLjcwNTcgNi4xNzg4NCAxMS40MTM1IDYuNDcwNTRMNy43NSAxMC4xMjc1VjEuNzVDNy43NSAxLjMzNTc5IDcuNDE0MjEgMSA3IDFWMUM2LjU4NTc5IDEgNi4yNSAxLjMzNTc5IDYuMjUgMS43NVYxMC4xMjc1TDIuNTk3MjYgNi40NjgyMkMyLjMwMzM4IDYuMTczODEgMS44MjY0MSA2LjE3MzU5IDEuNTMyMjYgNi40Njc3NFY2LjQ2Nzc0QzEuMjM4MyA2Ljc2MTcgMS4yMzgzIDcuMjM4MyAxLjUzMjI2IDcuNTMyMjZMNi4yOTI4OSAxMi4yOTI5QzYuNjgzNDIgMTIuNjgzNCA3LjMxNjU4IDEyLjY4MzQgNy43MDcxMSAxMi4yOTI5TDEyLjQ3MSA3LjUyODk5WiIgZmlsbD0iIzYxNjE2MSIvPgo8L3N2Zz4K);
  --jp-icon-move-up: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAxNCAxNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggY2xhc3M9ImpwLWljb24zIiBkPSJNMS41Mjg5OSA2LjQ3MTAxQzEuMjM2ODQgNi43NjMxNiAxLjIzNjg0IDcuMjM2ODQgMS41Mjg5OSA3LjUyODk5VjcuNTI4OTlDMS44MjA5NSA3LjgyMDk1IDIuMjk0MjYgNy44MjExNiAyLjU4NjQ5IDcuNTI5NDZMNi4yNSAzLjg3MjVWMTIuMjVDNi4yNSAxMi42NjQyIDYuNTg1NzkgMTMgNyAxM1YxM0M3LjQxNDIxIDEzIDcuNzUgMTIuNjY0MiA3Ljc1IDEyLjI1VjMuODcyNUwxMS40MDI3IDcuNTMxNzhDMTEuNjk2NiA3LjgyNjE5IDEyLjE3MzYgNy44MjY0MSAxMi40Njc3IDcuNTMyMjZWNy41MzIyNkMxMi43NjE3IDcuMjM4MyAxMi43NjE3IDYuNzYxNyAxMi40Njc3IDYuNDY3NzRMNy43MDcxMSAxLjcwNzExQzcuMzE2NTggMS4zMTY1OCA2LjY4MzQyIDEuMzE2NTggNi4yOTI4OSAxLjcwNzExTDEuNTI4OTkgNi40NzEwMVoiIGZpbGw9IiM2MTYxNjEiLz4KPC9zdmc+Cg==);
  --jp-icon-new-folder: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTIwIDZoLThsLTItMkg0Yy0xLjExIDAtMS45OS44OS0xLjk5IDJMMiAxOGMwIDEuMTEuODkgMiAyIDJoMTZjMS4xMSAwIDItLjg5IDItMlY4YzAtMS4xMS0uODktMi0yLTJ6bS0xIDhoLTN2M2gtMnYtM2gtM3YtMmgzVjloMnYzaDN2MnoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-not-trusted: url(data:image/svg+xml;base64,PHN2ZyBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI1IDI1Ij4KICAgIDxwYXRoIGNsYXNzPSJqcC1pY29uMiIgc3Ryb2tlPSIjMzMzMzMzIiBzdHJva2Utd2lkdGg9IjIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDMgMykiIGQ9Ik0xLjg2MDk0IDExLjQ0MDlDMC44MjY0NDggOC43NzAyNyAwLjg2Mzc3OSA2LjA1NzY0IDEuMjQ5MDcgNC4xOTkzMkMyLjQ4MjA2IDMuOTMzNDcgNC4wODA2OCAzLjQwMzQ3IDUuNjAxMDIgMi44NDQ5QzcuMjM1NDkgMi4yNDQ0IDguODU2NjYgMS41ODE1IDkuOTg3NiAxLjA5NTM5QzExLjA1OTcgMS41ODM0MSAxMi42MDk0IDIuMjQ0NCAxNC4yMTggMi44NDMzOUMxNS43NTAzIDMuNDEzOTQgMTcuMzk5NSAzLjk1MjU4IDE4Ljc1MzkgNC4yMTM4NUMxOS4xMzY0IDYuMDcxNzcgMTkuMTcwOSA4Ljc3NzIyIDE4LjEzOSAxMS40NDA5QzE3LjAzMDMgMTQuMzAzMiAxNC42NjY4IDE3LjE4NDQgOS45OTk5OSAxOC45MzU0QzUuMzMzMTkgMTcuMTg0NCAyLjk2OTY4IDE0LjMwMzIgMS44NjA5NCAxMS40NDA5WiIvPgogICAgPHBhdGggY2xhc3M9ImpwLWljb24yIiBzdHJva2U9IiMzMzMzMzMiIHN0cm9rZS13aWR0aD0iMiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOS4zMTU5MiA5LjMyMDMxKSIgZD0iTTcuMzY4NDIgMEwwIDcuMzY0NzkiLz4KICAgIDxwYXRoIGNsYXNzPSJqcC1pY29uMiIgc3Ryb2tlPSIjMzMzMzMzIiBzdHJva2Utd2lkdGg9IjIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDkuMzE1OTIgMTYuNjgzNikgc2NhbGUoMSAtMSkiIGQ9Ik03LjM2ODQyIDBMMCA3LjM2NDc5Ii8+Cjwvc3ZnPgo=);
  --jp-icon-notebook: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8ZyBjbGFzcz0ianAtbm90ZWJvb2staWNvbi1jb2xvciBqcC1pY29uLXNlbGVjdGFibGUiIGZpbGw9IiNFRjZDMDAiPgogICAgPHBhdGggZD0iTTE4LjcgMy4zdjE1LjRIMy4zVjMuM2gxNS40bTEuNS0xLjVIMS44djE4LjNoMTguM2wuMS0xOC4zeiIvPgogICAgPHBhdGggZD0iTTE2LjUgMTYuNWwtNS40LTQuMy01LjYgNC4zdi0xMWgxMXoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-numbering: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9IjAgMCAyOCAyOCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KCTxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CgkJPHBhdGggZD0iTTQgMTlINlYxOS41SDVWMjAuNUg2VjIxSDRWMjJIN1YxOEg0VjE5Wk01IDEwSDZWNkg0VjdINVYxMFpNNCAxM0g1LjhMNCAxNS4xVjE2SDdWMTVINS4yTDcgMTIuOVYxMkg0VjEzWk05IDdWOUgyM1Y3SDlaTTkgMjFIMjNWMTlIOVYyMVpNOSAxNUgyM1YxM0g5VjE1WiIvPgoJPC9nPgo8L3N2Zz4K);
  --jp-icon-offline-bolt: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjE2Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTEyIDIuMDJjLTUuNTEgMC05Ljk4IDQuNDctOS45OCA5Ljk4czQuNDcgOS45OCA5Ljk4IDkuOTggOS45OC00LjQ3IDkuOTgtOS45OFMxNy41MSAyLjAyIDEyIDIuMDJ6TTExLjQ4IDIwdi02LjI2SDhMMTMgNHY2LjI2aDMuMzVMMTEuNDggMjB6Ii8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-palette: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTE4IDEzVjIwSDRWNkg5LjAyQzkuMDcgNS4yOSA5LjI0IDQuNjIgOS41IDRINEMyLjkgNCAyIDQuOSAyIDZWMjBDMiAyMS4xIDIuOSAyMiA0IDIySDE4QzE5LjEgMjIgMjAgMjEuMSAyMCAyMFYxNUwxOCAxM1pNMTkuMyA4Ljg5QzE5Ljc0IDguMTkgMjAgNy4zOCAyMCA2LjVDMjAgNC4wMSAxNy45OSAyIDE1LjUgMkMxMy4wMSAyIDExIDQuMDEgMTEgNi41QzExIDguOTkgMTMuMDEgMTEgMTUuNDkgMTFDMTYuMzcgMTEgMTcuMTkgMTAuNzQgMTcuODggMTAuM0wyMSAxMy40MkwyMi40MiAxMkwxOS4zIDguODlaTTE1LjUgOUMxNC4xMiA5IDEzIDcuODggMTMgNi41QzEzIDUuMTIgMTQuMTIgNCAxNS41IDRDMTYuODggNCAxOCA1LjEyIDE4IDYuNUMxOCA3Ljg4IDE2Ljg4IDkgMTUuNSA5WiIvPgogICAgPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik00IDZIOS4wMTg5NEM5LjAwNjM5IDYuMTY1MDIgOSA2LjMzMTc2IDkgNi41QzkgOC44MTU3NyAxMC4yMTEgMTAuODQ4NyAxMi4wMzQzIDEySDlWMTRIMTZWMTIuOTgxMUMxNi41NzAzIDEyLjkzNzcgMTcuMTIgMTIuODIwNyAxNy42Mzk2IDEyLjYzOTZMMTggMTNWMjBINFY2Wk04IDhINlYxMEg4VjhaTTYgMTJIOFYxNEg2VjEyWk04IDE2SDZWMThIOFYxNlpNOSAxNkgxNlYxOEg5VjE2WiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-paste: url(data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGggZD0iTTE5IDJoLTQuMThDMTQuNC44NCAxMy4zIDAgMTIgMGMtMS4zIDAtMi40Ljg0LTIuODIgMkg1Yy0xLjEgMC0yIC45LTIgMnYxNmMwIDEuMS45IDIgMiAyaDE0YzEuMSAwIDItLjkgMi0yVjRjMC0xLjEtLjktMi0yLTJ6bS03IDBjLjU1IDAgMSAuNDUgMSAxcy0uNDUgMS0xIDEtMS0uNDUtMS0xIC40NS0xIDEtMXptNyAxOEg1VjRoMnYzaDEwVjRoMnYxNnoiLz4KICAgIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-pdf: url(data:image/svg+xml;base64,PHN2ZwogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMiAyMiIgd2lkdGg9IjE2Ij4KICAgIDxwYXRoIHRyYW5zZm9ybT0icm90YXRlKDQ1KSIgY2xhc3M9ImpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iI0ZGMkEyQSIKICAgICAgIGQ9Im0gMjIuMzQ0MzY5LC0zLjAxNjM2NDIgaCA1LjYzODYwNCB2IDEuNTc5MjQzMyBoIC0zLjU0OTIyNyB2IDEuNTA4NjkyOTkgaCAzLjMzNzU3NiBWIDEuNjUwODE1NCBoIC0zLjMzNzU3NiB2IDMuNDM1MjYxMyBoIC0yLjA4OTM3NyB6IG0gLTcuMTM2NDQ0LDEuNTc5MjQzMyB2IDQuOTQzOTU0MyBoIDAuNzQ4OTIgcSAxLjI4MDc2MSwwIDEuOTUzNzAzLC0wLjYzNDk1MzUgMC42NzgzNjksLTAuNjM0OTUzNSAwLjY3ODM2OSwtMS44NDUxNjQxIDAsLTEuMjA0NzgzNTUgLTAuNjcyOTQyLC0xLjgzNDMxMDExIC0wLjY3Mjk0MiwtMC42Mjk1MjY1OSAtMS45NTkxMywtMC42Mjk1MjY1OSB6IG0gLTIuMDg5Mzc3LC0xLjU3OTI0MzMgaCAyLjIwMzM0MyBxIDEuODQ1MTY0LDAgMi43NDYwMzksMC4yNjU5MjA3IDAuOTA2MzAxLDAuMjYwNDkzNyAxLjU1MjEwOCwwLjg5MDAyMDMgMC41Njk4MywwLjU0ODEyMjMgMC44NDY2MDUsMS4yNjQ0ODAwNiAwLjI3Njc3NCwwLjcxNjM1NzgxIDAuMjc2Nzc0LDEuNjIyNjU4OTQgMCwwLjkxNzE1NTEgLTAuMjc2Nzc0LDEuNjM4OTM5OSAtMC4yNzY3NzUsMC43MTYzNTc4IC0wLjg0NjYwNSwxLjI2NDQ4IC0wLjY1MTIzNCwwLjYyOTUyNjYgLTEuNTYyOTYyLDAuODk1NDQ3MyAtMC45MTE3MjgsMC4yNjA0OTM3IC0yLjczNTE4NSwwLjI2MDQ5MzcgaCAtMi4yMDMzNDMgeiBtIC04LjE0NTg1NjUsMCBoIDMuNDY3ODIzIHEgMS41NDY2ODE2LDAgMi4zNzE1Nzg1LDAuNjg5MjIzIDAuODMwMzI0LDAuNjgzNzk2MSAwLjgzMDMyNCwxLjk1MzcwMzE0IDAsMS4yNzUzMzM5NyAtMC44MzAzMjQsMS45NjQ1NTcwNiBRIDkuOTg3MTk2MSwyLjI3NDkxNSA4LjQ0MDUxNDUsMi4yNzQ5MTUgSCA3LjA2MjA2ODQgViA1LjA4NjA3NjcgSCA0Ljk3MjY5MTUgWiBtIDIuMDg5Mzc2OSwxLjUxNDExOTkgdiAyLjI2MzAzOTQzIGggMS4xNTU5NDEgcSAwLjYwNzgxODgsMCAwLjkzODg2MjksLTAuMjkzMDU1NDcgMC4zMzEwNDQxLC0wLjI5ODQ4MjQxIDAuMzMxMDQ0MSwtMC44NDExNzc3MiAwLC0wLjU0MjY5NTMxIC0wLjMzMTA0NDEsLTAuODM1NzUwNzQgLTAuMzMxMDQ0MSwtMC4yOTMwNTU1IC0wLjkzODg2MjksLTAuMjkzMDU1NSB6IgovPgo8L3N2Zz4K);
  --jp-icon-python: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iLTEwIC0xMCAxMzEuMTYxMzYxNjk0MzM1OTQgMTMyLjM4ODk5OTkzODk2NDg0Ij4KICA8cGF0aCBjbGFzcz0ianAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjMzA2OTk4IiBkPSJNIDU0LjkxODc4NSw5LjE5Mjc0MjFlLTQgQyA1MC4zMzUxMzIsMC4wMjIyMTcyNyA0NS45NTc4NDYsMC40MTMxMzY5NyA0Mi4xMDYyODUsMS4wOTQ2NjkzIDMwLjc2MDA2OSwzLjA5OTE3MzEgMjguNzAwMDM2LDcuMjk0NzcxNCAyOC43MDAwMzUsMTUuMDMyMTY5IHYgMTAuMjE4NzUgaCAyNi44MTI1IHYgMy40MDYyNSBoIC0yNi44MTI1IC0xMC4wNjI1IGMgLTcuNzkyNDU5LDAgLTE0LjYxNTc1ODgsNC42ODM3MTcgLTE2Ljc0OTk5OTgsMTMuNTkzNzUgLTIuNDYxODE5OTgsMTAuMjEyOTY2IC0yLjU3MTAxNTA4LDE2LjU4NjAyMyAwLDI3LjI1IDEuOTA1OTI4Myw3LjkzNzg1MiA2LjQ1NzU0MzIsMTMuNTkzNzQ4IDE0LjI0OTk5OTgsMTMuNTkzNzUgaCA5LjIxODc1IHYgLTEyLjI1IGMgMCwtOC44NDk5MDIgNy42NTcxNDQsLTE2LjY1NjI0OCAxNi43NSwtMTYuNjU2MjUgaCAyNi43ODEyNSBjIDcuNDU0OTUxLDAgMTMuNDA2MjUzLC02LjEzODE2NCAxMy40MDYyNSwtMTMuNjI1IHYgLTI1LjUzMTI1IGMgMCwtNy4yNjYzMzg2IC02LjEyOTk4LC0xMi43MjQ3NzcxIC0xMy40MDYyNSwtMTMuOTM3NDk5NyBDIDY0LjI4MTU0OCwwLjMyNzk0Mzk3IDU5LjUwMjQzOCwtMC4wMjAzNzkwMyA1NC45MTg3ODUsOS4xOTI3NDIxZS00IFogbSAtMTQuNSw4LjIxODc1MDEyNTc5IGMgMi43Njk1NDcsMCA1LjAzMTI1LDIuMjk4NjQ1NiA1LjAzMTI1LDUuMTI0OTk5NiAtMmUtNiwyLjgxNjMzNiAtMi4yNjE3MDMsNS4wOTM3NSAtNS4wMzEyNSw1LjA5Mzc1IC0yLjc3OTQ3NiwtMWUtNiAtNS4wMzEyNSwtMi4yNzc0MTUgLTUuMDMxMjUsLTUuMDkzNzUgLTEwZS03LC0yLjgyNjM1MyAyLjI1MTc3NCwtNS4xMjQ5OTk2IDUuMDMxMjUsLTUuMTI0OTk5NiB6Ii8+CiAgPHBhdGggY2xhc3M9ImpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iI2ZmZDQzYiIgZD0ibSA4NS42Mzc1MzUsMjguNjU3MTY5IHYgMTEuOTA2MjUgYyAwLDkuMjMwNzU1IC03LjgyNTg5NSwxNi45OTk5OTkgLTE2Ljc1LDE3IGggLTI2Ljc4MTI1IGMgLTcuMzM1ODMzLDAgLTEzLjQwNjI0OSw2LjI3ODQ4MyAtMTMuNDA2MjUsMTMuNjI1IHYgMjUuNTMxMjQ3IGMgMCw3LjI2NjM0NCA2LjMxODU4OCwxMS41NDAzMjQgMTMuNDA2MjUsMTMuNjI1MDA0IDguNDg3MzMxLDIuNDk1NjEgMTYuNjI2MjM3LDIuOTQ2NjMgMjYuNzgxMjUsMCA2Ljc1MDE1NSwtMS45NTQzOSAxMy40MDYyNTMsLTUuODg3NjEgMTMuNDA2MjUsLTEzLjYyNTAwNCBWIDg2LjUwMDkxOSBoIC0yNi43ODEyNSB2IC0zLjQwNjI1IGggMjYuNzgxMjUgMTMuNDA2MjU0IGMgNy43OTI0NjEsMCAxMC42OTYyNTEsLTUuNDM1NDA4IDEzLjQwNjI0MSwtMTMuNTkzNzUgMi43OTkzMywtOC4zOTg4ODYgMi42ODAyMiwtMTYuNDc1Nzc2IDAsLTI3LjI1IC0xLjkyNTc4LC03Ljc1NzQ0MSAtNS42MDM4NywtMTMuNTkzNzUgLTEzLjQwNjI0MSwtMTMuNTkzNzUgeiBtIC0xNS4wNjI1LDY0LjY1NjI1IGMgMi43Nzk0NzgsM2UtNiA1LjAzMTI1LDIuMjc3NDE3IDUuMDMxMjUsNS4wOTM3NDcgLTJlLTYsMi44MjYzNTQgLTIuMjUxNzc1LDUuMTI1MDA0IC01LjAzMTI1LDUuMTI1MDA0IC0yLjc2OTU1LDAgLTUuMDMxMjUsLTIuMjk4NjUgLTUuMDMxMjUsLTUuMTI1MDA0IDJlLTYsLTIuODE2MzMgMi4yNjE2OTcsLTUuMDkzNzQ3IDUuMDMxMjUsLTUuMDkzNzQ3IHoiLz4KPC9zdmc+Cg==);
  --jp-icon-r-kernel: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8cGF0aCBjbGFzcz0ianAtaWNvbi1jb250cmFzdDMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjMjE5NkYzIiBkPSJNNC40IDIuNWMxLjItLjEgMi45LS4zIDQuOS0uMyAyLjUgMCA0LjEuNCA1LjIgMS4zIDEgLjcgMS41IDEuOSAxLjUgMy41IDAgMi0xLjQgMy41LTIuOSA0LjEgMS4yLjQgMS43IDEuNiAyLjIgMyAuNiAxLjkgMSAzLjkgMS4zIDQuNmgtMy44Yy0uMy0uNC0uOC0xLjctMS4yLTMuN3MtMS4yLTIuNi0yLjYtMi42aC0uOXY2LjRINC40VjIuNXptMy43IDYuOWgxLjRjMS45IDAgMi45LS45IDIuOS0yLjNzLTEtMi4zLTIuOC0yLjNjLS43IDAtMS4zIDAtMS42LjJ2NC41aC4xdi0uMXoiLz4KPC9zdmc+Cg==);
  --jp-icon-react: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMTUwIDE1MCA1NDEuOSAyOTUuMyI+CiAgPGcgY2xhc3M9ImpwLWljb24tYnJhbmQyIGpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iIzYxREFGQiI+CiAgICA8cGF0aCBkPSJNNjY2LjMgMjk2LjVjMC0zMi41LTQwLjctNjMuMy0xMDMuMS04Mi40IDE0LjQtNjMuNiA4LTExNC4yLTIwLjItMTMwLjQtNi41LTMuOC0xNC4xLTUuNi0yMi40LTUuNnYyMi4zYzQuNiAwIDguMy45IDExLjQgMi42IDEzLjYgNy44IDE5LjUgMzcuNSAxNC45IDc1LjctMS4xIDkuNC0yLjkgMTkuMy01LjEgMjkuNC0xOS42LTQuOC00MS04LjUtNjMuNS0xMC45LTEzLjUtMTguNS0yNy41LTM1LjMtNDEuNi01MCAzMi42LTMwLjMgNjMuMi00Ni45IDg0LTQ2LjlWNzhjLTI3LjUgMC02My41IDE5LjYtOTkuOSA1My42LTM2LjQtMzMuOC03Mi40LTUzLjItOTkuOS01My4ydjIyLjNjMjAuNyAwIDUxLjQgMTYuNSA4NCA0Ni42LTE0IDE0LjctMjggMzEuNC00MS4zIDQ5LjktMjIuNiAyLjQtNDQgNi4xLTYzLjYgMTEtMi4zLTEwLTQtMTkuNy01LjItMjktNC43LTM4LjIgMS4xLTY3LjkgMTQuNi03NS44IDMtMS44IDYuOS0yLjYgMTEuNS0yLjZWNzguNWMtOC40IDAtMTYgMS44LTIyLjYgNS42LTI4LjEgMTYuMi0zNC40IDY2LjctMTkuOSAxMzAuMS02Mi4yIDE5LjItMTAyLjcgNDkuOS0xMDIuNyA4Mi4zIDAgMzIuNSA0MC43IDYzLjMgMTAzLjEgODIuNC0xNC40IDYzLjYtOCAxMTQuMiAyMC4yIDEzMC40IDYuNSAzLjggMTQuMSA1LjYgMjIuNSA1LjYgMjcuNSAwIDYzLjUtMTkuNiA5OS45LTUzLjYgMzYuNCAzMy44IDcyLjQgNTMuMiA5OS45IDUzLjIgOC40IDAgMTYtMS44IDIyLjYtNS42IDI4LjEtMTYuMiAzNC40LTY2LjcgMTkuOS0xMzAuMSA2Mi0xOS4xIDEwMi41LTQ5LjkgMTAyLjUtODIuM3ptLTEzMC4yLTY2LjdjLTMuNyAxMi45LTguMyAyNi4yLTEzLjUgMzkuNS00LjEtOC04LjQtMTYtMTMuMS0yNC00LjYtOC05LjUtMTUuOC0xNC40LTIzLjQgMTQuMiAyLjEgMjcuOSA0LjcgNDEgNy45em0tNDUuOCAxMDYuNWMtNy44IDEzLjUtMTUuOCAyNi4zLTI0LjEgMzguMi0xNC45IDEuMy0zMCAyLTQ1LjIgMi0xNS4xIDAtMzAuMi0uNy00NS0xLjktOC4zLTExLjktMTYuNC0yNC42LTI0LjItMzgtNy42LTEzLjEtMTQuNS0yNi40LTIwLjgtMzkuOCA2LjItMTMuNCAxMy4yLTI2LjggMjAuNy0zOS45IDcuOC0xMy41IDE1LjgtMjYuMyAyNC4xLTM4LjIgMTQuOS0xLjMgMzAtMiA0NS4yLTIgMTUuMSAwIDMwLjIuNyA0NSAxLjkgOC4zIDExLjkgMTYuNCAyNC42IDI0LjIgMzggNy42IDEzLjEgMTQuNSAyNi40IDIwLjggMzkuOC02LjMgMTMuNC0xMy4yIDI2LjgtMjAuNyAzOS45em0zMi4zLTEzYzUuNCAxMy40IDEwIDI2LjggMTMuOCAzOS44LTEzLjEgMy4yLTI2LjkgNS45LTQxLjIgOCA0LjktNy43IDkuOC0xNS42IDE0LjQtMjMuNyA0LjYtOCA4LjktMTYuMSAxMy0yNC4xek00MjEuMiA0MzBjLTkuMy05LjYtMTguNi0yMC4zLTI3LjgtMzIgOSAuNCAxOC4yLjcgMjcuNS43IDkuNCAwIDE4LjctLjIgMjcuOC0uNy05IDExLjctMTguMyAyMi40LTI3LjUgMzJ6bS03NC40LTU4LjljLTE0LjItMi4xLTI3LjktNC43LTQxLTcuOSAzLjctMTIuOSA4LjMtMjYuMiAxMy41LTM5LjUgNC4xIDggOC40IDE2IDEzLjEgMjQgNC43IDggOS41IDE1LjggMTQuNCAyMy40ek00MjAuNyAxNjNjOS4zIDkuNiAxOC42IDIwLjMgMjcuOCAzMi05LS40LTE4LjItLjctMjcuNS0uNy05LjQgMC0xOC43LjItMjcuOC43IDktMTEuNyAxOC4zLTIyLjQgMjcuNS0zMnptLTc0IDU4LjljLTQuOSA3LjctOS44IDE1LjYtMTQuNCAyMy43LTQuNiA4LTguOSAxNi0xMyAyNC01LjQtMTMuNC0xMC0yNi44LTEzLjgtMzkuOCAxMy4xLTMuMSAyNi45LTUuOCA0MS4yLTcuOXptLTkwLjUgMTI1LjJjLTM1LjQtMTUuMS01OC4zLTM0LjktNTguMy01MC42IDAtMTUuNyAyMi45LTM1LjYgNTguMy01MC42IDguNi0zLjcgMTgtNyAyNy43LTEwLjEgNS43IDE5LjYgMTMuMiA0MCAyMi41IDYwLjktOS4yIDIwLjgtMTYuNiA0MS4xLTIyLjIgNjAuNi05LjktMy4xLTE5LjMtNi41LTI4LTEwLjJ6TTMxMCA0OTBjLTEzLjYtNy44LTE5LjUtMzcuNS0xNC45LTc1LjcgMS4xLTkuNCAyLjktMTkuMyA1LjEtMjkuNCAxOS42IDQuOCA0MSA4LjUgNjMuNSAxMC45IDEzLjUgMTguNSAyNy41IDM1LjMgNDEuNiA1MC0zMi42IDMwLjMtNjMuMiA0Ni45LTg0IDQ2LjktNC41LS4xLTguMy0xLTExLjMtMi43em0yMzcuMi03Ni4yYzQuNyAzOC4yLTEuMSA2Ny45LTE0LjYgNzUuOC0zIDEuOC02LjkgMi42LTExLjUgMi42LTIwLjcgMC01MS40LTE2LjUtODQtNDYuNiAxNC0xNC43IDI4LTMxLjQgNDEuMy00OS45IDIyLjYtMi40IDQ0LTYuMSA2My42LTExIDIuMyAxMC4xIDQuMSAxOS44IDUuMiAyOS4xem0zOC41LTY2LjdjLTguNiAzLjctMTggNy0yNy43IDEwLjEtNS43LTE5LjYtMTMuMi00MC0yMi41LTYwLjkgOS4yLTIwLjggMTYuNi00MS4xIDIyLjItNjAuNiA5LjkgMy4xIDE5LjMgNi41IDI4LjEgMTAuMiAzNS40IDE1LjEgNTguMyAzNC45IDU4LjMgNTAuNi0uMSAxNS43LTIzIDM1LjYtNTguNCA1MC42ek0zMjAuOCA3OC40eiIvPgogICAgPGNpcmNsZSBjeD0iNDIwLjkiIGN5PSIyOTYuNSIgcj0iNDUuNyIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-redo: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjE2Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgICA8cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+PHBhdGggZD0iTTE4LjQgMTAuNkMxNi41NSA4Ljk5IDE0LjE1IDggMTEuNSA4Yy00LjY1IDAtOC41OCAzLjAzLTkuOTYgNy4yMkwzLjkgMTZjMS4wNS0zLjE5IDQuMDUtNS41IDcuNi01LjUgMS45NSAwIDMuNzMuNzIgNS4xMiAxLjg4TDEzIDE2aDlWN2wtMy42IDMuNnoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-refresh: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDE4IDE4Ij4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGggZD0iTTkgMTMuNWMtMi40OSAwLTQuNS0yLjAxLTQuNS00LjVTNi41MSA0LjUgOSA0LjVjMS4yNCAwIDIuMzYuNTIgMy4xNyAxLjMzTDEwIDhoNVYzbC0xLjc2IDEuNzZDMTIuMTUgMy42OCAxMC42NiAzIDkgMyA1LjY5IDMgMy4wMSA1LjY5IDMuMDEgOVM1LjY5IDE1IDkgMTVjMi45NyAwIDUuNDMtMi4xNiA1LjktNWgtMS41MmMtLjQ2IDItMi4yNCAzLjUtNC4zOCAzLjV6Ii8+CiAgICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-regex: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIwIDIwIj4KICA8ZyBjbGFzcz0ianAtaWNvbjIiIGZpbGw9IiM0MTQxNDEiPgogICAgPHJlY3QgeD0iMiIgeT0iMiIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2Ii8+CiAgPC9nPgoKICA8ZyBjbGFzcz0ianAtaWNvbi1hY2NlbnQyIiBmaWxsPSIjRkZGIj4KICAgIDxjaXJjbGUgY2xhc3M9InN0MiIgY3g9IjUuNSIgY3k9IjE0LjUiIHI9IjEuNSIvPgogICAgPHJlY3QgeD0iMTIiIHk9IjQiIGNsYXNzPSJzdDIiIHdpZHRoPSIxIiBoZWlnaHQ9IjgiLz4KICAgIDxyZWN0IHg9IjguNSIgeT0iNy41IiB0cmFuc2Zvcm09Im1hdHJpeCgwLjg2NiAtMC41IDAuNSAwLjg2NiAtMi4zMjU1IDcuMzIxOSkiIGNsYXNzPSJzdDIiIHdpZHRoPSI4IiBoZWlnaHQ9IjEiLz4KICAgIDxyZWN0IHg9IjEyIiB5PSI0IiB0cmFuc2Zvcm09Im1hdHJpeCgwLjUgLTAuODY2IDAuODY2IDAuNSAtMC42Nzc5IDE0LjgyNTIpIiBjbGFzcz0ic3QyIiB3aWR0aD0iMSIgaGVpZ2h0PSI4Ii8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-run: url(data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGggZD0iTTggNXYxNGwxMS03eiIvPgogICAgPC9nPgo8L3N2Zz4K);
  --jp-icon-running: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDUxMiA1MTIiPgogIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICA8cGF0aCBkPSJNMjU2IDhDMTE5IDggOCAxMTkgOCAyNTZzMTExIDI0OCAyNDggMjQ4IDI0OC0xMTEgMjQ4LTI0OFMzOTMgOCAyNTYgOHptOTYgMzI4YzAgOC44LTcuMiAxNi0xNiAxNkgxNzZjLTguOCAwLTE2LTcuMi0xNi0xNlYxNzZjMC04LjggNy4yLTE2IDE2LTE2aDE2MGM4LjggMCAxNiA3LjIgMTYgMTZ2MTYweiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-save: url(data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGggZD0iTTE3IDNINWMtMS4xMSAwLTIgLjktMiAydjE0YzAgMS4xLjg5IDIgMiAyaDE0YzEuMSAwIDItLjkgMi0yVjdsLTQtNHptLTUgMTZjLTEuNjYgMC0zLTEuMzQtMy0zczEuMzQtMyAzLTMgMyAxLjM0IDMgMy0xLjM0IDMtMyAzem0zLTEwSDVWNWgxMHY0eiIvPgogICAgPC9nPgo8L3N2Zz4K);
  --jp-icon-search: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMTggMTgiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTEyLjEsMTAuOWgtMC43bC0wLjItMC4yYzAuOC0wLjksMS4zLTIuMiwxLjMtMy41YzAtMy0yLjQtNS40LTUuNC01LjRTMS44LDQuMiwxLjgsNy4xczIuNCw1LjQsNS40LDUuNCBjMS4zLDAsMi41LTAuNSwzLjUtMS4zbDAuMiwwLjJ2MC43bDQuMSw0LjFsMS4yLTEuMkwxMi4xLDEwLjl6IE03LjEsMTAuOWMtMi4xLDAtMy43LTEuNy0zLjctMy43czEuNy0zLjcsMy43LTMuN3MzLjcsMS43LDMuNywzLjcgUzkuMiwxMC45LDcuMSwxMC45eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-settings: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8cGF0aCBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIiBkPSJNMTkuNDMgMTIuOThjLjA0LS4zMi4wNy0uNjQuMDctLjk4cy0uMDMtLjY2LS4wNy0uOThsMi4xMS0xLjY1Yy4xOS0uMTUuMjQtLjQyLjEyLS42NGwtMi0zLjQ2Yy0uMTItLjIyLS4zOS0uMy0uNjEtLjIybC0yLjQ5IDFjLS41Mi0uNC0xLjA4LS43My0xLjY5LS45OGwtLjM4LTIuNjVBLjQ4OC40ODggMCAwMDE0IDJoLTRjLS4yNSAwLS40Ni4xOC0uNDkuNDJsLS4zOCAyLjY1Yy0uNjEuMjUtMS4xNy41OS0xLjY5Ljk4bC0yLjQ5LTFjLS4yMy0uMDktLjQ5IDAtLjYxLjIybC0yIDMuNDZjLS4xMy4yMi0uMDcuNDkuMTIuNjRsMi4xMSAxLjY1Yy0uMDQuMzItLjA3LjY1LS4wNy45OHMuMDMuNjYuMDcuOThsLTIuMTEgMS42NWMtLjE5LjE1LS4yNC40Mi0uMTIuNjRsMiAzLjQ2Yy4xMi4yMi4zOS4zLjYxLjIybDIuNDktMWMuNTIuNCAxLjA4LjczIDEuNjkuOThsLjM4IDIuNjVjLjAzLjI0LjI0LjQyLjQ5LjQyaDRjLjI1IDAgLjQ2LS4xOC40OS0uNDJsLjM4LTIuNjVjLjYxLS4yNSAxLjE3LS41OSAxLjY5LS45OGwyLjQ5IDFjLjIzLjA5LjQ5IDAgLjYxLS4yMmwyLTMuNDZjLjEyLS4yMi4wNy0uNDktLjEyLS42NGwtMi4xMS0xLjY1ek0xMiAxNS41Yy0xLjkzIDAtMy41LTEuNTctMy41LTMuNXMxLjU3LTMuNSAzLjUtMy41IDMuNSAxLjU3IDMuNSAzLjUtMS41NyAzLjUtMy41IDMuNXoiLz4KPC9zdmc+Cg==);
  --jp-icon-share: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIHZpZXdCb3g9IjAgMCAyNCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTSAxOCAyIEMgMTYuMzU0OTkgMiAxNSAzLjM1NDk5MDQgMTUgNSBDIDE1IDUuMTkwOTUyOSAxNS4wMjE3OTEgNS4zNzcxMjI0IDE1LjA1NjY0MSA1LjU1ODU5MzggTCA3LjkyMTg3NSA5LjcyMDcwMzEgQyA3LjM5ODUzOTkgOS4yNzc4NTM5IDYuNzMyMDc3MSA5IDYgOSBDIDQuMzU0OTkwNCA5IDMgMTAuMzU0OTkgMyAxMiBDIDMgMTMuNjQ1MDEgNC4zNTQ5OTA0IDE1IDYgMTUgQyA2LjczMjA3NzEgMTUgNy4zOTg1Mzk5IDE0LjcyMjE0NiA3LjkyMTg3NSAxNC4yNzkyOTcgTCAxNS4wNTY2NDEgMTguNDM5NDUzIEMgMTUuMDIxNTU1IDE4LjYyMTUxNCAxNSAxOC44MDgzODYgMTUgMTkgQyAxNSAyMC42NDUwMSAxNi4zNTQ5OSAyMiAxOCAyMiBDIDE5LjY0NTAxIDIyIDIxIDIwLjY0NTAxIDIxIDE5IEMgMjEgMTcuMzU0OTkgMTkuNjQ1MDEgMTYgMTggMTYgQyAxNy4yNjc0OCAxNiAxNi42MDE1OTMgMTYuMjc5MzI4IDE2LjA3ODEyNSAxNi43MjI2NTYgTCA4Ljk0MzM1OTQgMTIuNTU4NTk0IEMgOC45NzgyMDk1IDEyLjM3NzEyMiA5IDEyLjE5MDk1MyA5IDEyIEMgOSAxMS44MDkwNDcgOC45NzgyMDk1IDExLjYyMjg3OCA4Ljk0MzM1OTQgMTEuNDQxNDA2IEwgMTYuMDc4MTI1IDcuMjc5Mjk2OSBDIDE2LjYwMTQ2IDcuNzIyMTQ2MSAxNy4yNjc5MjMgOCAxOCA4IEMgMTkuNjQ1MDEgOCAyMSA2LjY0NTAwOTYgMjEgNSBDIDIxIDMuMzU0OTkwNCAxOS42NDUwMSAyIDE4IDIgeiBNIDE4IDQgQyAxOC41NjQxMjkgNCAxOSA0LjQzNTg3MDYgMTkgNSBDIDE5IDUuNTY0MTI5NCAxOC41NjQxMjkgNiAxOCA2IEMgMTcuNDM1ODcxIDYgMTcgNS41NjQxMjk0IDE3IDUgQyAxNyA0LjQzNTg3MDYgMTcuNDM1ODcxIDQgMTggNCB6IE0gNiAxMSBDIDYuNTY0MTI5NCAxMSA3IDExLjQzNTg3MSA3IDEyIEMgNyAxMi41NjQxMjkgNi41NjQxMjk0IDEzIDYgMTMgQyA1LjQzNTg3MDYgMTMgNSAxMi41NjQxMjkgNSAxMiBDIDUgMTEuNDM1ODcxIDUuNDM1ODcwNiAxMSA2IDExIHogTSAxOCAxOCBDIDE4LjU2NDEyOSAxOCAxOSAxOC40MzU4NzEgMTkgMTkgQyAxOSAxOS41NjQxMjkgMTguNTY0MTI5IDIwIDE4IDIwIEMgMTcuNDM1ODcxIDIwIDE3IDE5LjU2NDEyOSAxNyAxOSBDIDE3IDE4LjQzNTg3MSAxNy40MzU4NzEgMTggMTggMTggeiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-spreadsheet: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8cGF0aCBjbGFzcz0ianAtaWNvbi1jb250cmFzdDEganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNENBRjUwIiBkPSJNMi4yIDIuMnYxNy42aDE3LjZWMi4ySDIuMnptMTUuNCA3LjdoLTUuNVY0LjRoNS41djUuNXpNOS45IDQuNHY1LjVINC40VjQuNGg1LjV6bS01LjUgNy43aDUuNXY1LjVINC40di01LjV6bTcuNyA1LjV2LTUuNWg1LjV2NS41aC01LjV6Ii8+Cjwvc3ZnPgo=);
  --jp-icon-stop: url(data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPgogICAgICAgIDxwYXRoIGQ9Ik02IDZoMTJ2MTJINnoiLz4KICAgIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-tab: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTIxIDNIM2MtMS4xIDAtMiAuOS0yIDJ2MTRjMCAxLjEuOSAyIDIgMmgxOGMxLjEgMCAyLS45IDItMlY1YzAtMS4xLS45LTItMi0yem0wIDE2SDNWNWgxMHY0aDh2MTB6Ii8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-table-rows: url(data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPgogICAgICAgIDxwYXRoIGQ9Ik0yMSw4SDNWNGgxOFY4eiBNMjEsMTBIM3Y0aDE4VjEweiBNMjEsMTZIM3Y0aDE4VjE2eiIvPgogICAgPC9nPgo8L3N2Zz4K);
  --jp-icon-tag: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgiIGhlaWdodD0iMjgiIHZpZXdCb3g9IjAgMCA0MyAyOCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KCTxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CgkJPHBhdGggZD0iTTI4LjgzMzIgMTIuMzM0TDMyLjk5OTggMTYuNTAwN0wzNy4xNjY1IDEyLjMzNEgyOC44MzMyWiIvPgoJCTxwYXRoIGQ9Ik0xNi4yMDk1IDIxLjYxMDRDMTUuNjg3MyAyMi4xMjk5IDE0Ljg0NDMgMjIuMTI5OSAxNC4zMjQ4IDIxLjYxMDRMNi45ODI5IDE0LjcyNDVDNi41NzI0IDE0LjMzOTQgNi4wODMxMyAxMy42MDk4IDYuMDQ3ODYgMTMuMDQ4MkM1Ljk1MzQ3IDExLjUyODggNi4wMjAwMiA4LjYxOTQ0IDYuMDY2MjEgNy4wNzY5NUM2LjA4MjgxIDYuNTE0NzcgNi41NTU0OCA2LjA0MzQ3IDcuMTE4MDQgNi4wMzA1NUM5LjA4ODYzIDUuOTg0NzMgMTMuMjYzOCA1LjkzNTc5IDEzLjY1MTggNi4zMjQyNUwyMS43MzY5IDEzLjYzOUMyMi4yNTYgMTQuMTU4NSAyMS43ODUxIDE1LjQ3MjQgMjEuMjYyIDE1Ljk5NDZMMTYuMjA5NSAyMS42MTA0Wk05Ljc3NTg1IDguMjY1QzkuMzM1NTEgNy44MjU2NiA4LjYyMzUxIDcuODI1NjYgOC4xODI4IDguMjY1QzcuNzQzNDYgOC43MDU3MSA3Ljc0MzQ2IDkuNDE3MzMgOC4xODI4IDkuODU2NjdDOC42MjM4MiAxMC4yOTY0IDkuMzM1ODIgMTAuMjk2NCA5Ljc3NTg1IDkuODU2NjdDMTAuMjE1NiA5LjQxNzMzIDEwLjIxNTYgOC43MDUzMyA5Ljc3NTg1IDguMjY1WiIvPgoJPC9nPgo8L3N2Zz4K);
  --jp-icon-terminal: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0IiA+CiAgICA8cmVjdCBjbGFzcz0ianAtdGVybWluYWwtaWNvbi1iYWNrZ3JvdW5kLWNvbG9yIGpwLWljb24tc2VsZWN0YWJsZSIgd2lkdGg9IjIwIiBoZWlnaHQ9IjIwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyIDIpIiBmaWxsPSIjMzMzMzMzIi8+CiAgICA8cGF0aCBjbGFzcz0ianAtdGVybWluYWwtaWNvbi1jb2xvciBqcC1pY29uLXNlbGVjdGFibGUtaW52ZXJzZSIgZD0iTTUuMDU2NjQgOC43NjE3MkM1LjA1NjY0IDguNTk3NjYgNS4wMzEyNSA4LjQ1MzEyIDQuOTgwNDcgOC4zMjgxMkM0LjkzMzU5IDguMTk5MjIgNC44NTU0NyA4LjA4MjAzIDQuNzQ2MDkgNy45NzY1NkM0LjY0MDYyIDcuODcxMDkgNC41IDcuNzc1MzkgNC4zMjQyMiA3LjY4OTQ1QzQuMTUyMzQgNy41OTk2MSAzLjk0MzM2IDcuNTExNzIgMy42OTcyNyA3LjQyNTc4QzMuMzAyNzMgNy4yODUxNiAyLjk0MzM2IDcuMTM2NzIgMi42MTkxNCA2Ljk4MDQ3QzIuMjk0OTIgNi44MjQyMiAyLjAxNzU4IDYuNjQyNTggMS43ODcxMSA2LjQzNTU1QzEuNTYwNTUgNi4yMjg1MiAxLjM4NDc3IDUuOTg4MjggMS4yNTk3NyA1LjcxNDg0QzEuMTM0NzcgNS40Mzc1IDEuMDcyMjcgNS4xMDkzOCAxLjA3MjI3IDQuNzMwNDdDMS4wNzIyNyA0LjM5ODQ0IDEuMTI4OTEgNC4wOTU3IDEuMjQyMTkgMy44MjIyN0MxLjM1NTQ3IDMuNTQ0OTIgMS41MTU2MiAzLjMwNDY5IDEuNzIyNjYgMy4xMDE1NkMxLjkyOTY5IDIuODk4NDQgMi4xNzk2OSAyLjczNDM3IDIuNDcyNjYgMi42MDkzOEMyLjc2NTYyIDIuNDg0MzggMy4wOTE4IDIuNDA0MyAzLjQ1MTE3IDIuMzY5MTRWMS4xMDkzOEg0LjM4ODY3VjIuMzgwODZDNC43NDAyMyAyLjQyNzczIDUuMDU2NjQgMi41MjM0NCA1LjMzNzg5IDIuNjY3OTdDNS42MTkxNCAyLjgxMjUgNS44NTc0MiAzLjAwMTk1IDYuMDUyNzMgMy4yMzYzM0M2LjI1MTk1IDMuNDY2OCA2LjQwNDMgMy43NDAyMyA2LjUwOTc3IDQuMDU2NjRDNi42MTkxNCA0LjM2OTE0IDYuNjczODMgNC43MjA3IDYuNjczODMgNS4xMTEzM0g1LjA0NDkyQzUuMDQ0OTIgNC42Mzg2NyA0LjkzNzUgNC4yODEyNSA0LjcyMjY2IDQuMDM5MDZDNC41MDc4MSAzLjc5Mjk3IDQuMjE2OCAzLjY2OTkyIDMuODQ5NjEgMy42Njk5MkMzLjY1MDM5IDMuNjY5OTIgMy40NzY1NiAzLjY5NzI3IDMuMzI4MTIgMy43NTE5NUMzLjE4MzU5IDMuODAyNzMgMy4wNjQ0NSAzLjg3Njk1IDIuOTcwNyAzLjk3NDYxQzIuODc2OTUgNC4wNjgzNiAyLjgwNjY0IDQuMTc5NjkgMi43NTk3NyA0LjMwODU5QzIuNzE2OCA0LjQzNzUgMi42OTUzMSA0LjU3ODEyIDIuNjk1MzEgNC43MzA0N0MyLjY5NTMxIDQuODgyODEgMi43MTY4IDUuMDE5NTMgMi43NTk3NyA1LjE0MDYyQzIuODA2NjQgNS4yNTc4MSAyLjg4MjgxIDUuMzY3MTkgMi45ODgyOCA1LjQ2ODc1QzMuMDk3NjYgNS41NzAzMSAzLjI0MDIzIDUuNjY3OTcgMy40MTYwMiA1Ljc2MTcyQzMuNTkxOCA1Ljg1MTU2IDMuODEwNTUgNS45NDMzNiA0LjA3MjI3IDYuMDM3MTFDNC40NjY4IDYuMTg1NTUgNC44MjQyMiA2LjMzOTg0IDUuMTQ0NTMgNi41QzUuNDY0ODQgNi42NTYyNSA1LjczODI4IDYuODM5ODQgNS45NjQ4NCA3LjA1MDc4QzYuMTk1MzEgNy4yNTc4MSA2LjM3MTA5IDcuNSA2LjQ5MjE5IDcuNzc3MzRDNi42MTcxOSA4LjA1MDc4IDYuNjc5NjkgOC4zNzUgNi42Nzk2OSA4Ljc1QzYuNjc5NjkgOS4wOTM3NSA2LjYyMzA1IDkuNDA0MyA2LjUwOTc3IDkuNjgxNjRDNi4zOTY0OCA5Ljk1NTA4IDYuMjM0MzggMTAuMTkxNCA2LjAyMzQ0IDEwLjM5MDZDNS44MTI1IDEwLjU4OTggNS41NTg1OSAxMC43NSA1LjI2MTcyIDEwLjg3MTFDNC45NjQ4NCAxMC45ODgzIDQuNjMyODEgMTEuMDY0NSA0LjI2NTYyIDExLjA5OTZWMTIuMjQ4SDMuMzMzOThWMTEuMDk5NkMzLjAwMTk1IDExLjA2ODQgMi42Nzk2OSAxMC45OTYxIDIuMzY3MTkgMTAuODgyOEMyLjA1NDY5IDEwLjc2NTYgMS43NzczNCAxMC41OTc3IDEuNTM1MTYgMTAuMzc4OUMxLjI5Njg4IDEwLjE2MDIgMS4xMDU0NyA5Ljg4NDc3IDAuOTYwOTM4IDkuNTUyNzNDMC44MTY0MDYgOS4yMTY4IDAuNzQ0MTQxIDguODE0NDUgMC43NDQxNDEgOC4zNDU3SDIuMzc4OTFDMi4zNzg5MSA4LjYyNjk1IDIuNDE5OTIgOC44NjMyOCAyLjUwMTk1IDkuMDU0NjlDMi41ODM5OCA5LjI0MjE5IDIuNjg5NDUgOS4zOTI1OCAyLjgxODM2IDkuNTA1ODZDMi45NTExNyA5LjYxNTIzIDMuMTAxNTYgOS42OTMzNiAzLjI2OTUzIDkuNzQwMjNDMy40Mzc1IDkuNzg3MTEgMy42MDkzOCA5LjgxMDU1IDMuNzg1MTYgOS44MTA1NUM0LjIwMzEyIDkuODEwNTUgNC41MTk1MyA5LjcxMjg5IDQuNzM0MzggOS41MTc1OEM0Ljk0OTIyIDkuMzIyMjcgNS4wNTY2NCA5LjA3MDMxIDUuMDU2NjQgOC43NjE3MlpNMTMuNDE4IDEyLjI3MTVIOC4wNzQyMlYxMUgxMy40MThWMTIuMjcxNVoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDMuOTUyNjQgNikiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPgo=);
  --jp-icon-text-editor: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8cGF0aCBjbGFzcz0ianAtdGV4dC1lZGl0b3ItaWNvbi1jb2xvciBqcC1pY29uLXNlbGVjdGFibGUiIGZpbGw9IiM2MTYxNjEiIGQ9Ik0xNSAxNUgzdjJoMTJ2LTJ6bTAtOEgzdjJoMTJWN3pNMyAxM2gxOHYtMkgzdjJ6bTAgOGgxOHYtMkgzdjJ6TTMgM3YyaDE4VjNIM3oiLz4KPC9zdmc+Cg==);
  --jp-icon-toc: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIj4KICAgIDxwYXRoIGQ9Ik03LDVIMjFWN0g3VjVNNywxM1YxMUgyMVYxM0g3TTQsNC41QTEuNSwxLjUgMCAwLDEgNS41LDZBMS41LDEuNSAwIDAsMSA0LDcuNUExLjUsMS41IDAgMCwxIDIuNSw2QTEuNSwxLjUgMCAwLDEgNCw0LjVNNCwxMC41QTEuNSwxLjUgMCAwLDEgNS41LDEyQTEuNSwxLjUgMCAwLDEgNCwxMy41QTEuNSwxLjUgMCAwLDEgMi41LDEyQTEuNSwxLjUgMCAwLDEgNCwxMC41TTcsMTlWMTdIMjFWMTlIN000LDE2LjVBMS41LDEuNSAwIDAsMSA1LjUsMThBMS41LDEuNSAwIDAsMSA0LDE5LjVBMS41LDEuNSAwIDAsMSAyLjUsMThBMS41LDEuNSAwIDAsMSA0LDE2LjVaIiAvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-tree-view: url(data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPgogICAgICAgIDxwYXRoIGQ9Ik0yMiAxMVYzaC03djNIOVYzSDJ2OGg3VjhoMnYxMGg0djNoN3YtOGgtN3YzaC0yVjhoMnYzeiIvPgogICAgPC9nPgo8L3N2Zz4K);
  --jp-icon-trusted: url(data:image/svg+xml;base64,PHN2ZyBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI1Ij4KICAgIDxwYXRoIGNsYXNzPSJqcC1pY29uMiIgc3Ryb2tlPSIjMzMzMzMzIiBzdHJva2Utd2lkdGg9IjIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIgMykiIGQ9Ik0xLjg2MDk0IDExLjQ0MDlDMC44MjY0NDggOC43NzAyNyAwLjg2Mzc3OSA2LjA1NzY0IDEuMjQ5MDcgNC4xOTkzMkMyLjQ4MjA2IDMuOTMzNDcgNC4wODA2OCAzLjQwMzQ3IDUuNjAxMDIgMi44NDQ5QzcuMjM1NDkgMi4yNDQ0IDguODU2NjYgMS41ODE1IDkuOTg3NiAxLjA5NTM5QzExLjA1OTcgMS41ODM0MSAxMi42MDk0IDIuMjQ0NCAxNC4yMTggMi44NDMzOUMxNS43NTAzIDMuNDEzOTQgMTcuMzk5NSAzLjk1MjU4IDE4Ljc1MzkgNC4yMTM4NUMxOS4xMzY0IDYuMDcxNzcgMTkuMTcwOSA4Ljc3NzIyIDE4LjEzOSAxMS40NDA5QzE3LjAzMDMgMTQuMzAzMiAxNC42NjY4IDE3LjE4NDQgOS45OTk5OSAxOC45MzU0QzUuMzMzMiAxNy4xODQ0IDIuOTY5NjggMTQuMzAzMiAxLjg2MDk0IDExLjQ0MDlaIi8+CiAgICA8cGF0aCBjbGFzcz0ianAtaWNvbjIiIGZpbGw9IiMzMzMzMzMiIHN0cm9rZT0iIzMzMzMzMyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOCA5Ljg2NzE5KSIgZD0iTTIuODYwMTUgNC44NjUzNUwwLjcyNjU0OSAyLjk5OTU5TDAgMy42MzA0NUwyLjg2MDE1IDYuMTMxNTdMOCAwLjYzMDg3Mkw3LjI3ODU3IDBMMi44NjAxNSA0Ljg2NTM1WiIvPgo8L3N2Zz4K);
  --jp-icon-undo: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTEyLjUgOGMtMi42NSAwLTUuMDUuOTktNi45IDIuNkwyIDd2OWg5bC0zLjYyLTMuNjJjMS4zOS0xLjE2IDMuMTYtMS44OCA1LjEyLTEuODggMy41NCAwIDYuNTUgMi4zMSA3LjYgNS41bDIuMzctLjc4QzIxLjA4IDExLjAzIDE3LjE1IDggMTIuNSA4eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-user: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIHZpZXdCb3g9IjAgMCAyNCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTE2IDdhNCA0IDAgMTEtOCAwIDQgNCAwIDAxOCAwek0xMiAxNGE3IDcgMCAwMC03IDdoMTRhNyA3IDAgMDAtNy03eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-users: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDM2IDI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgogPGcgY2xhc3M9ImpwLWljb24zIiB0cmFuc2Zvcm09Im1hdHJpeCgxLjczMjcgMCAwIDEuNzMyNyAtMy42MjgyIC4wOTk1NzcpIiBmaWxsPSIjNjE2MTYxIj4KICA8cGF0aCB0cmFuc2Zvcm09Im1hdHJpeCgxLjUsMCwwLDEuNSwwLC02KSIgZD0ibTEyLjE4NiA3LjUwOThjLTEuMDUzNSAwLTEuOTc1NyAwLjU2NjUtMi40Nzg1IDEuNDEwMiAwLjc1MDYxIDAuMzEyNzcgMS4zOTc0IDAuODI2NDggMS44NzMgMS40NzI3aDMuNDg2M2MwLTEuNTkyLTEuMjg4OS0yLjg4MjgtMi44ODA5LTIuODgyOHoiLz4KICA8cGF0aCBkPSJtMjAuNDY1IDIuMzg5NWEyLjE4ODUgMi4xODg1IDAgMCAxLTIuMTg4NCAyLjE4ODUgMi4xODg1IDIuMTg4NSAwIDAgMS0yLjE4ODUtMi4xODg1IDIuMTg4NSAyLjE4ODUgMCAwIDEgMi4xODg1LTIuMTg4NSAyLjE4ODUgMi4xODg1IDAgMCAxIDIuMTg4NCAyLjE4ODV6Ii8+CiAgPHBhdGggdHJhbnNmb3JtPSJtYXRyaXgoMS41LDAsMCwxLjUsMCwtNikiIGQ9Im0zLjU4OTggOC40MjE5Yy0xLjExMjYgMC0yLjAxMzcgMC45MDExMS0yLjAxMzcgMi4wMTM3aDIuODE0NWMwLjI2Nzk3LTAuMzczMDkgMC41OTA3LTAuNzA0MzUgMC45NTg5OC0wLjk3ODUyLTAuMzQ0MzMtMC42MTY4OC0xLjAwMzEtMS4wMzUyLTEuNzU5OC0xLjAzNTJ6Ii8+CiAgPHBhdGggZD0ibTYuOTE1NCA0LjYyM2ExLjUyOTQgMS41Mjk0IDAgMCAxLTEuNTI5NCAxLjUyOTQgMS41Mjk0IDEuNTI5NCAwIDAgMS0xLjUyOTQtMS41Mjk0IDEuNTI5NCAxLjUyOTQgMCAwIDEgMS41Mjk0LTEuNTI5NCAxLjUyOTQgMS41Mjk0IDAgMCAxIDEuNTI5NCAxLjUyOTR6Ii8+CiAgPHBhdGggZD0ibTYuMTM1IDEzLjUzNWMwLTMuMjM5MiAyLjYyNTktNS44NjUgNS44NjUtNS44NjUgMy4yMzkyIDAgNS44NjUgMi42MjU5IDUuODY1IDUuODY1eiIvPgogIDxjaXJjbGUgY3g9IjEyIiBjeT0iMy43Njg1IiByPSIyLjk2ODUiLz4KIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-vega: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8ZyBjbGFzcz0ianAtaWNvbjEganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjMjEyMTIxIj4KICAgIDxwYXRoIGQ9Ik0xMC42IDUuNGwyLjItMy4ySDIuMnY3LjNsNC02LjZ6Ii8+CiAgICA8cGF0aCBkPSJNMTUuOCAyLjJsLTQuNCA2LjZMNyA2LjNsLTQuOCA4djUuNWgxNy42VjIuMmgtNHptLTcgMTUuNEg1LjV2LTQuNGgzLjN2NC40em00LjQgMEg5LjhWOS44aDMuNHY3Ljh6bTQuNCAwaC0zLjRWNi41aDMuNHYxMS4xeiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-word: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIwIDIwIj4KIDxnIGNsYXNzPSJqcC1pY29uMiIgZmlsbD0iIzQxNDE0MSI+CiAgPHJlY3QgeD0iMiIgeT0iMiIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2Ii8+CiA8L2c+CiA8ZyBjbGFzcz0ianAtaWNvbi1hY2NlbnQyIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSguNDMgLjA0MDEpIiBmaWxsPSIjZmZmIj4KICA8cGF0aCBkPSJtNC4xNCA4Ljc2cTAuMDY4Mi0xLjg5IDIuNDItMS44OSAxLjE2IDAgMS42OCAwLjQyIDAuNTY3IDAuNDEgMC41NjcgMS4xNnYzLjQ3cTAgMC40NjIgMC41MTQgMC40NjIgMC4xMDMgMCAwLjItMC4wMjMxdjAuNzE0cS0wLjM5OSAwLjEwMy0wLjY1MSAwLjEwMy0wLjQ1MiAwLTAuNjkzLTAuMjItMC4yMzEtMC4yLTAuMjg0LTAuNjYyLTAuOTU2IDAuODcyLTIgMC44NzItMC45MDMgMC0xLjQ3LTAuNDcyLTAuNTI1LTAuNDcyLTAuNTI1LTEuMjYgMC0wLjI2MiAwLjA0NTItMC40NzIgMC4wNTY3LTAuMjIgMC4xMTYtMC4zNzggMC4wNjgyLTAuMTY4IDAuMjMxLTAuMzA0IDAuMTU4LTAuMTQ3IDAuMjYyLTAuMjQyIDAuMTE2LTAuMDkxNCAwLjM2OC0wLjE2OCAwLjI2Mi0wLjA5MTQgMC4zOTktMC4xMjYgMC4xMzYtMC4wNDUyIDAuNDcyLTAuMTAzIDAuMzM2LTAuMDU3OCAwLjUwNC0wLjA3OTggMC4xNTgtMC4wMjMxIDAuNTY3LTAuMDc5OCAwLjU1Ni0wLjA2ODIgMC43NzctMC4yMjEgMC4yMi0wLjE1MiAwLjIyLTAuNDQxdi0wLjI1MnEwLTAuNDMtMC4zNTctMC42NjItMC4zMzYtMC4yMzEtMC45NzYtMC4yMzEtMC42NjIgMC0wLjk5OCAwLjI2Mi0wLjMzNiAwLjI1Mi0wLjM5OSAwLjc5OHptMS44OSAzLjY4cTAuNzg4IDAgMS4yNi0wLjQxIDAuNTA0LTAuNDIgMC41MDQtMC45MDN2LTEuMDVxLTAuMjg0IDAuMTM2LTAuODYxIDAuMjMxLTAuNTY3IDAuMDkxNC0wLjk4NyAwLjE1OC0wLjQyIDAuMDY4Mi0wLjc2NiAwLjMyNi0wLjMzNiAwLjI1Mi0wLjMzNiAwLjcwNHQwLjMwNCAwLjcwNCAwLjg2MSAwLjI1MnoiIHN0cm9rZS13aWR0aD0iMS4wNSIvPgogIDxwYXRoIGQ9Im0xMCA0LjU2aDAuOTQ1djMuMTVxMC42NTEtMC45NzYgMS44OS0wLjk3NiAxLjE2IDAgMS44OSAwLjg0IDAuNjgyIDAuODQgMC42ODIgMi4zMSAwIDEuNDctMC43MDQgMi40Mi0wLjcwNCAwLjg4Mi0xLjg5IDAuODgyLTEuMjYgMC0xLjg5LTEuMDJ2MC43NjZoLTAuODV6bTIuNjIgMy4wNHEtMC43NDYgMC0xLjE2IDAuNjQtMC40NTIgMC42My0wLjQ1MiAxLjY4IDAgMS4wNSAwLjQ1MiAxLjY4dDEuMTYgMC42M3EwLjc3NyAwIDEuMjYtMC42MyAwLjQ5NC0wLjY0IDAuNDk0LTEuNjggMC0xLjA1LTAuNDcyLTEuNjgtMC40NjItMC42NC0xLjI2LTAuNjR6IiBzdHJva2Utd2lkdGg9IjEuMDUiLz4KICA8cGF0aCBkPSJtMi43MyAxNS44IDEzLjYgMC4wMDgxYzAuMDA2OSAwIDAtMi42IDAtMi42IDAtMC4wMDc4LTEuMTUgMC0xLjE1IDAtMC4wMDY5IDAtMC4wMDgzIDEuNS0wLjAwODMgMS41LTJlLTMgLTAuMDAxNC0xMS4zLTAuMDAxNC0xMS4zLTAuMDAxNGwtMC4wMDU5Mi0xLjVjMC0wLjAwNzgtMS4xNyAwLjAwMTMtMS4xNyAwLjAwMTN6IiBzdHJva2Utd2lkdGg9Ii45NzUiLz4KIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-yaml: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8ZyBjbGFzcz0ianAtaWNvbi1jb250cmFzdDIganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjRDgxQjYwIj4KICAgIDxwYXRoIGQ9Ik03LjIgMTguNnYtNS40TDMgNS42aDMuM2wxLjQgMy4xYy4zLjkuNiAxLjYgMSAyLjUuMy0uOC42LTEuNiAxLTIuNWwxLjQtMy4xaDMuNGwtNC40IDcuNnY1LjVsLTIuOS0uMXoiLz4KICAgIDxjaXJjbGUgY2xhc3M9InN0MCIgY3g9IjE3LjYiIGN5PSIxNi41IiByPSIyLjEiLz4KICAgIDxjaXJjbGUgY2xhc3M9InN0MCIgY3g9IjE3LjYiIGN5PSIxMSIgcj0iMi4xIi8+CiAgPC9nPgo8L3N2Zz4K);
}

/* Icon CSS class declarations */

.jp-AddAboveIcon {
  background-image: var(--jp-icon-add-above);
}

.jp-AddBelowIcon {
  background-image: var(--jp-icon-add-below);
}

.jp-AddIcon {
  background-image: var(--jp-icon-add);
}

.jp-BellIcon {
  background-image: var(--jp-icon-bell);
}

.jp-BugDotIcon {
  background-image: var(--jp-icon-bug-dot);
}

.jp-BugIcon {
  background-image: var(--jp-icon-bug);
}

.jp-BuildIcon {
  background-image: var(--jp-icon-build);
}

.jp-CaretDownEmptyIcon {
  background-image: var(--jp-icon-caret-down-empty);
}

.jp-CaretDownEmptyThinIcon {
  background-image: var(--jp-icon-caret-down-empty-thin);
}

.jp-CaretDownIcon {
  background-image: var(--jp-icon-caret-down);
}

.jp-CaretLeftIcon {
  background-image: var(--jp-icon-caret-left);
}

.jp-CaretRightIcon {
  background-image: var(--jp-icon-caret-right);
}

.jp-CaretUpEmptyThinIcon {
  background-image: var(--jp-icon-caret-up-empty-thin);
}

.jp-CaretUpIcon {
  background-image: var(--jp-icon-caret-up);
}

.jp-CaseSensitiveIcon {
  background-image: var(--jp-icon-case-sensitive);
}

.jp-CheckIcon {
  background-image: var(--jp-icon-check);
}

.jp-CircleEmptyIcon {
  background-image: var(--jp-icon-circle-empty);
}

.jp-CircleIcon {
  background-image: var(--jp-icon-circle);
}

.jp-ClearIcon {
  background-image: var(--jp-icon-clear);
}

.jp-CloseIcon {
  background-image: var(--jp-icon-close);
}

.jp-CodeCheckIcon {
  background-image: var(--jp-icon-code-check);
}

.jp-CodeIcon {
  background-image: var(--jp-icon-code);
}

.jp-CollapseAllIcon {
  background-image: var(--jp-icon-collapse-all);
}

.jp-ConsoleIcon {
  background-image: var(--jp-icon-console);
}

.jp-CopyIcon {
  background-image: var(--jp-icon-copy);
}

.jp-CopyrightIcon {
  background-image: var(--jp-icon-copyright);
}

.jp-CutIcon {
  background-image: var(--jp-icon-cut);
}

.jp-DeleteIcon {
  background-image: var(--jp-icon-delete);
}

.jp-DownloadIcon {
  background-image: var(--jp-icon-download);
}

.jp-DuplicateIcon {
  background-image: var(--jp-icon-duplicate);
}

.jp-EditIcon {
  background-image: var(--jp-icon-edit);
}

.jp-EllipsesIcon {
  background-image: var(--jp-icon-ellipses);
}

.jp-ErrorIcon {
  background-image: var(--jp-icon-error);
}

.jp-ExpandAllIcon {
  background-image: var(--jp-icon-expand-all);
}

.jp-ExtensionIcon {
  background-image: var(--jp-icon-extension);
}

.jp-FastForwardIcon {
  background-image: var(--jp-icon-fast-forward);
}

.jp-FileIcon {
  background-image: var(--jp-icon-file);
}

.jp-FileUploadIcon {
  background-image: var(--jp-icon-file-upload);
}

.jp-FilterDotIcon {
  background-image: var(--jp-icon-filter-dot);
}

.jp-FilterIcon {
  background-image: var(--jp-icon-filter);
}

.jp-FilterListIcon {
  background-image: var(--jp-icon-filter-list);
}

.jp-FolderFavoriteIcon {
  background-image: var(--jp-icon-folder-favorite);
}

.jp-FolderIcon {
  background-image: var(--jp-icon-folder);
}

.jp-HomeIcon {
  background-image: var(--jp-icon-home);
}

.jp-Html5Icon {
  background-image: var(--jp-icon-html5);
}

.jp-ImageIcon {
  background-image: var(--jp-icon-image);
}

.jp-InfoIcon {
  background-image: var(--jp-icon-info);
}

.jp-InspectorIcon {
  background-image: var(--jp-icon-inspector);
}

.jp-JsonIcon {
  background-image: var(--jp-icon-json);
}

.jp-JuliaIcon {
  background-image: var(--jp-icon-julia);
}

.jp-JupyterFaviconIcon {
  background-image: var(--jp-icon-jupyter-favicon);
}

.jp-JupyterIcon {
  background-image: var(--jp-icon-jupyter);
}

.jp-JupyterlabWordmarkIcon {
  background-image: var(--jp-icon-jupyterlab-wordmark);
}

.jp-KernelIcon {
  background-image: var(--jp-icon-kernel);
}

.jp-KeyboardIcon {
  background-image: var(--jp-icon-keyboard);
}

.jp-LaunchIcon {
  background-image: var(--jp-icon-launch);
}

.jp-LauncherIcon {
  background-image: var(--jp-icon-launcher);
}

.jp-LineFormIcon {
  background-image: var(--jp-icon-line-form);
}

.jp-LinkIcon {
  background-image: var(--jp-icon-link);
}

.jp-ListIcon {
  background-image: var(--jp-icon-list);
}

.jp-MarkdownIcon {
  background-image: var(--jp-icon-markdown);
}

.jp-MoveDownIcon {
  background-image: var(--jp-icon-move-down);
}

.jp-MoveUpIcon {
  background-image: var(--jp-icon-move-up);
}

.jp-NewFolderIcon {
  background-image: var(--jp-icon-new-folder);
}

.jp-NotTrustedIcon {
  background-image: var(--jp-icon-not-trusted);
}

.jp-NotebookIcon {
  background-image: var(--jp-icon-notebook);
}

.jp-NumberingIcon {
  background-image: var(--jp-icon-numbering);
}

.jp-OfflineBoltIcon {
  background-image: var(--jp-icon-offline-bolt);
}

.jp-PaletteIcon {
  background-image: var(--jp-icon-palette);
}

.jp-PasteIcon {
  background-image: var(--jp-icon-paste);
}

.jp-PdfIcon {
  background-image: var(--jp-icon-pdf);
}

.jp-PythonIcon {
  background-image: var(--jp-icon-python);
}

.jp-RKernelIcon {
  background-image: var(--jp-icon-r-kernel);
}

.jp-ReactIcon {
  background-image: var(--jp-icon-react);
}

.jp-RedoIcon {
  background-image: var(--jp-icon-redo);
}

.jp-RefreshIcon {
  background-image: var(--jp-icon-refresh);
}

.jp-RegexIcon {
  background-image: var(--jp-icon-regex);
}

.jp-RunIcon {
  background-image: var(--jp-icon-run);
}

.jp-RunningIcon {
  background-image: var(--jp-icon-running);
}

.jp-SaveIcon {
  background-image: var(--jp-icon-save);
}

.jp-SearchIcon {
  background-image: var(--jp-icon-search);
}

.jp-SettingsIcon {
  background-image: var(--jp-icon-settings);
}

.jp-ShareIcon {
  background-image: var(--jp-icon-share);
}

.jp-SpreadsheetIcon {
  background-image: var(--jp-icon-spreadsheet);
}

.jp-StopIcon {
  background-image: var(--jp-icon-stop);
}

.jp-TabIcon {
  background-image: var(--jp-icon-tab);
}

.jp-TableRowsIcon {
  background-image: var(--jp-icon-table-rows);
}

.jp-TagIcon {
  background-image: var(--jp-icon-tag);
}

.jp-TerminalIcon {
  background-image: var(--jp-icon-terminal);
}

.jp-TextEditorIcon {
  background-image: var(--jp-icon-text-editor);
}

.jp-TocIcon {
  background-image: var(--jp-icon-toc);
}

.jp-TreeViewIcon {
  background-image: var(--jp-icon-tree-view);
}

.jp-TrustedIcon {
  background-image: var(--jp-icon-trusted);
}

.jp-UndoIcon {
  background-image: var(--jp-icon-undo);
}

.jp-UserIcon {
  background-image: var(--jp-icon-user);
}

.jp-UsersIcon {
  background-image: var(--jp-icon-users);
}

.jp-VegaIcon {
  background-image: var(--jp-icon-vega);
}

.jp-WordIcon {
  background-image: var(--jp-icon-word);
}

.jp-YamlIcon {
  background-image: var(--jp-icon-yaml);
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/**
 * (DEPRECATED) Support for consuming icons as CSS background images
 */

.jp-Icon,
.jp-MaterialIcon {
  background-position: center;
  background-repeat: no-repeat;
  background-size: 16px;
  min-width: 16px;
  min-height: 16px;
}

.jp-Icon-cover {
  background-position: center;
  background-repeat: no-repeat;
  background-size: cover;
}

/**
 * (DEPRECATED) Support for specific CSS icon sizes
 */

.jp-Icon-16 {
  background-size: 16px;
  min-width: 16px;
  min-height: 16px;
}

.jp-Icon-18 {
  background-size: 18px;
  min-width: 18px;
  min-height: 18px;
}

.jp-Icon-20 {
  background-size: 20px;
  min-width: 20px;
  min-height: 20px;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.lm-TabBar .lm-TabBar-addButton {
  align-items: center;
  display: flex;
  padding: 4px;
  padding-bottom: 5px;
  margin-right: 1px;
  background-color: var(--jp-layout-color2);
}

.lm-TabBar .lm-TabBar-addButton:hover {
  background-color: var(--jp-layout-color1);
}

.lm-DockPanel-tabBar .lm-TabBar-tab {
  width: var(--jp-private-horizontal-tab-width);
}

.lm-DockPanel-tabBar .lm-TabBar-content {
  flex: unset;
}

.lm-DockPanel-tabBar[data-orientation='horizontal'] {
  flex: 1 1 auto;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/**
 * Support for icons as inline SVG HTMLElements
 */

/* recolor the primary elements of an icon */
.jp-icon0[fill] {
  fill: var(--jp-inverse-layout-color0);
}

.jp-icon1[fill] {
  fill: var(--jp-inverse-layout-color1);
}

.jp-icon2[fill] {
  fill: var(--jp-inverse-layout-color2);
}

.jp-icon3[fill] {
  fill: var(--jp-inverse-layout-color3);
}

.jp-icon4[fill] {
  fill: var(--jp-inverse-layout-color4);
}

.jp-icon0[stroke] {
  stroke: var(--jp-inverse-layout-color0);
}

.jp-icon1[stroke] {
  stroke: var(--jp-inverse-layout-color1);
}

.jp-icon2[stroke] {
  stroke: var(--jp-inverse-layout-color2);
}

.jp-icon3[stroke] {
  stroke: var(--jp-inverse-layout-color3);
}

.jp-icon4[stroke] {
  stroke: var(--jp-inverse-layout-color4);
}

/* recolor the accent elements of an icon */
.jp-icon-accent0[fill] {
  fill: var(--jp-layout-color0);
}

.jp-icon-accent1[fill] {
  fill: var(--jp-layout-color1);
}

.jp-icon-accent2[fill] {
  fill: var(--jp-layout-color2);
}

.jp-icon-accent3[fill] {
  fill: var(--jp-layout-color3);
}

.jp-icon-accent4[fill] {
  fill: var(--jp-layout-color4);
}

.jp-icon-accent0[stroke] {
  stroke: var(--jp-layout-color0);
}

.jp-icon-accent1[stroke] {
  stroke: var(--jp-layout-color1);
}

.jp-icon-accent2[stroke] {
  stroke: var(--jp-layout-color2);
}

.jp-icon-accent3[stroke] {
  stroke: var(--jp-layout-color3);
}

.jp-icon-accent4[stroke] {
  stroke: var(--jp-layout-color4);
}

/* set the color of an icon to transparent */
.jp-icon-none[fill] {
  fill: none;
}

.jp-icon-none[stroke] {
  stroke: none;
}

/* brand icon colors. Same for light and dark */
.jp-icon-brand0[fill] {
  fill: var(--jp-brand-color0);
}

.jp-icon-brand1[fill] {
  fill: var(--jp-brand-color1);
}

.jp-icon-brand2[fill] {
  fill: var(--jp-brand-color2);
}

.jp-icon-brand3[fill] {
  fill: var(--jp-brand-color3);
}

.jp-icon-brand4[fill] {
  fill: var(--jp-brand-color4);
}

.jp-icon-brand0[stroke] {
  stroke: var(--jp-brand-color0);
}

.jp-icon-brand1[stroke] {
  stroke: var(--jp-brand-color1);
}

.jp-icon-brand2[stroke] {
  stroke: var(--jp-brand-color2);
}

.jp-icon-brand3[stroke] {
  stroke: var(--jp-brand-color3);
}

.jp-icon-brand4[stroke] {
  stroke: var(--jp-brand-color4);
}

/* warn icon colors. Same for light and dark */
.jp-icon-warn0[fill] {
  fill: var(--jp-warn-color0);
}

.jp-icon-warn1[fill] {
  fill: var(--jp-warn-color1);
}

.jp-icon-warn2[fill] {
  fill: var(--jp-warn-color2);
}

.jp-icon-warn3[fill] {
  fill: var(--jp-warn-color3);
}

.jp-icon-warn0[stroke] {
  stroke: var(--jp-warn-color0);
}

.jp-icon-warn1[stroke] {
  stroke: var(--jp-warn-color1);
}

.jp-icon-warn2[stroke] {
  stroke: var(--jp-warn-color2);
}

.jp-icon-warn3[stroke] {
  stroke: var(--jp-warn-color3);
}

/* icon colors that contrast well with each other and most backgrounds */
.jp-icon-contrast0[fill] {
  fill: var(--jp-icon-contrast-color0);
}

.jp-icon-contrast1[fill] {
  fill: var(--jp-icon-contrast-color1);
}

.jp-icon-contrast2[fill] {
  fill: var(--jp-icon-contrast-color2);
}

.jp-icon-contrast3[fill] {
  fill: var(--jp-icon-contrast-color3);
}

.jp-icon-contrast0[stroke] {
  stroke: var(--jp-icon-contrast-color0);
}

.jp-icon-contrast1[stroke] {
  stroke: var(--jp-icon-contrast-color1);
}

.jp-icon-contrast2[stroke] {
  stroke: var(--jp-icon-contrast-color2);
}

.jp-icon-contrast3[stroke] {
  stroke: var(--jp-icon-contrast-color3);
}

.jp-icon-dot[fill] {
  fill: var(--jp-warn-color0);
}

.jp-jupyter-icon-color[fill] {
  fill: var(--jp-jupyter-icon-color, var(--jp-warn-color0));
}

.jp-notebook-icon-color[fill] {
  fill: var(--jp-notebook-icon-color, var(--jp-warn-color0));
}

.jp-json-icon-color[fill] {
  fill: var(--jp-json-icon-color, var(--jp-warn-color1));
}

.jp-console-icon-color[fill] {
  fill: var(--jp-console-icon-color, white);
}

.jp-console-icon-background-color[fill] {
  fill: var(--jp-console-icon-background-color, var(--jp-brand-color1));
}

.jp-terminal-icon-color[fill] {
  fill: var(--jp-terminal-icon-color, var(--jp-layout-color2));
}

.jp-terminal-icon-background-color[fill] {
  fill: var(
    --jp-terminal-icon-background-color,
    var(--jp-inverse-layout-color2)
  );
}

.jp-text-editor-icon-color[fill] {
  fill: var(--jp-text-editor-icon-color, var(--jp-inverse-layout-color3));
}

.jp-inspector-icon-color[fill] {
  fill: var(--jp-inspector-icon-color, var(--jp-inverse-layout-color3));
}

/* CSS for icons in selected filebrowser listing items */
.jp-DirListing-item.jp-mod-selected .jp-icon-selectable[fill] {
  fill: #fff;
}

.jp-DirListing-item.jp-mod-selected .jp-icon-selectable-inverse[fill] {
  fill: var(--jp-brand-color1);
}

/* stylelint-disable selector-max-class, selector-max-compound-selectors */

/**
* TODO: come up with non css-hack solution for showing the busy icon on top
*  of the close icon
* CSS for complex behavior of close icon of tabs in the main area tabbar
*/
.lm-DockPanel-tabBar
  .lm-TabBar-tab.lm-mod-closable.jp-mod-dirty
  > .lm-TabBar-tabCloseIcon
  > :not(:hover)
  > .jp-icon3[fill] {
  fill: none;
}

.lm-DockPanel-tabBar
  .lm-TabBar-tab.lm-mod-closable.jp-mod-dirty
  > .lm-TabBar-tabCloseIcon
  > :not(:hover)
  > .jp-icon-busy[fill] {
  fill: var(--jp-inverse-layout-color3);
}

/* stylelint-enable selector-max-class, selector-max-compound-selectors */

/* CSS for icons in status bar */
#jp-main-statusbar .jp-mod-selected .jp-icon-selectable[fill] {
  fill: #fff;
}

#jp-main-statusbar .jp-mod-selected .jp-icon-selectable-inverse[fill] {
  fill: var(--jp-brand-color1);
}

/* special handling for splash icon CSS. While the theme CSS reloads during
   splash, the splash icon can loose theming. To prevent that, we set a
   default for its color variable */
:root {
  --jp-warn-color0: var(--md-orange-700);
}

/* not sure what to do with this one, used in filebrowser listing */
.jp-DragIcon {
  margin-right: 4px;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/**
 * Support for alt colors for icons as inline SVG HTMLElements
 */

/* alt recolor the primary elements of an icon */
.jp-icon-alt .jp-icon0[fill] {
  fill: var(--jp-layout-color0);
}

.jp-icon-alt .jp-icon1[fill] {
  fill: var(--jp-layout-color1);
}

.jp-icon-alt .jp-icon2[fill] {
  fill: var(--jp-layout-color2);
}

.jp-icon-alt .jp-icon3[fill] {
  fill: var(--jp-layout-color3);
}

.jp-icon-alt .jp-icon4[fill] {
  fill: var(--jp-layout-color4);
}

.jp-icon-alt .jp-icon0[stroke] {
  stroke: var(--jp-layout-color0);
}

.jp-icon-alt .jp-icon1[stroke] {
  stroke: var(--jp-layout-color1);
}

.jp-icon-alt .jp-icon2[stroke] {
  stroke: var(--jp-layout-color2);
}

.jp-icon-alt .jp-icon3[stroke] {
  stroke: var(--jp-layout-color3);
}

.jp-icon-alt .jp-icon4[stroke] {
  stroke: var(--jp-layout-color4);
}

/* alt recolor the accent elements of an icon */
.jp-icon-alt .jp-icon-accent0[fill] {
  fill: var(--jp-inverse-layout-color0);
}

.jp-icon-alt .jp-icon-accent1[fill] {
  fill: var(--jp-inverse-layout-color1);
}

.jp-icon-alt .jp-icon-accent2[fill] {
  fill: var(--jp-inverse-layout-color2);
}

.jp-icon-alt .jp-icon-accent3[fill] {
  fill: var(--jp-inverse-layout-color3);
}

.jp-icon-alt .jp-icon-accent4[fill] {
  fill: var(--jp-inverse-layout-color4);
}

.jp-icon-alt .jp-icon-accent0[stroke] {
  stroke: var(--jp-inverse-layout-color0);
}

.jp-icon-alt .jp-icon-accent1[stroke] {
  stroke: var(--jp-inverse-layout-color1);
}

.jp-icon-alt .jp-icon-accent2[stroke] {
  stroke: var(--jp-inverse-layout-color2);
}

.jp-icon-alt .jp-icon-accent3[stroke] {
  stroke: var(--jp-inverse-layout-color3);
}

.jp-icon-alt .jp-icon-accent4[stroke] {
  stroke: var(--jp-inverse-layout-color4);
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-icon-hoverShow:not(:hover) .jp-icon-hoverShow-content {
  display: none !important;
}

/**
 * Support for hover colors for icons as inline SVG HTMLElements
 */

/**
 * regular colors
 */

/* recolor the primary elements of an icon */
.jp-icon-hover :hover .jp-icon0-hover[fill] {
  fill: var(--jp-inverse-layout-color0);
}

.jp-icon-hover :hover .jp-icon1-hover[fill] {
  fill: var(--jp-inverse-layout-color1);
}

.jp-icon-hover :hover .jp-icon2-hover[fill] {
  fill: var(--jp-inverse-layout-color2);
}

.jp-icon-hover :hover .jp-icon3-hover[fill] {
  fill: var(--jp-inverse-layout-color3);
}

.jp-icon-hover :hover .jp-icon4-hover[fill] {
  fill: var(--jp-inverse-layout-color4);
}

.jp-icon-hover :hover .jp-icon0-hover[stroke] {
  stroke: var(--jp-inverse-layout-color0);
}

.jp-icon-hover :hover .jp-icon1-hover[stroke] {
  stroke: var(--jp-inverse-layout-color1);
}

.jp-icon-hover :hover .jp-icon2-hover[stroke] {
  stroke: var(--jp-inverse-layout-color2);
}

.jp-icon-hover :hover .jp-icon3-hover[stroke] {
  stroke: var(--jp-inverse-layout-color3);
}

.jp-icon-hover :hover .jp-icon4-hover[stroke] {
  stroke: var(--jp-inverse-layout-color4);
}

/* recolor the accent elements of an icon */
.jp-icon-hover :hover .jp-icon-accent0-hover[fill] {
  fill: var(--jp-layout-color0);
}

.jp-icon-hover :hover .jp-icon-accent1-hover[fill] {
  fill: var(--jp-layout-color1);
}

.jp-icon-hover :hover .jp-icon-accent2-hover[fill] {
  fill: var(--jp-layout-color2);
}

.jp-icon-hover :hover .jp-icon-accent3-hover[fill] {
  fill: var(--jp-layout-color3);
}

.jp-icon-hover :hover .jp-icon-accent4-hover[fill] {
  fill: var(--jp-layout-color4);
}

.jp-icon-hover :hover .jp-icon-accent0-hover[stroke] {
  stroke: var(--jp-layout-color0);
}

.jp-icon-hover :hover .jp-icon-accent1-hover[stroke] {
  stroke: var(--jp-layout-color1);
}

.jp-icon-hover :hover .jp-icon-accent2-hover[stroke] {
  stroke: var(--jp-layout-color2);
}

.jp-icon-hover :hover .jp-icon-accent3-hover[stroke] {
  stroke: var(--jp-layout-color3);
}

.jp-icon-hover :hover .jp-icon-accent4-hover[stroke] {
  stroke: var(--jp-layout-color4);
}

/* set the color of an icon to transparent */
.jp-icon-hover :hover .jp-icon-none-hover[fill] {
  fill: none;
}

.jp-icon-hover :hover .jp-icon-none-hover[stroke] {
  stroke: none;
}

/**
 * inverse colors
 */

/* inverse recolor the primary elements of an icon */
.jp-icon-hover.jp-icon-alt :hover .jp-icon0-hover[fill] {
  fill: var(--jp-layout-color0);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon1-hover[fill] {
  fill: var(--jp-layout-color1);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon2-hover[fill] {
  fill: var(--jp-layout-color2);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon3-hover[fill] {
  fill: var(--jp-layout-color3);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon4-hover[fill] {
  fill: var(--jp-layout-color4);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon0-hover[stroke] {
  stroke: var(--jp-layout-color0);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon1-hover[stroke] {
  stroke: var(--jp-layout-color1);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon2-hover[stroke] {
  stroke: var(--jp-layout-color2);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon3-hover[stroke] {
  stroke: var(--jp-layout-color3);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon4-hover[stroke] {
  stroke: var(--jp-layout-color4);
}

/* inverse recolor the accent elements of an icon */
.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent0-hover[fill] {
  fill: var(--jp-inverse-layout-color0);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent1-hover[fill] {
  fill: var(--jp-inverse-layout-color1);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent2-hover[fill] {
  fill: var(--jp-inverse-layout-color2);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent3-hover[fill] {
  fill: var(--jp-inverse-layout-color3);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent4-hover[fill] {
  fill: var(--jp-inverse-layout-color4);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent0-hover[stroke] {
  stroke: var(--jp-inverse-layout-color0);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent1-hover[stroke] {
  stroke: var(--jp-inverse-layout-color1);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent2-hover[stroke] {
  stroke: var(--jp-inverse-layout-color2);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent3-hover[stroke] {
  stroke: var(--jp-inverse-layout-color3);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent4-hover[stroke] {
  stroke: var(--jp-inverse-layout-color4);
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-IFrame {
  width: 100%;
  height: 100%;
}

.jp-IFrame > iframe {
  border: none;
}

/*
When drag events occur, `lm-mod-override-cursor` is added to the body.
Because iframes steal all cursor events, the following two rules are necessary
to suppress pointer events while resize drags are occurring. There may be a
better solution to this problem.
*/
body.lm-mod-override-cursor .jp-IFrame {
  position: relative;
}

body.lm-mod-override-cursor .jp-IFrame::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: transparent;
}

/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2016, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-HoverBox {
  position: fixed;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-FormGroup-content fieldset {
  border: none;
  padding: 0;
  min-width: 0;
  width: 100%;
}

/* stylelint-disable selector-max-type */

.jp-FormGroup-content fieldset .jp-inputFieldWrapper input,
.jp-FormGroup-content fieldset .jp-inputFieldWrapper select,
.jp-FormGroup-content fieldset .jp-inputFieldWrapper textarea {
  font-size: var(--jp-content-font-size2);
  border-color: var(--jp-input-border-color);
  border-style: solid;
  border-radius: var(--jp-border-radius);
  border-width: 1px;
  padding: 6px 8px;
  background: none;
  color: var(--jp-ui-font-color0);
  height: inherit;
}

.jp-FormGroup-content fieldset input[type='checkbox'] {
  position: relative;
  top: 2px;
  margin-left: 0;
}

.jp-FormGroup-content button.jp-mod-styled {
  cursor: pointer;
}

.jp-FormGroup-content .checkbox label {
  cursor: pointer;
  font-size: var(--jp-content-font-size1);
}

.jp-FormGroup-content .jp-root > fieldset > legend {
  display: none;
}

.jp-FormGroup-content .jp-root > fieldset > p {
  display: none;
}

/** copy of `input.jp-mod-styled:focus` style */
.jp-FormGroup-content fieldset input:focus,
.jp-FormGroup-content fieldset select:focus {
  -moz-outline-radius: unset;
  outline: var(--jp-border-width) solid var(--md-blue-500);
  outline-offset: -1px;
  box-shadow: inset 0 0 4px var(--md-blue-300);
}

.jp-FormGroup-content fieldset input:hover:not(:focus),
.jp-FormGroup-content fieldset select:hover:not(:focus) {
  background-color: var(--jp-border-color2);
}

/* stylelint-enable selector-max-type */

.jp-FormGroup-content .checkbox .field-description {
  /* Disable default description field for checkbox:
   because other widgets do not have description fields,
   we add descriptions to each widget on the field level.
  */
  display: none;
}

.jp-FormGroup-content #root__description {
  display: none;
}

.jp-FormGroup-content .jp-modifiedIndicator {
  width: 5px;
  background-color: var(--jp-brand-color2);
  margin-top: 0;
  margin-left: calc(var(--jp-private-settingeditor-modifier-indent) * -1);
  flex-shrink: 0;
}

.jp-FormGroup-content .jp-modifiedIndicator.jp-errorIndicator {
  background-color: var(--jp-error-color0);
  margin-right: 0.5em;
}

/* RJSF ARRAY style */

.jp-arrayFieldWrapper legend {
  font-size: var(--jp-content-font-size2);
  color: var(--jp-ui-font-color0);
  flex-basis: 100%;
  padding: 4px 0;
  font-weight: var(--jp-content-heading-font-weight);
  border-bottom: 1px solid var(--jp-border-color2);
}

.jp-arrayFieldWrapper .field-description {
  padding: 4px 0;
  white-space: pre-wrap;
}

.jp-arrayFieldWrapper .array-item {
  width: 100%;
  border: 1px solid var(--jp-border-color2);
  border-radius: 4px;
  margin: 4px;
}

.jp-ArrayOperations {
  display: flex;
  margin-left: 8px;
}

.jp-ArrayOperationsButton {
  margin: 2px;
}

.jp-ArrayOperationsButton .jp-icon3[fill] {
  fill: var(--jp-ui-font-color0);
}

button.jp-ArrayOperationsButton.jp-mod-styled:disabled {
  cursor: not-allowed;
  opacity: 0.5;
}

/* RJSF form validation error */

.jp-FormGroup-content .validationErrors {
  color: var(--jp-error-color0);
}

/* Hide panel level error as duplicated the field level error */
.jp-FormGroup-content .panel.errors {
  display: none;
}

/* RJSF normal content (settings-editor) */

.jp-FormGroup-contentNormal {
  display: flex;
  align-items: center;
  flex-wrap: wrap;
}

.jp-FormGroup-contentNormal .jp-FormGroup-contentItem {
  margin-left: 7px;
  color: var(--jp-ui-font-color0);
}

.jp-FormGroup-contentNormal .jp-FormGroup-description {
  flex-basis: 100%;
  padding: 4px 7px;
}

.jp-FormGroup-contentNormal .jp-FormGroup-default {
  flex-basis: 100%;
  padding: 4px 7px;
}

.jp-FormGroup-contentNormal .jp-FormGroup-fieldLabel {
  font-size: var(--jp-content-font-size1);
  font-weight: normal;
  min-width: 120px;
}

.jp-FormGroup-contentNormal fieldset:not(:first-child) {
  margin-left: 7px;
}

.jp-FormGroup-contentNormal .field-array-of-string .array-item {
  /* Display `jp-ArrayOperations` buttons side-by-side with content except
    for small screens where flex-wrap will place them one below the other.
  */
  display: flex;
  align-items: center;
  flex-wrap: wrap;
}

.jp-FormGroup-contentNormal .jp-objectFieldWrapper .form-group {
  padding: 2px 8px 2px var(--jp-private-settingeditor-modifier-indent);
  margin-top: 2px;
}

/* RJSF compact content (metadata-form) */

.jp-FormGroup-content.jp-FormGroup-contentCompact {
  width: 100%;
}

.jp-FormGroup-contentCompact .form-group {
  display: flex;
  padding: 0.5em 0.2em 0.5em 0;
}

.jp-FormGroup-contentCompact
  .jp-FormGroup-compactTitle
  .jp-FormGroup-description {
  font-size: var(--jp-ui-font-size1);
  color: var(--jp-ui-font-color2);
}

.jp-FormGroup-contentCompact .jp-FormGroup-fieldLabel {
  padding-bottom: 0.3em;
}

.jp-FormGroup-contentCompact .jp-inputFieldWrapper .form-control {
  width: 100%;
  box-sizing: border-box;
}

.jp-FormGroup-contentCompact .jp-arrayFieldWrapper .jp-FormGroup-compactTitle {
  padding-bottom: 7px;
}

.jp-FormGroup-contentCompact
  .jp-objectFieldWrapper
  .jp-objectFieldWrapper
  .form-group {
  padding: 2px 8px 2px var(--jp-private-settingeditor-modifier-indent);
  margin-top: 2px;
}

.jp-FormGroup-contentCompact ul.error-detail {
  margin-block-start: 0.5em;
  margin-block-end: 0.5em;
  padding-inline-start: 1em;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

.jp-SidePanel {
  display: flex;
  flex-direction: column;
  min-width: var(--jp-sidebar-min-width);
  overflow-y: auto;
  color: var(--jp-ui-font-color1);
  background: var(--jp-layout-color1);
  font-size: var(--jp-ui-font-size1);
}

.jp-SidePanel-header {
  flex: 0 0 auto;
  display: flex;
  border-bottom: var(--jp-border-width) solid var(--jp-border-color2);
  font-size: var(--jp-ui-font-size0);
  font-weight: 600;
  letter-spacing: 1px;
  margin: 0;
  padding: 2px;
  text-transform: uppercase;
}

.jp-SidePanel-toolbar {
  flex: 0 0 auto;
}

.jp-SidePanel-content {
  flex: 1 1 auto;
}

.jp-SidePanel-toolbar,
.jp-AccordionPanel-toolbar {
  height: var(--jp-private-toolbar-height);
}

.jp-SidePanel-toolbar.jp-Toolbar-micro {
  display: none;
}

.lm-AccordionPanel .jp-AccordionPanel-title {
  box-sizing: border-box;
  line-height: 25px;
  margin: 0;
  display: flex;
  align-items: center;
  background: var(--jp-layout-color1);
  color: var(--jp-ui-font-color1);
  border-bottom: var(--jp-border-width) solid var(--jp-toolbar-border-color);
  box-shadow: var(--jp-toolbar-box-shadow);
  font-size: var(--jp-ui-font-size0);
}

.jp-AccordionPanel-title {
  cursor: pointer;
  user-select: none;
  -moz-user-select: none;
  -webkit-user-select: none;
  text-transform: uppercase;
}

.lm-AccordionPanel[data-orientation='horizontal'] > .jp-AccordionPanel-title {
  /* Title is rotated for horizontal accordion panel using CSS */
  display: block;
  transform-origin: top left;
  transform: rotate(-90deg) translate(-100%);
}

.jp-AccordionPanel-title .lm-AccordionPanel-titleLabel {
  user-select: none;
  text-overflow: ellipsis;
  white-space: nowrap;
  overflow: hidden;
}

.jp-AccordionPanel-title .lm-AccordionPanel-titleCollapser {
  transform: rotate(-90deg);
  margin: auto 0;
  height: 16px;
}

.jp-AccordionPanel-title.lm-mod-expanded .lm-AccordionPanel-titleCollapser {
  transform: rotate(0deg);
}

.lm-AccordionPanel .jp-AccordionPanel-toolbar {
  background: none;
  box-shadow: none;
  border: none;
  margin-left: auto;
}

.lm-AccordionPanel .lm-SplitPanel-handle:hover {
  background: var(--jp-layout-color3);
}

.jp-text-truncated {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/*-----------------------------------------------------------------------------
| Copyright (c) 2017, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-Spinner {
  position: absolute;
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 10;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background: var(--jp-layout-color0);
  outline: none;
}

.jp-SpinnerContent {
  font-size: 10px;
  margin: 50px auto;
  text-indent: -9999em;
  width: 3em;
  height: 3em;
  border-radius: 50%;
  background: var(--jp-brand-color3);
  background: linear-gradient(
    to right,
    #f37626 10%,
    rgba(255, 255, 255, 0) 42%
  );
  position: relative;
  animation: load3 1s infinite linear, fadeIn 1s;
}

.jp-SpinnerContent::before {
  width: 50%;
  height: 50%;
  background: #f37626;
  border-radius: 100% 0 0;
  position: absolute;
  top: 0;
  left: 0;
  content: '';
}

.jp-SpinnerContent::after {
  background: var(--jp-layout-color0);
  width: 75%;
  height: 75%;
  border-radius: 50%;
  content: '';
  margin: auto;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
}

@keyframes fadeIn {
  0% {
    opacity: 0;
  }

  100% {
    opacity: 1;
  }
}

@keyframes load3 {
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
}

/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2017, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

button.jp-mod-styled {
  font-size: var(--jp-ui-font-size1);
  color: var(--jp-ui-font-color0);
  border: none;
  box-sizing: border-box;
  text-align: center;
  line-height: 32px;
  height: 32px;
  padding: 0 12px;
  letter-spacing: 0.8px;
  outline: none;
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
}

input.jp-mod-styled {
  background: var(--jp-input-background);
  height: 28px;
  box-sizing: border-box;
  border: var(--jp-border-width) solid var(--jp-border-color1);
  padding-left: 7px;
  padding-right: 7px;
  font-size: var(--jp-ui-font-size2);
  color: var(--jp-ui-font-color0);
  outline: none;
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
}

input[type='checkbox'].jp-mod-styled {
  appearance: checkbox;
  -webkit-appearance: checkbox;
  -moz-appearance: checkbox;
  height: auto;
}

input.jp-mod-styled:focus {
  border: var(--jp-border-width) solid var(--md-blue-500);
  box-shadow: inset 0 0 4px var(--md-blue-300);
}

.jp-select-wrapper {
  display: flex;
  position: relative;
  flex-direction: column;
  padding: 1px;
  background-color: var(--jp-layout-color1);
  box-sizing: border-box;
  margin-bottom: 12px;
}

.jp-select-wrapper:not(.multiple) {
  height: 28px;
}

.jp-select-wrapper.jp-mod-focused select.jp-mod-styled {
  border: var(--jp-border-width) solid var(--jp-input-active-border-color);
  box-shadow: var(--jp-input-box-shadow);
  background-color: var(--jp-input-active-background);
}

select.jp-mod-styled:hover {
  cursor: pointer;
  color: var(--jp-ui-font-color0);
  background-color: var(--jp-input-hover-background);
  box-shadow: inset 0 0 1px rgba(0, 0, 0, 0.5);
}

select.jp-mod-styled {
  flex: 1 1 auto;
  width: 100%;
  font-size: var(--jp-ui-font-size2);
  background: var(--jp-input-background);
  color: var(--jp-ui-font-color0);
  padding: 0 25px 0 8px;
  border: var(--jp-border-width) solid var(--jp-input-border-color);
  border-radius: 0;
  outline: none;
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
}

select.jp-mod-styled:not([multiple]) {
  height: 32px;
}

select.jp-mod-styled[multiple] {
  max-height: 200px;
  overflow-y: auto;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-switch {
  display: flex;
  align-items: center;
  padding-left: 4px;
  padding-right: 4px;
  font-size: var(--jp-ui-font-size1);
  background-color: transparent;
  color: var(--jp-ui-font-color1);
  border: none;
  height: 20px;
}

.jp-switch:hover {
  background-color: var(--jp-layout-color2);
}

.jp-switch-label {
  margin-right: 5px;
  font-family: var(--jp-ui-font-family);
}

.jp-switch-track {
  cursor: pointer;
  background-color: var(--jp-switch-color, var(--jp-border-color1));
  -webkit-transition: 0.4s;
  transition: 0.4s;
  border-radius: 34px;
  height: 16px;
  width: 35px;
  position: relative;
}

.jp-switch-track::before {
  content: '';
  position: absolute;
  height: 10px;
  width: 10px;
  margin: 3px;
  left: 0;
  background-color: var(--jp-ui-inverse-font-color1);
  -webkit-transition: 0.4s;
  transition: 0.4s;
  border-radius: 50%;
}

.jp-switch[aria-checked='true'] .jp-switch-track {
  background-color: var(--jp-switch-true-position-color, var(--jp-warn-color0));
}

.jp-switch[aria-checked='true'] .jp-switch-track::before {
  /* track width (35) - margins (3 + 3) - thumb width (10) */
  left: 19px;
}

/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2016, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

:root {
  --jp-private-toolbar-height: calc(
    28px + var(--jp-border-width)
  ); /* leave 28px for content */
}

.jp-Toolbar {
  color: var(--jp-ui-font-color1);
  flex: 0 0 auto;
  display: flex;
  flex-direction: row;
  border-bottom: var(--jp-border-width) solid var(--jp-toolbar-border-color);
  box-shadow: var(--jp-toolbar-box-shadow);
  background: var(--jp-toolbar-background);
  min-height: var(--jp-toolbar-micro-height);
  padding: 2px;
  z-index: 8;
  overflow-x: hidden;
}

/* Toolbar items */

.jp-Toolbar > .jp-Toolbar-item.jp-Toolbar-spacer {
  flex-grow: 1;
  flex-shrink: 1;
}

.jp-Toolbar-item.jp-Toolbar-kernelStatus {
  display: inline-block;
  width: 32px;
  background-repeat: no-repeat;
  background-position: center;
  background-size: 16px;
}

.jp-Toolbar > .jp-Toolbar-item {
  flex: 0 0 auto;
  display: flex;
  padding-left: 1px;
  padding-right: 1px;
  font-size: var(--jp-ui-font-size1);
  line-height: var(--jp-private-toolbar-height);
  height: 100%;
}

/* Toolbar buttons */

/* This is the div we use to wrap the react component into a Widget */
div.jp-ToolbarButton {
  color: transparent;
  border: none;
  box-sizing: border-box;
  outline: none;
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
  padding: 0;
  margin: 0;
}

button.jp-ToolbarButtonComponent {
  background: var(--jp-layout-color1);
  border: none;
  box-sizing: border-box;
  outline: none;
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
  padding: 0 6px;
  margin: 0;
  height: 24px;
  border-radius: var(--jp-border-radius);
  display: flex;
  align-items: center;
  text-align: center;
  font-size: 14px;
  min-width: unset;
  min-height: unset;
}

button.jp-ToolbarButtonComponent:disabled {
  opacity: 0.4;
}

button.jp-ToolbarButtonComponent > span {
  padding: 0;
  flex: 0 0 auto;
}

button.jp-ToolbarButtonComponent .jp-ToolbarButtonComponent-label {
  font-size: var(--jp-ui-font-size1);
  line-height: 100%;
  padding-left: 2px;
  color: var(--jp-ui-font-color1);
  font-family: var(--jp-ui-font-family);
}

#jp-main-dock-panel[data-mode='single-document']
  .jp-MainAreaWidget
  > .jp-Toolbar.jp-Toolbar-micro {
  padding: 0;
  min-height: 0;
}

#jp-main-dock-panel[data-mode='single-document']
  .jp-MainAreaWidget
  > .jp-Toolbar {
  border: none;
  box-shadow: none;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

.jp-WindowedPanel-outer {
  position: relative;
  overflow-y: auto;
}

.jp-WindowedPanel-inner {
  position: relative;
}

.jp-WindowedPanel-window {
  position: absolute;
  left: 0;
  right: 0;
  overflow: visible;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/* Sibling imports */

body {
  color: var(--jp-ui-font-color1);
  font-size: var(--jp-ui-font-size1);
}

/* Disable native link decoration styles everywhere outside of dialog boxes */
a {
  text-decoration: unset;
  color: unset;
}

a:hover {
  text-decoration: unset;
  color: unset;
}

/* Accessibility for links inside dialog box text */
.jp-Dialog-content a {
  text-decoration: revert;
  color: var(--jp-content-link-color);
}

.jp-Dialog-content a:hover {
  text-decoration: revert;
}

/* Styles for ui-components */
.jp-Button {
  color: var(--jp-ui-font-color2);
  border-radius: var(--jp-border-radius);
  padding: 0 12px;
  font-size: var(--jp-ui-font-size1);

  /* Copy from blueprint 3 */
  display: inline-flex;
  flex-direction: row;
  border: none;
  cursor: pointer;
  align-items: center;
  justify-content: center;
  text-align: left;
  vertical-align: middle;
  min-height: 30px;
  min-width: 30px;
}

.jp-Button:disabled {
  cursor: not-allowed;
}

.jp-Button:empty {
  padding: 0 !important;
}

.jp-Button.jp-mod-small {
  min-height: 24px;
  min-width: 24px;
  font-size: 12px;
  padding: 0 7px;
}

/* Use our own theme for hover styles */
.jp-Button.jp-mod-minimal:hover {
  background-color: var(--jp-layout-color2);
}

.jp-Button.jp-mod-minimal {
  background: none;
}

.jp-InputGroup {
  display: block;
  position: relative;
}

.jp-InputGroup input {
  box-sizing: border-box;
  border: none;
  border-radius: 0;
  background-color: transparent;
  color: var(--jp-ui-font-color0);
  box-shadow: inset 0 0 0 var(--jp-border-width) var(--jp-input-border-color);
  padding-bottom: 0;
  padding-top: 0;
  padding-left: 10px;
  padding-right: 28px;
  position: relative;
  width: 100%;
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  font-size: 14px;
  font-weight: 400;
  height: 30px;
  line-height: 30px;
  outline: none;
  vertical-align: middle;
}

.jp-InputGroup input:focus {
  box-shadow: inset 0 0 0 var(--jp-border-width)
      var(--jp-input-active-box-shadow-color),
    inset 0 0 0 3px var(--jp-input-active-box-shadow-color);
}

.jp-InputGroup input:disabled {
  cursor: not-allowed;
  resize: block;
  background-color: var(--jp-layout-color2);
  color: var(--jp-ui-font-color2);
}

.jp-InputGroup input:disabled ~ span {
  cursor: not-allowed;
  color: var(--jp-ui-font-color2);
}

.jp-InputGroup input::placeholder,
input::placeholder {
  color: var(--jp-ui-font-color2);
}

.jp-InputGroupAction {
  position: absolute;
  bottom: 1px;
  right: 0;
  padding: 6px;
}

.jp-HTMLSelect.jp-DefaultStyle select {
  background-color: initial;
  border: none;
  border-radius: 0;
  box-shadow: none;
  color: var(--jp-ui-font-color0);
  display: block;
  font-size: var(--jp-ui-font-size1);
  font-family: var(--jp-ui-font-family);
  height: 24px;
  line-height: 14px;
  padding: 0 25px 0 10px;
  text-align: left;
  -moz-appearance: none;
  -webkit-appearance: none;
}

.jp-HTMLSelect.jp-DefaultStyle select:disabled {
  background-color: var(--jp-layout-color2);
  color: var(--jp-ui-font-color2);
  cursor: not-allowed;
  resize: block;
}

.jp-HTMLSelect.jp-DefaultStyle select:disabled ~ span {
  cursor: not-allowed;
}

/* Use our own theme for hover and option styles */
/* stylelint-disable-next-line selector-max-type */
.jp-HTMLSelect.jp-DefaultStyle select:hover,
.jp-HTMLSelect.jp-DefaultStyle select > option {
  background-color: var(--jp-layout-color2);
  color: var(--jp-ui-font-color0);
}

select {
  box-sizing: border-box;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Styles
|----------------------------------------------------------------------------*/

.jp-StatusBar-Widget {
  display: flex;
  align-items: center;
  background: var(--jp-layout-color2);
  min-height: var(--jp-statusbar-height);
  justify-content: space-between;
  padding: 0 10px;
}

.jp-StatusBar-Left {
  display: flex;
  align-items: center;
  flex-direction: row;
}

.jp-StatusBar-Middle {
  display: flex;
  align-items: center;
}

.jp-StatusBar-Right {
  display: flex;
  align-items: center;
  flex-direction: row-reverse;
}

.jp-StatusBar-Item {
  max-height: var(--jp-statusbar-height);
  margin: 0 2px;
  height: var(--jp-statusbar-height);
  white-space: nowrap;
  text-overflow: ellipsis;
  color: var(--jp-ui-font-color1);
  padding: 0 6px;
}

.jp-mod-highlighted:hover {
  background-color: var(--jp-layout-color3);
}

.jp-mod-clicked {
  background-color: var(--jp-brand-color1);
}

.jp-mod-clicked:hover {
  background-color: var(--jp-brand-color0);
}

.jp-mod-clicked .jp-StatusBar-TextItem {
  color: var(--jp-ui-inverse-font-color1);
}

.jp-StatusBar-HoverItem {
  box-shadow: '0px 4px 4px rgba(0, 0, 0, 0.25)';
}

.jp-StatusBar-TextItem {
  font-size: var(--jp-ui-font-size1);
  font-family: var(--jp-ui-font-family);
  line-height: 24px;
  color: var(--jp-ui-font-color1);
}

.jp-StatusBar-GroupItem {
  display: flex;
  align-items: center;
  flex-direction: row;
}

.jp-Statusbar-ProgressCircle svg {
  display: block;
  margin: 0 auto;
  width: 16px;
  height: 24px;
  align-self: normal;
}

.jp-Statusbar-ProgressCircle path {
  fill: var(--jp-inverse-layout-color3);
}

.jp-Statusbar-ProgressBar-progress-bar {
  height: 10px;
  width: 100px;
  border: solid 0.25px var(--jp-brand-color2);
  border-radius: 3px;
  overflow: hidden;
  align-self: center;
}

.jp-Statusbar-ProgressBar-progress-bar > div {
  background-color: var(--jp-brand-color2);
  background-image: linear-gradient(
    -45deg,
    rgba(255, 255, 255, 0.2) 25%,
    transparent 25%,
    transparent 50%,
    rgba(255, 255, 255, 0.2) 50%,
    rgba(255, 255, 255, 0.2) 75%,
    transparent 75%,
    transparent
  );
  background-size: 40px 40px;
  float: left;
  width: 0%;
  height: 100%;
  font-size: 12px;
  line-height: 14px;
  color: #fff;
  text-align: center;
  animation: jp-Statusbar-ExecutionTime-progress-bar 2s linear infinite;
}

.jp-Statusbar-ProgressBar-progress-bar p {
  color: var(--jp-ui-font-color1);
  font-family: var(--jp-ui-font-family);
  font-size: var(--jp-ui-font-size1);
  line-height: 10px;
  width: 100px;
}

@keyframes jp-Statusbar-ExecutionTime-progress-bar {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 40px 40px;
  }
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Variables
|----------------------------------------------------------------------------*/

:root {
  --jp-private-commandpalette-search-height: 28px;
}

/*-----------------------------------------------------------------------------
| Overall styles
|----------------------------------------------------------------------------*/

.lm-CommandPalette {
  padding-bottom: 0;
  color: var(--jp-ui-font-color1);
  background: var(--jp-layout-color1);

  /* This is needed so that all font sizing of children done in ems is
   * relative to this base size */
  font-size: var(--jp-ui-font-size1);
}

/*-----------------------------------------------------------------------------
| Modal variant
|----------------------------------------------------------------------------*/

.jp-ModalCommandPalette {
  position: absolute;
  z-index: 10000;
  top: 38px;
  left: 30%;
  margin: 0;
  padding: 4px;
  width: 40%;
  box-shadow: var(--jp-elevation-z4);
  border-radius: 4px;
  background: var(--jp-layout-color0);
}

.jp-ModalCommandPalette .lm-CommandPalette {
  max-height: 40vh;
}

.jp-ModalCommandPalette .lm-CommandPalette .lm-close-icon::after {
  display: none;
}

.jp-ModalCommandPalette .lm-CommandPalette .lm-CommandPalette-header {
  display: none;
}

.jp-ModalCommandPalette .lm-CommandPalette .lm-CommandPalette-item {
  margin-left: 4px;
  margin-right: 4px;
}

.jp-ModalCommandPalette
  .lm-CommandPalette
  .lm-CommandPalette-item.lm-mod-disabled {
  display: none;
}

/*-----------------------------------------------------------------------------
| Search
|----------------------------------------------------------------------------*/

.lm-CommandPalette-search {
  padding: 4px;
  background-color: var(--jp-layout-color1);
  z-index: 2;
}

.lm-CommandPalette-wrapper {
  overflow: overlay;
  padding: 0 9px;
  background-color: var(--jp-input-active-background);
  height: 30px;
  box-shadow: inset 0 0 0 var(--jp-border-width) var(--jp-input-border-color);
}

.lm-CommandPalette.lm-mod-focused .lm-CommandPalette-wrapper {
  box-shadow: inset 0 0 0 1px var(--jp-input-active-box-shadow-color),
    inset 0 0 0 3px var(--jp-input-active-box-shadow-color);
}

.jp-SearchIconGroup {
  color: white;
  background-color: var(--jp-brand-color1);
  position: absolute;
  top: 4px;
  right: 4px;
  padding: 5px 5px 1px;
}

.jp-SearchIconGroup svg {
  height: 20px;
  width: 20px;
}

.jp-SearchIconGroup .jp-icon3[fill] {
  fill: var(--jp-layout-color0);
}

.lm-CommandPalette-input {
  background: transparent;
  width: calc(100% - 18px);
  float: left;
  border: none;
  outline: none;
  font-size: var(--jp-ui-font-size1);
  color: var(--jp-ui-font-color0);
  line-height: var(--jp-private-commandpalette-search-height);
}

.lm-CommandPalette-input::-webkit-input-placeholder,
.lm-CommandPalette-input::-moz-placeholder,
.lm-CommandPalette-input:-ms-input-placeholder {
  color: var(--jp-ui-font-color2);
  font-size: var(--jp-ui-font-size1);
}

/*-----------------------------------------------------------------------------
| Results
|----------------------------------------------------------------------------*/

.lm-CommandPalette-header:first-child {
  margin-top: 0;
}

.lm-CommandPalette-header {
  border-bottom: solid var(--jp-border-width) var(--jp-border-color2);
  color: var(--jp-ui-font-color1);
  cursor: pointer;
  display: flex;
  font-size: var(--jp-ui-font-size0);
  font-weight: 600;
  letter-spacing: 1px;
  margin-top: 8px;
  padding: 8px 0 8px 12px;
  text-transform: uppercase;
}

.lm-CommandPalette-header.lm-mod-active {
  background: var(--jp-layout-color2);
}

.lm-CommandPalette-header > mark {
  background-color: transparent;
  font-weight: bold;
  color: var(--jp-ui-font-color1);
}

.lm-CommandPalette-item {
  padding: 4px 12px 4px 4px;
  color: var(--jp-ui-font-color1);
  font-size: var(--jp-ui-font-size1);
  font-weight: 400;
  display: flex;
}

.lm-CommandPalette-item.lm-mod-disabled {
  color: var(--jp-ui-font-color2);
}

.lm-CommandPalette-item.lm-mod-active {
  color: var(--jp-ui-inverse-font-color1);
  background: var(--jp-brand-color1);
}

.lm-CommandPalette-item.lm-mod-active .lm-CommandPalette-itemLabel > mark {
  color: var(--jp-ui-inverse-font-color0);
}

.lm-CommandPalette-item.lm-mod-active .jp-icon-selectable[fill] {
  fill: var(--jp-layout-color0);
}

.lm-CommandPalette-item.lm-mod-active:hover:not(.lm-mod-disabled) {
  color: var(--jp-ui-inverse-font-color1);
  background: var(--jp-brand-color1);
}

.lm-CommandPalette-item:hover:not(.lm-mod-active):not(.lm-mod-disabled) {
  background: var(--jp-layout-color2);
}

.lm-CommandPalette-itemContent {
  overflow: hidden;
}

.lm-CommandPalette-itemLabel > mark {
  color: var(--jp-ui-font-color0);
  background-color: transparent;
  font-weight: bold;
}

.lm-CommandPalette-item.lm-mod-disabled mark {
  color: var(--jp-ui-font-color2);
}

.lm-CommandPalette-item .lm-CommandPalette-itemIcon {
  margin: 0 4px 0 0;
  position: relative;
  width: 16px;
  top: 2px;
  flex: 0 0 auto;
}

.lm-CommandPalette-item.lm-mod-disabled .lm-CommandPalette-itemIcon {
  opacity: 0.6;
}

.lm-CommandPalette-item .lm-CommandPalette-itemShortcut {
  flex: 0 0 auto;
}

.lm-CommandPalette-itemCaption {
  display: none;
}

.lm-CommandPalette-content {
  background-color: var(--jp-layout-color1);
}

.lm-CommandPalette-content:empty::after {
  content: 'No results';
  margin: auto;
  margin-top: 20px;
  width: 100px;
  display: block;
  font-size: var(--jp-ui-font-size2);
  font-family: var(--jp-ui-font-family);
  font-weight: lighter;
}

.lm-CommandPalette-emptyMessage {
  text-align: center;
  margin-top: 24px;
  line-height: 1.32;
  padding: 0 8px;
  color: var(--jp-content-font-color3);
}

/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2017, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-Dialog {
  position: absolute;
  z-index: 10000;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  top: 0;
  left: 0;
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  background: var(--jp-dialog-background);
}

.jp-Dialog-content {
  display: flex;
  flex-direction: column;
  margin-left: auto;
  margin-right: auto;
  background: var(--jp-layout-color1);
  padding: 24px 24px 12px;
  min-width: 300px;
  min-height: 150px;
  max-width: 1000px;
  max-height: 500px;
  box-sizing: border-box;
  box-shadow: var(--jp-elevation-z20);
  word-wrap: break-word;
  border-radius: var(--jp-border-radius);

  /* This is needed so that all font sizing of children done in ems is
   * relative to this base size */
  font-size: var(--jp-ui-font-size1);
  color: var(--jp-ui-font-color1);
  resize: both;
}

.jp-Dialog-content.jp-Dialog-content-small {
  max-width: 500px;
}

.jp-Dialog-button {
  overflow: visible;
}

button.jp-Dialog-button:focus {
  outline: 1px solid var(--jp-brand-color1);
  outline-offset: 4px;
  -moz-outline-radius: 0;
}

button.jp-Dialog-button:focus::-moz-focus-inner {
  border: 0;
}

button.jp-Dialog-button.jp-mod-styled.jp-mod-accept:focus,
button.jp-Dialog-button.jp-mod-styled.jp-mod-warn:focus,
button.jp-Dialog-button.jp-mod-styled.jp-mod-reject:focus {
  outline-offset: 4px;
  -moz-outline-radius: 0;
}

button.jp-Dialog-button.jp-mod-styled.jp-mod-accept:focus {
  outline: 1px solid var(--jp-accept-color-normal, var(--jp-brand-color1));
}

button.jp-Dialog-button.jp-mod-styled.jp-mod-warn:focus {
  outline: 1px solid var(--jp-warn-color-normal, var(--jp-error-color1));
}

button.jp-Dialog-button.jp-mod-styled.jp-mod-reject:focus {
  outline: 1px solid var(--jp-reject-color-normal, var(--md-grey-600));
}

button.jp-Dialog-close-button {
  padding: 0;
  height: 100%;
  min-width: unset;
  min-height: unset;
}

.jp-Dialog-header {
  display: flex;
  justify-content: space-between;
  flex: 0 0 auto;
  padding-bottom: 12px;
  font-size: var(--jp-ui-font-size3);
  font-weight: 400;
  color: var(--jp-ui-font-color1);
}

.jp-Dialog-body {
  display: flex;
  flex-direction: column;
  flex: 1 1 auto;
  font-size: var(--jp-ui-font-size1);
  background: var(--jp-layout-color1);
  color: var(--jp-ui-font-color1);
  overflow: auto;
}

.jp-Dialog-footer {
  display: flex;
  flex-direction: row;
  justify-content: flex-end;
  align-items: center;
  flex: 0 0 auto;
  margin-left: -12px;
  margin-right: -12px;
  padding: 12px;
}

.jp-Dialog-checkbox {
  padding-right: 5px;
}

.jp-Dialog-checkbox > input:focus-visible {
  outline: 1px solid var(--jp-input-active-border-color);
  outline-offset: 1px;
}

.jp-Dialog-spacer {
  flex: 1 1 auto;
}

.jp-Dialog-title {
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}

.jp-Dialog-body > .jp-select-wrapper {
  width: 100%;
}

.jp-Dialog-body > button {
  padding: 0 16px;
}

.jp-Dialog-body > label {
  line-height: 1.4;
  color: var(--jp-ui-font-color0);
}

.jp-Dialog-button.jp-mod-styled:not(:last-child) {
  margin-right: 12px;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

.jp-Input-Boolean-Dialog {
  flex-direction: row-reverse;
  align-items: end;
  width: 100%;
}

.jp-Input-Boolean-Dialog > label {
  flex: 1 1 auto;
}

/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2016, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-MainAreaWidget > :focus {
  outline: none;
}

.jp-MainAreaWidget .jp-MainAreaWidget-error {
  padding: 6px;
}

.jp-MainAreaWidget .jp-MainAreaWidget-error > pre {
  width: auto;
  padding: 10px;
  background: var(--jp-error-color3);
  border: var(--jp-border-width) solid var(--jp-error-color1);
  border-radius: var(--jp-border-radius);
  color: var(--jp-ui-font-color1);
  font-size: var(--jp-ui-font-size1);
  white-space: pre-wrap;
  word-wrap: break-word;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/**
 * google-material-color v1.2.6
 * https://github.com/danlevan/google-material-color
 */
:root {
  --md-red-50: #ffebee;
  --md-red-100: #ffcdd2;
  --md-red-200: #ef9a9a;
  --md-red-300: #e57373;
  --md-red-400: #ef5350;
  --md-red-500: #f44336;
  --md-red-600: #e53935;
  --md-red-700: #d32f2f;
  --md-red-800: #c62828;
  --md-red-900: #b71c1c;
  --md-red-A100: #ff8a80;
  --md-red-A200: #ff5252;
  --md-red-A400: #ff1744;
  --md-red-A700: #d50000;
  --md-pink-50: #fce4ec;
  --md-pink-100: #f8bbd0;
  --md-pink-200: #f48fb1;
  --md-pink-300: #f06292;
  --md-pink-400: #ec407a;
  --md-pink-500: #e91e63;
  --md-pink-600: #d81b60;
  --md-pink-700: #c2185b;
  --md-pink-800: #ad1457;
  --md-pink-900: #880e4f;
  --md-pink-A100: #ff80ab;
  --md-pink-A200: #ff4081;
  --md-pink-A400: #f50057;
  --md-pink-A700: #c51162;
  --md-purple-50: #f3e5f5;
  --md-purple-100: #e1bee7;
  --md-purple-200: #ce93d8;
  --md-purple-300: #ba68c8;
  --md-purple-400: #ab47bc;
  --md-purple-500: #9c27b0;
  --md-purple-600: #8e24aa;
  --md-purple-700: #7b1fa2;
  --md-purple-800: #6a1b9a;
  --md-purple-900: #4a148c;
  --md-purple-A100: #ea80fc;
  --md-purple-A200: #e040fb;
  --md-purple-A400: #d500f9;
  --md-purple-A700: #a0f;
  --md-deep-purple-50: #ede7f6;
  --md-deep-purple-100: #d1c4e9;
  --md-deep-purple-200: #b39ddb;
  --md-deep-purple-300: #9575cd;
  --md-deep-purple-400: #7e57c2;
  --md-deep-purple-500: #673ab7;
  --md-deep-purple-600: #5e35b1;
  --md-deep-purple-700: #512da8;
  --md-deep-purple-800: #4527a0;
  --md-deep-purple-900: #311b92;
  --md-deep-purple-A100: #b388ff;
  --md-deep-purple-A200: #7c4dff;
  --md-deep-purple-A400: #651fff;
  --md-deep-purple-A700: #6200ea;
  --md-indigo-50: #e8eaf6;
  --md-indigo-100: #c5cae9;
  --md-indigo-200: #9fa8da;
  --md-indigo-300: #7986cb;
  --md-indigo-400: #5c6bc0;
  --md-indigo-500: #3f51b5;
  --md-indigo-600: #3949ab;
  --md-indigo-700: #303f9f;
  --md-indigo-800: #283593;
  --md-indigo-900: #1a237e;
  --md-indigo-A100: #8c9eff;
  --md-indigo-A200: #536dfe;
  --md-indigo-A400: #3d5afe;
  --md-indigo-A700: #304ffe;
  --md-blue-50: #e3f2fd;
  --md-blue-100: #bbdefb;
  --md-blue-200: #90caf9;
  --md-blue-300: #64b5f6;
  --md-blue-400: #42a5f5;
  --md-blue-500: #2196f3;
  --md-blue-600: #1e88e5;
  --md-blue-700: #1976d2;
  --md-blue-800: #1565c0;
  --md-blue-900: #0d47a1;
  --md-blue-A100: #82b1ff;
  --md-blue-A200: #448aff;
  --md-blue-A400: #2979ff;
  --md-blue-A700: #2962ff;
  --md-light-blue-50: #e1f5fe;
  --md-light-blue-100: #b3e5fc;
  --md-light-blue-200: #81d4fa;
  --md-light-blue-300: #4fc3f7;
  --md-light-blue-400: #29b6f6;
  --md-light-blue-500: #03a9f4;
  --md-light-blue-600: #039be5;
  --md-light-blue-700: #0288d1;
  --md-light-blue-800: #0277bd;
  --md-light-blue-900: #01579b;
  --md-light-blue-A100: #80d8ff;
  --md-light-blue-A200: #40c4ff;
  --md-light-blue-A400: #00b0ff;
  --md-light-blue-A700: #0091ea;
  --md-cyan-50: #e0f7fa;
  --md-cyan-100: #b2ebf2;
  --md-cyan-200: #80deea;
  --md-cyan-300: #4dd0e1;
  --md-cyan-400: #26c6da;
  --md-cyan-500: #00bcd4;
  --md-cyan-600: #00acc1;
  --md-cyan-700: #0097a7;
  --md-cyan-800: #00838f;
  --md-cyan-900: #006064;
  --md-cyan-A100: #84ffff;
  --md-cyan-A200: #18ffff;
  --md-cyan-A400: #00e5ff;
  --md-cyan-A700: #00b8d4;
  --md-teal-50: #e0f2f1;
  --md-teal-100: #b2dfdb;
  --md-teal-200: #80cbc4;
  --md-teal-300: #4db6ac;
  --md-teal-400: #26a69a;
  --md-teal-500: #009688;
  --md-teal-600: #00897b;
  --md-teal-700: #00796b;
  --md-teal-800: #00695c;
  --md-teal-900: #004d40;
  --md-teal-A100: #a7ffeb;
  --md-teal-A200: #64ffda;
  --md-teal-A400: #1de9b6;
  --md-teal-A700: #00bfa5;
  --md-green-50: #e8f5e9;
  --md-green-100: #c8e6c9;
  --md-green-200: #a5d6a7;
  --md-green-300: #81c784;
  --md-green-400: #66bb6a;
  --md-green-500: #4caf50;
  --md-green-600: #43a047;
  --md-green-700: #388e3c;
  --md-green-800: #2e7d32;
  --md-green-900: #1b5e20;
  --md-green-A100: #b9f6ca;
  --md-green-A200: #69f0ae;
  --md-green-A400: #00e676;
  --md-green-A700: #00c853;
  --md-light-green-50: #f1f8e9;
  --md-light-green-100: #dcedc8;
  --md-light-green-200: #c5e1a5;
  --md-light-green-300: #aed581;
  --md-light-green-400: #9ccc65;
  --md-light-green-500: #8bc34a;
  --md-light-green-600: #7cb342;
  --md-light-green-700: #689f38;
  --md-light-green-800: #558b2f;
  --md-light-green-900: #33691e;
  --md-light-green-A100: #ccff90;
  --md-light-green-A200: #b2ff59;
  --md-light-green-A400: #76ff03;
  --md-light-green-A700: #64dd17;
  --md-lime-50: #f9fbe7;
  --md-lime-100: #f0f4c3;
  --md-lime-200: #e6ee9c;
  --md-lime-300: #dce775;
  --md-lime-400: #d4e157;
  --md-lime-500: #cddc39;
  --md-lime-600: #c0ca33;
  --md-lime-700: #afb42b;
  --md-lime-800: #9e9d24;
  --md-lime-900: #827717;
  --md-lime-A100: #f4ff81;
  --md-lime-A200: #eeff41;
  --md-lime-A400: #c6ff00;
  --md-lime-A700: #aeea00;
  --md-yellow-50: #fffde7;
  --md-yellow-100: #fff9c4;
  --md-yellow-200: #fff59d;
  --md-yellow-300: #fff176;
  --md-yellow-400: #ffee58;
  --md-yellow-500: #ffeb3b;
  --md-yellow-600: #fdd835;
  --md-yellow-700: #fbc02d;
  --md-yellow-800: #f9a825;
  --md-yellow-900: #f57f17;
  --md-yellow-A100: #ffff8d;
  --md-yellow-A200: #ff0;
  --md-yellow-A400: #ffea00;
  --md-yellow-A700: #ffd600;
  --md-amber-50: #fff8e1;
  --md-amber-100: #ffecb3;
  --md-amber-200: #ffe082;
  --md-amber-300: #ffd54f;
  --md-amber-400: #ffca28;
  --md-amber-500: #ffc107;
  --md-amber-600: #ffb300;
  --md-amber-700: #ffa000;
  --md-amber-800: #ff8f00;
  --md-amber-900: #ff6f00;
  --md-amber-A100: #ffe57f;
  --md-amber-A200: #ffd740;
  --md-amber-A400: #ffc400;
  --md-amber-A700: #ffab00;
  --md-orange-50: #fff3e0;
  --md-orange-100: #ffe0b2;
  --md-orange-200: #ffcc80;
  --md-orange-300: #ffb74d;
  --md-orange-400: #ffa726;
  --md-orange-500: #ff9800;
  --md-orange-600: #fb8c00;
  --md-orange-700: #f57c00;
  --md-orange-800: #ef6c00;
  --md-orange-900: #e65100;
  --md-orange-A100: #ffd180;
  --md-orange-A200: #ffab40;
  --md-orange-A400: #ff9100;
  --md-orange-A700: #ff6d00;
  --md-deep-orange-50: #fbe9e7;
  --md-deep-orange-100: #ffccbc;
  --md-deep-orange-200: #ffab91;
  --md-deep-orange-300: #ff8a65;
  --md-deep-orange-400: #ff7043;
  --md-deep-orange-500: #ff5722;
  --md-deep-orange-600: #f4511e;
  --md-deep-orange-700: #e64a19;
  --md-deep-orange-800: #d84315;
  --md-deep-orange-900: #bf360c;
  --md-deep-orange-A100: #ff9e80;
  --md-deep-orange-A200: #ff6e40;
  --md-deep-orange-A400: #ff3d00;
  --md-deep-orange-A700: #dd2c00;
  --md-brown-50: #efebe9;
  --md-brown-100: #d7ccc8;
  --md-brown-200: #bcaaa4;
  --md-brown-300: #a1887f;
  --md-brown-400: #8d6e63;
  --md-brown-500: #795548;
  --md-brown-600: #6d4c41;
  --md-brown-700: #5d4037;
  --md-brown-800: #4e342e;
  --md-brown-900: #3e2723;
  --md-grey-50: #fafafa;
  --md-grey-100: #f5f5f5;
  --md-grey-200: #eee;
  --md-grey-300: #e0e0e0;
  --md-grey-400: #bdbdbd;
  --md-grey-500: #9e9e9e;
  --md-grey-600: #757575;
  --md-grey-700: #616161;
  --md-grey-800: #424242;
  --md-grey-900: #212121;
  --md-blue-grey-50: #eceff1;
  --md-blue-grey-100: #cfd8dc;
  --md-blue-grey-200: #b0bec5;
  --md-blue-grey-300: #90a4ae;
  --md-blue-grey-400: #78909c;
  --md-blue-grey-500: #607d8b;
  --md-blue-grey-600: #546e7a;
  --md-blue-grey-700: #455a64;
  --md-blue-grey-800: #37474f;
  --md-blue-grey-900: #263238;
}

/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2017, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| RenderedText
|----------------------------------------------------------------------------*/

:root {
  /* This is the padding value to fill the gaps between lines containing spans with background color. */
  --jp-private-code-span-padding: calc(
    (var(--jp-code-line-height) - 1) * var(--jp-code-font-size) / 2
  );
}

.jp-RenderedText {
  text-align: left;
  padding-left: var(--jp-code-padding);
  line-height: var(--jp-code-line-height);
  font-family: var(--jp-code-font-family);
}

.jp-RenderedText pre,
.jp-RenderedJavaScript pre,
.jp-RenderedHTMLCommon pre {
  color: var(--jp-content-font-color1);
  font-size: var(--jp-code-font-size);
  border: none;
  margin: 0;
  padding: 0;
}

.jp-RenderedText pre a:link {
  text-decoration: none;
  color: var(--jp-content-link-color);
}

.jp-RenderedText pre a:hover {
  text-decoration: underline;
  color: var(--jp-content-link-color);
}

.jp-RenderedText pre a:visited {
  text-decoration: none;
  color: var(--jp-content-link-color);
}

/* console foregrounds and backgrounds */
.jp-RenderedText pre .ansi-black-fg {
  color: #3e424d;
}

.jp-RenderedText pre .ansi-red-fg {
  color: #e75c58;
}

.jp-RenderedText pre .ansi-green-fg {
  color: #00a250;
}

.jp-RenderedText pre .ansi-yellow-fg {
  color: #ddb62b;
}

.jp-RenderedText pre .ansi-blue-fg {
  color: #208ffb;
}

.jp-RenderedText pre .ansi-magenta-fg {
  color: #d160c4;
}

.jp-RenderedText pre .ansi-cyan-fg {
  color: #60c6c8;
}

.jp-RenderedText pre .ansi-white-fg {
  color: #c5c1b4;
}

.jp-RenderedText pre .ansi-black-bg {
  background-color: #3e424d;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-red-bg {
  background-color: #e75c58;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-green-bg {
  background-color: #00a250;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-yellow-bg {
  background-color: #ddb62b;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-blue-bg {
  background-color: #208ffb;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-magenta-bg {
  background-color: #d160c4;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-cyan-bg {
  background-color: #60c6c8;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-white-bg {
  background-color: #c5c1b4;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-black-intense-fg {
  color: #282c36;
}

.jp-RenderedText pre .ansi-red-intense-fg {
  color: #b22b31;
}

.jp-RenderedText pre .ansi-green-intense-fg {
  color: #007427;
}

.jp-RenderedText pre .ansi-yellow-intense-fg {
  color: #b27d12;
}

.jp-RenderedText pre .ansi-blue-intense-fg {
  color: #0065ca;
}

.jp-RenderedText pre .ansi-magenta-intense-fg {
  color: #a03196;
}

.jp-RenderedText pre .ansi-cyan-intense-fg {
  color: #258f8f;
}

.jp-RenderedText pre .ansi-white-intense-fg {
  color: #a1a6b2;
}

.jp-RenderedText pre .ansi-black-intense-bg {
  background-color: #282c36;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-red-intense-bg {
  background-color: #b22b31;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-green-intense-bg {
  background-color: #007427;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-yellow-intense-bg {
  background-color: #b27d12;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-blue-intense-bg {
  background-color: #0065ca;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-magenta-intense-bg {
  background-color: #a03196;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-cyan-intense-bg {
  background-color: #258f8f;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-white-intense-bg {
  background-color: #a1a6b2;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-default-inverse-fg {
  color: var(--jp-ui-inverse-font-color0);
}

.jp-RenderedText pre .ansi-default-inverse-bg {
  background-color: var(--jp-inverse-layout-color0);
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-bold {
  font-weight: bold;
}

.jp-RenderedText pre .ansi-underline {
  text-decoration: underline;
}

.jp-RenderedText[data-mime-type='application/vnd.jupyter.stderr'] {
  background: var(--jp-rendermime-error-background);
  padding-top: var(--jp-code-padding);
}

/*-----------------------------------------------------------------------------
| RenderedLatex
|----------------------------------------------------------------------------*/

.jp-RenderedLatex {
  color: var(--jp-content-font-color1);
  font-size: var(--jp-content-font-size1);
  line-height: var(--jp-content-line-height);
}

/* Left-justify outputs.*/
.jp-OutputArea-output.jp-RenderedLatex {
  padding: var(--jp-code-padding);
  text-align: left;
}

/*-----------------------------------------------------------------------------
| RenderedHTML
|----------------------------------------------------------------------------*/

.jp-RenderedHTMLCommon {
  color: var(--jp-content-font-color1);
  font-family: var(--jp-content-font-family);
  font-size: var(--jp-content-font-size1);
  line-height: var(--jp-content-line-height);

  /* Give a bit more R padding on Markdown text to keep line lengths reasonable */
  padding-right: 20px;
}

.jp-RenderedHTMLCommon em {
  font-style: italic;
}

.jp-RenderedHTMLCommon strong {
  font-weight: bold;
}

.jp-RenderedHTMLCommon u {
  text-decoration: underline;
}

.jp-RenderedHTMLCommon a:link {
  text-decoration: none;
  color: var(--jp-content-link-color);
}

.jp-RenderedHTMLCommon a:hover {
  text-decoration: underline;
  color: var(--jp-content-link-color);
}

.jp-RenderedHTMLCommon a:visited {
  text-decoration: none;
  color: var(--jp-content-link-color);
}

/* Headings */

.jp-RenderedHTMLCommon h1,
.jp-RenderedHTMLCommon h2,
.jp-RenderedHTMLCommon h3,
.jp-RenderedHTMLCommon h4,
.jp-RenderedHTMLCommon h5,
.jp-RenderedHTMLCommon h6 {
  line-height: var(--jp-content-heading-line-height);
  font-weight: var(--jp-content-heading-font-weight);
  font-style: normal;
  margin: var(--jp-content-heading-margin-top) 0
    var(--jp-content-heading-margin-bottom) 0;
}

.jp-RenderedHTMLCommon h1:first-child,
.jp-RenderedHTMLCommon h2:first-child,
.jp-RenderedHTMLCommon h3:first-child,
.jp-RenderedHTMLCommon h4:first-child,
.jp-RenderedHTMLCommon h5:first-child,
.jp-RenderedHTMLCommon h6:first-child {
  margin-top: calc(0.5 * var(--jp-content-heading-margin-top));
}

.jp-RenderedHTMLCommon h1:last-child,
.jp-RenderedHTMLCommon h2:last-child,
.jp-RenderedHTMLCommon h3:last-child,
.jp-RenderedHTMLCommon h4:last-child,
.jp-RenderedHTMLCommon h5:last-child,
.jp-RenderedHTMLCommon h6:last-child {
  margin-bottom: calc(0.5 * var(--jp-content-heading-margin-bottom));
}

.jp-RenderedHTMLCommon h1 {
  font-size: var(--jp-content-font-size5);
}

.jp-RenderedHTMLCommon h2 {
  font-size: var(--jp-content-font-size4);
}

.jp-RenderedHTMLCommon h3 {
  font-size: var(--jp-content-font-size3);
}

.jp-RenderedHTMLCommon h4 {
  font-size: var(--jp-content-font-size2);
}

.jp-RenderedHTMLCommon h5 {
  font-size: var(--jp-content-font-size1);
}

.jp-RenderedHTMLCommon h6 {
  font-size: var(--jp-content-font-size0);
}

/* Lists */

/* stylelint-disable selector-max-type, selector-max-compound-selectors */

.jp-RenderedHTMLCommon ul:not(.list-inline),
.jp-RenderedHTMLCommon ol:not(.list-inline) {
  padding-left: 2em;
}

.jp-RenderedHTMLCommon ul {
  list-style: disc;
}

.jp-RenderedHTMLCommon ul ul {
  list-style: square;
}

.jp-RenderedHTMLCommon ul ul ul {
  list-style: circle;
}

.jp-RenderedHTMLCommon ol {
  list-style: decimal;
}

.jp-RenderedHTMLCommon ol ol {
  list-style: upper-alpha;
}

.jp-RenderedHTMLCommon ol ol ol {
  list-style: lower-alpha;
}

.jp-RenderedHTMLCommon ol ol ol ol {
  list-style: lower-roman;
}

.jp-RenderedHTMLCommon ol ol ol ol ol {
  list-style: decimal;
}

.jp-RenderedHTMLCommon ol,
.jp-RenderedHTMLCommon ul {
  margin-bottom: 1em;
}

.jp-RenderedHTMLCommon ul ul,
.jp-RenderedHTMLCommon ul ol,
.jp-RenderedHTMLCommon ol ul,
.jp-RenderedHTMLCommon ol ol {
  margin-bottom: 0;
}

/* stylelint-enable selector-max-type, selector-max-compound-selectors */

.jp-RenderedHTMLCommon hr {
  color: var(--jp-border-color2);
  background-color: var(--jp-border-color1);
  margin-top: 1em;
  margin-bottom: 1em;
}

.jp-RenderedHTMLCommon > pre {
  margin: 1.5em 2em;
}

.jp-RenderedHTMLCommon pre,
.jp-RenderedHTMLCommon code {
  border: 0;
  background-color: var(--jp-layout-color0);
  color: var(--jp-content-font-color1);
  font-family: var(--jp-code-font-family);
  font-size: inherit;
  line-height: var(--jp-code-line-height);
  padding: 0;
  white-space: pre-wrap;
}

.jp-RenderedHTMLCommon :not(pre) > code {
  background-color: var(--jp-layout-color2);
  padding: 1px 5px;
}

/* Tables */

.jp-RenderedHTMLCommon table {
  border-collapse: collapse;
  border-spacing: 0;
  border: none;
  color: var(--jp-ui-font-color1);
  font-size: var(--jp-ui-font-size1);
  table-layout: fixed;
  margin-left: auto;
  margin-bottom: 1em;
  margin-right: auto;
}

.jp-RenderedHTMLCommon thead {
  border-bottom: var(--jp-border-width) solid var(--jp-border-color1);
  vertical-align: bottom;
}

.jp-RenderedHTMLCommon td,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon tr {
  vertical-align: middle;
  padding: 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}

.jp-RenderedMarkdown.jp-RenderedHTMLCommon td,
.jp-RenderedMarkdown.jp-RenderedHTMLCommon th {
  max-width: none;
}

:not(.jp-RenderedMarkdown).jp-RenderedHTMLCommon td,
:not(.jp-RenderedMarkdown).jp-RenderedHTMLCommon th,
:not(.jp-RenderedMarkdown).jp-RenderedHTMLCommon tr {
  text-align: right;
}

.jp-RenderedHTMLCommon th {
  font-weight: bold;
}

.jp-RenderedHTMLCommon tbody tr:nth-child(odd) {
  background: var(--jp-layout-color0);
}

.jp-RenderedHTMLCommon tbody tr:nth-child(even) {
  background: var(--jp-rendermime-table-row-background);
}

.jp-RenderedHTMLCommon tbody tr:hover {
  background: var(--jp-rendermime-table-row-hover-background);
}

.jp-RenderedHTMLCommon p {
  text-align: left;
  margin: 0;
  margin-bottom: 1em;
}

.jp-RenderedHTMLCommon img {
  -moz-force-broken-image-icon: 1;
}

/* Restrict to direct children as other images could be nested in other content. */
.jp-RenderedHTMLCommon > img {
  display: block;
  margin-left: 0;
  margin-right: 0;
  margin-bottom: 1em;
}

/* Change color behind transparent images if they need it... */
[data-jp-theme-light='false'] .jp-RenderedImage img.jp-needs-light-background {
  background-color: var(--jp-inverse-layout-color1);
}

[data-jp-theme-light='true'] .jp-RenderedImage img.jp-needs-dark-background {
  background-color: var(--jp-inverse-layout-color1);
}

.jp-RenderedHTMLCommon img,
.jp-RenderedImage img,
.jp-RenderedHTMLCommon svg,
.jp-RenderedSVG svg {
  max-width: 100%;
  height: auto;
}

.jp-RenderedHTMLCommon img.jp-mod-unconfined,
.jp-RenderedImage img.jp-mod-unconfined,
.jp-RenderedHTMLCommon svg.jp-mod-unconfined,
.jp-RenderedSVG svg.jp-mod-unconfined {
  max-width: none;
}

.jp-RenderedHTMLCommon .alert {
  padding: var(--jp-notebook-padding);
  border: var(--jp-border-width) solid transparent;
  border-radius: var(--jp-border-radius);
  margin-bottom: 1em;
}

.jp-RenderedHTMLCommon .alert-info {
  color: var(--jp-info-color0);
  background-color: var(--jp-info-color3);
  border-color: var(--jp-info-color2);
}

.jp-RenderedHTMLCommon .alert-info hr {
  border-color: var(--jp-info-color3);
}

.jp-RenderedHTMLCommon .alert-info > p:last-child,
.jp-RenderedHTMLCommon .alert-info > ul:last-child {
  margin-bottom: 0;
}

.jp-RenderedHTMLCommon .alert-warning {
  color: var(--jp-warn-color0);
  background-color: var(--jp-warn-color3);
  border-color: var(--jp-warn-color2);
}

.jp-RenderedHTMLCommon .alert-warning hr {
  border-color: var(--jp-warn-color3);
}

.jp-RenderedHTMLCommon .alert-warning > p:last-child,
.jp-RenderedHTMLCommon .alert-warning > ul:last-child {
  margin-bottom: 0;
}

.jp-RenderedHTMLCommon .alert-success {
  color: var(--jp-success-color0);
  background-color: var(--jp-success-color3);
  border-color: var(--jp-success-color2);
}

.jp-RenderedHTMLCommon .alert-success hr {
  border-color: var(--jp-success-color3);
}

.jp-RenderedHTMLCommon .alert-success > p:last-child,
.jp-RenderedHTMLCommon .alert-success > ul:last-child {
  margin-bottom: 0;
}

.jp-RenderedHTMLCommon .alert-danger {
  color: var(--jp-error-color0);
  background-color: var(--jp-error-color3);
  border-color: var(--jp-error-color2);
}

.jp-RenderedHTMLCommon .alert-danger hr {
  border-color: var(--jp-error-color3);
}

.jp-RenderedHTMLCommon .alert-danger > p:last-child,
.jp-RenderedHTMLCommon .alert-danger > ul:last-child {
  margin-bottom: 0;
}

.jp-RenderedHTMLCommon blockquote {
  margin: 1em 2em;
  padding: 0 1em;
  border-left: 5px solid var(--jp-border-color2);
}

a.jp-InternalAnchorLink {
  visibility: hidden;
  margin-left: 8px;
  color: var(--md-blue-800);
}

h1:hover .jp-InternalAnchorLink,
h2:hover .jp-InternalAnchorLink,
h3:hover .jp-InternalAnchorLink,
h4:hover .jp-InternalAnchorLink,
h5:hover .jp-InternalAnchorLink,
h6:hover .jp-InternalAnchorLink {
  visibility: visible;
}

.jp-RenderedHTMLCommon kbd {
  background-color: var(--jp-rendermime-table-row-background);
  border: 1px solid var(--jp-border-color0);
  border-bottom-color: var(--jp-border-color2);
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.25);
  display: inline-block;
  font-size: var(--jp-ui-font-size0);
  line-height: 1em;
  padding: 0.2em 0.5em;
}

/* Most direct children of .jp-RenderedHTMLCommon have a margin-bottom of 1.0.
 * At the bottom of cells this is a bit too much as there is also spacing
 * between cells. Going all the way to 0 gets too tight between markdown and
 * code cells.
 */
.jp-RenderedHTMLCommon > *:last-child {
  margin-bottom: 0.5em;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-cursor-backdrop {
  position: fixed;
  width: 200px;
  height: 200px;
  margin-top: -100px;
  margin-left: -100px;
  will-change: transform;
  z-index: 100;
}

.lm-mod-drag-image {
  will-change: transform;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

.jp-lineFormSearch {
  padding: 4px 12px;
  background-color: var(--jp-layout-color2);
  box-shadow: var(--jp-toolbar-box-shadow);
  z-index: 2;
  font-size: var(--jp-ui-font-size1);
}

.jp-lineFormCaption {
  font-size: var(--jp-ui-font-size0);
  line-height: var(--jp-ui-font-size1);
  margin-top: 4px;
  color: var(--jp-ui-font-color0);
}

.jp-baseLineForm {
  border: none;
  border-radius: 0;
  position: absolute;
  background-size: 16px;
  background-repeat: no-repeat;
  background-position: center;
  outline: none;
}

.jp-lineFormButtonContainer {
  top: 4px;
  right: 8px;
  height: 24px;
  padding: 0 12px;
  width: 12px;
}

.jp-lineFormButtonIcon {
  top: 0;
  right: 0;
  background-color: var(--jp-brand-color1);
  height: 100%;
  width: 100%;
  box-sizing: border-box;
  padding: 4px 6px;
}

.jp-lineFormButton {
  top: 0;
  right: 0;
  background-color: transparent;
  height: 100%;
  width: 100%;
  box-sizing: border-box;
}

.jp-lineFormWrapper {
  overflow: hidden;
  padding: 0 8px;
  border: 1px solid var(--jp-border-color0);
  background-color: var(--jp-input-active-background);
  height: 22px;
}

.jp-lineFormWrapperFocusWithin {
  border: var(--jp-border-width) solid var(--md-blue-500);
  box-shadow: inset 0 0 4px var(--md-blue-300);
}

.jp-lineFormInput {
  background: transparent;
  width: 200px;
  height: 100%;
  border: none;
  outline: none;
  color: var(--jp-ui-font-color0);
  line-height: 28px;
}

/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2016, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-JSONEditor {
  display: flex;
  flex-direction: column;
  width: 100%;
}

.jp-JSONEditor-host {
  flex: 1 1 auto;
  border: var(--jp-border-width) solid var(--jp-input-border-color);
  border-radius: 0;
  background: var(--jp-layout-color0);
  min-height: 50px;
  padding: 1px;
}

.jp-JSONEditor.jp-mod-error .jp-JSONEditor-host {
  border-color: red;
  outline-color: red;
}

.jp-JSONEditor-header {
  display: flex;
  flex: 1 0 auto;
  padding: 0 0 0 12px;
}

.jp-JSONEditor-header label {
  flex: 0 0 auto;
}

.jp-JSONEditor-commitButton {
  height: 16px;
  width: 16px;
  background-size: 18px;
  background-repeat: no-repeat;
  background-position: center;
}

.jp-JSONEditor-host.jp-mod-focused {
  background-color: var(--jp-input-active-background);
  border: 1px solid var(--jp-input-active-border-color);
  box-shadow: var(--jp-input-box-shadow);
}

.jp-Editor.jp-mod-dropTarget {
  border: var(--jp-border-width) solid var(--jp-input-active-border-color);
  box-shadow: var(--jp-input-box-shadow);
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/
.jp-DocumentSearch-input {
  border: none;
  outline: none;
  color: var(--jp-ui-font-color0);
  font-size: var(--jp-ui-font-size1);
  background-color: var(--jp-layout-color0);
  font-family: var(--jp-ui-font-family);
  padding: 2px 1px;
  resize: none;
}

.jp-DocumentSearch-overlay {
  position: absolute;
  background-color: var(--jp-toolbar-background);
  border-bottom: var(--jp-border-width) solid var(--jp-toolbar-border-color);
  border-left: var(--jp-border-width) solid var(--jp-toolbar-border-color);
  top: 0;
  right: 0;
  z-index: 7;
  min-width: 405px;
  padding: 2px;
  font-size: var(--jp-ui-font-size1);

  --jp-private-document-search-button-height: 20px;
}

.jp-DocumentSearch-overlay button {
  background-color: var(--jp-toolbar-background);
  outline: 0;
}

.jp-DocumentSearch-overlay button:hover {
  background-color: var(--jp-layout-color2);
}

.jp-DocumentSearch-overlay button:active {
  background-color: var(--jp-layout-color3);
}

.jp-DocumentSearch-overlay-row {
  display: flex;
  align-items: center;
  margin-bottom: 2px;
}

.jp-DocumentSearch-button-content {
  display: inline-block;
  cursor: pointer;
  box-sizing: border-box;
  width: 100%;
  height: 100%;
}

.jp-DocumentSearch-button-content svg {
  width: 100%;
  height: 100%;
}

.jp-DocumentSearch-input-wrapper {
  border: var(--jp-border-width) solid var(--jp-border-color0);
  display: flex;
  background-color: var(--jp-layout-color0);
  margin: 2px;
}

.jp-DocumentSearch-input-wrapper:focus-within {
  border-color: var(--jp-cell-editor-active-border-color);
}

.jp-DocumentSearch-toggle-wrapper,
.jp-DocumentSearch-button-wrapper {
  all: initial;
  overflow: hidden;
  display: inline-block;
  border: none;
  box-sizing: border-box;
}

.jp-DocumentSearch-toggle-wrapper {
  width: 14px;
  height: 14px;
}

.jp-DocumentSearch-button-wrapper {
  width: var(--jp-private-document-search-button-height);
  height: var(--jp-private-document-search-button-height);
}

.jp-DocumentSearch-toggle-wrapper:focus,
.jp-DocumentSearch-button-wrapper:focus {
  outline: var(--jp-border-width) solid
    var(--jp-cell-editor-active-border-color);
  outline-offset: -1px;
}

.jp-DocumentSearch-toggle-wrapper,
.jp-DocumentSearch-button-wrapper,
.jp-DocumentSearch-button-content:focus {
  outline: none;
}

.jp-DocumentSearch-toggle-placeholder {
  width: 5px;
}

.jp-DocumentSearch-input-button::before {
  display: block;
  padding-top: 100%;
}

.jp-DocumentSearch-input-button-off {
  opacity: var(--jp-search-toggle-off-opacity);
}

.jp-DocumentSearch-input-button-off:hover {
  opacity: var(--jp-search-toggle-hover-opacity);
}

.jp-DocumentSearch-input-button-on {
  opacity: var(--jp-search-toggle-on-opacity);
}

.jp-DocumentSearch-index-counter {
  padding-left: 10px;
  padding-right: 10px;
  user-select: none;
  min-width: 35px;
  display: inline-block;
}

.jp-DocumentSearch-up-down-wrapper {
  display: inline-block;
  padding-right: 2px;
  margin-left: auto;
  white-space: nowrap;
}

.jp-DocumentSearch-spacer {
  margin-left: auto;
}

.jp-DocumentSearch-up-down-wrapper button {
  outline: 0;
  border: none;
  width: var(--jp-private-document-search-button-height);
  height: var(--jp-private-document-search-button-height);
  vertical-align: middle;
  margin: 1px 5px 2px;
}

.jp-DocumentSearch-up-down-button:hover {
  background-color: var(--jp-layout-color2);
}

.jp-DocumentSearch-up-down-button:active {
  background-color: var(--jp-layout-color3);
}

.jp-DocumentSearch-filter-button {
  border-radius: var(--jp-border-radius);
}

.jp-DocumentSearch-filter-button:hover {
  background-color: var(--jp-layout-color2);
}

.jp-DocumentSearch-filter-button-enabled {
  background-color: var(--jp-layout-color2);
}

.jp-DocumentSearch-filter-button-enabled:hover {
  background-color: var(--jp-layout-color3);
}

.jp-DocumentSearch-search-options {
  padding: 0 8px;
  margin-left: 3px;
  width: 100%;
  display: grid;
  justify-content: start;
  grid-template-columns: 1fr 1fr;
  align-items: center;
  justify-items: stretch;
}

.jp-DocumentSearch-search-filter-disabled {
  color: var(--jp-ui-font-color2);
}

.jp-DocumentSearch-search-filter {
  display: flex;
  align-items: center;
  user-select: none;
}

.jp-DocumentSearch-regex-error {
  color: var(--jp-error-color0);
}

.jp-DocumentSearch-replace-button-wrapper {
  overflow: hidden;
  display: inline-block;
  box-sizing: border-box;
  border: var(--jp-border-width) solid var(--jp-border-color0);
  margin: auto 2px;
  padding: 1px 4px;
  height: calc(var(--jp-private-document-search-button-height) + 2px);
}

.jp-DocumentSearch-replace-button-wrapper:focus {
  border: var(--jp-border-width) solid var(--jp-cell-editor-active-border-color);
}

.jp-DocumentSearch-replace-button {
  display: inline-block;
  text-align: center;
  cursor: pointer;
  box-sizing: border-box;
  color: var(--jp-ui-font-color1);

  /* height - 2 * (padding of wrapper) */
  line-height: calc(var(--jp-private-document-search-button-height) - 2px);
  width: 100%;
  height: 100%;
}

.jp-DocumentSearch-replace-button:focus {
  outline: none;
}

.jp-DocumentSearch-replace-wrapper-class {
  margin-left: 14px;
  display: flex;
}

.jp-DocumentSearch-replace-toggle {
  border: none;
  background-color: var(--jp-toolbar-background);
  border-radius: var(--jp-border-radius);
}

.jp-DocumentSearch-replace-toggle:hover {
  background-color: var(--jp-layout-color2);
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.cm-editor {
  line-height: var(--jp-code-line-height);
  font-size: var(--jp-code-font-size);
  font-family: var(--jp-code-font-family);
  border: 0;
  border-radius: 0;
  height: auto;

  /* Changed to auto to autogrow */
}

.cm-editor pre {
  padding: 0 var(--jp-code-padding);
}

.jp-CodeMirrorEditor[data-type='inline'] .cm-dialog {
  background-color: var(--jp-layout-color0);
  color: var(--jp-content-font-color1);
}

.jp-CodeMirrorEditor {
  cursor: text;
}

/* When zoomed out 67% and 33% on a screen of 1440 width x 900 height */
@media screen and (min-width: 2138px) and (max-width: 4319px) {
  .jp-CodeMirrorEditor[data-type='inline'] .cm-cursor {
    border-left: var(--jp-code-cursor-width1) solid
      var(--jp-editor-cursor-color);
  }
}

/* When zoomed out less than 33% */
@media screen and (min-width: 4320px) {
  .jp-CodeMirrorEditor[data-type='inline'] .cm-cursor {
    border-left: var(--jp-code-cursor-width2) solid
      var(--jp-editor-cursor-color);
  }
}

.cm-editor.jp-mod-readOnly .cm-cursor {
  display: none;
}

.jp-CollaboratorCursor {
  border-left: 5px solid transparent;
  border-right: 5px solid transparent;
  border-top: none;
  border-bottom: 3px solid;
  background-clip: content-box;
  margin-left: -5px;
  margin-right: -5px;
}

.cm-searching,
.cm-searching span {
  /* `.cm-searching span`: we need to override syntax highlighting */
  background-color: var(--jp-search-unselected-match-background-color);
  color: var(--jp-search-unselected-match-color);
}

.cm-searching::selection,
.cm-searching span::selection {
  background-color: var(--jp-search-unselected-match-background-color);
  color: var(--jp-search-unselected-match-color);
}

.jp-current-match > .cm-searching,
.jp-current-match > .cm-searching span,
.cm-searching > .jp-current-match,
.cm-searching > .jp-current-match span {
  background-color: var(--jp-search-selected-match-background-color);
  color: var(--jp-search-selected-match-color);
}

.jp-current-match > .cm-searching::selection,
.cm-searching > .jp-current-match::selection,
.jp-current-match > .cm-searching span::selection {
  background-color: var(--jp-search-selected-match-background-color);
  color: var(--jp-search-selected-match-color);
}

.cm-trailingspace {
  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAYAAAB4ka1VAAAAsElEQVQIHQGlAFr/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7+r3zKmT0/+pk9P/7+r3zAAAAAAAAAAABAAAAAAAAAAA6OPzM+/q9wAAAAAA6OPzMwAAAAAAAAAAAgAAAAAAAAAAGR8NiRQaCgAZIA0AGR8NiQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQyoYJ/SY80UAAAAASUVORK5CYII=);
  background-position: center left;
  background-repeat: repeat-x;
}

.jp-CollaboratorCursor-hover {
  position: absolute;
  z-index: 1;
  transform: translateX(-50%);
  color: white;
  border-radius: 3px;
  padding-left: 4px;
  padding-right: 4px;
  padding-top: 1px;
  padding-bottom: 1px;
  text-align: center;
  font-size: var(--jp-ui-font-size1);
  white-space: nowrap;
}

.jp-CodeMirror-ruler {
  border-left: 1px dashed var(--jp-border-color2);
}

/* Styles for shared cursors (remote cursor locations and selected ranges) */
.jp-CodeMirrorEditor .cm-ySelectionCaret {
  position: relative;
  border-left: 1px solid black;
  margin-left: -1px;
  margin-right: -1px;
  box-sizing: border-box;
}

.jp-CodeMirrorEditor .cm-ySelectionCaret > .cm-ySelectionInfo {
  white-space: nowrap;
  position: absolute;
  top: -1.15em;
  padding-bottom: 0.05em;
  left: -1px;
  font-size: 0.95em;
  font-family: var(--jp-ui-font-family);
  font-weight: bold;
  line-height: normal;
  user-select: none;
  color: white;
  padding-left: 2px;
  padding-right: 2px;
  z-index: 101;
  transition: opacity 0.3s ease-in-out;
}

.jp-CodeMirrorEditor .cm-ySelectionInfo {
  transition-delay: 0.7s;
  opacity: 0;
}

.jp-CodeMirrorEditor .cm-ySelectionCaret:hover > .cm-ySelectionInfo {
  opacity: 1;
  transition-delay: 0s;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-MimeDocument {
  outline: none;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Variables
|----------------------------------------------------------------------------*/

:root {
  --jp-private-filebrowser-button-height: 28px;
  --jp-private-filebrowser-button-width: 48px;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-FileBrowser .jp-SidePanel-content {
  display: flex;
  flex-direction: column;
}

.jp-FileBrowser-toolbar.jp-Toolbar {
  flex-wrap: wrap;
  row-gap: 12px;
  border-bottom: none;
  height: auto;
  margin: 8px 12px 0;
  box-shadow: none;
  padding: 0;
  justify-content: flex-start;
}

.jp-FileBrowser-Panel {
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
}

.jp-BreadCrumbs {
  flex: 0 0 auto;
  margin: 8px 12px;
}

.jp-BreadCrumbs-item {
  margin: 0 2px;
  padding: 0 2px;
  border-radius: var(--jp-border-radius);
  cursor: pointer;
}

.jp-BreadCrumbs-item:hover {
  background-color: var(--jp-layout-color2);
}

.jp-BreadCrumbs-item:first-child {
  margin-left: 0;
}

.jp-BreadCrumbs-item.jp-mod-dropTarget {
  background-color: var(--jp-brand-color2);
  opacity: 0.7;
}

/*-----------------------------------------------------------------------------
| Buttons
|----------------------------------------------------------------------------*/

.jp-FileBrowser-toolbar > .jp-Toolbar-item {
  flex: 0 0 auto;
  padding-left: 0;
  padding-right: 2px;
  align-items: center;
  height: unset;
}

.jp-FileBrowser-toolbar > .jp-Toolbar-item .jp-ToolbarButtonComponent {
  width: 40px;
}

/*-----------------------------------------------------------------------------
| Other styles
|----------------------------------------------------------------------------*/

.jp-FileDialog.jp-mod-conflict input {
  color: var(--jp-error-color1);
}

.jp-FileDialog .jp-new-name-title {
  margin-top: 12px;
}

.jp-LastModified-hidden {
  display: none;
}

.jp-FileSize-hidden {
  display: none;
}

.jp-FileBrowser .lm-AccordionPanel > h3:first-child {
  display: none;
}

/*-----------------------------------------------------------------------------
| DirListing
|----------------------------------------------------------------------------*/

.jp-DirListing {
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  outline: 0;
}

.jp-DirListing-header {
  flex: 0 0 auto;
  display: flex;
  flex-direction: row;
  align-items: center;
  overflow: hidden;
  border-top: var(--jp-border-width) solid var(--jp-border-color2);
  border-bottom: var(--jp-border-width) solid var(--jp-border-color1);
  box-shadow: var(--jp-toolbar-box-shadow);
  z-index: 2;
}

.jp-DirListing-headerItem {
  padding: 4px 12px 2px;
  font-weight: 500;
}

.jp-DirListing-headerItem:hover {
  background: var(--jp-layout-color2);
}

.jp-DirListing-headerItem.jp-id-name {
  flex: 1 0 84px;
}

.jp-DirListing-headerItem.jp-id-modified {
  flex: 0 0 112px;
  border-left: var(--jp-border-width) solid var(--jp-border-color2);
  text-align: right;
}

.jp-DirListing-headerItem.jp-id-filesize {
  flex: 0 0 75px;
  border-left: var(--jp-border-width) solid var(--jp-border-color2);
  text-align: right;
}

.jp-id-narrow {
  display: none;
  flex: 0 0 5px;
  padding: 4px;
  border-left: var(--jp-border-width) solid var(--jp-border-color2);
  text-align: right;
  color: var(--jp-border-color2);
}

.jp-DirListing-narrow .jp-id-narrow {
  display: block;
}

.jp-DirListing-narrow .jp-id-modified,
.jp-DirListing-narrow .jp-DirListing-itemModified {
  display: none;
}

.jp-DirListing-headerItem.jp-mod-selected {
  font-weight: 600;
}

/* increase specificity to override bundled default */
.jp-DirListing-content {
  flex: 1 1 auto;
  margin: 0;
  padding: 0;
  list-style-type: none;
  overflow: auto;
  background-color: var(--jp-layout-color1);
}

.jp-DirListing-content mark {
  color: var(--jp-ui-font-color0);
  background-color: transparent;
  font-weight: bold;
}

.jp-DirListing-content .jp-DirListing-item.jp-mod-selected mark {
  color: var(--jp-ui-inverse-font-color0);
}

/* Style the directory listing content when a user drops a file to upload */
.jp-DirListing.jp-mod-native-drop .jp-DirListing-content {
  outline: 5px dashed rgba(128, 128, 128, 0.5);
  outline-offset: -10px;
  cursor: copy;
}

.jp-DirListing-item {
  display: flex;
  flex-direction: row;
  align-items: center;
  padding: 4px 12px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.jp-DirListing-checkboxWrapper {
  /* Increases hit area of checkbox. */
  padding: 4px;
}

.jp-DirListing-header
  .jp-DirListing-checkboxWrapper
  + .jp-DirListing-headerItem {
  padding-left: 4px;
}

.jp-DirListing-content .jp-DirListing-checkboxWrapper {
  position: relative;
  left: -4px;
  margin: -4px 0 -4px -8px;
}

.jp-DirListing-checkboxWrapper.jp-mod-visible {
  visibility: visible;
}

/* For devices that support hovering, hide checkboxes until hovered, selected...
*/
@media (hover: hover) {
  .jp-DirListing-checkboxWrapper {
    visibility: hidden;
  }

  .jp-DirListing-item:hover .jp-DirListing-checkboxWrapper,
  .jp-DirListing-item.jp-mod-selected .jp-DirListing-checkboxWrapper {
    visibility: visible;
  }
}

.jp-DirListing-item[data-is-dot] {
  opacity: 75%;
}

.jp-DirListing-item.jp-mod-selected {
  color: var(--jp-ui-inverse-font-color1);
  background: var(--jp-brand-color1);
}

.jp-DirListing-item.jp-mod-dropTarget {
  background: var(--jp-brand-color3);
}

.jp-DirListing-item:hover:not(.jp-mod-selected) {
  background: var(--jp-layout-color2);
}

.jp-DirListing-itemIcon {
  flex: 0 0 20px;
  margin-right: 4px;
}

.jp-DirListing-itemText {
  flex: 1 0 64px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  user-select: none;
}

.jp-DirListing-itemText:focus {
  outline-width: 2px;
  outline-color: var(--jp-inverse-layout-color1);
  outline-style: solid;
  outline-offset: 1px;
}

.jp-DirListing-item.jp-mod-selected .jp-DirListing-itemText:focus {
  outline-color: var(--jp-layout-color1);
}

.jp-DirListing-itemModified {
  flex: 0 0 125px;
  text-align: right;
}

.jp-DirListing-itemFileSize {
  flex: 0 0 90px;
  text-align: right;
}

.jp-DirListing-editor {
  flex: 1 0 64px;
  outline: none;
  border: none;
  color: var(--jp-ui-font-color1);
  background-color: var(--jp-layout-color1);
}

.jp-DirListing-item.jp-mod-running .jp-DirListing-itemIcon::before {
  color: var(--jp-success-color1);
  content: '\25CF';
  font-size: 8px;
  position: absolute;
  left: -8px;
}

.jp-DirListing-item.jp-mod-running.jp-mod-selected
  .jp-DirListing-itemIcon::before {
  color: var(--jp-ui-inverse-font-color1);
}

.jp-DirListing-item.lm-mod-drag-image,
.jp-DirListing-item.jp-mod-selected.lm-mod-drag-image {
  font-size: var(--jp-ui-font-size1);
  padding-left: 4px;
  margin-left: 4px;
  width: 160px;
  background-color: var(--jp-ui-inverse-font-color2);
  box-shadow: var(--jp-elevation-z2);
  border-radius: 0;
  color: var(--jp-ui-font-color1);
  transform: translateX(-40%) translateY(-58%);
}

.jp-Document {
  min-width: 120px;
  min-height: 120px;
  outline: none;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Main OutputArea
| OutputArea has a list of Outputs
|----------------------------------------------------------------------------*/

.jp-OutputArea {
  overflow-y: auto;
}

.jp-OutputArea-child {
  display: table;
  table-layout: fixed;
  width: 100%;
  overflow: hidden;
}

.jp-OutputPrompt {
  width: var(--jp-cell-prompt-width);
  color: var(--jp-cell-outprompt-font-color);
  font-family: var(--jp-cell-prompt-font-family);
  padding: var(--jp-code-padding);
  letter-spacing: var(--jp-cell-prompt-letter-spacing);
  line-height: var(--jp-code-line-height);
  font-size: var(--jp-code-font-size);
  border: var(--jp-border-width) solid transparent;
  opacity: var(--jp-cell-prompt-opacity);

  /* Right align prompt text, don't wrap to handle large prompt numbers */
  text-align: right;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;

  /* Disable text selection */
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.jp-OutputArea-prompt {
  display: table-cell;
  vertical-align: top;
}

.jp-OutputArea-output {
  display: table-cell;
  width: 100%;
  height: auto;
  overflow: auto;
  user-select: text;
  -moz-user-select: text;
  -webkit-user-select: text;
  -ms-user-select: text;
}

.jp-OutputArea .jp-RenderedText {
  padding-left: 1ch;
}

/**
 * Prompt overlay.
 */

.jp-OutputArea-promptOverlay {
  position: absolute;
  top: 0;
  width: var(--jp-cell-prompt-width);
  height: 100%;
  opacity: 0.5;
}

.jp-OutputArea-promptOverlay:hover {
  background: var(--jp-layout-color2);
  box-shadow: inset 0 0 1px var(--jp-inverse-layout-color0);
  cursor: zoom-out;
}

.jp-mod-outputsScrolled .jp-OutputArea-promptOverlay:hover {
  cursor: zoom-in;
}

/**
 * Isolated output.
 */
.jp-OutputArea-output.jp-mod-isolated {
  width: 100%;
  display: block;
}

/*
When drag events occur, `lm-mod-override-cursor` is added to the body.
Because iframes steal all cursor events, the following two rules are necessary
to suppress pointer events while resize drags are occurring. There may be a
better solution to this problem.
*/
body.lm-mod-override-cursor .jp-OutputArea-output.jp-mod-isolated {
  position: relative;
}

body.lm-mod-override-cursor .jp-OutputArea-output.jp-mod-isolated::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: transparent;
}

/* pre */

.jp-OutputArea-output pre {
  border: none;
  margin: 0;
  padding: 0;
  overflow-x: auto;
  overflow-y: auto;
  word-break: break-all;
  word-wrap: break-word;
  white-space: pre-wrap;
}

/* tables */

.jp-OutputArea-output.jp-RenderedHTMLCommon table {
  margin-left: 0;
  margin-right: 0;
}

/* description lists */

.jp-OutputArea-output dl,
.jp-OutputArea-output dt,
.jp-OutputArea-output dd {
  display: block;
}

.jp-OutputArea-output dl {
  width: 100%;
  overflow: hidden;
  padding: 0;
  margin: 0;
}

.jp-OutputArea-output dt {
  font-weight: bold;
  float: left;
  width: 20%;
  padding: 0;
  margin: 0;
}

.jp-OutputArea-output dd {
  float: left;
  width: 80%;
  padding: 0;
  margin: 0;
}

.jp-TrimmedOutputs pre {
  background: var(--jp-layout-color3);
  font-size: calc(var(--jp-code-font-size) * 1.4);
  text-align: center;
  text-transform: uppercase;
}

/* Hide the gutter in case of
 *  - nested output areas (e.g. in the case of output widgets)
 *  - mirrored output areas
 */
.jp-OutputArea .jp-OutputArea .jp-OutputArea-prompt {
  display: none;
}

/* Hide empty lines in the output area, for instance due to cleared widgets */
.jp-OutputArea-prompt:empty {
  padding: 0;
  border: 0;
}

/*-----------------------------------------------------------------------------
| executeResult is added to any Output-result for the display of the object
| returned by a cell
|----------------------------------------------------------------------------*/

.jp-OutputArea-output.jp-OutputArea-executeResult {
  margin-left: 0;
  width: 100%;
}

/* Text output with the Out[] prompt needs a top padding to match the
 * alignment of the Out[] prompt itself.
 */
.jp-OutputArea-executeResult .jp-RenderedText.jp-OutputArea-output {
  padding-top: var(--jp-code-padding);
  border-top: var(--jp-border-width) solid transparent;
}

/*-----------------------------------------------------------------------------
| The Stdin output
|----------------------------------------------------------------------------*/

.jp-Stdin-prompt {
  color: var(--jp-content-font-color0);
  padding-right: var(--jp-code-padding);
  vertical-align: baseline;
  flex: 0 0 auto;
}

.jp-Stdin-input {
  font-family: var(--jp-code-font-family);
  font-size: inherit;
  color: inherit;
  background-color: inherit;
  width: 42%;
  min-width: 200px;

  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;

  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0 0.25em;
  margin: 0 0.25em;
  flex: 0 0 70%;
}

.jp-Stdin-input::placeholder {
  opacity: 0;
}

.jp-Stdin-input:focus {
  box-shadow: none;
}

.jp-Stdin-input:focus::placeholder {
  opacity: 1;
}

/*-----------------------------------------------------------------------------
| Output Area View
|----------------------------------------------------------------------------*/

.jp-LinkedOutputView .jp-OutputArea {
  height: 100%;
  display: block;
}

.jp-LinkedOutputView .jp-OutputArea-output:only-child {
  height: 100%;
}

/*-----------------------------------------------------------------------------
| Printing
|----------------------------------------------------------------------------*/

@media print {
  .jp-OutputArea-child {
    break-inside: avoid-page;
  }
}

/*-----------------------------------------------------------------------------
| Mobile
|----------------------------------------------------------------------------*/
@media only screen and (max-width: 760px) {
  .jp-OutputPrompt {
    display: table-row;
    text-align: left;
  }

  .jp-OutputArea-child .jp-OutputArea-output {
    display: table-row;
    margin-left: var(--jp-notebook-padding);
  }
}

/* Trimmed outputs warning */
.jp-TrimmedOutputs > a {
  margin: 10px;
  text-decoration: none;
  cursor: pointer;
}

.jp-TrimmedOutputs > a:hover {
  text-decoration: none;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Table of Contents
|----------------------------------------------------------------------------*/

:root {
  --jp-private-toc-active-width: 4px;
}

.jp-TableOfContents {
  display: flex;
  flex-direction: column;
  background: var(--jp-layout-color1);
  color: var(--jp-ui-font-color1);
  font-size: var(--jp-ui-font-size1);
  height: 100%;
}

.jp-TableOfContents-placeholder {
  text-align: center;
}

.jp-TableOfContents-placeholderContent {
  color: var(--jp-content-font-color2);
  padding: 8px;
}

.jp-TableOfContents-placeholderContent > h3 {
  margin-bottom: var(--jp-content-heading-margin-bottom);
}

.jp-TableOfContents .jp-SidePanel-content {
  overflow-y: auto;
}

.jp-TableOfContents-tree {
  margin: 4px;
}

.jp-TableOfContents ol {
  list-style-type: none;
}

/* stylelint-disable-next-line selector-max-type */
.jp-TableOfContents li > ol {
  /* Align left border with triangle icon center */
  padding-left: 11px;
}

.jp-TableOfContents-content {
  /* left margin for the active heading indicator */
  margin: 0 0 0 var(--jp-private-toc-active-width);
  padding: 0;
  background-color: var(--jp-layout-color1);
}

.jp-tocItem {
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.jp-tocItem-heading {
  display: flex;
  cursor: pointer;
}

.jp-tocItem-heading:hover {
  background-color: var(--jp-layout-color2);
}

.jp-tocItem-content {
  display: block;
  padding: 4px 0;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow-x: hidden;
}

.jp-tocItem-collapser {
  height: 20px;
  margin: 2px 2px 0;
  padding: 0;
  background: none;
  border: none;
  cursor: pointer;
}

.jp-tocItem-collapser:hover {
  background-color: var(--jp-layout-color3);
}

/* Active heading indicator */

.jp-tocItem-heading::before {
  content: ' ';
  background: transparent;
  width: var(--jp-private-toc-active-width);
  height: 24px;
  position: absolute;
  left: 0;
  border-radius: var(--jp-border-radius);
}

.jp-tocItem-heading.jp-tocItem-active::before {
  background-color: var(--jp-brand-color1);
}

.jp-tocItem-heading:hover.jp-tocItem-active::before {
  background: var(--jp-brand-color0);
  opacity: 1;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-Collapser {
  flex: 0 0 var(--jp-cell-collapser-width);
  padding: 0;
  margin: 0;
  border: none;
  outline: none;
  background: transparent;
  border-radius: var(--jp-border-radius);
  opacity: 1;
}

.jp-Collapser-child {
  display: block;
  width: 100%;
  box-sizing: border-box;

  /* height: 100% doesn't work because the height of its parent is computed from content */
  position: absolute;
  top: 0;
  bottom: 0;
}

/*-----------------------------------------------------------------------------
| Printing
|----------------------------------------------------------------------------*/

/*
Hiding collapsers in print mode.

Note: input and output wrappers have "display: block" propery in print mode.
*/

@media print {
  .jp-Collapser {
    display: none;
  }
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Header/Footer
|----------------------------------------------------------------------------*/

/* Hidden by zero height by default */
.jp-CellHeader,
.jp-CellFooter {
  height: 0;
  width: 100%;
  padding: 0;
  margin: 0;
  border: none;
  outline: none;
  background: transparent;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Input
|----------------------------------------------------------------------------*/

/* All input areas */
.jp-InputArea {
  display: table;
  table-layout: fixed;
  width: 100%;
  overflow: hidden;
}

.jp-InputArea-editor {
  display: table-cell;
  overflow: hidden;
  vertical-align: top;

  /* This is the non-active, default styling */
  border: var(--jp-border-width) solid var(--jp-cell-editor-border-color);
  border-radius: 0;
  background: var(--jp-cell-editor-background);
}

.jp-InputPrompt {
  display: table-cell;
  vertical-align: top;
  width: var(--jp-cell-prompt-width);
  color: var(--jp-cell-inprompt-font-color);
  font-family: var(--jp-cell-prompt-font-family);
  padding: var(--jp-code-padding);
  letter-spacing: var(--jp-cell-prompt-letter-spacing);
  opacity: var(--jp-cell-prompt-opacity);
  line-height: var(--jp-code-line-height);
  font-size: var(--jp-code-font-size);
  border: var(--jp-border-width) solid transparent;

  /* Right align prompt text, don't wrap to handle large prompt numbers */
  text-align: right;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;

  /* Disable text selection */
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

/*-----------------------------------------------------------------------------
| Mobile
|----------------------------------------------------------------------------*/
@media only screen and (max-width: 760px) {
  .jp-InputArea-editor {
    display: table-row;
    margin-left: var(--jp-notebook-padding);
  }

  .jp-InputPrompt {
    display: table-row;
    text-align: left;
  }
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Placeholder
|----------------------------------------------------------------------------*/

.jp-Placeholder {
  display: table;
  table-layout: fixed;
  width: 100%;
}

.jp-Placeholder-prompt {
  display: table-cell;
  box-sizing: border-box;
}

.jp-Placeholder-content {
  display: table-cell;
  padding: 4px 6px;
  border: 1px solid transparent;
  border-radius: 0;
  background: none;
  box-sizing: border-box;
  cursor: pointer;
}

.jp-Placeholder-contentContainer {
  display: flex;
}

.jp-Placeholder-content:hover,
.jp-InputPlaceholder > .jp-Placeholder-content:hover {
  border-color: var(--jp-layout-color3);
}

.jp-Placeholder-content .jp-MoreHorizIcon {
  width: 32px;
  height: 16px;
  border: 1px solid transparent;
  border-radius: var(--jp-border-radius);
}

.jp-Placeholder-content .jp-MoreHorizIcon:hover {
  border: 1px solid var(--jp-border-color1);
  box-shadow: 0 0 2px 0 rgba(0, 0, 0, 0.25);
  background-color: var(--jp-layout-color0);
}

.jp-PlaceholderText {
  white-space: nowrap;
  overflow-x: hidden;
  color: var(--jp-inverse-layout-color3);
  font-family: var(--jp-code-font-family);
}

.jp-InputPlaceholder > .jp-Placeholder-content {
  border-color: var(--jp-cell-editor-border-color);
  background: var(--jp-cell-editor-background);
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Private CSS variables
|----------------------------------------------------------------------------*/

:root {
  --jp-private-cell-scrolling-output-offset: 5px;
}

/*-----------------------------------------------------------------------------
| Cell
|----------------------------------------------------------------------------*/

.jp-Cell {
  padding: var(--jp-cell-padding);
  margin: 0;
  border: none;
  outline: none;
  background: transparent;
}

/*-----------------------------------------------------------------------------
| Common input/output
|----------------------------------------------------------------------------*/

.jp-Cell-inputWrapper,
.jp-Cell-outputWrapper {
  display: flex;
  flex-direction: row;
  padding: 0;
  margin: 0;

  /* Added to reveal the box-shadow on the input and output collapsers. */
  overflow: visible;
}

/* Only input/output areas inside cells */
.jp-Cell-inputArea,
.jp-Cell-outputArea {
  flex: 1 1 auto;
}

/*-----------------------------------------------------------------------------
| Collapser
|----------------------------------------------------------------------------*/

/* Make the output collapser disappear when there is not output, but do so
 * in a manner that leaves it in the layout and preserves its width.
 */
.jp-Cell.jp-mod-noOutputs .jp-Cell-outputCollapser {
  border: none !important;
  background: transparent !important;
}

.jp-Cell:not(.jp-mod-noOutputs) .jp-Cell-outputCollapser {
  min-height: var(--jp-cell-collapser-min-height);
}

/*-----------------------------------------------------------------------------
| Output
|----------------------------------------------------------------------------*/

/* Put a space between input and output when there IS output */
.jp-Cell:not(.jp-mod-noOutputs) .jp-Cell-outputWrapper {
  margin-top: 5px;
}

.jp-CodeCell.jp-mod-outputsScrolled .jp-Cell-outputArea {
  overflow-y: auto;
  max-height: 24em;
  margin-left: var(--jp-private-cell-scrolling-output-offset);
  resize: vertical;
}

.jp-CodeCell.jp-mod-outputsScrolled .jp-Cell-outputArea[style*='height'] {
  max-height: unset;
}

.jp-CodeCell.jp-mod-outputsScrolled .jp-Cell-outputArea::after {
  content: ' ';
  box-shadow: inset 0 0 6px 2px rgb(0 0 0 / 30%);
  width: 100%;
  height: 100%;
  position: sticky;
  bottom: 0;
  top: 0;
  margin-top: -50%;
  float: left;
  display: block;
  pointer-events: none;
}

.jp-CodeCell.jp-mod-outputsScrolled .jp-OutputArea-child {
  padding-top: 6px;
}

.jp-CodeCell.jp-mod-outputsScrolled .jp-OutputArea-prompt {
  width: calc(
    var(--jp-cell-prompt-width) - var(--jp-private-cell-scrolling-output-offset)
  );
}

.jp-CodeCell.jp-mod-outputsScrolled .jp-OutputArea-promptOverlay {
  left: calc(-1 * var(--jp-private-cell-scrolling-output-offset));
}

/*-----------------------------------------------------------------------------
| CodeCell
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| MarkdownCell
|----------------------------------------------------------------------------*/

.jp-MarkdownOutput {
  display: table-cell;
  width: 100%;
  margin-top: 0;
  margin-bottom: 0;
  padding-left: var(--jp-code-padding);
}

.jp-MarkdownOutput.jp-RenderedHTMLCommon {
  overflow: auto;
}

/* collapseHeadingButton (show always if hiddenCellsButton is _not_ shown) */
.jp-collapseHeadingButton {
  display: flex;
  min-height: var(--jp-cell-collapser-min-height);
  font-size: var(--jp-code-font-size);
  position: absolute;
  background-color: transparent;
  background-size: 25px;
  background-repeat: no-repeat;
  background-position-x: center;
  background-position-y: top;
  background-image: var(--jp-icon-caret-down);
  right: 0;
  top: 0;
  bottom: 0;
}

.jp-collapseHeadingButton.jp-mod-collapsed {
  background-image: var(--jp-icon-caret-right);
}

/*
 set the container font size to match that of content
 so that the nested collapse buttons have the right size
*/
.jp-MarkdownCell .jp-InputPrompt {
  font-size: var(--jp-content-font-size1);
}

/*
  Align collapseHeadingButton with cell top header
  The font sizes are identical to the ones in packages/rendermime/style/base.css
*/
.jp-mod-rendered .jp-collapseHeadingButton[data-heading-level='1'] {
  font-size: var(--jp-content-font-size5);
  background-position-y: calc(0.3 * var(--jp-content-font-size5));
}

.jp-mod-rendered .jp-collapseHeadingButton[data-heading-level='2'] {
  font-size: var(--jp-content-font-size4);
  background-position-y: calc(0.3 * var(--jp-content-font-size4));
}

.jp-mod-rendered .jp-collapseHeadingButton[data-heading-level='3'] {
  font-size: var(--jp-content-font-size3);
  background-position-y: calc(0.3 * var(--jp-content-font-size3));
}

.jp-mod-rendered .jp-collapseHeadingButton[data-heading-level='4'] {
  font-size: var(--jp-content-font-size2);
  background-position-y: calc(0.3 * var(--jp-content-font-size2));
}

.jp-mod-rendered .jp-collapseHeadingButton[data-heading-level='5'] {
  font-size: var(--jp-content-font-size1);
  background-position-y: top;
}

.jp-mod-rendered .jp-collapseHeadingButton[data-heading-level='6'] {
  font-size: var(--jp-content-font-size0);
  background-position-y: top;
}

/* collapseHeadingButton (show only on (hover,active) if hiddenCellsButton is shown) */
.jp-Notebook.jp-mod-showHiddenCellsButton .jp-collapseHeadingButton {
  display: none;
}

.jp-Notebook.jp-mod-showHiddenCellsButton
  :is(.jp-MarkdownCell:hover, .jp-mod-active)
  .jp-collapseHeadingButton {
  display: flex;
}

/* showHiddenCellsButton (only show if jp-mod-showHiddenCellsButton is set, which
is a consequence of the showHiddenCellsButton option in Notebook Settings)*/
.jp-Notebook.jp-mod-showHiddenCellsButton .jp-showHiddenCellsButton {
  margin-left: calc(var(--jp-cell-prompt-width) + 2 * var(--jp-code-padding));
  margin-top: var(--jp-code-padding);
  border: 1px solid var(--jp-border-color2);
  background-color: var(--jp-border-color3) !important;
  color: var(--jp-content-font-color0) !important;
  display: flex;
}

.jp-Notebook.jp-mod-showHiddenCellsButton .jp-showHiddenCellsButton:hover {
  background-color: var(--jp-border-color2) !important;
}

.jp-showHiddenCellsButton {
  display: none;
}

/*-----------------------------------------------------------------------------
| Printing
|----------------------------------------------------------------------------*/

/*
Using block instead of flex to allow the use of the break-inside CSS property for
cell outputs.
*/

@media print {
  .jp-Cell-inputWrapper,
  .jp-Cell-outputWrapper {
    display: block;
  }
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Variables
|----------------------------------------------------------------------------*/

:root {
  --jp-notebook-toolbar-padding: 2px 5px 2px 2px;
}

/*-----------------------------------------------------------------------------

/*-----------------------------------------------------------------------------
| Styles
|----------------------------------------------------------------------------*/

.jp-NotebookPanel-toolbar {
  padding: var(--jp-notebook-toolbar-padding);

  /* disable paint containment from lumino 2.0 default strict CSS containment */
  contain: style size !important;
}

.jp-Toolbar-item.jp-Notebook-toolbarCellType .jp-select-wrapper.jp-mod-focused {
  border: none;
  box-shadow: none;
}

.jp-Notebook-toolbarCellTypeDropdown select {
  height: 24px;
  font-size: var(--jp-ui-font-size1);
  line-height: 14px;
  border-radius: 0;
  display: block;
}

.jp-Notebook-toolbarCellTypeDropdown span {
  top: 5px !important;
}

.jp-Toolbar-responsive-popup {
  position: absolute;
  height: fit-content;
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  justify-content: flex-end;
  border-bottom: var(--jp-border-width) solid var(--jp-toolbar-border-color);
  box-shadow: var(--jp-toolbar-box-shadow);
  background: var(--jp-toolbar-background);
  min-height: var(--jp-toolbar-micro-height);
  padding: var(--jp-notebook-toolbar-padding);
  z-index: 1;
  right: 0;
  top: 0;
}

.jp-Toolbar > .jp-Toolbar-responsive-opener {
  margin-left: auto;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Variables
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------

/*-----------------------------------------------------------------------------
| Styles
|----------------------------------------------------------------------------*/

.jp-Notebook-ExecutionIndicator {
  position: relative;
  display: inline-block;
  height: 100%;
  z-index: 9997;
}

.jp-Notebook-ExecutionIndicator-tooltip {
  visibility: hidden;
  height: auto;
  width: max-content;
  width: -moz-max-content;
  background-color: var(--jp-layout-color2);
  color: var(--jp-ui-font-color1);
  text-align: justify;
  border-radius: 6px;
  padding: 0 5px;
  position: fixed;
  display: table;
}

.jp-Notebook-ExecutionIndicator-tooltip.up {
  transform: translateX(-50%) translateY(-100%) translateY(-32px);
}

.jp-Notebook-ExecutionIndicator-tooltip.down {
  transform: translateX(calc(-100% + 16px)) translateY(5px);
}

.jp-Notebook-ExecutionIndicator-tooltip.hidden {
  display: none;
}

.jp-Notebook-ExecutionIndicator:hover .jp-Notebook-ExecutionIndicator-tooltip {
  visibility: visible;
}

.jp-Notebook-ExecutionIndicator span {
  font-size: var(--jp-ui-font-size1);
  font-family: var(--jp-ui-font-family);
  color: var(--jp-ui-font-color1);
  line-height: 24px;
  display: block;
}

.jp-Notebook-ExecutionIndicator-progress-bar {
  display: flex;
  justify-content: center;
  height: 100%;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*
 * Execution indicator
 */
.jp-tocItem-content::after {
  content: '';

  /* Must be identical to form a circle */
  width: 12px;
  height: 12px;
  background: none;
  border: none;
  position: absolute;
  right: 0;
}

.jp-tocItem-content[data-running='0']::after {
  border-radius: 50%;
  border: var(--jp-border-width) solid var(--jp-inverse-layout-color3);
  background: none;
}

.jp-tocItem-content[data-running='1']::after {
  border-radius: 50%;
  border: var(--jp-border-width) solid var(--jp-inverse-layout-color3);
  background-color: var(--jp-inverse-layout-color3);
}

.jp-tocItem-content[data-running='0'],
.jp-tocItem-content[data-running='1'] {
  margin-right: 12px;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

.jp-Notebook-footer {
  height: 27px;
  margin-left: calc(
    var(--jp-cell-prompt-width) + var(--jp-cell-collapser-width) +
      var(--jp-cell-padding)
  );
  width: calc(
    100% -
      (
        var(--jp-cell-prompt-width) + var(--jp-cell-collapser-width) +
          var(--jp-cell-padding) + var(--jp-cell-padding)
      )
  );
  border: var(--jp-border-width) solid var(--jp-cell-editor-border-color);
  color: var(--jp-ui-font-color3);
  margin-top: 6px;
  background: none;
  cursor: pointer;
}

.jp-Notebook-footer:focus {
  border-color: var(--jp-cell-editor-active-border-color);
}

/* For devices that support hovering, hide footer until hover */
@media (hover: hover) {
  .jp-Notebook-footer {
    opacity: 0;
  }

  .jp-Notebook-footer:focus,
  .jp-Notebook-footer:hover {
    opacity: 1;
  }
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Imports
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| CSS variables
|----------------------------------------------------------------------------*/

:root {
  --jp-side-by-side-output-size: 1fr;
  --jp-side-by-side-resized-cell: var(--jp-side-by-side-output-size);
  --jp-private-notebook-dragImage-width: 304px;
  --jp-private-notebook-dragImage-height: 36px;
  --jp-private-notebook-selected-color: var(--md-blue-400);
  --jp-private-notebook-active-color: var(--md-green-400);
}

/*-----------------------------------------------------------------------------
| Notebook
|----------------------------------------------------------------------------*/

/* stylelint-disable selector-max-class */

.jp-NotebookPanel {
  display: block;
  height: 100%;
}

.jp-NotebookPanel.jp-Document {
  min-width: 240px;
  min-height: 120px;
}

.jp-Notebook {
  padding: var(--jp-notebook-padding);
  outline: none;
  overflow: auto;
  background: var(--jp-layout-color0);
}

.jp-Notebook.jp-mod-scrollPastEnd::after {
  display: block;
  content: '';
  min-height: var(--jp-notebook-scroll-padding);
}

.jp-MainAreaWidget-ContainStrict .jp-Notebook * {
  contain: strict;
}

.jp-Notebook .jp-Cell {
  overflow: visible;
}

.jp-Notebook .jp-Cell .jp-InputPrompt {
  cursor: move;
}

/*-----------------------------------------------------------------------------
| Notebook state related styling
|
| The notebook and cells each have states, here are the possibilities:
|
| - Notebook
|   - Command
|   - Edit
| - Cell
|   - None
|   - Active (only one can be active)
|   - Selected (the cells actions are applied to)
|   - Multiselected (when multiple selected, the cursor)
|   - No outputs
|----------------------------------------------------------------------------*/

/* Command or edit modes */

.jp-Notebook .jp-Cell:not(.jp-mod-active) .jp-InputPrompt {
  opacity: var(--jp-cell-prompt-not-active-opacity);
  color: var(--jp-cell-prompt-not-active-font-color);
}

.jp-Notebook .jp-Cell:not(.jp-mod-active) .jp-OutputPrompt {
  opacity: var(--jp-cell-prompt-not-active-opacity);
  color: var(--jp-cell-prompt-not-active-font-color);
}

/* cell is active */
.jp-Notebook .jp-Cell.jp-mod-active .jp-Collapser {
  background: var(--jp-brand-color1);
}

/* cell is dirty */
.jp-Notebook .jp-Cell.jp-mod-dirty .jp-InputPrompt {
  color: var(--jp-warn-color1);
}

.jp-Notebook .jp-Cell.jp-mod-dirty .jp-InputPrompt::before {
  color: var(--jp-warn-color1);
  content: '';
}

.jp-Notebook .jp-Cell.jp-mod-active.jp-mod-dirty .jp-Collapser {
  background: var(--jp-warn-color1);
}

/* collapser is hovered */
.jp-Notebook .jp-Cell .jp-Collapser:hover {
  box-shadow: var(--jp-elevation-z2);
  background: var(--jp-brand-color1);
  opacity: var(--jp-cell-collapser-not-active-hover-opacity);
}

/* cell is active and collapser is hovered */
.jp-Notebook .jp-Cell.jp-mod-active .jp-Collapser:hover {
  background: var(--jp-brand-color0);
  opacity: 1;
}

/* Command mode */

.jp-Notebook.jp-mod-commandMode .jp-Cell.jp-mod-selected {
  background: var(--jp-notebook-multiselected-color);
}

.jp-Notebook.jp-mod-commandMode
  .jp-Cell.jp-mod-active.jp-mod-selected:not(.jp-mod-multiSelected) {
  background: transparent;
}

/* Edit mode */

.jp-Notebook.jp-mod-editMode .jp-Cell.jp-mod-active .jp-InputArea-editor {
  border: var(--jp-border-width) solid var(--jp-cell-editor-active-border-color);
  box-shadow: var(--jp-input-box-shadow);
  background-color: var(--jp-cell-editor-active-background);
}

/*-----------------------------------------------------------------------------
| Notebook drag and drop
|----------------------------------------------------------------------------*/

.jp-Notebook-cell.jp-mod-dropSource {
  opacity: 0.5;
}

.jp-Notebook-cell.jp-mod-dropTarget,
.jp-Notebook.jp-mod-commandMode
  .jp-Notebook-cell.jp-mod-active.jp-mod-selected.jp-mod-dropTarget {
  border-top-color: var(--jp-private-notebook-selected-color);
  border-top-style: solid;
  border-top-width: 2px;
}

.jp-dragImage {
  display: block;
  flex-direction: row;
  width: var(--jp-private-notebook-dragImage-width);
  height: var(--jp-private-notebook-dragImage-height);
  border: var(--jp-border-width) solid var(--jp-cell-editor-border-color);
  background: var(--jp-cell-editor-background);
  overflow: visible;
}

.jp-dragImage-singlePrompt {
  box-shadow: 2px 2px 4px 0 rgba(0, 0, 0, 0.12);
}

.jp-dragImage .jp-dragImage-content {
  flex: 1 1 auto;
  z-index: 2;
  font-size: var(--jp-code-font-size);
  font-family: var(--jp-code-font-family);
  line-height: var(--jp-code-line-height);
  padding: var(--jp-code-padding);
  border: var(--jp-border-width) solid var(--jp-cell-editor-border-color);
  background: var(--jp-cell-editor-background-color);
  color: var(--jp-content-font-color3);
  text-align: left;
  margin: 4px 4px 4px 0;
}

.jp-dragImage .jp-dragImage-prompt {
  flex: 0 0 auto;
  min-width: 36px;
  color: var(--jp-cell-inprompt-font-color);
  padding: var(--jp-code-padding);
  padding-left: 12px;
  font-family: var(--jp-cell-prompt-font-family);
  letter-spacing: var(--jp-cell-prompt-letter-spacing);
  line-height: 1.9;
  font-size: var(--jp-code-font-size);
  border: var(--jp-border-width) solid transparent;
}

.jp-dragImage-multipleBack {
  z-index: -1;
  position: absolute;
  height: 32px;
  width: 300px;
  top: 8px;
  left: 8px;
  background: var(--jp-layout-color2);
  border: var(--jp-border-width) solid var(--jp-input-border-color);
  box-shadow: 2px 2px 4px 0 rgba(0, 0, 0, 0.12);
}

/*-----------------------------------------------------------------------------
| Cell toolbar
|----------------------------------------------------------------------------*/

.jp-NotebookTools {
  display: block;
  min-width: var(--jp-sidebar-min-width);
  color: var(--jp-ui-font-color1);
  background: var(--jp-layout-color1);

  /* This is needed so that all font sizing of children done in ems is
    * relative to this base size */
  font-size: var(--jp-ui-font-size1);
  overflow: auto;
}

.jp-ActiveCellTool {
  padding: 12px 0;
  display: flex;
}

.jp-ActiveCellTool-Content {
  flex: 1 1 auto;
}

.jp-ActiveCellTool .jp-ActiveCellTool-CellContent {
  background: var(--jp-cell-editor-background);
  border: var(--jp-border-width) solid var(--jp-cell-editor-border-color);
  border-radius: 0;
  min-height: 29px;
}

.jp-ActiveCellTool .jp-InputPrompt {
  min-width: calc(var(--jp-cell-prompt-width) * 0.75);
}

.jp-ActiveCellTool-CellContent > pre {
  padding: 5px 4px;
  margin: 0;
  white-space: normal;
}

.jp-MetadataEditorTool {
  flex-direction: column;
  padding: 12px 0;
}

.jp-RankedPanel > :not(:first-child) {
  margin-top: 12px;
}

.jp-KeySelector select.jp-mod-styled {
  font-size: var(--jp-ui-font-size1);
  color: var(--jp-ui-font-color0);
  border: var(--jp-border-width) solid var(--jp-border-color1);
}

.jp-KeySelector label,
.jp-MetadataEditorTool label,
.jp-NumberSetter label {
  line-height: 1.4;
}

.jp-NotebookTools .jp-select-wrapper {
  margin-top: 4px;
  margin-bottom: 0;
}

.jp-NumberSetter input {
  width: 100%;
  margin-top: 4px;
}

.jp-NotebookTools .jp-Collapse {
  margin-top: 16px;
}

/*-----------------------------------------------------------------------------
| Presentation Mode (.jp-mod-presentationMode)
|----------------------------------------------------------------------------*/

.jp-mod-presentationMode .jp-Notebook {
  --jp-content-font-size1: var(--jp-content-presentation-font-size1);
  --jp-code-font-size: var(--jp-code-presentation-font-size);
}

.jp-mod-presentationMode .jp-Notebook .jp-Cell .jp-InputPrompt,
.jp-mod-presentationMode .jp-Notebook .jp-Cell .jp-OutputPrompt {
  flex: 0 0 110px;
}

/*-----------------------------------------------------------------------------
| Side-by-side Mode (.jp-mod-sideBySide)
|----------------------------------------------------------------------------*/
.jp-mod-sideBySide.jp-Notebook .jp-Notebook-cell {
  margin-top: 3em;
  margin-bottom: 3em;
  margin-left: 5%;
  margin-right: 5%;
}

.jp-mod-sideBySide.jp-Notebook .jp-CodeCell {
  display: grid;
  grid-template-columns: minmax(0, 1fr) min-content minmax(
      0,
      var(--jp-side-by-side-output-size)
    );
  grid-template-rows: auto minmax(0, 1fr) auto;
  grid-template-areas:
    'header header header'
    'input handle output'
    'footer footer footer';
}

.jp-mod-sideBySide.jp-Notebook .jp-CodeCell.jp-mod-resizedCell {
  grid-template-columns: minmax(0, 1fr) min-content minmax(
      0,
      var(--jp-side-by-side-resized-cell)
    );
}

.jp-mod-sideBySide.jp-Notebook .jp-CodeCell .jp-CellHeader {
  grid-area: header;
}

.jp-mod-sideBySide.jp-Notebook .jp-CodeCell .jp-Cell-inputWrapper {
  grid-area: input;
}

.jp-mod-sideBySide.jp-Notebook .jp-CodeCell .jp-Cell-outputWrapper {
  /* overwrite the default margin (no vertical separation needed in side by side move */
  margin-top: 0;
  grid-area: output;
}

.jp-mod-sideBySide.jp-Notebook .jp-CodeCell .jp-CellFooter {
  grid-area: footer;
}

.jp-mod-sideBySide.jp-Notebook .jp-CodeCell .jp-CellResizeHandle {
  grid-area: handle;
  user-select: none;
  display: block;
  height: 100%;
  cursor: ew-resize;
  padding: 0 var(--jp-cell-padding);
}

.jp-mod-sideBySide.jp-Notebook .jp-CodeCell .jp-CellResizeHandle::after {
  content: '';
  display: block;
  background: var(--jp-border-color2);
  height: 100%;
  width: 5px;
}

.jp-mod-sideBySide.jp-Notebook
  .jp-CodeCell.jp-mod-resizedCell
  .jp-CellResizeHandle::after {
  background: var(--jp-border-color0);
}

.jp-CellResizeHandle {
  display: none;
}

/*-----------------------------------------------------------------------------
| Placeholder
|----------------------------------------------------------------------------*/

.jp-Cell-Placeholder {
  padding-left: 55px;
}

.jp-Cell-Placeholder-wrapper {
  background: #fff;
  border: 1px solid;
  border-color: #e5e6e9 #dfe0e4 #d0d1d5;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  margin: 10px 15px;
}

.jp-Cell-Placeholder-wrapper-inner {
  padding: 15px;
  position: relative;
}

.jp-Cell-Placeholder-wrapper-body {
  background-repeat: repeat;
  background-size: 50% auto;
}

.jp-Cell-Placeholder-wrapper-body div {
  background: #f6f7f8;
  background-image: -webkit-linear-gradient(
    left,
    #f6f7f8 0%,
    #edeef1 20%,
    #f6f7f8 40%,
    #f6f7f8 100%
  );
  background-repeat: no-repeat;
  background-size: 800px 104px;
  height: 104px;
  position: absolute;
  right: 15px;
  left: 15px;
  top: 15px;
}

div.jp-Cell-Placeholder-h1 {
  top: 20px;
  height: 20px;
  left: 15px;
  width: 150px;
}

div.jp-Cell-Placeholder-h2 {
  left: 15px;
  top: 50px;
  height: 10px;
  width: 100px;
}

div.jp-Cell-Placeholder-content-1,
div.jp-Cell-Placeholder-content-2,
div.jp-Cell-Placeholder-content-3 {
  left: 15px;
  right: 15px;
  height: 10px;
}

div.jp-Cell-Placeholder-content-1 {
  top: 100px;
}

div.jp-Cell-Placeholder-content-2 {
  top: 120px;
}

div.jp-Cell-Placeholder-content-3 {
  top: 140px;
}

</style>
<style type="text/css">
/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*
The following CSS variables define the main, public API for styling JupyterLab.
These variables should be used by all plugins wherever possible. In other
words, plugins should not define custom colors, sizes, etc unless absolutely
necessary. This enables users to change the visual theme of JupyterLab
by changing these variables.

Many variables appear in an ordered sequence (0,1,2,3). These sequences
are designed to work well together, so for example, `--jp-border-color1` should
be used with `--jp-layout-color1`. The numbers have the following meanings:

* 0: super-primary, reserved for special emphasis
* 1: primary, most important under normal situations
* 2: secondary, next most important under normal situations
* 3: tertiary, next most important under normal situations

Throughout JupyterLab, we are mostly following principles from Google's
Material Design when selecting colors. We are not, however, following
all of MD as it is not optimized for dense, information rich UIs.
*/

:root {
  /* Elevation
   *
   * We style box-shadows using Material Design's idea of elevation. These particular numbers are taken from here:
   *
   * https://github.com/material-components/material-components-web
   * https://material-components-web.appspot.com/elevation.html
   */

  --jp-shadow-base-lightness: 0;
  --jp-shadow-umbra-color: rgba(
    var(--jp-shadow-base-lightness),
    var(--jp-shadow-base-lightness),
    var(--jp-shadow-base-lightness),
    0.2
  );
  --jp-shadow-penumbra-color: rgba(
    var(--jp-shadow-base-lightness),
    var(--jp-shadow-base-lightness),
    var(--jp-shadow-base-lightness),
    0.14
  );
  --jp-shadow-ambient-color: rgba(
    var(--jp-shadow-base-lightness),
    var(--jp-shadow-base-lightness),
    var(--jp-shadow-base-lightness),
    0.12
  );
  --jp-elevation-z0: none;
  --jp-elevation-z1: 0 2px 1px -1px var(--jp-shadow-umbra-color),
    0 1px 1px 0 var(--jp-shadow-penumbra-color),
    0 1px 3px 0 var(--jp-shadow-ambient-color);
  --jp-elevation-z2: 0 3px 1px -2px var(--jp-shadow-umbra-color),
    0 2px 2px 0 var(--jp-shadow-penumbra-color),
    0 1px 5px 0 var(--jp-shadow-ambient-color);
  --jp-elevation-z4: 0 2px 4px -1px var(--jp-shadow-umbra-color),
    0 4px 5px 0 var(--jp-shadow-penumbra-color),
    0 1px 10px 0 var(--jp-shadow-ambient-color);
  --jp-elevation-z6: 0 3px 5px -1px var(--jp-shadow-umbra-color),
    0 6px 10px 0 var(--jp-shadow-penumbra-color),
    0 1px 18px 0 var(--jp-shadow-ambient-color);
  --jp-elevation-z8: 0 5px 5px -3px var(--jp-shadow-umbra-color),
    0 8px 10px 1px var(--jp-shadow-penumbra-color),
    0 3px 14px 2px var(--jp-shadow-ambient-color);
  --jp-elevation-z12: 0 7px 8px -4px var(--jp-shadow-umbra-color),
    0 12px 17px 2px var(--jp-shadow-penumbra-color),
    0 5px 22px 4px var(--jp-shadow-ambient-color);
  --jp-elevation-z16: 0 8px 10px -5px var(--jp-shadow-umbra-color),
    0 16px 24px 2px var(--jp-shadow-penumbra-color),
    0 6px 30px 5px var(--jp-shadow-ambient-color);
  --jp-elevation-z20: 0 10px 13px -6px var(--jp-shadow-umbra-color),
    0 20px 31px 3px var(--jp-shadow-penumbra-color),
    0 8px 38px 7px var(--jp-shadow-ambient-color);
  --jp-elevation-z24: 0 11px 15px -7px var(--jp-shadow-umbra-color),
    0 24px 38px 3px var(--jp-shadow-penumbra-color),
    0 9px 46px 8px var(--jp-shadow-ambient-color);

  /* Borders
   *
   * The following variables, specify the visual styling of borders in JupyterLab.
   */

  --jp-border-width: 1px;
  --jp-border-color0: var(--md-grey-400);
  --jp-border-color1: var(--md-grey-400);
  --jp-border-color2: var(--md-grey-300);
  --jp-border-color3: var(--md-grey-200);
  --jp-inverse-border-color: var(--md-grey-600);
  --jp-border-radius: 2px;

  /* UI Fonts
   *
   * The UI font CSS variables are used for the typography all of the JupyterLab
   * user interface elements that are not directly user generated content.
   *
   * The font sizing here is done assuming that the body font size of --jp-ui-font-size1
   * is applied to a parent element. When children elements, such as headings, are sized
   * in em all things will be computed relative to that body size.
   */

  --jp-ui-font-scale-factor: 1.2;
  --jp-ui-font-size0: 0.83333em;
  --jp-ui-font-size1: 13px; /* Base font size */
  --jp-ui-font-size2: 1.2em;
  --jp-ui-font-size3: 1.44em;
  --jp-ui-font-family: system-ui, -apple-system, blinkmacsystemfont, 'Segoe UI',
    helvetica, arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji',
    'Segoe UI Symbol';

  /*
   * Use these font colors against the corresponding main layout colors.
   * In a light theme, these go from dark to light.
   */

  /* Defaults use Material Design specification */
  --jp-ui-font-color0: rgba(0, 0, 0, 1);
  --jp-ui-font-color1: rgba(0, 0, 0, 0.87);
  --jp-ui-font-color2: rgba(0, 0, 0, 0.54);
  --jp-ui-font-color3: rgba(0, 0, 0, 0.38);

  /*
   * Use these against the brand/accent/warn/error colors.
   * These will typically go from light to darker, in both a dark and light theme.
   */

  --jp-ui-inverse-font-color0: rgba(255, 255, 255, 1);
  --jp-ui-inverse-font-color1: rgba(255, 255, 255, 1);
  --jp-ui-inverse-font-color2: rgba(255, 255, 255, 0.7);
  --jp-ui-inverse-font-color3: rgba(255, 255, 255, 0.5);

  /* Content Fonts
   *
   * Content font variables are used for typography of user generated content.
   *
   * The font sizing here is done assuming that the body font size of --jp-content-font-size1
   * is applied to a parent element. When children elements, such as headings, are sized
   * in em all things will be computed relative to that body size.
   */

  --jp-content-line-height: 1.6;
  --jp-content-font-scale-factor: 1.2;
  --jp-content-font-size0: 0.83333em;
  --jp-content-font-size1: 14px; /* Base font size */
  --jp-content-font-size2: 1.2em;
  --jp-content-font-size3: 1.44em;
  --jp-content-font-size4: 1.728em;
  --jp-content-font-size5: 2.0736em;

  /* This gives a magnification of about 125% in presentation mode over normal. */
  --jp-content-presentation-font-size1: 17px;
  --jp-content-heading-line-height: 1;
  --jp-content-heading-margin-top: 1.2em;
  --jp-content-heading-margin-bottom: 0.8em;
  --jp-content-heading-font-weight: 500;

  /* Defaults use Material Design specification */
  --jp-content-font-color0: rgba(0, 0, 0, 1);
  --jp-content-font-color1: rgba(0, 0, 0, 0.87);
  --jp-content-font-color2: rgba(0, 0, 0, 0.54);
  --jp-content-font-color3: rgba(0, 0, 0, 0.38);
  --jp-content-link-color: var(--md-blue-900);
  --jp-content-font-family: system-ui, -apple-system, blinkmacsystemfont,
    'Segoe UI', helvetica, arial, sans-serif, 'Apple Color Emoji',
    'Segoe UI Emoji', 'Segoe UI Symbol';

  /*
   * Code Fonts
   *
   * Code font variables are used for typography of code and other monospaces content.
   */

  --jp-code-font-size: 13px;
  --jp-code-line-height: 1.3077; /* 17px for 13px base */
  --jp-code-padding: 5px; /* 5px for 13px base, codemirror highlighting needs integer px value */
  --jp-code-font-family-default: menlo, consolas, 'DejaVu Sans Mono', monospace;
  --jp-code-font-family: var(--jp-code-font-family-default);

  /* This gives a magnification of about 125% in presentation mode over normal. */
  --jp-code-presentation-font-size: 16px;

  /* may need to tweak cursor width if you change font size */
  --jp-code-cursor-width0: 1.4px;
  --jp-code-cursor-width1: 2px;
  --jp-code-cursor-width2: 4px;

  /* Layout
   *
   * The following are the main layout colors use in JupyterLab. In a light
   * theme these would go from light to dark.
   */

  --jp-layout-color0: white;
  --jp-layout-color1: white;
  --jp-layout-color2: var(--md-grey-200);
  --jp-layout-color3: var(--md-grey-400);
  --jp-layout-color4: var(--md-grey-600);

  /* Inverse Layout
   *
   * The following are the inverse layout colors use in JupyterLab. In a light
   * theme these would go from dark to light.
   */

  --jp-inverse-layout-color0: #111;
  --jp-inverse-layout-color1: var(--md-grey-900);
  --jp-inverse-layout-color2: var(--md-grey-800);
  --jp-inverse-layout-color3: var(--md-grey-700);
  --jp-inverse-layout-color4: var(--md-grey-600);

  /* Brand/accent */

  --jp-brand-color0: var(--md-blue-900);
  --jp-brand-color1: var(--md-blue-700);
  --jp-brand-color2: var(--md-blue-300);
  --jp-brand-color3: var(--md-blue-100);
  --jp-brand-color4: var(--md-blue-50);
  --jp-accent-color0: var(--md-green-900);
  --jp-accent-color1: var(--md-green-700);
  --jp-accent-color2: var(--md-green-300);
  --jp-accent-color3: var(--md-green-100);

  /* State colors (warn, error, success, info) */

  --jp-warn-color0: var(--md-orange-900);
  --jp-warn-color1: var(--md-orange-700);
  --jp-warn-color2: var(--md-orange-300);
  --jp-warn-color3: var(--md-orange-100);
  --jp-error-color0: var(--md-red-900);
  --jp-error-color1: var(--md-red-700);
  --jp-error-color2: var(--md-red-300);
  --jp-error-color3: var(--md-red-100);
  --jp-success-color0: var(--md-green-900);
  --jp-success-color1: var(--md-green-700);
  --jp-success-color2: var(--md-green-300);
  --jp-success-color3: var(--md-green-100);
  --jp-info-color0: var(--md-cyan-900);
  --jp-info-color1: var(--md-cyan-700);
  --jp-info-color2: var(--md-cyan-300);
  --jp-info-color3: var(--md-cyan-100);

  /* Cell specific styles */

  --jp-cell-padding: 5px;
  --jp-cell-collapser-width: 8px;
  --jp-cell-collapser-min-height: 20px;
  --jp-cell-collapser-not-active-hover-opacity: 0.6;
  --jp-cell-editor-background: var(--md-grey-100);
  --jp-cell-editor-border-color: var(--md-grey-300);
  --jp-cell-editor-box-shadow: inset 0 0 2px var(--md-blue-300);
  --jp-cell-editor-active-background: var(--jp-layout-color0);
  --jp-cell-editor-active-border-color: var(--jp-brand-color1);
  --jp-cell-prompt-width: 64px;
  --jp-cell-prompt-font-family: var(--jp-code-font-family-default);
  --jp-cell-prompt-letter-spacing: 0;
  --jp-cell-prompt-opacity: 1;
  --jp-cell-prompt-not-active-opacity: 0.5;
  --jp-cell-prompt-not-active-font-color: var(--md-grey-700);

  /* A custom blend of MD grey and blue 600
   * See https://meyerweb.com/eric/tools/color-blend/#546E7A:1E88E5:5:hex */
  --jp-cell-inprompt-font-color: #307fc1;

  /* A custom blend of MD grey and orange 600
   * https://meyerweb.com/eric/tools/color-blend/#546E7A:F4511E:5:hex */
  --jp-cell-outprompt-font-color: #bf5b3d;

  /* Notebook specific styles */

  --jp-notebook-padding: 10px;
  --jp-notebook-select-background: var(--jp-layout-color1);
  --jp-notebook-multiselected-color: var(--md-blue-50);

  /* The scroll padding is calculated to fill enough space at the bottom of the
  notebook to show one single-line cell (with appropriate padding) at the top
  when the notebook is scrolled all the way to the bottom. We also subtract one
  pixel so that no scrollbar appears if we have just one single-line cell in the
  notebook. This padding is to enable a 'scroll past end' feature in a notebook.
  */
  --jp-notebook-scroll-padding: calc(
    100% - var(--jp-code-font-size) * var(--jp-code-line-height) -
      var(--jp-code-padding) - var(--jp-cell-padding) - 1px
  );

  /* Rendermime styles */

  --jp-rendermime-error-background: #fdd;
  --jp-rendermime-table-row-background: var(--md-grey-100);
  --jp-rendermime-table-row-hover-background: var(--md-light-blue-50);

  /* Dialog specific styles */

  --jp-dialog-background: rgba(0, 0, 0, 0.25);

  /* Console specific styles */

  --jp-console-padding: 10px;

  /* Toolbar specific styles */

  --jp-toolbar-border-color: var(--jp-border-color1);
  --jp-toolbar-micro-height: 8px;
  --jp-toolbar-background: var(--jp-layout-color1);
  --jp-toolbar-box-shadow: 0 0 2px 0 rgba(0, 0, 0, 0.24);
  --jp-toolbar-header-margin: 4px 4px 0 4px;
  --jp-toolbar-active-background: var(--md-grey-300);

  /* Statusbar specific styles */

  --jp-statusbar-height: 24px;

  /* Input field styles */

  --jp-input-box-shadow: inset 0 0 2px var(--md-blue-300);
  --jp-input-active-background: var(--jp-layout-color1);
  --jp-input-hover-background: var(--jp-layout-color1);
  --jp-input-background: var(--md-grey-100);
  --jp-input-border-color: var(--jp-inverse-border-color);
  --jp-input-active-border-color: var(--jp-brand-color1);
  --jp-input-active-box-shadow-color: rgba(19, 124, 189, 0.3);

  /* General editor styles */

  --jp-editor-selected-background: #d9d9d9;
  --jp-editor-selected-focused-background: #d7d4f0;
  --jp-editor-cursor-color: var(--jp-ui-font-color0);

  /* Code mirror specific styles */

  --jp-mirror-editor-keyword-color: #008000;
  --jp-mirror-editor-atom-color: #88f;
  --jp-mirror-editor-number-color: #080;
  --jp-mirror-editor-def-color: #00f;
  --jp-mirror-editor-variable-color: var(--md-grey-900);
  --jp-mirror-editor-variable-2-color: rgb(0, 54, 109);
  --jp-mirror-editor-variable-3-color: #085;
  --jp-mirror-editor-punctuation-color: #05a;
  --jp-mirror-editor-property-color: #05a;
  --jp-mirror-editor-operator-color: #a2f;
  --jp-mirror-editor-comment-color: #408080;
  --jp-mirror-editor-string-color: #ba2121;
  --jp-mirror-editor-string-2-color: #708;
  --jp-mirror-editor-meta-color: #a2f;
  --jp-mirror-editor-qualifier-color: #555;
  --jp-mirror-editor-builtin-color: #008000;
  --jp-mirror-editor-bracket-color: #997;
  --jp-mirror-editor-tag-color: #170;
  --jp-mirror-editor-attribute-color: #00c;
  --jp-mirror-editor-header-color: blue;
  --jp-mirror-editor-quote-color: #090;
  --jp-mirror-editor-link-color: #00c;
  --jp-mirror-editor-error-color: #f00;
  --jp-mirror-editor-hr-color: #999;

  /*
    RTC user specific colors.
    These colors are used for the cursor, username in the editor,
    and the icon of the user.
  */

  --jp-collaborator-color1: #ffad8e;
  --jp-collaborator-color2: #dac83d;
  --jp-collaborator-color3: #72dd76;
  --jp-collaborator-color4: #00e4d0;
  --jp-collaborator-color5: #45d4ff;
  --jp-collaborator-color6: #e2b1ff;
  --jp-collaborator-color7: #ff9de6;

  /* Vega extension styles */

  --jp-vega-background: white;

  /* Sidebar-related styles */

  --jp-sidebar-min-width: 250px;

  /* Search-related styles */

  --jp-search-toggle-off-opacity: 0.5;
  --jp-search-toggle-hover-opacity: 0.8;
  --jp-search-toggle-on-opacity: 1;
  --jp-search-selected-match-background-color: rgb(245, 200, 0);
  --jp-search-selected-match-color: black;
  --jp-search-unselected-match-background-color: var(
    --jp-inverse-layout-color0
  );
  --jp-search-unselected-match-color: var(--jp-ui-inverse-font-color0);

  /* Icon colors that work well with light or dark backgrounds */
  --jp-icon-contrast-color0: var(--md-purple-600);
  --jp-icon-contrast-color1: var(--md-green-600);
  --jp-icon-contrast-color2: var(--md-pink-600);
  --jp-icon-contrast-color3: var(--md-blue-600);

  /* Button colors */
  --jp-accept-color-normal: var(--md-blue-700);
  --jp-accept-color-hover: var(--md-blue-800);
  --jp-accept-color-active: var(--md-blue-900);
  --jp-warn-color-normal: var(--md-red-700);
  --jp-warn-color-hover: var(--md-red-800);
  --jp-warn-color-active: var(--md-red-900);
  --jp-reject-color-normal: var(--md-grey-600);
  --jp-reject-color-hover: var(--md-grey-700);
  --jp-reject-color-active: var(--md-grey-800);

  /* File or activity icons and switch semantic variables */
  --jp-jupyter-icon-color: #f37626;
  --jp-notebook-icon-color: #f37626;
  --jp-json-icon-color: var(--md-orange-700);
  --jp-console-icon-background-color: var(--md-blue-700);
  --jp-console-icon-color: white;
  --jp-terminal-icon-background-color: var(--md-grey-800);
  --jp-terminal-icon-color: var(--md-grey-200);
  --jp-text-editor-icon-color: var(--md-grey-700);
  --jp-inspector-icon-color: var(--md-grey-700);
  --jp-switch-color: var(--md-grey-400);
  --jp-switch-true-position-color: var(--md-orange-900);
}
</style>
<style type="text/css">
/* Force rendering true colors when outputing to pdf */
* {
  -webkit-print-color-adjust: exact;
}

/* Misc */
a.anchor-link {
  display: none;
}

/* Input area styling */
.jp-InputArea {
  overflow: hidden;
}

.jp-InputArea-editor {
  overflow: hidden;
}

.cm-editor.cm-s-jupyter .highlight pre {
/* weird, but --jp-code-padding defined to be 5px but 4px horizontal padding is hardcoded for pre.cm-line */
  padding: var(--jp-code-padding) 4px;
  margin: 0;

  font-family: inherit;
  font-size: inherit;
  line-height: inherit;
  color: inherit;

}

.jp-OutputArea-output pre {
  line-height: inherit;
  font-family: inherit;
}

.jp-RenderedText pre {
  color: var(--jp-content-font-color1);
  font-size: var(--jp-code-font-size);
}

/* Hiding the collapser by default */
.jp-Collapser {
  display: none;
}

@page {
    margin: 0.5in; /* Margin for each printed piece of paper */
}

@media print {
  .jp-Cell-inputWrapper,
  .jp-Cell-outputWrapper {
    display: block;
  }
}
</style>
<!-- Load mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML-full,Safe"> </script>
<!-- MathJax configuration -->
<script type="text/x-mathjax-config">
    init_mathjax = function() {
        if (window.MathJax) {
        // MathJax loaded
            MathJax.Hub.Config({
                TeX: {
                    equationNumbers: {
                    autoNumber: "AMS",
                    useLabelIds: true
                    }
                },
                tex2jax: {
                    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                    processEscapes: true,
                    processEnvironments: true
                },
                displayAlign: 'center',
                messageStyle: 'none',
                CommonHTML: {
                    linebreaks: {
                    automatic: true
                    }
                }
            });

            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        }
    }
    init_mathjax();
    </script>
<!-- End of mathjax configuration --><script type="module">
  document.addEventListener("DOMContentLoaded", async () => {
    const diagrams = document.querySelectorAll(".jp-Mermaid > pre.mermaid");
    // do not load mermaidjs if not needed
    if (!diagrams.length) {
      return;
    }
    const mermaid = (await import("https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.7.0/mermaid.esm.min.mjs")).default;
    const parser = new DOMParser();

    mermaid.initialize({
      maxTextSize: 100000,
      maxEdges: 100000,
      startOnLoad: false,
      fontFamily: window
        .getComputedStyle(document.body)
        .getPropertyValue("--jp-ui-font-family"),
      theme: document.querySelector("body[data-jp-theme-light='true']")
        ? "default"
        : "dark",
    });

    let _nextMermaidId = 0;

    function makeMermaidImage(svg) {
      const img = document.createElement("img");
      const doc = parser.parseFromString(svg, "image/svg+xml");
      const svgEl = doc.querySelector("svg");
      const { maxWidth } = svgEl?.style || {};
      const firstTitle = doc.querySelector("title");
      const firstDesc = doc.querySelector("desc");

      img.setAttribute("src", `data:image/svg+xml,${encodeURIComponent(svg)}`);
      if (maxWidth) {
        img.width = parseInt(maxWidth);
      }
      if (firstTitle) {
        img.setAttribute("alt", firstTitle.textContent);
      }
      if (firstDesc) {
        const caption = document.createElement("figcaption");
        caption.className = "sr-only";
        caption.textContent = firstDesc.textContent;
        return [img, caption];
      }
      return [img];
    }

    async function makeMermaidError(text) {
      let errorMessage = "";
      try {
        await mermaid.parse(text);
      } catch (err) {
        errorMessage = `${err}`;
      }

      const result = document.createElement("details");
      result.className = 'jp-RenderedMermaid-Details';
      const summary = document.createElement("summary");
      summary.className = 'jp-RenderedMermaid-Summary';
      const pre = document.createElement("pre");
      const code = document.createElement("code");
      code.innerText = text;
      pre.appendChild(code);
      summary.appendChild(pre);
      result.appendChild(summary);

      const warning = document.createElement("pre");
      warning.innerText = errorMessage;
      result.appendChild(warning);
      return [result];
    }

    async function renderOneMarmaid(src) {
      const id = `jp-mermaid-${_nextMermaidId++}`;
      const parent = src.parentNode;
      let raw = src.textContent.trim();
      const el = document.createElement("div");
      el.style.visibility = "hidden";
      document.body.appendChild(el);
      let results = null;
      let output = null;
      try {
        let { svg } = await mermaid.render(id, raw, el);
        svg = cleanMermaidSvg(svg);
        results = makeMermaidImage(svg);
        output = document.createElement("figure");
        results.map(output.appendChild, output);
      } catch (err) {
        parent.classList.add("jp-mod-warning");
        results = await makeMermaidError(raw);
        output = results[0];
      } finally {
        el.remove();
      }
      parent.classList.add("jp-RenderedMermaid");
      parent.appendChild(output);
    }


    /**
     * Post-process to ensure mermaid diagrams contain only valid SVG and XHTML.
     */
    function cleanMermaidSvg(svg) {
      return svg.replace(RE_VOID_ELEMENT, replaceVoidElement);
    }


    /**
     * A regular expression for all void elements, which may include attributes and
     * a slash.
     *
     * @see https://developer.mozilla.org/en-US/docs/Glossary/Void_element
     *
     * Of these, only `<br>` is generated by Mermaid in place of `\n`,
     * but _any_ "malformed" tag will break the SVG rendering entirely.
     */
    const RE_VOID_ELEMENT =
      /<\s*(area|base|br|col|embed|hr|img|input|link|meta|param|source|track|wbr)\s*([^>]*?)\s*>/gi;

    /**
     * Ensure a void element is closed with a slash, preserving any attributes.
     */
    function replaceVoidElement(match, tag, rest) {
      rest = rest.trim();
      if (!rest.endsWith('/')) {
        rest = `${rest} /`;
      }
      return `<${tag} ${rest}>`;
    }

    void Promise.all([...diagrams].map(renderOneMarmaid));
  });
</script>
<style>
  .jp-Mermaid:not(.jp-RenderedMermaid) {
    display: none;
  }

  .jp-RenderedMermaid {
    overflow: auto;
    display: flex;
  }

  .jp-RenderedMermaid.jp-mod-warning {
    width: auto;
    padding: 0.5em;
    margin-top: 0.5em;
    border: var(--jp-border-width) solid var(--jp-warn-color2);
    border-radius: var(--jp-border-radius);
    color: var(--jp-ui-font-color1);
    font-size: var(--jp-ui-font-size1);
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  .jp-RenderedMermaid figure {
    margin: 0;
    overflow: auto;
    max-width: 100%;
  }

  .jp-RenderedMermaid img {
    max-width: 100%;
  }

  .jp-RenderedMermaid-Details > pre {
    margin-top: 1em;
  }

  .jp-RenderedMermaid-Summary {
    color: var(--jp-warn-color2);
  }

  .jp-RenderedMermaid:not(.jp-mod-warning) pre {
    display: none;
  }

  .jp-RenderedMermaid-Summary > pre {
    display: inline-block;
    white-space: normal;
  }
</style>
<!-- End of mermaid configuration --></head>
<body class="jp-Notebook" data-jp-theme-light="true" data-jp-theme-name="JupyterLab Light">
<main>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=2f0d7858">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h1 id="EDA---An%C3%A0lisi-de-Dades-Agr%C3%ADcoles-i-Clim%C3%A0tiques">EDA - Anlisi de Dades Agrcoles i Climtiques<a class="anchor-link" href="#EDA---An%C3%A0lisi-de-Dades-Agr%C3%ADcoles-i-Clim%C3%A0tiques"></a></h1><p>Aquest notebook realitza una exploraci inicial de tots els fitxers disponibles a la carpeta <code>data/</code> amb l'objectiu d'aconseguir unificar tota la informaci disponible en data frames.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=31648114">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[1]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">country_converter</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">coco</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=25890f18">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[2]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Configuraci de pandas per mostrar tots els prints complets</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'display.max_rows'</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'display.max_columns'</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'display.max_colwidth'</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'display.width'</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'display.precision'</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=c4f4a41c">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[3]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Definir la ruta base dels fitxers de dades</span>
<span class="n">DATA_DIR</span> <span class="o">=</span> <span class="s2">"../data"</span>
<span class="n">CLIMATE_DATA_DIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_DIR</span><span class="p">,</span> <span class="s2">"climate_data"</span><span class="p">)</span>
<span class="n">FAOSTAT_DIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_DIR</span><span class="p">,</span> <span class="s2">"faostat"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=bac5a4f1">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[4]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Inicialitzar el diccionari principal</span>
<span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"climate_data"</span><span class="p">:</span> <span class="p">{},</span>
    <span class="s2">"faostat"</span><span class="p">:</span> <span class="p">{}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=4f2d46f5">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[5]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Carregar fitxers de climate_data</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Carregant fitxers de climate_data..."</span><span class="p">)</span>

<span class="c1"># CSV: Climate_Indicators_Annual_Mean_Global_Surface_Temperature.csv</span>
<span class="n">climate_temp_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">CLIMATE_DATA_DIR</span><span class="p">,</span> <span class="s2">"Climate_Indicators_Annual_Mean_Global_Surface_Temperature.csv"</span><span class="p">)</span>
<span class="n">data_dict</span><span class="p">[</span><span class="s2">"climate_data"</span><span class="p">][</span><span class="s2">"Climate_Indicators_Annual_Mean_Global_Surface_Temperature"</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">climate_temp_file</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Carregat: Climate_Indicators_Annual_Mean_Global_Surface_Temperature.csv"</span><span class="p">)</span>

<span class="c1"># CSV: World_Development_Indicators.csv</span>
<span class="n">wdi_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">CLIMATE_DATA_DIR</span><span class="p">,</span> <span class="s2">"World_Development_Indicators.csv"</span><span class="p">)</span>
<span class="n">data_dict</span><span class="p">[</span><span class="s2">"climate_data"</span><span class="p">][</span><span class="s2">"World_Development_Indicators"</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">wdi_file</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Carregat: World_Development_Indicators.csv"</span><span class="p">)</span>

<span class="c1"># Excel: tas_pr_annual_mean_historical.xlsx</span>
<span class="n">excel_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">CLIMATE_DATA_DIR</span><span class="p">,</span> <span class="s2">"tas_pr_annual_mean_historical.xlsx"</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="c1"># Llegir totes les fulls de l'Excel</span>
    <span class="n">excel_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelFile</span><span class="p">(</span><span class="n">excel_file</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">sheet_name</span> <span class="ow">in</span> <span class="n">excel_data</span><span class="o">.</span><span class="n">sheet_names</span><span class="p">:</span>
        <span class="n">df_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"annual_mean_historical_</span><span class="si">{</span><span class="n">sheet_name</span><span class="si">}</span><span class="s2">"</span>
        <span class="n">data_dict</span><span class="p">[</span><span class="s2">"climate_data"</span><span class="p">][</span><span class="n">df_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">excel_file</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="n">sheet_name</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Carregat: tas_pr_annual_mean_historical.xlsx (full: </span><span class="si">{</span><span class="n">sheet_name</span><span class="si">}</span><span class="s2">)"</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Error carregant Excel: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Total fitxers climate_data carregats: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="s1">'climate_data'</span><span class="p">])</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Carregant fitxers de climate_data...
Carregat: Climate_Indicators_Annual_Mean_Global_Surface_Temperature.csv
Carregat: World_Development_Indicators.csv
Carregat: tas_pr_annual_mean_historical.xlsx (full: pr)
Carregat: tas_pr_annual_mean_historical.xlsx (full: tas)

Total fitxers climate_data carregats: 4
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=aec9a9db">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[6]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Carregar fitxers de faostat</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Carregant fitxers de faostat..."</span><span class="p">)</span>

<span class="c1"># Llistar totes les carpetes de faostat</span>
<span class="n">faostat_folders</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">FAOSTAT_DIR</span><span class="p">)</span> 
                   <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">FAOSTAT_DIR</span><span class="p">,</span> <span class="n">f</span><span class="p">))]</span>

<span class="k">for</span> <span class="n">folder</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">faostat_folders</span><span class="p">):</span>
    <span class="n">folder_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">FAOSTAT_DIR</span><span class="p">,</span> <span class="n">folder</span><span class="p">)</span>
    <span class="c1"># Eliminar el sufix '_E_All_Data_(Normalized)' del nom de la carpeta (ja que totes ho tenen)</span>
    <span class="n">folder_key</span> <span class="o">=</span> <span class="n">folder</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'_E_All_Data_(Normalized)'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
    
    <span class="c1"># Inicialitzar el diccionari per aquesta carpeta</span>
    <span class="n">data_dict</span><span class="p">[</span><span class="s2">"faostat"</span><span class="p">][</span><span class="n">folder_key</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="c1"># Llistar tots els fitxers CSV de la carpeta</span>
    <span class="n">csv_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">folder_path</span><span class="p">)</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">'.csv'</span><span class="p">)]</span>
    
    <span class="k">for</span> <span class="n">csv_file</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">csv_files</span><span class="p">):</span>
        <span class="n">csv_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder_path</span><span class="p">,</span> <span class="n">csv_file</span><span class="p">)</span>
        <span class="c1"># Utilitzar el nom del fitxer (sense extensi) com a clau</span>
        <span class="n">file_key</span> <span class="o">=</span> <span class="n">csv_file</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.csv'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="n">data_dict</span><span class="p">[</span><span class="s2">"faostat"</span><span class="p">][</span><span class="n">folder_key</span><span class="p">][</span><span class="n">file_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">csv_path</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Carregat: </span><span class="si">{</span><span class="n">folder</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">csv_file</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Error carregant </span><span class="si">{</span><span class="n">folder</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">csv_file</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Total carpetes faostat processades: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="s1">'faostat'</span><span class="p">])</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Carregant fitxers de faostat...
Carregat: Emissions_Totals_E_All_Data_(Normalized)/Emissions_Totals_E_All_Data_(Normalized).csv
Carregat: Emissions_Totals_E_All_Data_(Normalized)/Emissions_Totals_E_AreaCodes.csv
Carregat: Emissions_Totals_E_All_Data_(Normalized)/Emissions_Totals_E_Elements.csv
Carregat: Emissions_Totals_E_All_Data_(Normalized)/Emissions_Totals_E_Flags.csv
Carregat: Emissions_Totals_E_All_Data_(Normalized)/Emissions_Totals_E_ItemCodes.csv
Carregat: Emissions_Totals_E_All_Data_(Normalized)/Emissions_Totals_E_Sources.csv
Carregat: Employment_Indicators_Agriculture_E_All_Data_(Normalized)/Employment_Indicators_Agriculture_E_All_Data_(Normalized).csv
Carregat: Employment_Indicators_Agriculture_E_All_Data_(Normalized)/Employment_Indicators_Agriculture_E_AreaCodes.csv
Carregat: Employment_Indicators_Agriculture_E_All_Data_(Normalized)/Employment_Indicators_Agriculture_E_Elements.csv
Carregat: Employment_Indicators_Agriculture_E_All_Data_(Normalized)/Employment_Indicators_Agriculture_E_Flags.csv
Carregat: Employment_Indicators_Agriculture_E_All_Data_(Normalized)/Employment_Indicators_Agriculture_E_Indicators.csv
Carregat: Employment_Indicators_Agriculture_E_All_Data_(Normalized)/Employment_Indicators_Agriculture_E_Sexs.csv
Carregat: Employment_Indicators_Agriculture_E_All_Data_(Normalized)/Employment_Indicators_Agriculture_E_Sources.csv
Carregat: Environment_LandCover_E_All_Data_(Normalized)/Environment_LandCover_E_All_Data_(Normalized).csv
Carregat: Environment_LandCover_E_All_Data_(Normalized)/Environment_LandCover_E_AreaCodes.csv
Carregat: Environment_LandCover_E_All_Data_(Normalized)/Environment_LandCover_E_Elements.csv
Carregat: Environment_LandCover_E_All_Data_(Normalized)/Environment_LandCover_E_Flags.csv
Carregat: Environment_LandCover_E_All_Data_(Normalized)/Environment_LandCover_E_ItemCodes.csv
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>/var/folders/x5/22k124b128j49p973rsrf6hc0000gn/T/ipykernel_11357/317185709.py:25: DtypeWarning: Columns (12) have mixed types. Specify dtype option on import or set low_memory=False.
  data_dict["faostat"][folder_key][file_key] = pd.read_csv(csv_path)
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Carregat: Inputs_FertilizersNutrient_E_All_Data_(Normalized)/Inputs_FertilizersNutrient_E_All_Data_(Normalized).csv
Carregat: Inputs_FertilizersNutrient_E_All_Data_(Normalized)/Inputs_FertilizersNutrient_E_AreaCodes.csv
Carregat: Inputs_FertilizersNutrient_E_All_Data_(Normalized)/Inputs_FertilizersNutrient_E_Elements.csv
Carregat: Inputs_FertilizersNutrient_E_All_Data_(Normalized)/Inputs_FertilizersNutrient_E_Flags.csv
Carregat: Inputs_FertilizersNutrient_E_All_Data_(Normalized)/Inputs_FertilizersNutrient_E_ItemCodes.csv
Carregat: Inputs_LandUse_E_All_Data_(Normalized)/Inputs_LandUse_E_All_Data_(Normalized).csv
Carregat: Inputs_LandUse_E_All_Data_(Normalized)/Inputs_LandUse_E_AreaCodes.csv
Carregat: Inputs_LandUse_E_All_Data_(Normalized)/Inputs_LandUse_E_Elements.csv
Carregat: Inputs_LandUse_E_All_Data_(Normalized)/Inputs_LandUse_E_Flags.csv
Carregat: Inputs_LandUse_E_All_Data_(Normalized)/Inputs_LandUse_E_ItemCodes.csv
Carregat: Inputs_Pesticides_Use_E_All_Data_(Normalized)/Inputs_Pesticides_Use_E_All_Data_(Normalized).csv
Carregat: Inputs_Pesticides_Use_E_All_Data_(Normalized)/Inputs_Pesticides_Use_E_AreaCodes.csv
Carregat: Inputs_Pesticides_Use_E_All_Data_(Normalized)/Inputs_Pesticides_Use_E_Elements.csv
Carregat: Inputs_Pesticides_Use_E_All_Data_(Normalized)/Inputs_Pesticides_Use_E_Flags.csv
Carregat: Inputs_Pesticides_Use_E_All_Data_(Normalized)/Inputs_Pesticides_Use_E_ItemCodes.csv
Carregat: Population_E_All_Data_(Normalized)/Population_E_All_Data_(Normalized).csv
Carregat: Population_E_All_Data_(Normalized)/Population_E_AreaCodes.csv
Carregat: Population_E_All_Data_(Normalized)/Population_E_Elements.csv
Carregat: Population_E_All_Data_(Normalized)/Population_E_Flags.csv
Carregat: Population_E_All_Data_(Normalized)/Population_E_ItemCodes.csv
Carregat: Prices_E_All_Data_(Normalized)/Prices_E_All_Data_(Normalized).csv
Carregat: Prices_E_All_Data_(Normalized)/Prices_E_AreaCodes.csv
Carregat: Prices_E_All_Data_(Normalized)/Prices_E_Elements.csv
Carregat: Prices_E_All_Data_(Normalized)/Prices_E_Flags.csv
Carregat: Prices_E_All_Data_(Normalized)/Prices_E_ItemCodes.csv
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>/var/folders/x5/22k124b128j49p973rsrf6hc0000gn/T/ipykernel_11357/317185709.py:25: DtypeWarning: Columns (13) have mixed types. Specify dtype option on import or set low_memory=False.
  data_dict["faostat"][folder_key][file_key] = pd.read_csv(csv_path)
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Carregat: Production_Crops_Livestock_E_All_Data_(Normalized)/Production_Crops_Livestock_E_All_Data_(Normalized).csv
Carregat: Production_Crops_Livestock_E_All_Data_(Normalized)/Production_Crops_Livestock_E_AreaCodes.csv
Carregat: Production_Crops_Livestock_E_All_Data_(Normalized)/Production_Crops_Livestock_E_Elements.csv
Carregat: Production_Crops_Livestock_E_All_Data_(Normalized)/Production_Crops_Livestock_E_Flags.csv
Carregat: Production_Crops_Livestock_E_All_Data_(Normalized)/Production_Crops_Livestock_E_ItemCodes.csv

Total carpetes faostat processades: 9
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=3335088f">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[7]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Resum de tots els dataframes carregats</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Resum del diccionari data_dict"</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2"> CLIMATE_DATA (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="s1">'climate_data'</span><span class="p">])</span><span class="si">}</span><span class="s2"> fitxers):"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="s1">'climate_data'</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="s1">'climate_data'</span><span class="p">][</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  - </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> files x </span><span class="si">{</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> columnes"</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2"> FAOSTAT (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="s1">'faostat'</span><span class="p">])</span><span class="si">}</span><span class="s2"> carpetes):"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">folder_key</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="s1">'faostat'</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
    <span class="n">num_files</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="s1">'faostat'</span><span class="p">][</span><span class="n">folder_key</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  - </span><span class="si">{</span><span class="n">folder_key</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">num_files</span><span class="si">}</span><span class="s2"> fitxers"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">file_key</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="p">[</span><span class="s1">'faostat'</span><span class="p">][</span><span class="n">folder_key</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="s1">'All_Data'</span> <span class="ow">in</span> <span class="n">k</span><span class="p">):</span>
            <span class="n">shape</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="s1">'faostat'</span><span class="p">][</span><span class="n">folder_key</span><span class="p">][</span><span class="n">file_key</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"     Main File:</span><span class="si">{</span><span class="n">file_key</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> files x </span><span class="si">{</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> columnes"</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Tots els fitxers han estat carregats correctament al diccionari data_dict"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Resum del diccionari data_dict

 CLIMATE_DATA (4 fitxers):
  - Climate_Indicators_Annual_Mean_Global_Surface_Temperature: 231 files x 74 columnes
  - World_Development_Indicators: 1875 files x 69 columnes
  - annual_mean_historical_pr: 246 files x 126 columnes
  - annual_mean_historical_tas: 246 files x 126 columnes

 FAOSTAT (9 carpetes):
  - Emissions_Totals: 6 fitxers
     Main File:Emissions_Totals_E_All_Data_(Normalized): 2500184 files x 15 columnes
  - Employment_Indicators_Agriculture: 7 fitxers
     Main File:Employment_Indicators_Agriculture_E_All_Data_(Normalized): 188070 files x 17 columnes
  - Environment_LandCover: 5 fitxers
     Main File:Environment_LandCover_E_All_Data_(Normalized): 210986 files x 12 columnes
  - Inputs_FertilizersNutrient: 5 fitxers
     Main File:Inputs_FertilizersNutrient_E_All_Data_(Normalized): 241859 files x 13 columnes
  - Inputs_LandUse: 5 fitxers
     Main File:Inputs_LandUse_E_All_Data_(Normalized): 413211 files x 13 columnes
  - Inputs_Pesticides_Use: 5 fitxers
     Main File:Inputs_Pesticides_Use_E_All_Data_(Normalized): 103622 files x 13 columnes
  - Population: 5 fitxers
     Main File:Population_E_All_Data_(Normalized): 168404 files x 13 columnes
  - Prices: 5 fitxers
     Main File:Prices_E_All_Data_(Normalized): 1664300 files x 15 columnes
  - Production_Crops_Livestock: 5 fitxers
     Main File:Production_Crops_Livestock_E_All_Data_(Normalized): 4116252 files x 14 columnes
Tots els fitxers han estat carregats correctament al diccionari data_dict
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=93564d96">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[8]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Verificaci: mostrar les claus del diccionari</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Estructura del diccionari data_dict:"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Claus principals: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">data_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Claus de climate_data: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="s1">'climate_data'</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Claus de faostat: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="s1">'faostat'</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Estructura del diccionari data_dict:

Claus principals: ['climate_data', 'faostat']

Claus de climate_data: ['Climate_Indicators_Annual_Mean_Global_Surface_Temperature', 'World_Development_Indicators', 'annual_mean_historical_pr', 'annual_mean_historical_tas']

Claus de faostat: ['Emissions_Totals', 'Employment_Indicators_Agriculture', 'Environment_LandCover', 'Inputs_FertilizersNutrient', 'Inputs_LandUse', 'Inputs_Pesticides_Use', 'Population', 'Prices', 'Production_Crops_Livestock']
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=fa93d5ea">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="Construcci%C3%B3-dels-DataFrame-Final-(agri_product_df-i-agri_country_year_df)">Construcci dels DataFrame Final (<code>agri_product_df</code> i <code>agri_country_year_df</code>)<a class="anchor-link" href="#Construcci%C3%B3-dels-DataFrame-Final-(agri_product_df-i-agri_country_year_df)"></a></h2><p>Els dataframes final seran <code>agri_product_df</code>, que contrindr informaci per cada Area (pas) x ramaderia/cultiu x any, i <code>agri_country_year_df</code>, que contindr indicadors externs tils per comparar amb l'anterior a nivell Area (pas) x any</p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=6a4898de">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Definici%C3%B3-de-Funcionn-generals-utilitzades-a-lo-llarg-del-codi">Definici de Funcionn generals utilitzades a lo llarg del codi<a class="anchor-link" href="#Definici%C3%B3-de-Funcionn-generals-utilitzades-a-lo-llarg-del-codi"></a></h3><p>Les funcions han sigut definides a posteriori de veure patrons que podien generalitzar-se</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=06396b08">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[9]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Funci per analitzar qualsevol dataset de faostat</span>
<span class="k">def</span><span class="w"> </span><span class="nf">analitzar_dataset_faostat</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Funci per analitzar un dataset de faostat.</span>
<span class="sd">    </span>
<span class="sd">    Mostra:</span>
<span class="sd">    - Informaci del dataframe principal (All_Data): dimensions, columnes, info(), head()</span>
<span class="sd">    - Head() de tots els altres dataframes d'aquesta carpeta (els que no sn All_Data)</span>
<span class="sd">    - Elements nics de les columnes 'Item' i 'Element' del main_df</span>
<span class="sd">    Parmetres:</span>
<span class="sd">    -----------</span>
<span class="sd">    key : str</span>
<span class="sd">        Clau del dataset a analitzar (ex: 'Production_Crops_Livestock', 'Inputs_FertilizersNutrient')</span>
<span class="sd">    """</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Anlisi del dataset: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    
    <span class="c1"># Trobar el dataframe principal (All_Data)</span>
    <span class="n">all_data_key</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="p">[</span><span class="s2">"faostat"</span><span class="p">][</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="s1">'All_Data'</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
            <span class="n">all_data_key</span> <span class="o">=</span> <span class="n">k</span>
            <span class="k">break</span>
    
    <span class="c1"># Obtenir el dataframe principal</span>
    <span class="n">main_df</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="s2">"faostat"</span><span class="p">][</span><span class="n">key</span><span class="p">][</span><span class="n">all_data_key</span><span class="p">]</span>
    
    <span class="c1"># Mostrar informaci del dataframe principal</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Dataframe principal (</span><span class="si">{</span><span class="n">all_data_key</span><span class="si">}</span><span class="s2">):"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Dimensions: </span><span class="si">{</span><span class="n">main_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> files x </span><span class="si">{</span><span class="n">main_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> columnes"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2"> Columnes (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">main_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2">):"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">main_df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  </span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">2d</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2"> Primeres files del dataframe principal:"</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">main_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
    
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">"Item"</span><span class="p">,</span> <span class="s2">"Element"</span><span class="p">,</span> <span class="s2">"Indicator"</span><span class="p">,</span> <span class="s2">"Source"</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">main_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2"> Valors nics de la columna '</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">':"</span><span class="p">)</span>
            <span class="n">unique_values</span> <span class="o">=</span> <span class="n">main_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Total nics: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">unique_values</span><span class="p">)</span><span class="si">}</span><span class="s2"> (mostrant com a mxim 50)"</span><span class="p">)</span>
            <span class="n">display</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">unique_values</span><span class="p">[:</span><span class="mi">50</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">col</span><span class="p">]))</span>

    <span class="c1"># Mostrar head() dels altres dataframes</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">" Altres dataframes de </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">:"</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="s2">"faostat"</span><span class="p">][</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="k">if</span> <span class="s1">'All_Data'</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2"> Contingut de </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">:"</span><span class="p">)</span>
            <span class="n">display</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="s2">"faostat"</span><span class="p">][</span><span class="n">key</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>


<span class="c1"># Desprs de veure que el patr de la fusi de dataframes sempre ser el mateix, per amb diferents dataframes.</span>
<span class="k">def</span><span class="w"> </span><span class="nf">merge_agri_dataframes</span><span class="p">(</span>
    <span class="n">df_initial</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">df_to_merge</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">df_name_initial</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"df_initial"</span><span class="p">,</span>
    <span class="n">df_name_to_merge</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"df_to_merge"</span><span class="p">,</span>
    <span class="n">merge_cols</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Area Code"</span><span class="p">,</span> <span class="s2">"Area Code (M49)"</span><span class="p">,</span> <span class="s2">"Area"</span><span class="p">,</span> <span class="s2">"Year Code"</span><span class="p">,</span> <span class="s2">"Year"</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Funci per fer merge de dos dataframes agrcoles.</span>
<span class="sd">    </span>
<span class="sd">    Parmetres:</span>
<span class="sd">    -----------</span>
<span class="sd">    df_initial : DataFrame</span>
<span class="sd">        DataFrame inicial al qual s'afegir la informaci</span>
<span class="sd">    df_to_merge : DataFrame</span>
<span class="sd">        DataFrame que es fusionar amb l'inicial</span>
<span class="sd">    df_name_initial : str</span>
<span class="sd">        Nom del dataframe inicial (per als prints)</span>
<span class="sd">    df_name_to_merge : str</span>
<span class="sd">        Nom del dataframe a mergear (per als prints)</span>
<span class="sd">    </span>
<span class="sd">    Retorna:</span>
<span class="sd">    --------</span>
<span class="sd">    DataFrame</span>
<span class="sd">        DataFrame resultat del merge</span>
<span class="sd">    """</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Nombre de files de </span><span class="si">{</span><span class="n">df_name_initial</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">df_initial</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Nombre de columnes de </span><span class="si">{</span><span class="n">df_name_initial</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">df_initial</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Nombre de files de </span><span class="si">{</span><span class="n">df_name_to_merge</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">df_to_merge</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Nombre de columnes de </span><span class="si">{</span><span class="n">df_name_to_merge</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">df_to_merge</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    
    <span class="c1"># Fem el merge/join</span>
    <span class="n">df_result</span> <span class="o">=</span> <span class="n">df_initial</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
        <span class="n">df_to_merge</span><span class="p">,</span>
        <span class="n">on</span><span class="o">=</span><span class="n">merge_cols</span><span class="p">,</span>
        <span class="n">how</span><span class="o">=</span><span class="s2">"left"</span>
    <span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Nombre final de files del resultat: </span><span class="si">{</span><span class="n">df_result</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Nombre final de columnes del resultat: </span><span class="si">{</span><span class="n">df_result</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">display</span><span class="p">(</span><span class="n">df_result</span><span class="p">[(</span><span class="n">df_result</span><span class="p">[</span><span class="s2">"Area"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"Spain"</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_result</span><span class="p">[</span><span class="s2">"Year"</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2020</span><span class="p">)]</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
    
    <span class="k">return</span> <span class="n">df_result</span>

<span class="c1"># Tamb podem generalitzar el procs de creaci de dataframes filtrats.</span>
<span class="k">def</span><span class="w"> </span><span class="nf">crear_df_faostat_filtrat</span><span class="p">(</span>
    <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">df_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">column_mapping</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">values_to_keep</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">data_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">,</span>
    <span class="n">delete_note_flag_columns</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Generalitza el processament d'un dataset FAOSTAT:</span>
<span class="sd">    - key: clau principal dins de data_dict['faostat']</span>
<span class="sd">    - df_name: nom variable a assignar (string; noms per print, retorna el df)</span>
<span class="sd">    - column_mapping: dict de mapping per renombrar columnes</span>
<span class="sd">    - values_to_keep: dict amb claus=noms de columnes (post-mapping) i valors=llista de valors a mantenir</span>
<span class="sd">                      Exemple: {'Item': ['x', 'y'], 'Element': ['z'], 'Source': ['FAO TIER 1']}</span>
<span class="sd">    """</span>
    <span class="c1"># Trobar el dataframe principal (All_Data)</span>
    <span class="n">all_data_key</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="p">[</span><span class="s2">"faostat"</span><span class="p">][</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="s2">"All_Data"</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
            <span class="n">all_data_key</span> <span class="o">=</span> <span class="n">k</span>
            <span class="k">break</span>

    <span class="k">if</span> <span class="n">all_data_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"No s'ha trobat cap arxiu 'All_Data' per '</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">'"</span><span class="p">)</span>

    <span class="c1"># Cpia del dataframe principal</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="s2">"faostat"</span><span class="p">][</span><span class="n">key</span><span class="p">][</span><span class="n">all_data_key</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Creaci de </span><span class="si">{</span><span class="n">df_name</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

    <span class="c1"># Eliminar les columnes 'Note' i 'Flag'</span>
    <span class="k">if</span> <span class="n">delete_note_flag_columns</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">"Note"</span><span class="p">,</span> <span class="s2">"Flag"</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s2">"ignore"</span><span class="p">)</span>

    <span class="c1"># Remapejar les columnes</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">column_mapping</span><span class="p">)</span>

    <span class="c1"># Filtrar amb les condicions especificades a values_to_keep</span>
    <span class="k">for</span> <span class="n">col_name</span><span class="p">,</span> <span class="n">values_list</span> <span class="ow">in</span> <span class="n">values_to_keep</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">col_name</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">values_list</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Advertncia: La columna '</span><span class="si">{</span><span class="n">col_name</span><span class="si">}</span><span class="s2">' no existeix al dataframe"</span><span class="p">)</span>

    <span class="c1"># Mostrem els valors diferents de 'Unit' per veure si hi ha valors nics</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Valors diferents de 'Unit':"</span><span class="p">)</span>
    <span class="n">groupby_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">values_to_keep</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">groupby_cols</span> <span class="ow">and</span> <span class="s2">"Unit"</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">groupby_cols</span><span class="p">)[</span><span class="s2">"Unit"</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Dimensions finals: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> files x </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> columnes"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Columnes finals (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2">):"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  </span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">2d</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Primeres files de </span><span class="si">{</span><span class="n">df_name</span><span class="si">}</span><span class="s2">:"</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Resum de valors nics:"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">col_name</span> <span class="ow">in</span> <span class="n">values_to_keep</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">col_name</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  - </span><span class="si">{</span><span class="n">col_name</span><span class="si">}</span><span class="s2"> nics: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="si">}</span><span class="s2"> a </span><span class="si">{</span><span class="nb">sorted</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>


<span class="c1"># Fem una funci ja que l'estructura de les columnes s la mateixa per a tots els dataframes.</span>
<span class="k">def</span><span class="w"> </span><span class="nf">pivot_faostat_df</span><span class="p">(</span>
    <span class="n">df_to_pivot</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">index_cols</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Area Code"</span><span class="p">,</span> <span class="s2">"Area Code (M49)"</span><span class="p">,</span> <span class="s2">"Area"</span><span class="p">,</span> <span class="s2">"Year Code"</span><span class="p">,</span> <span class="s2">"Year"</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Pivot landcover DataFrame so that each landcover category+metric becomes a column with values in ha.</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df_to_pivot : pd.DataFrame</span>
<span class="sd">        The landcover dataframe to be pivoted, with a 'pivot_col' and 'Value' columns.</span>
<span class="sd">    index_cols: list[str]</span>
<span class="sd">        The columns to be used as index in the pivot table.</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pivot_df : pd.DataFrame</span>
<span class="sd">        Pivoted DataFrame with wide columns for each landcover category+metric.</span>
<span class="sd">    """</span>
    <span class="n">pivot_df</span> <span class="o">=</span> <span class="n">df_to_pivot</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
        <span class="n">index</span><span class="o">=</span><span class="n">index_cols</span><span class="p">,</span>
        <span class="n">columns</span><span class="o">=</span><span class="s2">"pivot_col"</span><span class="p">,</span>
        <span class="n">values</span><span class="o">=</span><span class="s2">"Value"</span><span class="p">,</span>
        <span class="n">aggfunc</span><span class="o">=</span><span class="s2">"first"</span>
    <span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">pivot_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">display</span><span class="p">(</span><span class="n">pivot_df</span><span class="p">[</span><span class="n">pivot_df</span><span class="p">[</span><span class="s1">'Area'</span><span class="p">]</span><span class="o">==</span><span class="s1">'Spain'</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">pivot_df</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=1fd01af0">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Pas-1:-Creaci%C3%B3-de-agri_df-(Base-de-dades-agr%C3%ADcoles)">Pas 1: Creaci de <code>agri_df</code> (Base de dades agrcoles)<a class="anchor-link" href="#Pas-1:-Creaci%C3%B3-de-agri_df-(Base-de-dades-agr%C3%ADcoles)"></a></h3><p>La base per a la construcci del dataframe final ser el fitxer <strong><code>Production_Crops_Livestock_E_All_Data_(Normalized).csv</code></strong> ja que s el que cont la major informaci sobre producci agrcola i ramadera.</p>
<p><strong>Qu cont aquest dataset:</strong></p>
<ul>
<li>Producci</li>
<li>rea cosechada</li>
<li>Rendiment</li>
<li>Cap de bestiar</li>
<li>etc.</li>
</ul>
<p>Per pas x cultiu/ramaderia x any</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=cd16a266">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[10]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Pas 1: Assignar agri_df amb el dataframe de Production_Crops_Livestock</span>
<span class="n">agri_df</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="s2">"faostat"</span><span class="p">][</span><span class="s2">"Production_Crops_Livestock"</span><span class="p">][</span><span class="s2">"Production_Crops_Livestock_E_All_Data_(Normalized)"</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Agricultural dataframe (agri_df)"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Dimensions: </span><span class="si">{</span><span class="n">agri_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> files x </span><span class="si">{</span><span class="n">agri_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> columnes"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Columnes (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">agri_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2">):"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">agri_df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  </span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">2d</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Primeres files:"</span><span class="p">)</span>
<span class="n">agri_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Agricultural dataframe (agri_df)

Dimensions: 4,116,252 files x 14 columnes

Columnes (14):
   1. Area Code
   2. Area Code (M49)
   3. Area
   4. Item Code
   5. Item Code (CPC)
   6. Item
   7. Element Code
   8. Element
   9. Year Code
  10. Year
  11. Unit
  12. Value
  13. Flag
  14. Note

Primeres files:
</pre>
</div>
</div>
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[10]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Item Code</th>
<th>Item Code (CPC)</th>
<th>Item</th>
<th>Element Code</th>
<th>Element</th>
<th>Year Code</th>
<th>Year</th>
<th>Unit</th>
<th>Value</th>
<th>Flag</th>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>221</td>
<td>'01371</td>
<td>Almonds, in shell</td>
<td>5312</td>
<td>Area harvested</td>
<td>1961</td>
<td>1961</td>
<td>ha</td>
<td>0.0</td>
<td>A</td>
<td>NaN</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>221</td>
<td>'01371</td>
<td>Almonds, in shell</td>
<td>5312</td>
<td>Area harvested</td>
<td>1962</td>
<td>1962</td>
<td>ha</td>
<td>0.0</td>
<td>A</td>
<td>NaN</td>
</tr>
<tr>
<th>2</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>221</td>
<td>'01371</td>
<td>Almonds, in shell</td>
<td>5312</td>
<td>Area harvested</td>
<td>1963</td>
<td>1963</td>
<td>ha</td>
<td>0.0</td>
<td>A</td>
<td>NaN</td>
</tr>
<tr>
<th>3</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>221</td>
<td>'01371</td>
<td>Almonds, in shell</td>
<td>5312</td>
<td>Area harvested</td>
<td>1964</td>
<td>1964</td>
<td>ha</td>
<td>0.0</td>
<td>A</td>
<td>NaN</td>
</tr>
<tr>
<th>4</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>221</td>
<td>'01371</td>
<td>Almonds, in shell</td>
<td>5312</td>
<td>Area harvested</td>
<td>1965</td>
<td>1965</td>
<td>ha</td>
<td>0.0</td>
<td>A</td>
<td>NaN</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=df524e55">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[11]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Observem el contingut de la resta de dataframes de Production_Crops_Livestock per veure si realment els necessitem o </span>
<span class="c1"># tota la informaci del dataframe anterior s suficient, ja que sembla que ho cont tot.</span>

<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="p">[</span><span class="s2">"faostat"</span><span class="p">][</span><span class="s2">"Production_Crops_Livestock"</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> 
    <span class="k">if</span> <span class="s1">'All_Data'</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Contingut de </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">:"</span><span class="p">)</span>
        <span class="n">display</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="s2">"faostat"</span><span class="p">][</span><span class="s2">"Production_Crops_Livestock"</span><span class="p">][</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Contingut de Production_Crops_Livestock_E_AreaCodes:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>M49 Code</th>
<th>Area</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
</tr>
<tr>
<th>1</th>
<td>5100</td>
<td>'002</td>
<td>Africa</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>'008</td>
<td>Albania</td>
</tr>
<tr>
<th>3</th>
<td>4</td>
<td>'012</td>
<td>Algeria</td>
</tr>
<tr>
<th>4</th>
<td>5200</td>
<td>'019</td>
<td>Americas</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>

Contingut de Production_Crops_Livestock_E_Elements:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Element Code</th>
<th>Element</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>5312</td>
<td>Area harvested</td>
</tr>
<tr>
<th>1</th>
<td>5423</td>
<td>Extraction Rate</td>
</tr>
<tr>
<th>2</th>
<td>5313</td>
<td>Laying</td>
</tr>
<tr>
<th>3</th>
<td>5318</td>
<td>Milk Animals</td>
</tr>
<tr>
<th>4</th>
<td>5319</td>
<td>Prod Popultn</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>

Contingut de Production_Crops_Livestock_E_Flags:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Flag</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>A</td>
<td>Official figure</td>
</tr>
<tr>
<th>1</th>
<td>E</td>
<td>Estimated value</td>
</tr>
<tr>
<th>2</th>
<td>I</td>
<td>Value imputed by a receiving agency</td>
</tr>
<tr>
<th>3</th>
<td>M</td>
<td>Missing value; data cannot exist</td>
</tr>
<tr>
<th>4</th>
<td>X</td>
<td>Figure from external organization</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>

Contingut de Production_Crops_Livestock_E_ItemCodes:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Item Code</th>
<th>CPC Code</th>
<th>Item</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>101</td>
<td>'01195</td>
<td>Canary seed</td>
</tr>
<tr>
<th>1</th>
<td>1016</td>
<td>'02123</td>
<td>Goats</td>
</tr>
<tr>
<th>2</th>
<td>1017</td>
<td>'21116</td>
<td>Meat of goat; fresh or chilled</td>
</tr>
<tr>
<th>3</th>
<td>1018</td>
<td>'21156</td>
<td>Edible offal of goat; fresh; chilled or frozen</td>
</tr>
<tr>
<th>4</th>
<td>1019</td>
<td>'21515</td>
<td>Goat fat; unrendered</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>

</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=64c32d5f">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[12]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Veiem els valors nics de Element</span>
<span class="n">agri_df</span><span class="p">[</span><span class="s2">"Element"</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[12]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain" tabindex="0">
<pre>array(['Area harvested', 'Yield', 'Production', 'Stocks',
       'Producing Animals/Slaughtered', 'Yield/Carcass Weight', 'Laying',
       'Milk Animals'], dtype=object)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=2eb0e825">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>En aquest cas, no t sentit fer el pivot de les taules ja que les informacions dels elements sn molt diferents.
No tindria sentit tenir una columna de animals per cap cultiu o superficie explotada per animals.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=47c37b1f">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[13]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Lo nic que sembla que podem utilitzar s la descripci de les Flags, aix que ho afegin al dataframe principal</span>
<span class="c1"># i passem a l'anlisi del segent dataset.</span>

<span class="c1"># Carreguem el dataset de Production_Crops_Livestock_E_Flags</span>
<span class="n">flags_df</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="s2">"faostat"</span><span class="p">][</span><span class="s2">"Production_Crops_Livestock"</span><span class="p">][</span><span class="s2">"Production_Crops_Livestock_E_Flags"</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Elimina espais inicials i finals dels noms de les columnes de flags_df</span>
<span class="c1"># Hem hagut de debuggear el nom de la columna 'Flag' perqu no coincidia amb el nom de la columna del dataframe principal</span>
<span class="c1"># i el motiu era l'espai que hi havia al nom de la columna.</span>
<span class="n">flags_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">flags_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>


<span class="c1"># Afegim la descripci de les flags al dataframe principal</span>
<span class="c1"># Renombrem 'Description' a 'Flag_Description' per afegir-la al dataframe principal </span>
<span class="c1"># i eliminem la columna 'Note' que no utilitzarem</span>
<span class="n">flags_df</span> <span class="o">=</span> <span class="n">flags_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">'Description'</span><span class="p">:</span> <span class="s1">'Flag_Description'</span><span class="p">})</span>
<span class="n">agri_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">agri_df</span><span class="p">,</span> <span class="n">flags_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">'Flag'</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">'left'</span><span class="p">)</span>
<span class="n">agri_df</span> <span class="o">=</span> <span class="n">agri_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'Note'</span><span class="p">])</span>

<span class="c1"># Fem el display amb Spain per veure alguna dada en concret.</span>
<span class="n">display</span><span class="p">(</span>
    <span class="n">agri_df</span><span class="p">[</span>
        <span class="p">(</span><span class="n">agri_df</span><span class="p">[</span><span class="s1">'Area'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'Spain'</span><span class="p">)</span> <span class="o">&amp;</span>
        <span class="p">(</span><span class="n">agri_df</span><span class="p">[</span><span class="s1">'Item'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'Apples'</span><span class="p">)</span> <span class="o">&amp;</span>
        <span class="p">(</span><span class="n">agri_df</span><span class="p">[</span><span class="s1">'Value'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Item Code</th>
<th>Item Code (CPC)</th>
<th>Item</th>
<th>Element Code</th>
<th>Element</th>
<th>Year Code</th>
<th>Year</th>
<th>Unit</th>
<th>Value</th>
<th>Flag</th>
<th>Flag_Description</th>
</tr>
</thead>
<tbody>
<tr>
<th>2562065</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>515</td>
<td>'01341</td>
<td>Apples</td>
<td>5312</td>
<td>Area harvested</td>
<td>1961</td>
<td>1961</td>
<td>ha</td>
<td>16800.0</td>
<td>A</td>
<td>Official figure</td>
</tr>
<tr>
<th>2562066</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>515</td>
<td>'01341</td>
<td>Apples</td>
<td>5312</td>
<td>Area harvested</td>
<td>1962</td>
<td>1962</td>
<td>ha</td>
<td>17400.0</td>
<td>A</td>
<td>Official figure</td>
</tr>
<tr>
<th>2562067</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>515</td>
<td>'01341</td>
<td>Apples</td>
<td>5312</td>
<td>Area harvested</td>
<td>1963</td>
<td>1963</td>
<td>ha</td>
<td>18100.0</td>
<td>A</td>
<td>Official figure</td>
</tr>
<tr>
<th>2562068</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>515</td>
<td>'01341</td>
<td>Apples</td>
<td>5312</td>
<td>Area harvested</td>
<td>1964</td>
<td>1964</td>
<td>ha</td>
<td>22200.0</td>
<td>A</td>
<td>Official figure</td>
</tr>
<tr>
<th>2562069</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>515</td>
<td>'01341</td>
<td>Apples</td>
<td>5312</td>
<td>Area harvested</td>
<td>1965</td>
<td>1965</td>
<td>ha</td>
<td>26400.0</td>
<td>A</td>
<td>Official figure</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=8f31aaea">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Pas-2:-An%C3%A0lisi-d'altres-datasets-per-enriquir-agri_df">Pas 2: Anlisi d'altres datasets per enriquir <code>agri_df</code><a class="anchor-link" href="#Pas-2:-An%C3%A0lisi-d'altres-datasets-per-enriquir-agri_df"></a></h3><p>Ara l'objectiu s tenir ms informaci per afegir a <code>agri_df</code> i construir el dataframe final <code>agri_product_df</code>. Per aix, analitzarem els altres dataframes disponibles per veure quina informaci poden aportar.</p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=5260b0ac">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="An%C3%A0lisi-del-dataset-Prices">Anlisi del dataset <code>Prices</code><a class="anchor-link" href="#An%C3%A0lisi-del-dataset-Prices"></a></h3><p>Analitzem el dataset de Prices per veure quina informaci cont i com podem integrar-la al dataframe final.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=486f1ffa">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[14]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Analitzar el dataset de Prices</span>
<span class="n">analitzar_dataset_faostat</span><span class="p">(</span><span class="s1">'Prices'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Anlisi del dataset: Prices

Dataframe principal (Prices_E_All_Data_(Normalized)):
Dimensions: 1,664,300 files x 15 columnes

 Columnes (15):
   1. Area Code
   2. Area Code (M49)
   3. Area
   4. Item Code
   5. Item Code (CPC)
   6. Item
   7. Element Code
   8. Element
   9. Year Code
  10. Year
  11. Months Code
  12. Months
  13. Unit
  14. Value
  15. Flag

 Primeres files del dataframe principal:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Item Code</th>
<th>Item Code (CPC)</th>
<th>Item</th>
<th>Element Code</th>
<th>Element</th>
<th>Year Code</th>
<th>Year</th>
<th>Months Code</th>
<th>Months</th>
<th>Unit</th>
<th>Value</th>
<th>Flag</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>221</td>
<td>'01371</td>
<td>Almonds, in shell</td>
<td>5530</td>
<td>Producer Price (LCU/tonne)</td>
<td>1993</td>
<td>1993</td>
<td>7021</td>
<td>Annual value</td>
<td>LCU</td>
<td>46000.0</td>
<td>A</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>221</td>
<td>'01371</td>
<td>Almonds, in shell</td>
<td>5530</td>
<td>Producer Price (LCU/tonne)</td>
<td>1994</td>
<td>1994</td>
<td>7021</td>
<td>Annual value</td>
<td>LCU</td>
<td>50000.0</td>
<td>A</td>
</tr>
<tr>
<th>2</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>221</td>
<td>'01371</td>
<td>Almonds, in shell</td>
<td>5530</td>
<td>Producer Price (LCU/tonne)</td>
<td>1995</td>
<td>1995</td>
<td>7021</td>
<td>Annual value</td>
<td>LCU</td>
<td>62000.0</td>
<td>A</td>
</tr>
<tr>
<th>3</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>221</td>
<td>'01371</td>
<td>Almonds, in shell</td>
<td>5530</td>
<td>Producer Price (LCU/tonne)</td>
<td>1996</td>
<td>1996</td>
<td>7021</td>
<td>Annual value</td>
<td>LCU</td>
<td>50000.0</td>
<td>A</td>
</tr>
<tr>
<th>4</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>221</td>
<td>'01371</td>
<td>Almonds, in shell</td>
<td>5530</td>
<td>Producer Price (LCU/tonne)</td>
<td>1997</td>
<td>1997</td>
<td>7021</td>
<td>Annual value</td>
<td>LCU</td>
<td>41000.0</td>
<td>A</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
 Valors nics de la columna 'Item':
Total nics: 235 (mostrant com a mxim 50)
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Item</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Almonds, in shell</td>
</tr>
<tr>
<th>1</th>
<td>Anise, badian, coriander, cumin, caraway, fennel and juniper berries, raw</td>
</tr>
<tr>
<th>2</th>
<td>Apples</td>
</tr>
<tr>
<th>3</th>
<td>Apricots</td>
</tr>
<tr>
<th>4</th>
<td>Barley</td>
</tr>
<tr>
<th>5</th>
<td>Cantaloupes and other melons</td>
</tr>
<tr>
<th>6</th>
<td>Cotton lint, ginned</td>
</tr>
<tr>
<th>7</th>
<td>Cotton seed</td>
</tr>
<tr>
<th>8</th>
<td>Figs</td>
</tr>
<tr>
<th>9</th>
<td>Game meat, fresh, chilled or frozen</td>
</tr>
<tr>
<th>10</th>
<td>Grapes</td>
</tr>
<tr>
<th>11</th>
<td>Hen eggs in shell, fresh</td>
</tr>
<tr>
<th>12</th>
<td>Linseed</td>
</tr>
<tr>
<th>13</th>
<td>Maize (corn)</td>
</tr>
<tr>
<th>14</th>
<td>Meat of camels, fresh or chilled</td>
</tr>
<tr>
<th>15</th>
<td>Meat of camels, fresh or chilled (biological)</td>
</tr>
<tr>
<th>16</th>
<td>Meat of cattle with the bone, fresh or chilled</td>
</tr>
<tr>
<th>17</th>
<td>Meat of cattle with the bone, fresh or chilled (biological)</td>
</tr>
<tr>
<th>18</th>
<td>Meat of chickens, fresh or chilled</td>
</tr>
<tr>
<th>19</th>
<td>Meat of chickens, fresh or chilled (biological)</td>
</tr>
<tr>
<th>20</th>
<td>Meat of goat, fresh or chilled</td>
</tr>
<tr>
<th>21</th>
<td>Meat of goat, fresh or chilled (biological)</td>
</tr>
<tr>
<th>22</th>
<td>Meat of sheep, fresh or chilled</td>
</tr>
<tr>
<th>23</th>
<td>Meat of sheep, fresh or chilled (biological)</td>
</tr>
<tr>
<th>24</th>
<td>Millet</td>
</tr>
<tr>
<th>25</th>
<td>Natural honey</td>
</tr>
<tr>
<th>26</th>
<td>Olives</td>
</tr>
<tr>
<th>27</th>
<td>Oranges</td>
</tr>
<tr>
<th>28</th>
<td>Other citrus fruit, n.e.c.</td>
</tr>
<tr>
<th>29</th>
<td>Other nuts (excluding wild edible nuts and groundnuts), in shell, n.e.c.</td>
</tr>
<tr>
<th>30</th>
<td>Other pulses n.e.c.</td>
</tr>
<tr>
<th>31</th>
<td>Other stone fruits</td>
</tr>
<tr>
<th>32</th>
<td>Peaches and nectarines</td>
</tr>
<tr>
<th>33</th>
<td>Pears</td>
</tr>
<tr>
<th>34</th>
<td>Pistachios, in shell</td>
</tr>
<tr>
<th>35</th>
<td>Plums and sloes</td>
</tr>
<tr>
<th>36</th>
<td>Potatoes</td>
</tr>
<tr>
<th>37</th>
<td>Raw milk of camel</td>
</tr>
<tr>
<th>38</th>
<td>Raw milk of cattle</td>
</tr>
<tr>
<th>39</th>
<td>Raw milk of goats</td>
</tr>
<tr>
<th>40</th>
<td>Raw milk of sheep</td>
</tr>
<tr>
<th>41</th>
<td>Rice</td>
</tr>
<tr>
<th>42</th>
<td>Seed cotton, unginned</td>
</tr>
<tr>
<th>43</th>
<td>Sesame seed</td>
</tr>
<tr>
<th>44</th>
<td>Shorn wool, greasy, including fleece-washed shorn wool</td>
</tr>
<tr>
<th>45</th>
<td>Silk-worm cocoons suitable for reeling</td>
</tr>
<tr>
<th>46</th>
<td>Sugar cane</td>
</tr>
<tr>
<th>47</th>
<td>Sunflower seed</td>
</tr>
<tr>
<th>48</th>
<td>Walnuts, in shell</td>
</tr>
<tr>
<th>49</th>
<td>Watermelons</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
 Valors nics de la columna 'Element':
Total nics: 4 (mostrant com a mxim 50)
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Element</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Producer Price (LCU/tonne)</td>
</tr>
<tr>
<th>1</th>
<td>Producer Price (SLC/tonne)</td>
</tr>
<tr>
<th>2</th>
<td>Producer Price Index (2014-2016 = 100)</td>
</tr>
<tr>
<th>3</th>
<td>Producer Price (USD/tonne)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre> Altres dataframes de Prices:

 Contingut de Prices_E_AreaCodes:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>M49 Code</th>
<th>Area</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
</tr>
<tr>
<th>1</th>
<td>5100</td>
<td>'002</td>
<td>Africa</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>'008</td>
<td>Albania</td>
</tr>
<tr>
<th>3</th>
<td>4</td>
<td>'012</td>
<td>Algeria</td>
</tr>
<tr>
<th>4</th>
<td>5200</td>
<td>'019</td>
<td>Americas</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>


 Contingut de Prices_E_Elements:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Element Code</th>
<th>Element</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>5530</td>
<td>Producer Price (LCU/tonne)</td>
</tr>
<tr>
<th>1</th>
<td>5531</td>
<td>Producer Price (SLC/tonne)</td>
</tr>
<tr>
<th>2</th>
<td>5532</td>
<td>Producer Price (USD/tonne)</td>
</tr>
<tr>
<th>3</th>
<td>5539</td>
<td>Producer Price Index (2014-2016 = 100)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>


 Contingut de Prices_E_Flags:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Flag</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>A</td>
<td>Official figure</td>
</tr>
<tr>
<th>1</th>
<td>F</td>
<td>Forecast value</td>
</tr>
<tr>
<th>2</th>
<td>I</td>
<td>Value imputed by a receiving agency</td>
</tr>
<tr>
<th>3</th>
<td>X</td>
<td>Figure from external organization</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>


 Contingut de Prices_E_ItemCodes:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Item Code</th>
<th>CPC Code</th>
<th>Item</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>101</td>
<td>'01195</td>
<td>Canary seed</td>
</tr>
<tr>
<th>1</th>
<td>1013</td>
<td>'21115b</td>
<td>Meat of sheep; fresh or chilled (biological)</td>
</tr>
<tr>
<th>2</th>
<td>1017</td>
<td>'21116</td>
<td>Meat of goat; fresh or chilled</td>
</tr>
<tr>
<th>3</th>
<td>1020</td>
<td>'02292</td>
<td>Raw milk of goats</td>
</tr>
<tr>
<th>4</th>
<td>103</td>
<td>'01199.02</td>
<td>Mixed grain</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>

</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=a93ec010">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Creaci%C3%B3-de-prices_df">Creaci de <code>prices_df</code><a class="anchor-link" href="#Creaci%C3%B3-de-prices_df"></a></h3><p>Creem el dataframe de Prices basat en el dataset principal de Prices.</p>
<p>Del domini Prices hem seleccionat els tres tipus de preus de productor disponibles (LCU/tonne, SLC/tonne i USD/tonne) per permetre comparacions locals i internacionals. Aquests indicadors reflecteixen el valor econmic dels productes agrcoles i permeten analitzar la rendibilitat i l'evoluci dels mercats. Filtrem per 'Annual value' per tenir valors agregats anuals consistents amb la resta de datasets.</p>
<p><strong>Transformacions realitzades:</strong></p>
<ul>
<li>Eliminem les columnes <code>Note</code> i <code>Flag</code> (informaci no utilitzable per a l'anlisi)</li>
<li>Renombrem columnes: <code>Element</code> a <code>price_unit</code>, <code>Element Code</code> a <code>price_unit_code</code></li>
<li>Filtrar per elements: Producer Price (LCU/tonne), Producer Price (SLC/tonne), Producer Price (USD/tonne)</li>
<li>Filtrar per Months: 'Annual value'</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=4b4b22b1">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[15]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Crear prices_df utilitzant la funci generalitzada</span>
<span class="n">key</span> <span class="o">=</span> <span class="s1">'Prices'</span>
<span class="n">df_name</span> <span class="o">=</span> <span class="s1">'prices_df'</span>
<span class="n">column_mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'Element Code'</span><span class="p">:</span> <span class="s1">'price_unit_code'</span><span class="p">,</span>
    <span class="s1">'Element'</span><span class="p">:</span> <span class="s1">'price_unit'</span>
<span class="p">}</span>
<span class="n">values_to_keep</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'price_unit'</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">'Producer Price (LCU/tonne)'</span><span class="p">,</span>
        <span class="s1">'Producer Price (SLC/tonne)'</span><span class="p">,</span>
        <span class="s1">'Producer Price (USD/tonne)'</span>
    <span class="p">],</span>
    <span class="s1">'Months'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Annual value'</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">prices_df</span> <span class="o">=</span> <span class="n">crear_df_faostat_filtrat</span><span class="p">(</span>
    <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
    <span class="n">df_name</span><span class="o">=</span><span class="n">df_name</span><span class="p">,</span>
    <span class="n">column_mapping</span><span class="o">=</span><span class="n">column_mapping</span><span class="p">,</span>
    <span class="n">values_to_keep</span><span class="o">=</span><span class="n">values_to_keep</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Creaci de prices_df

Valors diferents de 'Unit':
price_unit                  Months      
Producer Price (LCU/tonne)  Annual value    [LCU]
Producer Price (SLC/tonne)  Annual value    [SLC]
Producer Price (USD/tonne)  Annual value    [USD]
Name: Unit, dtype: object

Dimensions finals: 884,623 files x 14 columnes

Columnes finals (14):
   1. Area Code
   2. Area Code (M49)
   3. Area
   4. Item Code
   5. Item Code (CPC)
   6. Item
   7. price_unit_code
   8. price_unit
   9. Year Code
  10. Year
  11. Months Code
  12. Months
  13. Unit
  14. Value

Primeres files de prices_df:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Item Code</th>
<th>Item Code (CPC)</th>
<th>Item</th>
<th>price_unit_code</th>
<th>price_unit</th>
<th>Year Code</th>
<th>Year</th>
<th>Months Code</th>
<th>Months</th>
<th>Unit</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>221</td>
<td>'01371</td>
<td>Almonds, in shell</td>
<td>5530</td>
<td>Producer Price (LCU/tonne)</td>
<td>1993</td>
<td>1993</td>
<td>7021</td>
<td>Annual value</td>
<td>LCU</td>
<td>46000.0</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>221</td>
<td>'01371</td>
<td>Almonds, in shell</td>
<td>5530</td>
<td>Producer Price (LCU/tonne)</td>
<td>1994</td>
<td>1994</td>
<td>7021</td>
<td>Annual value</td>
<td>LCU</td>
<td>50000.0</td>
</tr>
<tr>
<th>2</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>221</td>
<td>'01371</td>
<td>Almonds, in shell</td>
<td>5530</td>
<td>Producer Price (LCU/tonne)</td>
<td>1995</td>
<td>1995</td>
<td>7021</td>
<td>Annual value</td>
<td>LCU</td>
<td>62000.0</td>
</tr>
<tr>
<th>3</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>221</td>
<td>'01371</td>
<td>Almonds, in shell</td>
<td>5530</td>
<td>Producer Price (LCU/tonne)</td>
<td>1996</td>
<td>1996</td>
<td>7021</td>
<td>Annual value</td>
<td>LCU</td>
<td>50000.0</td>
</tr>
<tr>
<th>4</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>221</td>
<td>'01371</td>
<td>Almonds, in shell</td>
<td>5530</td>
<td>Producer Price (LCU/tonne)</td>
<td>1997</td>
<td>1997</td>
<td>7021</td>
<td>Annual value</td>
<td>LCU</td>
<td>41000.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
Resum de valors nics:
  - price_unit nics: 3 a ['Producer Price (LCU/tonne)', 'Producer Price (SLC/tonne)', 'Producer Price (USD/tonne)']
  - Months nics: 1 a ['Annual value']
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=e5299590">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Pivot-de-prices_df">Pivot de <code>prices_df</code><a class="anchor-link" href="#Pivot-de-prices_df"></a></h3><p>Realitzem el pivot per tenir una columna per cada combinaci de producte agrcola i unitat de preu.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=67f3fb51">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[16]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Crear la columna pivot_col amb el format simplificat</span>
<span class="n">prices_df</span><span class="p">[</span><span class="s2">"pivot_col"</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">"Value_"</span>
    <span class="o">+</span> <span class="n">prices_df</span><span class="p">[</span><span class="s2">"price_unit"</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'Producer Price ('</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">')'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">prices_pivot</span> <span class="o">=</span> <span class="n">pivot_faostat_df</span><span class="p">(</span>
    <span class="n">df_to_pivot</span> <span class="o">=</span> <span class="n">prices_df</span><span class="p">,</span>
    <span class="n">index_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Area Code"</span><span class="p">,</span> <span class="s2">"Area Code (M49)"</span><span class="p">,</span> <span class="s2">"Area"</span><span class="p">,</span> <span class="s2">"Item Code"</span><span class="p">,</span> <span class="s2">"Item Code (CPC)"</span><span class="p">,</span> <span class="s2">"Item"</span><span class="p">,</span> <span class="s2">"Year Code"</span><span class="p">,</span> <span class="s2">"Year"</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Item Code</th>
<th>Item Code (CPC)</th>
<th>Item</th>
<th>Year Code</th>
<th>Year</th>
<th>Value_LCU/tonne</th>
<th>Value_SLC/tonne</th>
<th>Value_USD/tonne</th>
</tr>
</thead>
<tbody>
<tr>
<th>248929</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>15</td>
<td>'0111</td>
<td>Wheat</td>
<td>1991</td>
<td>1991</td>
<td>27653.0</td>
<td>166.2</td>
<td>266.1</td>
</tr>
<tr>
<th>248930</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>15</td>
<td>'0111</td>
<td>Wheat</td>
<td>1992</td>
<td>1992</td>
<td>26755.0</td>
<td>160.8</td>
<td>261.3</td>
</tr>
<tr>
<th>248931</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>15</td>
<td>'0111</td>
<td>Wheat</td>
<td>1993</td>
<td>1993</td>
<td>26772.0</td>
<td>160.9</td>
<td>210.4</td>
</tr>
<tr>
<th>248932</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>15</td>
<td>'0111</td>
<td>Wheat</td>
<td>1994</td>
<td>1994</td>
<td>26838.0</td>
<td>161.3</td>
<td>200.3</td>
</tr>
<tr>
<th>248933</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>15</td>
<td>'0111</td>
<td>Wheat</td>
<td>1995</td>
<td>1995</td>
<td>28252.0</td>
<td>169.8</td>
<td>226.6</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=abd49033">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Merge-de-prices_df-amb-el-dataframe-principal">Merge de <code>prices_df</code> amb el dataframe principal<a class="anchor-link" href="#Merge-de-prices_df-amb-el-dataframe-principal"></a></h3><p>Un cop creat el pivot, farem el merge amb el dataframe principal utilitzant la funci <code>merge_agri_dataframes</code>.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=ae4c2616">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[17]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Fer el merge utilitzant la funci generalitzada</span>
<span class="n">agri_prices_df</span> <span class="o">=</span> <span class="n">merge_agri_dataframes</span><span class="p">(</span>
    <span class="n">df_initial</span><span class="o">=</span><span class="n">agri_df</span><span class="p">,</span>
    <span class="n">df_to_merge</span><span class="o">=</span><span class="n">prices_pivot</span><span class="p">,</span>
    <span class="n">df_name_initial</span><span class="o">=</span><span class="s2">"agri_df"</span><span class="p">,</span>
    <span class="n">df_name_to_merge</span><span class="o">=</span><span class="s2">"prices_pivot"</span><span class="p">,</span>
    <span class="n">merge_cols</span><span class="o">=</span><span class="p">[</span><span class="s2">"Area Code"</span><span class="p">,</span> <span class="s2">"Area Code (M49)"</span><span class="p">,</span> <span class="s2">"Area"</span><span class="p">,</span> <span class="s2">"Item Code"</span><span class="p">,</span> <span class="s2">"Item Code (CPC)"</span><span class="p">,</span> <span class="s2">"Item"</span><span class="p">,</span> <span class="s2">"Year Code"</span><span class="p">,</span> <span class="s2">"Year"</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Nombre de files de agri_df: 4116252
Nombre de columnes de agri_df: 14
Nombre de files de prices_pivot: 305036
Nombre de columnes de prices_pivot: 11
Nombre final de files del resultat: 4116252
Nombre final de columnes del resultat: 17
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Item Code</th>
<th>Item Code (CPC)</th>
<th>Item</th>
<th>Element Code</th>
<th>Element</th>
<th>Year Code</th>
<th>Year</th>
<th>Unit</th>
<th>Value</th>
<th>Flag</th>
<th>Flag_Description</th>
<th>Value_LCU/tonne</th>
<th>Value_SLC/tonne</th>
<th>Value_USD/tonne</th>
</tr>
</thead>
<tbody>
<tr>
<th>2561788</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>221</td>
<td>'01371</td>
<td>Almonds, in shell</td>
<td>5312</td>
<td>Area harvested</td>
<td>2020</td>
<td>2020</td>
<td>ha</td>
<td>718540.0</td>
<td>A</td>
<td>Official figure</td>
<td>1054.5</td>
<td>1054.5</td>
<td>1204.4</td>
</tr>
<tr>
<th>2561851</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>221</td>
<td>'01371</td>
<td>Almonds, in shell</td>
<td>5412</td>
<td>Yield</td>
<td>2020</td>
<td>2020</td>
<td>kg/ha</td>
<td>580.3</td>
<td>A</td>
<td>Official figure</td>
<td>1054.5</td>
<td>1054.5</td>
<td>1204.4</td>
</tr>
<tr>
<th>2561914</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>221</td>
<td>'01371</td>
<td>Almonds, in shell</td>
<td>5510</td>
<td>Production</td>
<td>2020</td>
<td>2020</td>
<td>t</td>
<td>416950.0</td>
<td>A</td>
<td>Official figure</td>
<td>1054.5</td>
<td>1054.5</td>
<td>1204.4</td>
</tr>
<tr>
<th>2562124</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>515</td>
<td>'01341</td>
<td>Apples</td>
<td>5312</td>
<td>Area harvested</td>
<td>2020</td>
<td>2020</td>
<td>ha</td>
<td>29490.0</td>
<td>A</td>
<td>Official figure</td>
<td>499.0</td>
<td>499.0</td>
<td>570.0</td>
</tr>
<tr>
<th>2562187</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>515</td>
<td>'01341</td>
<td>Apples</td>
<td>5412</td>
<td>Yield</td>
<td>2020</td>
<td>2020</td>
<td>kg/ha</td>
<td>17704.3</td>
<td>A</td>
<td>Official figure</td>
<td>499.0</td>
<td>499.0</td>
<td>570.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=a0e8dd0e">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Construcci%C3%B3-de-agri_country_year_df">Construcci de <code>agri_country_year_df</code><a class="anchor-link" href="#Construcci%C3%B3-de-agri_country_year_df"></a></h3>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=84457cb0">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Comencem a analitzar el datasets que no dependran del producte, si no nicament del pas i l'any</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=3c9ed8c7">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[18]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Comenarem per analitzar el dataset de FertilizersNutrient per veure quina informaci cont i com podem integrar-la.</span>

<span class="n">analitzar_dataset_faostat</span><span class="p">(</span><span class="s1">'Inputs_FertilizersNutrient'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Anlisi del dataset: Inputs_FertilizersNutrient

Dataframe principal (Inputs_FertilizersNutrient_E_All_Data_(Normalized)):
Dimensions: 241,859 files x 13 columnes

 Columnes (13):
   1. Area Code
   2. Area Code (M49)
   3. Area
   4. Item Code
   5. Item
   6. Element Code
   7. Element
   8. Year Code
   9. Year
  10. Unit
  11. Value
  12. Flag
  13. Note

 Primeres files del dataframe principal:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Item Code</th>
<th>Item</th>
<th>Element Code</th>
<th>Element</th>
<th>Year Code</th>
<th>Year</th>
<th>Unit</th>
<th>Value</th>
<th>Flag</th>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3102</td>
<td>Nutrient nitrogen N (total)</td>
<td>5510</td>
<td>Production</td>
<td>1974</td>
<td>1974</td>
<td>t</td>
<td>19117.0</td>
<td>A</td>
<td>Official data from questionnaire</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3102</td>
<td>Nutrient nitrogen N (total)</td>
<td>5510</td>
<td>Production</td>
<td>1975</td>
<td>1975</td>
<td>t</td>
<td>14774.0</td>
<td>A</td>
<td>Official data from questionnaire</td>
</tr>
<tr>
<th>2</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3102</td>
<td>Nutrient nitrogen N (total)</td>
<td>5510</td>
<td>Production</td>
<td>1976</td>
<td>1976</td>
<td>t</td>
<td>26203.0</td>
<td>A</td>
<td>Official data from questionnaire</td>
</tr>
<tr>
<th>3</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3102</td>
<td>Nutrient nitrogen N (total)</td>
<td>5510</td>
<td>Production</td>
<td>1977</td>
<td>1977</td>
<td>t</td>
<td>37689.0</td>
<td>A</td>
<td>Official data from questionnaire</td>
</tr>
<tr>
<th>4</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3102</td>
<td>Nutrient nitrogen N (total)</td>
<td>5510</td>
<td>Production</td>
<td>1978</td>
<td>1978</td>
<td>t</td>
<td>48300.0</td>
<td>A</td>
<td>Official data from questionnaire</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
 Valors nics de la columna 'Item':
Total nics: 3 (mostrant com a mxim 50)
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Item</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Nutrient nitrogen N (total)</td>
</tr>
<tr>
<th>1</th>
<td>Nutrient phosphate P2O5 (total)</td>
</tr>
<tr>
<th>2</th>
<td>Nutrient potash K2O (total)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
 Valors nics de la columna 'Element':
Total nics: 7 (mostrant com a mxim 50)
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Element</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Production</td>
</tr>
<tr>
<th>1</th>
<td>Import quantity</td>
</tr>
<tr>
<th>2</th>
<td>Export quantity</td>
</tr>
<tr>
<th>3</th>
<td>Agricultural Use</td>
</tr>
<tr>
<th>4</th>
<td>Use per area of cropland</td>
</tr>
<tr>
<th>5</th>
<td>Use per capita</td>
</tr>
<tr>
<th>6</th>
<td>Use per value of agricultural production</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre> Altres dataframes de Inputs_FertilizersNutrient:

 Contingut de Inputs_FertilizersNutrient_E_AreaCodes:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>M49 Code</th>
<th>Area</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
</tr>
<tr>
<th>1</th>
<td>5100</td>
<td>'002</td>
<td>Africa</td>
</tr>
<tr>
<th>2</th>
<td>51000</td>
<td>'002.03</td>
<td>Africa (excluding intra-trade)</td>
</tr>
<tr>
<th>3</th>
<td>3</td>
<td>'008</td>
<td>Albania</td>
</tr>
<tr>
<th>4</th>
<td>4</td>
<td>'012</td>
<td>Algeria</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>


 Contingut de Inputs_FertilizersNutrient_E_Elements:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Element Code</th>
<th>Element</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>5157</td>
<td>Agricultural Use</td>
</tr>
<tr>
<th>1</th>
<td>5910</td>
<td>Export quantity</td>
</tr>
<tr>
<th>2</th>
<td>5610</td>
<td>Import quantity</td>
</tr>
<tr>
<th>3</th>
<td>5510</td>
<td>Production</td>
</tr>
<tr>
<th>4</th>
<td>5159</td>
<td>Use per area of cropland</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>


 Contingut de Inputs_FertilizersNutrient_E_Flags:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Flag</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>A</td>
<td>Official figure</td>
</tr>
<tr>
<th>1</th>
<td>B</td>
<td>Time series break</td>
</tr>
<tr>
<th>2</th>
<td>E</td>
<td>Estimated value</td>
</tr>
<tr>
<th>3</th>
<td>I</td>
<td>Value imputed by a receiving agency</td>
</tr>
<tr>
<th>4</th>
<td>X</td>
<td>Figure from external organization</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>


 Contingut de Inputs_FertilizersNutrient_E_ItemCodes:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Item Code</th>
<th>CPC Code</th>
<th>Item</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>3102</td>
<td>'F3102</td>
<td>Nutrient nitrogen N (total)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>

</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=47b93e0d">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Processament-de-fertilizers_df">Processament de <code>fertilizers_df</code><a class="anchor-link" href="#Processament-de-fertilizers_df"></a></h3><p>Creem el dataframe de fertilitzants basat en el dataset principal de Inputs_FertilizersNutrient.</p>
<p><strong>Transformacions realitzades:</strong></p>
<ul>
<li>Eliminem les columnes <code>Note</code> i <code>Flag</code> (informaci no utilitzable per a l'anlisi)</li>
<li>Renombrem columnes per a millor claredat</li>
<li>Fem mapping dels nutrients per simplificar els noms</li>
<li>Filtrar els elements per quedar-nos noms amb els indicadors rellevants per a l'anlisi agrcola</li>
<li>L'objectiu s tenir un registre per cada Area x Year</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=75d4441d">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[19]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Crear fertilizers_df utilitzant la funci generalitzada</span>
<span class="n">key</span> <span class="o">=</span> <span class="s1">'Inputs_FertilizersNutrient'</span>
<span class="n">df_name</span> <span class="o">=</span> <span class="s1">'fertilizers_df'</span>
<span class="n">column_mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'Item Code'</span><span class="p">:</span> <span class="s1">'nutrient_code'</span><span class="p">,</span>
    <span class="s1">'Item'</span><span class="p">:</span> <span class="s1">'nutrient'</span><span class="p">,</span>
    <span class="s1">'Element Code'</span><span class="p">:</span> <span class="s1">'fertilizer_metric_code'</span><span class="p">,</span>
    <span class="s1">'Element'</span><span class="p">:</span> <span class="s1">'fertilizer_metric'</span>
<span class="p">}</span>
<span class="n">values_to_keep</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'fertilizer_metric'</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">'Agricultural Use'</span><span class="p">,</span>
        <span class="s1">'Use per area of cropland'</span><span class="p">,</span>
        <span class="s1">'Use per capita'</span><span class="p">,</span>
        <span class="s1">'Use per value of agricultural production'</span>
    <span class="p">]</span>
<span class="p">}</span>

<span class="n">fertilizers_df</span> <span class="o">=</span> <span class="n">crear_df_faostat_filtrat</span><span class="p">(</span>
    <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
    <span class="n">df_name</span><span class="o">=</span><span class="n">df_name</span><span class="p">,</span>
    <span class="n">column_mapping</span><span class="o">=</span><span class="n">column_mapping</span><span class="p">,</span>
    <span class="n">values_to_keep</span><span class="o">=</span><span class="n">values_to_keep</span>
<span class="p">)</span>

<span class="c1"># Mapping dels nutrients</span>
<span class="n">nutrient_mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'Nutrient nitrogen N (total)'</span><span class="p">:</span> <span class="s1">'N'</span><span class="p">,</span>
    <span class="s1">'Nutrient phosphate P2O5 (total)'</span><span class="p">:</span> <span class="s1">'P2O5'</span><span class="p">,</span>
    <span class="s1">'Nutrient potash K2O (total)'</span><span class="p">:</span> <span class="s1">'K2O'</span>
<span class="p">}</span>
<span class="n">fertilizers_df</span><span class="p">[</span><span class="s1">'nutrient'</span><span class="p">]</span> <span class="o">=</span> <span class="n">fertilizers_df</span><span class="p">[</span><span class="s1">'nutrient'</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">nutrient_mapping</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">fertilizers_df</span><span class="p">[</span><span class="s1">'nutrient'</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Mapping de nutrients aplicat"</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">fertilizers_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Creaci de fertilizers_df

Valors diferents de 'Unit':
fertilizer_metric
Agricultural Use                                 [t]
Use per area of cropland                     [kg/ha]
Use per capita                              [kg/cap]
Use per value of agricultural production    [g/Int$]
Name: Unit, dtype: object

Dimensions finals: 147,437 files x 11 columnes

Columnes finals (11):
   1. Area Code
   2. Area Code (M49)
   3. Area
   4. nutrient_code
   5. nutrient
   6. fertilizer_metric_code
   7. fertilizer_metric
   8. Year Code
   9. Year
  10. Unit
  11. Value

Primeres files de fertilizers_df:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>nutrient_code</th>
<th>nutrient</th>
<th>fertilizer_metric_code</th>
<th>fertilizer_metric</th>
<th>Year Code</th>
<th>Year</th>
<th>Unit</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<th>161</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3102</td>
<td>Nutrient nitrogen N (total)</td>
<td>5157</td>
<td>Agricultural Use</td>
<td>1961</td>
<td>1961</td>
<td>t</td>
<td>1000.0</td>
</tr>
<tr>
<th>162</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3102</td>
<td>Nutrient nitrogen N (total)</td>
<td>5157</td>
<td>Agricultural Use</td>
<td>1962</td>
<td>1962</td>
<td>t</td>
<td>1000.0</td>
</tr>
<tr>
<th>163</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3102</td>
<td>Nutrient nitrogen N (total)</td>
<td>5157</td>
<td>Agricultural Use</td>
<td>1963</td>
<td>1963</td>
<td>t</td>
<td>1000.0</td>
</tr>
<tr>
<th>164</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3102</td>
<td>Nutrient nitrogen N (total)</td>
<td>5157</td>
<td>Agricultural Use</td>
<td>1964</td>
<td>1964</td>
<td>t</td>
<td>1000.0</td>
</tr>
<tr>
<th>165</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3102</td>
<td>Nutrient nitrogen N (total)</td>
<td>5157</td>
<td>Agricultural Use</td>
<td>1965</td>
<td>1965</td>
<td>t</td>
<td>1000.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
Resum de valors nics:
  - fertilizer_metric nics: 4 a ['Agricultural Use', 'Use per area of cropland', 'Use per capita', 'Use per value of agricultural production']

Mapping de nutrients aplicat
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>nutrient_code</th>
<th>nutrient</th>
<th>fertilizer_metric_code</th>
<th>fertilizer_metric</th>
<th>Year Code</th>
<th>Year</th>
<th>Unit</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<th>161</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3102</td>
<td>N</td>
<td>5157</td>
<td>Agricultural Use</td>
<td>1961</td>
<td>1961</td>
<td>t</td>
<td>1000.0</td>
</tr>
<tr>
<th>162</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3102</td>
<td>N</td>
<td>5157</td>
<td>Agricultural Use</td>
<td>1962</td>
<td>1962</td>
<td>t</td>
<td>1000.0</td>
</tr>
<tr>
<th>163</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3102</td>
<td>N</td>
<td>5157</td>
<td>Agricultural Use</td>
<td>1963</td>
<td>1963</td>
<td>t</td>
<td>1000.0</td>
</tr>
<tr>
<th>164</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3102</td>
<td>N</td>
<td>5157</td>
<td>Agricultural Use</td>
<td>1964</td>
<td>1964</td>
<td>t</td>
<td>1000.0</td>
</tr>
<tr>
<th>165</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3102</td>
<td>N</td>
<td>5157</td>
<td>Agricultural Use</td>
<td>1965</td>
<td>1965</td>
<td>t</td>
<td>1000.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=fddd16fd">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Amb l'objectiu de tenir un registre per cada Area x Year, fem un pivot de fertilizers_df per la metrica.</p>
<p>Per fer-ho, em de vist que les unitats sn niques per cada fertilizer metric.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=46da3f3f">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[20]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Ja que sn niques, podem fer el pivot.</span>
<span class="c1"># Creem una columna con el nom final de columna a formar desprs del pivot</span>
<span class="n">fertilizers_df</span><span class="p">[</span><span class="s2">"pivot_col"</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">"Value_nutrient_"</span>
    <span class="o">+</span> <span class="n">fertilizers_df</span><span class="p">[</span><span class="s2">"nutrient_code"</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
    <span class="o">+</span> <span class="s2">"_"</span>
    <span class="o">+</span> <span class="n">fertilizers_df</span><span class="p">[</span><span class="s2">"nutrient"</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
    <span class="o">+</span> <span class="s2">"_"</span>
    <span class="o">+</span> <span class="n">fertilizers_df</span><span class="p">[</span><span class="s2">"fertilizer_metric"</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">" "</span><span class="p">,</span> <span class="s2">"_"</span><span class="p">)</span>
    <span class="o">+</span> <span class="s2">"_"</span>
    <span class="o">+</span> <span class="n">fertilizers_df</span><span class="p">[</span><span class="s2">"Unit"</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Realitzem el pivot</span>
<span class="n">fertilizers_pivot</span> <span class="o">=</span> <span class="n">pivot_faostat_df</span><span class="p">(</span>
    <span class="n">df_to_pivot</span> <span class="o">=</span> <span class="n">fertilizers_df</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Year Code</th>
<th>Year</th>
<th>Value_nutrient_3102_N_Agricultural_Use_t</th>
<th>Value_nutrient_3102_N_Use_per_area_of_cropland_kg/ha</th>
<th>Value_nutrient_3102_N_Use_per_capita_kg/cap</th>
<th>Value_nutrient_3102_N_Use_per_value_of_agricultural_production_g/Int$</th>
<th>Value_nutrient_3103_P2O5_Agricultural_Use_t</th>
<th>Value_nutrient_3103_P2O5_Use_per_area_of_cropland_kg/ha</th>
<th>Value_nutrient_3103_P2O5_Use_per_capita_kg/cap</th>
<th>Value_nutrient_3103_P2O5_Use_per_value_of_agricultural_production_g/Int$</th>
<th>Value_nutrient_3104_K2O_Agricultural_Use_t</th>
<th>Value_nutrient_3104_K2O_Use_per_area_of_cropland_kg/ha</th>
<th>Value_nutrient_3104_K2O_Use_per_capita_kg/cap</th>
<th>Value_nutrient_3104_K2O_Use_per_value_of_agricultural_production_g/Int$</th>
</tr>
</thead>
<tbody>
<tr>
<th>8638</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1961</td>
<td>1961</td>
<td>327178.0</td>
<td>15.78</td>
<td>10.66</td>
<td>17.77</td>
<td>307978.0</td>
<td>14.86</td>
<td>10.03</td>
<td>16.72</td>
<td>94700.0</td>
<td>4.57</td>
<td>3.08</td>
<td>5.14</td>
</tr>
<tr>
<th>8639</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1962</td>
<td>1962</td>
<td>345497.0</td>
<td>16.58</td>
<td>11.13</td>
<td>18.98</td>
<td>311111.0</td>
<td>14.93</td>
<td>10.02</td>
<td>17.09</td>
<td>95578.0</td>
<td>4.59</td>
<td>3.08</td>
<td>5.25</td>
</tr>
<tr>
<th>8640</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1963</td>
<td>1963</td>
<td>333031.0</td>
<td>15.98</td>
<td>10.61</td>
<td>15.59</td>
<td>313685.0</td>
<td>15.05</td>
<td>10.00</td>
<td>14.69</td>
<td>99654.0</td>
<td>4.78</td>
<td>3.18</td>
<td>4.67</td>
</tr>
<tr>
<th>8641</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1964</td>
<td>1964</td>
<td>364054.0</td>
<td>17.71</td>
<td>11.47</td>
<td>18.58</td>
<td>311973.0</td>
<td>15.18</td>
<td>9.83</td>
<td>15.92</td>
<td>91132.0</td>
<td>4.43</td>
<td>2.87</td>
<td>4.65</td>
</tr>
<tr>
<th>8642</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1965</td>
<td>1965</td>
<td>384720.0</td>
<td>18.68</td>
<td>11.98</td>
<td>19.53</td>
<td>305522.0</td>
<td>14.84</td>
<td>9.51</td>
<td>15.51</td>
<td>92117.0</td>
<td>4.47</td>
<td>2.87</td>
<td>4.68</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=c12772a9">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[21]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Associem el fertilizers_pivot a un df per anar actualitzant que ser el final.</span>
<span class="n">agri_fertilizers_df</span> <span class="o">=</span> <span class="n">fertilizers_pivot</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Nombre final de files d'agri_fertilizers_df: </span><span class="si">{</span><span class="n">agri_fertilizers_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Nombre final de columnes d'agri_fertilizers_df: </span><span class="si">{</span><span class="n">agri_fertilizers_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">agri_fertilizers_df</span><span class="p">[</span><span class="n">agri_fertilizers_df</span><span class="p">[</span><span class="s2">"Area"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"Spain"</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Nombre final de files d'agri_fertilizers_df: 12729
Nombre final de columnes d'agri_fertilizers_df: 17
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Year Code</th>
<th>Year</th>
<th>Value_nutrient_3102_N_Agricultural_Use_t</th>
<th>Value_nutrient_3102_N_Use_per_area_of_cropland_kg/ha</th>
<th>Value_nutrient_3102_N_Use_per_capita_kg/cap</th>
<th>Value_nutrient_3102_N_Use_per_value_of_agricultural_production_g/Int$</th>
<th>Value_nutrient_3103_P2O5_Agricultural_Use_t</th>
<th>Value_nutrient_3103_P2O5_Use_per_area_of_cropland_kg/ha</th>
<th>Value_nutrient_3103_P2O5_Use_per_capita_kg/cap</th>
<th>Value_nutrient_3103_P2O5_Use_per_value_of_agricultural_production_g/Int$</th>
<th>Value_nutrient_3104_K2O_Agricultural_Use_t</th>
<th>Value_nutrient_3104_K2O_Use_per_area_of_cropland_kg/ha</th>
<th>Value_nutrient_3104_K2O_Use_per_capita_kg/cap</th>
<th>Value_nutrient_3104_K2O_Use_per_value_of_agricultural_production_g/Int$</th>
</tr>
</thead>
<tbody>
<tr>
<th>8638</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1961</td>
<td>1961</td>
<td>327178.0</td>
<td>15.78</td>
<td>10.66</td>
<td>17.77</td>
<td>307978.0</td>
<td>14.86</td>
<td>10.03</td>
<td>16.72</td>
<td>94700.0</td>
<td>4.57</td>
<td>3.08</td>
<td>5.14</td>
</tr>
<tr>
<th>8639</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1962</td>
<td>1962</td>
<td>345497.0</td>
<td>16.58</td>
<td>11.13</td>
<td>18.98</td>
<td>311111.0</td>
<td>14.93</td>
<td>10.02</td>
<td>17.09</td>
<td>95578.0</td>
<td>4.59</td>
<td>3.08</td>
<td>5.25</td>
</tr>
<tr>
<th>8640</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1963</td>
<td>1963</td>
<td>333031.0</td>
<td>15.98</td>
<td>10.61</td>
<td>15.59</td>
<td>313685.0</td>
<td>15.05</td>
<td>10.00</td>
<td>14.69</td>
<td>99654.0</td>
<td>4.78</td>
<td>3.18</td>
<td>4.67</td>
</tr>
<tr>
<th>8641</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1964</td>
<td>1964</td>
<td>364054.0</td>
<td>17.71</td>
<td>11.47</td>
<td>18.58</td>
<td>311973.0</td>
<td>15.18</td>
<td>9.83</td>
<td>15.92</td>
<td>91132.0</td>
<td>4.43</td>
<td>2.87</td>
<td>4.65</td>
</tr>
<tr>
<th>8642</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1965</td>
<td>1965</td>
<td>384720.0</td>
<td>18.68</td>
<td>11.98</td>
<td>19.53</td>
<td>305522.0</td>
<td>14.84</td>
<td>9.51</td>
<td>15.51</td>
<td>92117.0</td>
<td>4.47</td>
<td>2.87</td>
<td>4.68</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=98cb7fe5">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Processament-del-dataset-LandUse">Processament del dataset LandUse<a class="anchor-link" href="#Processament-del-dataset-LandUse"></a></h3><p>Analitzem el dataset de LandUse per veure quina informaci cont i com podem integrar-la al dataframe final.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=345c0446">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[22]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Analitzar el dataset de LandUse</span>
<span class="n">analitzar_dataset_faostat</span><span class="p">(</span><span class="s1">'Inputs_LandUse'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Anlisi del dataset: Inputs_LandUse

Dataframe principal (Inputs_LandUse_E_All_Data_(Normalized)):
Dimensions: 413,211 files x 13 columnes

 Columnes (13):
   1. Area Code
   2. Area Code (M49)
   3. Area
   4. Item Code
   5. Item
   6. Element Code
   7. Element
   8. Year Code
   9. Year
  10. Unit
  11. Value
  12. Flag
  13. Note

 Primeres files del dataframe principal:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Item Code</th>
<th>Item</th>
<th>Element Code</th>
<th>Element</th>
<th>Year Code</th>
<th>Year</th>
<th>Unit</th>
<th>Value</th>
<th>Flag</th>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>6600</td>
<td>Country area</td>
<td>5110</td>
<td>Area</td>
<td>1961</td>
<td>1961</td>
<td>1000 ha</td>
<td>65286.0</td>
<td>A</td>
<td>NaN</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>6600</td>
<td>Country area</td>
<td>5110</td>
<td>Area</td>
<td>1962</td>
<td>1962</td>
<td>1000 ha</td>
<td>65286.0</td>
<td>A</td>
<td>NaN</td>
</tr>
<tr>
<th>2</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>6600</td>
<td>Country area</td>
<td>5110</td>
<td>Area</td>
<td>1963</td>
<td>1963</td>
<td>1000 ha</td>
<td>65286.0</td>
<td>A</td>
<td>NaN</td>
</tr>
<tr>
<th>3</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>6600</td>
<td>Country area</td>
<td>5110</td>
<td>Area</td>
<td>1964</td>
<td>1964</td>
<td>1000 ha</td>
<td>65286.0</td>
<td>A</td>
<td>NaN</td>
</tr>
<tr>
<th>4</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>6600</td>
<td>Country area</td>
<td>5110</td>
<td>Area</td>
<td>1965</td>
<td>1965</td>
<td>1000 ha</td>
<td>65286.0</td>
<td>A</td>
<td>NaN</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
 Valors nics de la columna 'Item':
Total nics: 45 (mostrant com a mxim 50)
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Item</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Country area</td>
</tr>
<tr>
<th>1</th>
<td>Land area</td>
</tr>
<tr>
<th>2</th>
<td>Agriculture</td>
</tr>
<tr>
<th>3</th>
<td>Agricultural land</td>
</tr>
<tr>
<th>4</th>
<td>Cropland</td>
</tr>
<tr>
<th>5</th>
<td>Arable land</td>
</tr>
<tr>
<th>6</th>
<td>Temporary crops</td>
</tr>
<tr>
<th>7</th>
<td>Temporary meadows and pastures</td>
</tr>
<tr>
<th>8</th>
<td>Temporary fallow</td>
</tr>
<tr>
<th>9</th>
<td>Permanent crops</td>
</tr>
<tr>
<th>10</th>
<td>Permanent meadows and pastures</td>
</tr>
<tr>
<th>11</th>
<td>Perm. meadows &amp; pastures - Nat. growing</td>
</tr>
<tr>
<th>12</th>
<td>Forest land</td>
</tr>
<tr>
<th>13</th>
<td>Naturally regenerating forest</td>
</tr>
<tr>
<th>14</th>
<td>Other land</td>
</tr>
<tr>
<th>15</th>
<td>Inland waters</td>
</tr>
<tr>
<th>16</th>
<td>Land area equipped for irrigation</td>
</tr>
<tr>
<th>17</th>
<td>Land area actually irrigated</td>
</tr>
<tr>
<th>18</th>
<td>Agriculture area actually irrigated</td>
</tr>
<tr>
<th>19</th>
<td>Agriculture area under organic agric.</td>
</tr>
<tr>
<th>20</th>
<td>Agriculture area certified organic</td>
</tr>
<tr>
<th>21</th>
<td>Farm buildings and Farmyards</td>
</tr>
<tr>
<th>22</th>
<td>Primary Forest</td>
</tr>
<tr>
<th>23</th>
<td>Coastal waters</td>
</tr>
<tr>
<th>24</th>
<td>Cropland area actually irrigated</td>
</tr>
<tr>
<th>25</th>
<td>Cropland area under organic agric.</td>
</tr>
<tr>
<th>26</th>
<td>Cropland area certified organic</td>
</tr>
<tr>
<th>27</th>
<td>Cropland area under protective cover</td>
</tr>
<tr>
<th>28</th>
<td>Perm. meadows &amp; pastures - Cultivated</td>
</tr>
<tr>
<th>29</th>
<td>Planted Forest</td>
</tr>
<tr>
<th>30</th>
<td>Land used for aquaculture</td>
</tr>
<tr>
<th>31</th>
<td>EEZ used for capture fisheries</td>
</tr>
<tr>
<th>32</th>
<td>Perm. meadows &amp; pastures area actually irrig.</td>
</tr>
<tr>
<th>33</th>
<td>Forestry area actually irrigated</td>
</tr>
<tr>
<th>34</th>
<td>Perm. meadows &amp; pastures area under organic agric.</td>
</tr>
<tr>
<th>35</th>
<td>Cropland area under conventional tillage</td>
</tr>
<tr>
<th>36</th>
<td>Cropland area under zero or no tillage</td>
</tr>
<tr>
<th>37</th>
<td>Cropland area under conservation tillage</td>
</tr>
<tr>
<th>38</th>
<td>Perm. meadows &amp; pastures area certified organic</td>
</tr>
<tr>
<th>39</th>
<td>Inland waters used for aquac. or holding facilities</td>
</tr>
<tr>
<th>40</th>
<td>Coastal waters used for capture fisheries</td>
</tr>
<tr>
<th>41</th>
<td>Inland waters used for capture fisheries</td>
</tr>
<tr>
<th>42</th>
<td>Coastal waters used for aquac. or holding facilities</td>
</tr>
<tr>
<th>43</th>
<td>EEZ used for aquac. or holding facilities</td>
</tr>
<tr>
<th>44</th>
<td>Exclusive Economic Zone (EEZ)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
 Valors nics de la columna 'Element':
Total nics: 8 (mostrant com a mxim 50)
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Element</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Area</td>
</tr>
<tr>
<th>1</th>
<td>Share in Land area</td>
</tr>
<tr>
<th>2</th>
<td>Value of agricultural production (Int. $) per Area</td>
</tr>
<tr>
<th>3</th>
<td>Share in Agricultural land</td>
</tr>
<tr>
<th>4</th>
<td>Area per capita</td>
</tr>
<tr>
<th>5</th>
<td>Carbon stock in living biomass</td>
</tr>
<tr>
<th>6</th>
<td>Share in Forest land</td>
</tr>
<tr>
<th>7</th>
<td>Share in Cropland</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre> Altres dataframes de Inputs_LandUse:

 Contingut de Inputs_LandUse_E_AreaCodes:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>M49 Code</th>
<th>Area</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
</tr>
<tr>
<th>1</th>
<td>5100</td>
<td>'002</td>
<td>Africa</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>'008</td>
<td>Albania</td>
</tr>
<tr>
<th>3</th>
<td>4</td>
<td>'012</td>
<td>Algeria</td>
</tr>
<tr>
<th>4</th>
<td>5</td>
<td>'016</td>
<td>American Samoa</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>


 Contingut de Inputs_LandUse_E_Elements:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Element Code</th>
<th>Element</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>5110</td>
<td>Area</td>
</tr>
<tr>
<th>1</th>
<td>7277</td>
<td>Area per capita</td>
</tr>
<tr>
<th>2</th>
<td>72151</td>
<td>Carbon stock in living biomass</td>
</tr>
<tr>
<th>3</th>
<td>72000</td>
<td>Indicators</td>
</tr>
<tr>
<th>4</th>
<td>7208</td>
<td>Share in Agricultural land</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>


 Contingut de Inputs_LandUse_E_Flags:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Flag</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>A</td>
<td>Official figure</td>
</tr>
<tr>
<th>1</th>
<td>B</td>
<td>Time series break</td>
</tr>
<tr>
<th>2</th>
<td>E</td>
<td>Estimated value</td>
</tr>
<tr>
<th>3</th>
<td>I</td>
<td>Value imputed by a receiving agency</td>
</tr>
<tr>
<th>4</th>
<td>X</td>
<td>Figure from external organization</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>


 Contingut de Inputs_LandUse_E_ItemCodes:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Item Code</th>
<th>CPC Code</th>
<th>Item</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>6610</td>
<td>NaN</td>
<td>Agricultural land</td>
</tr>
<tr>
<th>1</th>
<td>66710</td>
<td>NaN</td>
<td>Agricultural practices</td>
</tr>
<tr>
<th>2</th>
<td>6602</td>
<td>NaN</td>
<td>Agriculture</td>
</tr>
<tr>
<th>3</th>
<td>66020</td>
<td>NaN</td>
<td>Agriculture</td>
</tr>
<tr>
<th>4</th>
<td>6611</td>
<td>NaN</td>
<td>Agriculture area actually irrigated</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>

</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=c876001e">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Creaci%C3%B3-de-landuse_df">Creaci de <code>landuse_df</code><a class="anchor-link" href="#Creaci%C3%B3-de-landuse_df"></a></h3><p>Creem el dataframe de LandUse basat en el dataset principal de Inputs_LandUse.</p>
<p>Hem seleccionat nicament els tems que descriuen l'estructura fonamental del sl agrcola d'un pas (terra agrcola, terres cultivades, terres arables, cultius permanents i pastures). Aquests indicadors sn estables, no redundants i permeten analitzar l'evoluci del sector agrari i la seva relaci amb el clima, la producci i l's d'insums. La resta d'items aporten un nivell de detall massa especfic o redundant que incrementaria innecessriament la dimensionalitat del conjunt de dades i dificultaria la visualitzaci final. Per tal d'evitar duplicitats, tamb mantenim noms l'element "Area", ja que els "Share" i "per capita" poden derivar-se fcilment durant l'anlisi.</p>
<p>Per tant:</p>
<ul>
<li>Eliminem les columnes <code>Note</code> i <code>Flag</code> (informaci no utilitzable per a l'anlisi)</li>
<li>Renombrem columnes per a millor claredat: <code>Item</code> a <code>land_category</code>, <code>Element</code> a <code>land_metric</code></li>
<li>Filtrar els items i elements per quedar-nos noms amb els indicadors rellevants</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=60453f5d">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[23]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Crear landuse_df utilitzant la funci generalitzada</span>
<span class="n">key</span> <span class="o">=</span> <span class="s1">'Inputs_LandUse'</span>
<span class="n">df_name</span> <span class="o">=</span> <span class="s1">'landuse_df'</span>
<span class="n">column_mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'Item Code'</span><span class="p">:</span> <span class="s1">'land_category_code'</span><span class="p">,</span>
    <span class="s1">'Item'</span><span class="p">:</span> <span class="s1">'land_category'</span><span class="p">,</span>
    <span class="s1">'Element Code'</span><span class="p">:</span> <span class="s1">'land_metric_code'</span><span class="p">,</span>
    <span class="s1">'Element'</span><span class="p">:</span> <span class="s1">'land_metric'</span>
<span class="p">}</span>
<span class="n">values_to_keep</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'land_category'</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">'Land area'</span><span class="p">,</span>
        <span class="s1">'Agricultural land'</span><span class="p">,</span>
        <span class="s1">'Cropland'</span><span class="p">,</span>
        <span class="s1">'Arable land'</span><span class="p">,</span>
        <span class="s1">'Permanent crops'</span><span class="p">,</span>
        <span class="s1">'Permanent meadows and pastures'</span>
    <span class="p">],</span>
    <span class="s1">'land_metric'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Area'</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">landuse_df</span> <span class="o">=</span> <span class="n">crear_df_faostat_filtrat</span><span class="p">(</span>
    <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
    <span class="n">df_name</span><span class="o">=</span><span class="n">df_name</span><span class="p">,</span>
    <span class="n">column_mapping</span><span class="o">=</span><span class="n">column_mapping</span><span class="p">,</span>
    <span class="n">values_to_keep</span><span class="o">=</span><span class="n">values_to_keep</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Creaci de landuse_df

Valors diferents de 'Unit':
land_category                   land_metric
Agricultural land               Area           [1000 ha]
Arable land                     Area           [1000 ha]
Cropland                        Area           [1000 ha]
Land area                       Area           [1000 ha]
Permanent crops                 Area           [1000 ha]
Permanent meadows and pastures  Area           [1000 ha]
Name: Unit, dtype: object

Dimensions finals: 92,300 files x 11 columnes

Columnes finals (11):
   1. Area Code
   2. Area Code (M49)
   3. Area
   4. land_category_code
   5. land_category
   6. land_metric_code
   7. land_metric
   8. Year Code
   9. Year
  10. Unit
  11. Value

Primeres files de landuse_df:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>land_category_code</th>
<th>land_category</th>
<th>land_metric_code</th>
<th>land_metric</th>
<th>Year Code</th>
<th>Year</th>
<th>Unit</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<th>63</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>6601</td>
<td>Land area</td>
<td>5110</td>
<td>Area</td>
<td>1961</td>
<td>1961</td>
<td>1000 ha</td>
<td>65223.0</td>
</tr>
<tr>
<th>64</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>6601</td>
<td>Land area</td>
<td>5110</td>
<td>Area</td>
<td>1962</td>
<td>1962</td>
<td>1000 ha</td>
<td>65223.0</td>
</tr>
<tr>
<th>65</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>6601</td>
<td>Land area</td>
<td>5110</td>
<td>Area</td>
<td>1963</td>
<td>1963</td>
<td>1000 ha</td>
<td>65223.0</td>
</tr>
<tr>
<th>66</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>6601</td>
<td>Land area</td>
<td>5110</td>
<td>Area</td>
<td>1964</td>
<td>1964</td>
<td>1000 ha</td>
<td>65223.0</td>
</tr>
<tr>
<th>67</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>6601</td>
<td>Land area</td>
<td>5110</td>
<td>Area</td>
<td>1965</td>
<td>1965</td>
<td>1000 ha</td>
<td>65223.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
Resum de valors nics:
  - land_category nics: 6 a ['Agricultural land', 'Arable land', 'Cropland', 'Land area', 'Permanent crops', 'Permanent meadows and pastures']
  - land_metric nics: 1 a ['Area']
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=2cdbb192">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[24]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Convertim Value de 1000 ha a ha</span>
<span class="n">landuse_df</span><span class="p">[</span><span class="s1">'Value'</span><span class="p">]</span> <span class="o">=</span> <span class="n">landuse_df</span><span class="p">[</span><span class="s1">'Value'</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1000</span>

<span class="c1"># Crear la columna pivot_col segons l'estructura</span>
<span class="n">landuse_df</span><span class="p">[</span><span class="s1">'pivot_col'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s1">'Value_'</span>
    <span class="o">+</span> <span class="n">landuse_df</span><span class="p">[</span><span class="s1">'land_category_code'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
    <span class="o">+</span> <span class="s1">'_'</span>
    <span class="o">+</span> <span class="n">landuse_df</span><span class="p">[</span><span class="s1">'land_category'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span>
    <span class="o">+</span> <span class="s1">'_ha'</span>
<span class="p">)</span>

<span class="c1"># Pivotem el dataframe utilitzant la funci generalitzada</span>
<span class="n">landuse_pivot</span> <span class="o">=</span> <span class="n">pivot_faostat_df</span><span class="p">(</span><span class="n">landuse_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Year Code</th>
<th>Year</th>
<th>Value_6601_land_area_ha</th>
<th>Value_6610_agricultural_land_ha</th>
<th>Value_6620_cropland_ha</th>
<th>Value_6621_arable_land_ha</th>
<th>Value_6650_permanent_crops_ha</th>
<th>Value_6655_permanent_meadows_and_pastures_ha</th>
</tr>
</thead>
<tbody>
<tr>
<th>10982</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1961</td>
<td>1961</td>
<td>49978000.0</td>
<td>33230000.0</td>
<td>20730000.0</td>
<td>16246000.0</td>
<td>4484000.0</td>
<td>12500000.0</td>
</tr>
<tr>
<th>10983</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1962</td>
<td>1962</td>
<td>49978000.0</td>
<td>33232000.0</td>
<td>20832000.0</td>
<td>16296000.0</td>
<td>4536000.0</td>
<td>12400000.0</td>
</tr>
<tr>
<th>10984</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1963</td>
<td>1963</td>
<td>49978000.0</td>
<td>33137000.0</td>
<td>20837000.0</td>
<td>16205000.0</td>
<td>4632000.0</td>
<td>12300000.0</td>
</tr>
<tr>
<th>10985</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1964</td>
<td>1964</td>
<td>49978000.0</td>
<td>32753000.0</td>
<td>20553000.0</td>
<td>15919000.0</td>
<td>4634000.0</td>
<td>12200000.0</td>
</tr>
<tr>
<th>10986</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1965</td>
<td>1965</td>
<td>49978000.0</td>
<td>32694000.0</td>
<td>20594000.0</td>
<td>15966000.0</td>
<td>4628000.0</td>
<td>12100000.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=2c95be47">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[25]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Fer el merge utilitzant la funci generalitzada</span>
<span class="n">agri_landuse_df</span> <span class="o">=</span> <span class="n">merge_agri_dataframes</span><span class="p">(</span>
    <span class="n">df_initial</span><span class="o">=</span><span class="n">agri_fertilizers_df</span><span class="p">,</span>
    <span class="n">df_to_merge</span><span class="o">=</span><span class="n">landuse_pivot</span><span class="p">,</span>
    <span class="n">df_name_initial</span><span class="o">=</span><span class="s2">"agri_fertilizers_df"</span><span class="p">,</span>
    <span class="n">df_name_to_merge</span><span class="o">=</span><span class="s2">"landuse_pivot"</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Nombre de files de agri_fertilizers_df: 12729
Nombre de columnes de agri_fertilizers_df: 17
Nombre de files de landuse_pivot: 16228
Nombre de columnes de landuse_pivot: 11
Nombre final de files del resultat: 12729
Nombre final de columnes del resultat: 23
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Year Code</th>
<th>Year</th>
<th>Value_nutrient_3102_N_Agricultural_Use_t</th>
<th>Value_nutrient_3102_N_Use_per_area_of_cropland_kg/ha</th>
<th>Value_nutrient_3102_N_Use_per_capita_kg/cap</th>
<th>Value_nutrient_3102_N_Use_per_value_of_agricultural_production_g/Int$</th>
<th>Value_nutrient_3103_P2O5_Agricultural_Use_t</th>
<th>Value_nutrient_3103_P2O5_Use_per_area_of_cropland_kg/ha</th>
<th>Value_nutrient_3103_P2O5_Use_per_capita_kg/cap</th>
<th>Value_nutrient_3103_P2O5_Use_per_value_of_agricultural_production_g/Int$</th>
<th>Value_nutrient_3104_K2O_Agricultural_Use_t</th>
<th>Value_nutrient_3104_K2O_Use_per_area_of_cropland_kg/ha</th>
<th>Value_nutrient_3104_K2O_Use_per_capita_kg/cap</th>
<th>Value_nutrient_3104_K2O_Use_per_value_of_agricultural_production_g/Int$</th>
<th>Value_6601_land_area_ha</th>
<th>Value_6610_agricultural_land_ha</th>
<th>Value_6620_cropland_ha</th>
<th>Value_6621_arable_land_ha</th>
<th>Value_6650_permanent_crops_ha</th>
<th>Value_6655_permanent_meadows_and_pastures_ha</th>
</tr>
</thead>
<tbody>
<tr>
<th>8697</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>2020</td>
<td>2020</td>
<td>1059299.0</td>
<td>63.64</td>
<td>22.22</td>
<td>18.35</td>
<td>486673.0</td>
<td>29.24</td>
<td>10.21</td>
<td>8.43</td>
<td>399489.0</td>
<td>24.0</td>
<td>8.38</td>
<td>6.92</td>
<td>49955664.5</td>
<td>26142638.1</td>
<td>16646395.1</td>
<td>11639398.1</td>
<td>5006997.0</td>
<td>9496243.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=f5cb86db">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Creaci%C3%B3-de-pesticides_df">Creaci de <code>pesticides_df</code><a class="anchor-link" href="#Creaci%C3%B3-de-pesticides_df"></a></h3><p>Creem el dataframe de pesticides basat en el dataset principal de Inputs_Pesticides_Use.</p>
<p>Per al domini de pesticides hem seleccionat nicament l'tem "Pesticides (total)", ja que s l'indicador agregat que resumeix la pressi qumica exercida sobre els sistemes agrcoles d'un pas. La resta d'tems (35 categories d'insecticides, herbicides o fungicides) aporten un nivell de detall excessiu, sovint inconsistent entre pasos i anys, i no sn tils per a una anlisi macro a escala global. Pel que fa als elements, mantenim "Agricultural Use" com a indicador principal perqu reflecteix l's real de pesticides en agricultura. Aquesta selecci minimitza la complexitat del conjunt de dades i facilita la interpretaci i visualitzaci dels resultats.</p>
<p><strong>Transformacions realitzades:</strong></p>
<ul>
<li>Eliminem les columnes <code>Note</code> i <code>Flag</code> (informaci no utilitzable per a l'anlisi)</li>
<li>Renombrem columnes per a millor claredat: <code>Item</code> a <code>pesticide_category</code>, <code>Element</code> a <code>pesticide_metric</code></li>
<li>Filtrar els items i elements: noms "Pesticides (total)" i "Agricultural Use"</li>
</ul>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=388acc8f">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="An%C3%A0lisi-del-dataset-Pesticides-Use">Anlisi del dataset Pesticides Use<a class="anchor-link" href="#An%C3%A0lisi-del-dataset-Pesticides-Use"></a></h3><p>Analitzem el dataset de Pesticides Use per veure quina informaci cont i com podem integrar-la al dataframe final.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=588d1876">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[26]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Analitzar el dataset de Pesticides Use</span>
<span class="n">analitzar_dataset_faostat</span><span class="p">(</span><span class="s1">'Inputs_Pesticides_Use'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Anlisi del dataset: Inputs_Pesticides_Use

Dataframe principal (Inputs_Pesticides_Use_E_All_Data_(Normalized)):
Dimensions: 103,622 files x 13 columnes

 Columnes (13):
   1. Area Code
   2. Area Code (M49)
   3. Area
   4. Item Code
   5. Item
   6. Element Code
   7. Element
   8. Year Code
   9. Year
  10. Unit
  11. Value
  12. Flag
  13. Note

 Primeres files del dataframe principal:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Item Code</th>
<th>Item</th>
<th>Element Code</th>
<th>Element</th>
<th>Year Code</th>
<th>Year</th>
<th>Unit</th>
<th>Value</th>
<th>Flag</th>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>3</td>
<td>'008</td>
<td>Albania</td>
<td>1357</td>
<td>Pesticides (total)</td>
<td>5157</td>
<td>Agricultural Use</td>
<td>1990</td>
<td>1990</td>
<td>t</td>
<td>121.0</td>
<td>I</td>
<td>Imputed value</td>
</tr>
<tr>
<th>1</th>
<td>3</td>
<td>'008</td>
<td>Albania</td>
<td>1357</td>
<td>Pesticides (total)</td>
<td>5157</td>
<td>Agricultural Use</td>
<td>1991</td>
<td>1991</td>
<td>t</td>
<td>121.0</td>
<td>I</td>
<td>Imputed value</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>'008</td>
<td>Albania</td>
<td>1357</td>
<td>Pesticides (total)</td>
<td>5157</td>
<td>Agricultural Use</td>
<td>1992</td>
<td>1992</td>
<td>t</td>
<td>121.0</td>
<td>I</td>
<td>Imputed value</td>
</tr>
<tr>
<th>3</th>
<td>3</td>
<td>'008</td>
<td>Albania</td>
<td>1357</td>
<td>Pesticides (total)</td>
<td>5157</td>
<td>Agricultural Use</td>
<td>1993</td>
<td>1993</td>
<td>t</td>
<td>121.0</td>
<td>A</td>
<td>Official figure</td>
</tr>
<tr>
<th>4</th>
<td>3</td>
<td>'008</td>
<td>Albania</td>
<td>1357</td>
<td>Pesticides (total)</td>
<td>5157</td>
<td>Agricultural Use</td>
<td>1994</td>
<td>1994</td>
<td>t</td>
<td>201.0</td>
<td>A</td>
<td>Official figure</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
 Valors nics de la columna 'Item':
Total nics: 36 (mostrant com a mxim 50)
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Item</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Pesticides (total)</td>
</tr>
<tr>
<th>1</th>
<td>Insecticides</td>
</tr>
<tr>
<th>2</th>
<td>Insecticides  Chlorinated Hydrocarbons</td>
</tr>
<tr>
<th>3</th>
<td>Insecticides  Organo-phosphates</td>
</tr>
<tr>
<th>4</th>
<td>Insecticides  Carbamates</td>
</tr>
<tr>
<th>5</th>
<td>Insecticides  Pyrethroids</td>
</tr>
<tr>
<th>6</th>
<td>Insecticides - nes</td>
</tr>
<tr>
<th>7</th>
<td>Herbicides</td>
</tr>
<tr>
<th>8</th>
<td>Herbicides  Phenoxy hormone products</td>
</tr>
<tr>
<th>9</th>
<td>Herbicides  Triazines</td>
</tr>
<tr>
<th>10</th>
<td>Herbicides  Amides</td>
</tr>
<tr>
<th>11</th>
<td>Herbicides  Carbamates</td>
</tr>
<tr>
<th>12</th>
<td>Herbicides  Dinitroanilines</td>
</tr>
<tr>
<th>13</th>
<td>Herbicides  Sulfonyl ureas</td>
</tr>
<tr>
<th>14</th>
<td>Herbicides  Bipiridils</td>
</tr>
<tr>
<th>15</th>
<td>Herbicides - nes</td>
</tr>
<tr>
<th>16</th>
<td>Fungicides and Bactericides</td>
</tr>
<tr>
<th>17</th>
<td>Fung &amp; Bact  Inorganics</td>
</tr>
<tr>
<th>18</th>
<td>Fung &amp; Bact  Dithiocarbamates</td>
</tr>
<tr>
<th>19</th>
<td>Fung &amp; Bact  Benzimidazoles</td>
</tr>
<tr>
<th>20</th>
<td>Fung &amp; Bact  Triazoles, diazoles</td>
</tr>
<tr>
<th>21</th>
<td>Fung &amp; Bact - nes</td>
</tr>
<tr>
<th>22</th>
<td>Plant Growth Regulators</td>
</tr>
<tr>
<th>23</th>
<td>Rodenticides</td>
</tr>
<tr>
<th>24</th>
<td>Rodenticides  Anti-coagulants</td>
</tr>
<tr>
<th>25</th>
<td>Rodenticides  Other</td>
</tr>
<tr>
<th>26</th>
<td>Other Pesticides nes</td>
</tr>
<tr>
<th>27</th>
<td>Insecticides - Biopesticides</td>
</tr>
<tr>
<th>28</th>
<td>Herbicides  Urea derivates</td>
</tr>
<tr>
<th>29</th>
<td>Herbicides  Uracil</td>
</tr>
<tr>
<th>30</th>
<td>Fung &amp; Bact  Diazines, morpholines</td>
</tr>
<tr>
<th>31</th>
<td>Rodenticides  Cyanide Generators</td>
</tr>
<tr>
<th>32</th>
<td>Rodenticides  Hypercalcaemics</td>
</tr>
<tr>
<th>33</th>
<td>Rodenticides  Narcotics</td>
</tr>
<tr>
<th>34</th>
<td>Fung &amp; Bact - Biopesticides</td>
</tr>
<tr>
<th>35</th>
<td>Herbicides - Biopesticides</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
 Valors nics de la columna 'Element':
Total nics: 4 (mostrant com a mxim 50)
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Element</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Agricultural Use</td>
</tr>
<tr>
<th>1</th>
<td>Use per area of cropland</td>
</tr>
<tr>
<th>2</th>
<td>Use per capita</td>
</tr>
<tr>
<th>3</th>
<td>Use per value of agricultural production</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre> Altres dataframes de Inputs_Pesticides_Use:

 Contingut de Inputs_Pesticides_Use_E_AreaCodes:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>M49 Code</th>
<th>Area</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>5100</td>
<td>'002</td>
<td>Africa</td>
</tr>
<tr>
<th>1</th>
<td>3</td>
<td>'008</td>
<td>Albania</td>
</tr>
<tr>
<th>2</th>
<td>4</td>
<td>'012</td>
<td>Algeria</td>
</tr>
<tr>
<th>3</th>
<td>5200</td>
<td>'019</td>
<td>Americas</td>
</tr>
<tr>
<th>4</th>
<td>6</td>
<td>'020</td>
<td>Andorra</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>


 Contingut de Inputs_Pesticides_Use_E_Elements:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Element Code</th>
<th>Element</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>5157</td>
<td>Agricultural Use</td>
</tr>
<tr>
<th>1</th>
<td>5159</td>
<td>Use per area of cropland</td>
</tr>
<tr>
<th>2</th>
<td>5172</td>
<td>Use per capita</td>
</tr>
<tr>
<th>3</th>
<td>5173</td>
<td>Use per value of agricultural production</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>


 Contingut de Inputs_Pesticides_Use_E_Flags:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Flag</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>A</td>
<td>Official figure</td>
</tr>
<tr>
<th>1</th>
<td>E</td>
<td>Estimated value</td>
</tr>
<tr>
<th>2</th>
<td>I</td>
<td>Value imputed by a receiving agency</td>
</tr>
<tr>
<th>3</th>
<td>X</td>
<td>Figure from external organization</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>


 Contingut de Inputs_Pesticides_Use_E_ItemCodes:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Item Code</th>
<th>CPC Code</th>
<th>Item</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>

</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=01670dd9">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Creaci%C3%B3-de-pesticides_df">Creaci de <code>pesticides_df</code><a class="anchor-link" href="#Creaci%C3%B3-de-pesticides_df"></a></h3><p>Creem el dataframe de pesticides basat en el dataset principal de Inputs_Pesticides_Use.</p>
<p>Per al domini de pesticides hem seleccionat nicament l'tem "Pesticides (total)", ja que s l'indicador agregat que resumeix la pressi qumica exercida sobre els sistemes agrcoles d'un pas. La resta d'tems (35 categories d'insecticides, herbicides o fungicides) aporten un nivell de detall excessiu, sovint inconsistent entre pasos i anys, i no sn tils per a una anlisi macro a escala global. Pel que fa als elements, mantenim "Agricultural Use" com a indicador principal perqu reflecteix l's real de pesticides en agricultura. Aquesta selecci minimitza la complexitat del conjunt de dades i facilita la interpretaci i visualitzaci dels resultats.</p>
<p><strong>Transformacions realitzades:</strong></p>
<ul>
<li>Eliminem les columnes <code>Note</code> i <code>Flag</code> (informaci no utilitzable per a l'anlisi)</li>
<li>Renombrem columnes per a millor claredat: <code>Item</code> a <code>pesticide_category</code>, <code>Element</code> a <code>pesticide_metric</code></li>
<li>Filtrar els items i elements: noms "Pesticides (total)" i "Agricultural Use"</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=41b0f74b">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[27]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Creem el dataframe de pesticides</span>
<span class="n">key</span> <span class="o">=</span> <span class="s1">'Inputs_Pesticides_Use'</span>
<span class="n">df_name</span> <span class="o">=</span> <span class="s1">'pesticides_df'</span>
<span class="n">column_mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'Item Code'</span><span class="p">:</span> <span class="s1">'pesticide_category_code'</span><span class="p">,</span>
    <span class="s1">'Item'</span><span class="p">:</span> <span class="s1">'pesticide_category'</span><span class="p">,</span>
    <span class="s1">'Element Code'</span><span class="p">:</span> <span class="s1">'pesticide_metric_code'</span><span class="p">,</span>
    <span class="s1">'Element'</span><span class="p">:</span> <span class="s1">'pesticide_metric'</span>
<span class="p">}</span>
<span class="n">values_to_keep</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'pesticide_category'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Pesticides (total)'</span><span class="p">],</span>
    <span class="s1">'pesticide_metric'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Agricultural Use'</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">pesticides_df</span> <span class="o">=</span> <span class="n">crear_df_faostat_filtrat</span><span class="p">(</span>
    <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
    <span class="n">df_name</span><span class="o">=</span><span class="n">df_name</span><span class="p">,</span>
    <span class="n">column_mapping</span><span class="o">=</span><span class="n">column_mapping</span><span class="p">,</span>
    <span class="n">values_to_keep</span><span class="o">=</span><span class="n">values_to_keep</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Creaci de pesticides_df

Valors diferents de 'Unit':
pesticide_category  pesticide_metric
Pesticides (total)  Agricultural Use    [t]
Name: Unit, dtype: object

Dimensions finals: 8,226 files x 11 columnes

Columnes finals (11):
   1. Area Code
   2. Area Code (M49)
   3. Area
   4. pesticide_category_code
   5. pesticide_category
   6. pesticide_metric_code
   7. pesticide_metric
   8. Year Code
   9. Year
  10. Unit
  11. Value

Primeres files de pesticides_df:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>pesticide_category_code</th>
<th>pesticide_category</th>
<th>pesticide_metric_code</th>
<th>pesticide_metric</th>
<th>Year Code</th>
<th>Year</th>
<th>Unit</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>3</td>
<td>'008</td>
<td>Albania</td>
<td>1357</td>
<td>Pesticides (total)</td>
<td>5157</td>
<td>Agricultural Use</td>
<td>1990</td>
<td>1990</td>
<td>t</td>
<td>121.0</td>
</tr>
<tr>
<th>1</th>
<td>3</td>
<td>'008</td>
<td>Albania</td>
<td>1357</td>
<td>Pesticides (total)</td>
<td>5157</td>
<td>Agricultural Use</td>
<td>1991</td>
<td>1991</td>
<td>t</td>
<td>121.0</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>'008</td>
<td>Albania</td>
<td>1357</td>
<td>Pesticides (total)</td>
<td>5157</td>
<td>Agricultural Use</td>
<td>1992</td>
<td>1992</td>
<td>t</td>
<td>121.0</td>
</tr>
<tr>
<th>3</th>
<td>3</td>
<td>'008</td>
<td>Albania</td>
<td>1357</td>
<td>Pesticides (total)</td>
<td>5157</td>
<td>Agricultural Use</td>
<td>1993</td>
<td>1993</td>
<td>t</td>
<td>121.0</td>
</tr>
<tr>
<th>4</th>
<td>3</td>
<td>'008</td>
<td>Albania</td>
<td>1357</td>
<td>Pesticides (total)</td>
<td>5157</td>
<td>Agricultural Use</td>
<td>1994</td>
<td>1994</td>
<td>t</td>
<td>201.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
Resum de valors nics:
  - pesticide_category nics: 1 a ['Pesticides (total)']
  - pesticide_metric nics: 1 a ['Agricultural Use']
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=8505e291">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[28]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Ens quedem noms amb les columnes necessries i renomem el valor per claredat.</span>
<span class="c1"># No fem pivotatge perqu els valors d''Item' i 'Element' ja sn nics, aix s,</span>
<span class="c1"># noms hem seleccionat l'tem "Pesticides (total)" i l'element "Agricultural Use",</span>
<span class="c1"># per tant cada fila ja representa un nic valor anual per pas.</span>

<span class="n">pesticides_pivot_df</span> <span class="o">=</span> <span class="n">pesticides_df</span><span class="p">[[</span><span class="s1">'Area Code'</span><span class="p">,</span> <span class="s1">'Area Code (M49)'</span><span class="p">,</span> <span class="s1">'Area'</span><span class="p">,</span> <span class="s1">'Year Code'</span><span class="p">,</span> <span class="s1">'Year'</span><span class="p">,</span> <span class="s1">'Value'</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">pesticides_pivot_df</span> <span class="o">=</span> <span class="n">pesticides_pivot_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">'Value'</span><span class="p">:</span> <span class="s1">'Value_pesticide_agricultural_use_t'</span>
<span class="p">})</span>

<span class="c1"># Mostrem les primeres files per comprovaci</span>
<span class="n">pesticides_pivot_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[28]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Year Code</th>
<th>Year</th>
<th>Value_pesticide_agricultural_use_t</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>3</td>
<td>'008</td>
<td>Albania</td>
<td>1990</td>
<td>1990</td>
<td>121.0</td>
</tr>
<tr>
<th>1</th>
<td>3</td>
<td>'008</td>
<td>Albania</td>
<td>1991</td>
<td>1991</td>
<td>121.0</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>'008</td>
<td>Albania</td>
<td>1992</td>
<td>1992</td>
<td>121.0</td>
</tr>
<tr>
<th>3</th>
<td>3</td>
<td>'008</td>
<td>Albania</td>
<td>1993</td>
<td>1993</td>
<td>121.0</td>
</tr>
<tr>
<th>4</th>
<td>3</td>
<td>'008</td>
<td>Albania</td>
<td>1994</td>
<td>1994</td>
<td>201.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=ab753a79">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[29]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Ara podem fer el merge</span>

<span class="c1"># Utilitzem la funci definida prviament per fer merges successius amb altres dataframes,</span>

<span class="n">agri_pesticides_df</span> <span class="o">=</span> <span class="n">merge_agri_dataframes</span><span class="p">(</span>
    <span class="n">df_initial</span><span class="o">=</span><span class="n">agri_landuse_df</span><span class="p">,</span>
    <span class="n">df_to_merge</span><span class="o">=</span><span class="n">pesticides_pivot_df</span><span class="p">,</span>
    <span class="n">df_name_initial</span><span class="o">=</span><span class="s2">"agri_landuse_df"</span><span class="p">,</span>
    <span class="n">df_name_to_merge</span><span class="o">=</span><span class="s2">"pesticides_pivot_df"</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Nombre de files de agri_landuse_df: 12729
Nombre de columnes de agri_landuse_df: 23
Nombre de files de pesticides_pivot_df: 8226
Nombre de columnes de pesticides_pivot_df: 6
Nombre final de files del resultat: 12729
Nombre final de columnes del resultat: 24
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Year Code</th>
<th>Year</th>
<th>Value_nutrient_3102_N_Agricultural_Use_t</th>
<th>Value_nutrient_3102_N_Use_per_area_of_cropland_kg/ha</th>
<th>Value_nutrient_3102_N_Use_per_capita_kg/cap</th>
<th>Value_nutrient_3102_N_Use_per_value_of_agricultural_production_g/Int$</th>
<th>Value_nutrient_3103_P2O5_Agricultural_Use_t</th>
<th>Value_nutrient_3103_P2O5_Use_per_area_of_cropland_kg/ha</th>
<th>Value_nutrient_3103_P2O5_Use_per_capita_kg/cap</th>
<th>Value_nutrient_3103_P2O5_Use_per_value_of_agricultural_production_g/Int$</th>
<th>Value_nutrient_3104_K2O_Agricultural_Use_t</th>
<th>Value_nutrient_3104_K2O_Use_per_area_of_cropland_kg/ha</th>
<th>Value_nutrient_3104_K2O_Use_per_capita_kg/cap</th>
<th>Value_nutrient_3104_K2O_Use_per_value_of_agricultural_production_g/Int$</th>
<th>Value_6601_land_area_ha</th>
<th>Value_6610_agricultural_land_ha</th>
<th>Value_6620_cropland_ha</th>
<th>Value_6621_arable_land_ha</th>
<th>Value_6650_permanent_crops_ha</th>
<th>Value_6655_permanent_meadows_and_pastures_ha</th>
<th>Value_pesticide_agricultural_use_t</th>
</tr>
</thead>
<tbody>
<tr>
<th>8697</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>2020</td>
<td>2020</td>
<td>1059299.0</td>
<td>63.64</td>
<td>22.22</td>
<td>18.35</td>
<td>486673.0</td>
<td>29.24</td>
<td>10.21</td>
<td>8.43</td>
<td>399489.0</td>
<td>24.0</td>
<td>8.38</td>
<td>6.92</td>
<td>49955664.5</td>
<td>26142638.1</td>
<td>16646395.1</td>
<td>11639398.1</td>
<td>5006997.0</td>
<td>9496243.0</td>
<td>75775.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=50ea4de1">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="An%C3%A0lisi-del-dataset-LandCover">Anlisi del dataset LandCover<a class="anchor-link" href="#An%C3%A0lisi-del-dataset-LandCover"></a></h3><p>Analitzem el dataset de LandCover per veure quina informaci cont i com podem integrar-la al dataframe final.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=97bd0809">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[30]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Analitzar el dataset de LandCover</span>
<span class="n">analitzar_dataset_faostat</span><span class="p">(</span><span class="s1">'Environment_LandCover'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Anlisi del dataset: Environment_LandCover

Dataframe principal (Environment_LandCover_E_All_Data_(Normalized)):
Dimensions: 210,986 files x 12 columnes

 Columnes (12):
   1. Area Code
   2. Area Code (M49)
   3. Area
   4. Item Code
   5. Item
   6. Element Code
   7. Element
   8. Year Code
   9. Year
  10. Unit
  11. Value
  12. Flag

 Primeres files del dataframe principal:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Item Code</th>
<th>Item</th>
<th>Element Code</th>
<th>Element</th>
<th>Year Code</th>
<th>Year</th>
<th>Unit</th>
<th>Value</th>
<th>Flag</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>6970</td>
<td>Artificial surfaces (including urban and associated areas)</td>
<td>5006</td>
<td>Area from CGLS</td>
<td>2015</td>
<td>2015</td>
<td>1000 ha</td>
<td>102.77</td>
<td>E</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>6970</td>
<td>Artificial surfaces (including urban and associated areas)</td>
<td>5006</td>
<td>Area from CGLS</td>
<td>2016</td>
<td>2016</td>
<td>1000 ha</td>
<td>103.30</td>
<td>E</td>
</tr>
<tr>
<th>2</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>6970</td>
<td>Artificial surfaces (including urban and associated areas)</td>
<td>5006</td>
<td>Area from CGLS</td>
<td>2017</td>
<td>2017</td>
<td>1000 ha</td>
<td>105.41</td>
<td>E</td>
</tr>
<tr>
<th>3</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>6970</td>
<td>Artificial surfaces (including urban and associated areas)</td>
<td>5006</td>
<td>Area from CGLS</td>
<td>2018</td>
<td>2018</td>
<td>1000 ha</td>
<td>107.46</td>
<td>E</td>
</tr>
<tr>
<th>4</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>6970</td>
<td>Artificial surfaces (including urban and associated areas)</td>
<td>5006</td>
<td>Area from CGLS</td>
<td>2019</td>
<td>2019</td>
<td>1000 ha</td>
<td>108.34</td>
<td>E</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
 Valors nics de la columna 'Item':
Total nics: 14 (mostrant com a mxim 50)
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Item</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Artificial surfaces (including urban and associated areas)</td>
</tr>
<tr>
<th>1</th>
<td>Herbaceous crops</td>
</tr>
<tr>
<th>2</th>
<td>Woody crops</td>
</tr>
<tr>
<th>3</th>
<td>Multiple or layered crops</td>
</tr>
<tr>
<th>4</th>
<td>Grassland</td>
</tr>
<tr>
<th>5</th>
<td>Tree-covered areas</td>
</tr>
<tr>
<th>6</th>
<td>Mangroves</td>
</tr>
<tr>
<th>7</th>
<td>Shrub-covered areas</td>
</tr>
<tr>
<th>8</th>
<td>Shrubs and/or herbaceous vegetation, aquatic or regularly flooded</td>
</tr>
<tr>
<th>9</th>
<td>Sparsely natural vegetated areas</td>
</tr>
<tr>
<th>10</th>
<td>Terrestrial barren land</td>
</tr>
<tr>
<th>11</th>
<td>Permanent snow and glaciers</td>
</tr>
<tr>
<th>12</th>
<td>Inland water bodies</td>
</tr>
<tr>
<th>13</th>
<td>Coastal water bodies and intertidal areas</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
 Valors nics de la columna 'Element':
Total nics: 4 (mostrant com a mxim 50)
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Element</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Area from CGLS</td>
</tr>
<tr>
<th>1</th>
<td>Area from MODIS</td>
</tr>
<tr>
<th>2</th>
<td>Area from CCI_LC</td>
</tr>
<tr>
<th>3</th>
<td>Area from WorldCover</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre> Altres dataframes de Environment_LandCover:

 Contingut de Environment_LandCover_E_AreaCodes:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>M49 Code</th>
<th>Area</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
</tr>
<tr>
<th>1</th>
<td>5100</td>
<td>'002</td>
<td>Africa</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>'008</td>
<td>Albania</td>
</tr>
<tr>
<th>3</th>
<td>4</td>
<td>'012</td>
<td>Algeria</td>
</tr>
<tr>
<th>4</th>
<td>5</td>
<td>'016</td>
<td>American Samoa</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>


 Contingut de Environment_LandCover_E_Elements:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Element Code</th>
<th>Element</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>5008</td>
<td>Area from CCI_LC</td>
</tr>
<tr>
<th>1</th>
<td>5006</td>
<td>Area from CGLS</td>
</tr>
<tr>
<th>2</th>
<td>5007</td>
<td>Area from MODIS</td>
</tr>
<tr>
<th>3</th>
<td>5013</td>
<td>Area from WorldCover</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>


 Contingut de Environment_LandCover_E_Flags:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Flag</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>E</td>
<td>Estimated value</td>
</tr>
<tr>
<th>1</th>
<td>O</td>
<td>Missing value</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>


 Contingut de Environment_LandCover_E_ItemCodes:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Item Code</th>
<th>CPC Code</th>
<th>Item</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>

</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=142ad448">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Creaci%C3%B3-de-landcover_df">Creaci de <code>landcover_df</code><a class="anchor-link" href="#Creaci%C3%B3-de-landcover_df"></a></h3><p>Creem el dataframe de LandCover basat en el dataset principal de Environment_LandCover.</p>
<p>Del domini Land Cover hem seleccionat nicament els tems Grassland, Tree-covered areas i Herbaceous crops, ja que permeten caracteritzar els principals usos del sl relacionats amb agricultura, ramaderia i ocupaci forestal. La resta dtems aporten un nivell de detall massa especfic, poc estable al llarg del temps o no relacionat directament amb lactivitat agrria. Igualment, mantenim noms lelement Area from CCI_LC, ja que s el producte de coberta terrestre amb major consistncia metodolgica i aplicabilitat global (<a href="https://www.esa-landcover-cci.org/">https://www.esa-landcover-cci.org/</a>), i evita la duplicaci dinformaci que generaria utilitzar MODIS, CGLS o WorldCover. Aquesta selecci garanteix un conjunt de dades lleuger, coherent i til per a la visualitzaci final.</p>
<p><strong>Transformacions realitzades:</strong></p>
<ul>
<li>Eliminem les columnes <code>Note</code> i <code>Flag</code> (informaci no utilitzable per a l'anlisi)</li>
<li>Renombrem columnes per a millor claredat: <code>Item</code> a <code>landcover_category</code>, <code>Element</code> a <code>landcover_metric</code></li>
</ul>
<h1 id="Filtrar-els-items-i-elements-per-a-LandCover:">Filtrar els items i elements per a LandCover:<a class="anchor-link" href="#Filtrar-els-items-i-elements-per-a-LandCover:"></a></h1><p>landcover_items_to_keep = [
"Grassland",
"Tree-covered areas",
"Herbaceous crops"
]
landcover_elements_to_keep = ["Area from CCI_LC"]</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=5fd6c630">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[31]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Crear landcover_df utilitzant la funci generalitzada</span>
<span class="n">key</span> <span class="o">=</span> <span class="s1">'Environment_LandCover'</span>
<span class="n">df_name</span> <span class="o">=</span> <span class="s1">'landcover_df'</span>
<span class="n">column_mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'Item Code'</span><span class="p">:</span> <span class="s1">'landcover_category_code'</span><span class="p">,</span>
    <span class="s1">'Item'</span><span class="p">:</span> <span class="s1">'landcover_category'</span><span class="p">,</span>
    <span class="s1">'Element Code'</span><span class="p">:</span> <span class="s1">'landcover_metric_code'</span><span class="p">,</span>
    <span class="s1">'Element'</span><span class="p">:</span> <span class="s1">'landcover_metric'</span>
<span class="p">}</span>
<span class="n">values_to_keep</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'landcover_category'</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">"Grassland"</span><span class="p">,</span>
        <span class="s2">"Tree-covered areas"</span><span class="p">,</span>
        <span class="s2">"Herbaceous crops"</span>
    <span class="p">],</span>
    <span class="s1">'landcover_metric'</span><span class="p">:</span> <span class="p">[</span><span class="s2">"Area from CCI_LC"</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">landcover_df</span> <span class="o">=</span> <span class="n">crear_df_faostat_filtrat</span><span class="p">(</span>
    <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
    <span class="n">df_name</span><span class="o">=</span><span class="n">df_name</span><span class="p">,</span>
    <span class="n">column_mapping</span><span class="o">=</span><span class="n">column_mapping</span><span class="p">,</span>
    <span class="n">values_to_keep</span><span class="o">=</span><span class="n">values_to_keep</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Creaci de landcover_df

Valors diferents de 'Unit':
landcover_category  landcover_metric
Grassland           Area from CCI_LC    [1000 ha]
Herbaceous crops    Area from CCI_LC    [1000 ha]
Tree-covered areas  Area from CCI_LC    [1000 ha]
Name: Unit, dtype: object

Dimensions finals: 25,164 files x 11 columnes

Columnes finals (11):
   1. Area Code
   2. Area Code (M49)
   3. Area
   4. landcover_category_code
   5. landcover_category
   6. landcover_metric_code
   7. landcover_metric
   8. Year Code
   9. Year
  10. Unit
  11. Value

Primeres files de landcover_df:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>landcover_category_code</th>
<th>landcover_category</th>
<th>landcover_metric_code</th>
<th>landcover_metric</th>
<th>Year Code</th>
<th>Year</th>
<th>Unit</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<th>89</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>6971</td>
<td>Herbaceous crops</td>
<td>5008</td>
<td>Area from CCI_LC</td>
<td>1992</td>
<td>1992</td>
<td>1000 ha</td>
<td>5759.76</td>
</tr>
<tr>
<th>90</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>6971</td>
<td>Herbaceous crops</td>
<td>5008</td>
<td>Area from CCI_LC</td>
<td>1993</td>
<td>1993</td>
<td>1000 ha</td>
<td>5765.63</td>
</tr>
<tr>
<th>91</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>6971</td>
<td>Herbaceous crops</td>
<td>5008</td>
<td>Area from CCI_LC</td>
<td>1994</td>
<td>1994</td>
<td>1000 ha</td>
<td>5763.95</td>
</tr>
<tr>
<th>92</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>6971</td>
<td>Herbaceous crops</td>
<td>5008</td>
<td>Area from CCI_LC</td>
<td>1995</td>
<td>1995</td>
<td>1000 ha</td>
<td>5768.02</td>
</tr>
<tr>
<th>93</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>6971</td>
<td>Herbaceous crops</td>
<td>5008</td>
<td>Area from CCI_LC</td>
<td>1996</td>
<td>1996</td>
<td>1000 ha</td>
<td>5781.61</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
Resum de valors nics:
  - landcover_category nics: 3 a ['Grassland', 'Herbaceous crops', 'Tree-covered areas']
  - landcover_metric nics: 1 a ['Area from CCI_LC']
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=9c4f9249">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Pivot-de-landcover_df">Pivot de <code>landcover_df</code><a class="anchor-link" href="#Pivot-de-landcover_df"></a></h3>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=db0492a6">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[32]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Creem la columna pivot_col segons l'estructura:</span>
<span class="n">landcover_df</span><span class="p">[</span><span class="s2">"pivot_col"</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">"Value_"</span>
    <span class="o">+</span> <span class="n">landcover_df</span><span class="p">[</span><span class="s2">"landcover_category_code"</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
    <span class="o">+</span> <span class="s2">"_"</span>
    <span class="o">+</span> <span class="n">landcover_df</span><span class="p">[</span><span class="s2">"landcover_category"</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span>
    <span class="o">+</span> <span class="s2">"_ha"</span>
<span class="p">)</span>

<span class="c1"># Convertim Value de 1000 ha a ha</span>
<span class="n">landcover_df</span><span class="p">[</span><span class="s2">"Value"</span><span class="p">]</span> <span class="o">=</span> <span class="n">landcover_df</span><span class="p">[</span><span class="s2">"Value"</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1000</span>

<span class="c1"># Pivotem el dataframe</span>
<span class="n">landcover_pivot</span> <span class="o">=</span> <span class="n">pivot_faostat_df</span><span class="p">(</span><span class="n">landcover_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Year Code</th>
<th>Year</th>
<th>Value_6971_herbaceous_crops_ha</th>
<th>Value_6974_tree-covered_areas_ha</th>
<th>Value_6983_grassland_ha</th>
</tr>
</thead>
<tbody>
<tr>
<th>5756</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1992</td>
<td>1992</td>
<td>16689280.0</td>
<td>13019730.0</td>
<td>7184060.0</td>
</tr>
<tr>
<th>5757</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1993</td>
<td>1993</td>
<td>16688080.0</td>
<td>13020160.0</td>
<td>7183810.0</td>
</tr>
<tr>
<th>5758</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1994</td>
<td>1994</td>
<td>16624710.0</td>
<td>13020610.0</td>
<td>7183600.0</td>
</tr>
<tr>
<th>5759</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1995</td>
<td>1995</td>
<td>16455090.0</td>
<td>12949110.0</td>
<td>7192770.0</td>
</tr>
<tr>
<th>5760</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1996</td>
<td>1996</td>
<td>16614490.0</td>
<td>12937310.0</td>
<td>7193760.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=726f221a">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Merge-de-landcover_df-amb-el-dataframe-principal">Merge de <code>landcover_df</code> amb el dataframe principal<a class="anchor-link" href="#Merge-de-landcover_df-amb-el-dataframe-principal"></a></h3><p>Un cop creat el pivot, farem el merge amb el dataframe principal utilitzant la funci <code>merge_agri_dataframes</code>.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=24ccf164">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[33]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Fem el merge utilitzant la funci generalitzada</span>
<span class="n">agri_landcover_df</span> <span class="o">=</span> <span class="n">merge_agri_dataframes</span><span class="p">(</span>
    <span class="n">df_initial</span><span class="o">=</span><span class="n">agri_pesticides_df</span><span class="p">,</span>
    <span class="n">df_to_merge</span><span class="o">=</span><span class="n">landcover_pivot</span><span class="p">,</span>
    <span class="n">df_name_initial</span><span class="o">=</span><span class="s2">"agri_pesticides_df"</span><span class="p">,</span>
    <span class="n">df_name_to_merge</span><span class="o">=</span><span class="s2">"landcover_pivot"</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Nombre de files de agri_pesticides_df: 12729
Nombre de columnes de agri_pesticides_df: 24
Nombre de files de landcover_pivot: 8388
Nombre de columnes de landcover_pivot: 8
Nombre final de files del resultat: 12729
Nombre final de columnes del resultat: 27
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Year Code</th>
<th>Year</th>
<th>Value_nutrient_3102_N_Agricultural_Use_t</th>
<th>Value_nutrient_3102_N_Use_per_area_of_cropland_kg/ha</th>
<th>Value_nutrient_3102_N_Use_per_capita_kg/cap</th>
<th>Value_nutrient_3102_N_Use_per_value_of_agricultural_production_g/Int$</th>
<th>Value_nutrient_3103_P2O5_Agricultural_Use_t</th>
<th>Value_nutrient_3103_P2O5_Use_per_area_of_cropland_kg/ha</th>
<th>Value_nutrient_3103_P2O5_Use_per_capita_kg/cap</th>
<th>Value_nutrient_3103_P2O5_Use_per_value_of_agricultural_production_g/Int$</th>
<th>Value_nutrient_3104_K2O_Agricultural_Use_t</th>
<th>Value_nutrient_3104_K2O_Use_per_area_of_cropland_kg/ha</th>
<th>Value_nutrient_3104_K2O_Use_per_capita_kg/cap</th>
<th>Value_nutrient_3104_K2O_Use_per_value_of_agricultural_production_g/Int$</th>
<th>Value_6601_land_area_ha</th>
<th>Value_6610_agricultural_land_ha</th>
<th>Value_6620_cropland_ha</th>
<th>Value_6621_arable_land_ha</th>
<th>Value_6650_permanent_crops_ha</th>
<th>Value_6655_permanent_meadows_and_pastures_ha</th>
<th>Value_pesticide_agricultural_use_t</th>
<th>Value_6971_herbaceous_crops_ha</th>
<th>Value_6974_tree-covered_areas_ha</th>
<th>Value_6983_grassland_ha</th>
</tr>
</thead>
<tbody>
<tr>
<th>8697</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>2020</td>
<td>2020</td>
<td>1059299.0</td>
<td>63.64</td>
<td>22.22</td>
<td>18.35</td>
<td>486673.0</td>
<td>29.24</td>
<td>10.21</td>
<td>8.43</td>
<td>399489.0</td>
<td>24.0</td>
<td>8.38</td>
<td>6.92</td>
<td>49955664.5</td>
<td>26142638.1</td>
<td>16646395.1</td>
<td>11639398.1</td>
<td>5006997.0</td>
<td>9496243.0</td>
<td>75775.0</td>
<td>15384230.0</td>
<td>12553120.0</td>
<td>7383290.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=e8a9625d">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="An%C3%A0lisi-del-dataset-Emissions">Anlisi del dataset Emissions<a class="anchor-link" href="#An%C3%A0lisi-del-dataset-Emissions"></a></h3><p>Analitzem el dataset de Emissions per veure quina informaci cont i com podem integrar-la al dataframe final.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=1e9dcd77">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[34]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Analitzar el dataset de Emissions</span>
<span class="n">analitzar_dataset_faostat</span><span class="p">(</span><span class="s1">'Emissions_Totals'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Anlisi del dataset: Emissions_Totals

Dataframe principal (Emissions_Totals_E_All_Data_(Normalized)):
Dimensions: 2,500,184 files x 15 columnes

 Columnes (15):
   1. Area Code
   2. Area Code (M49)
   3. Area
   4. Item Code
   5. Item
   6. Element Code
   7. Element
   8. Year Code
   9. Year
  10. Source Code
  11. Source
  12. Unit
  13. Value
  14. Flag
  15. Note

 Primeres files del dataframe principal:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Item Code</th>
<th>Item</th>
<th>Element Code</th>
<th>Element</th>
<th>Year Code</th>
<th>Year</th>
<th>Source Code</th>
<th>Source</th>
<th>Unit</th>
<th>Value</th>
<th>Flag</th>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>5064</td>
<td>Crop Residues</td>
<td>7234</td>
<td>Direct emissions (N2O)</td>
<td>1961</td>
<td>1961</td>
<td>3050</td>
<td>FAO TIER 1</td>
<td>kt</td>
<td>0.8762</td>
<td>E</td>
<td>NaN</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>5064</td>
<td>Crop Residues</td>
<td>7234</td>
<td>Direct emissions (N2O)</td>
<td>1962</td>
<td>1962</td>
<td>3050</td>
<td>FAO TIER 1</td>
<td>kt</td>
<td>0.8829</td>
<td>E</td>
<td>NaN</td>
</tr>
<tr>
<th>2</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>5064</td>
<td>Crop Residues</td>
<td>7234</td>
<td>Direct emissions (N2O)</td>
<td>1963</td>
<td>1963</td>
<td>3050</td>
<td>FAO TIER 1</td>
<td>kt</td>
<td>0.8236</td>
<td>E</td>
<td>NaN</td>
</tr>
<tr>
<th>3</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>5064</td>
<td>Crop Residues</td>
<td>7234</td>
<td>Direct emissions (N2O)</td>
<td>1964</td>
<td>1964</td>
<td>3050</td>
<td>FAO TIER 1</td>
<td>kt</td>
<td>0.8882</td>
<td>E</td>
<td>NaN</td>
</tr>
<tr>
<th>4</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>5064</td>
<td>Crop Residues</td>
<td>7234</td>
<td>Direct emissions (N2O)</td>
<td>1965</td>
<td>1965</td>
<td>3050</td>
<td>FAO TIER 1</td>
<td>kt</td>
<td>0.8978</td>
<td>E</td>
<td>NaN</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
 Valors nics de la columna 'Item':
Total nics: 44 (mostrant com a mxim 50)
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Item</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Crop Residues</td>
</tr>
<tr>
<th>1</th>
<td>Rice Cultivation</td>
</tr>
<tr>
<th>2</th>
<td>Burning - Crop residues</td>
</tr>
<tr>
<th>3</th>
<td>Enteric Fermentation</td>
</tr>
<tr>
<th>4</th>
<td>Manure Management</td>
</tr>
<tr>
<th>5</th>
<td>Manure left on Pasture</td>
</tr>
<tr>
<th>6</th>
<td>Manure applied to Soils</td>
</tr>
<tr>
<th>7</th>
<td>Synthetic Fertilizers</td>
</tr>
<tr>
<th>8</th>
<td>Drained organic soils</td>
</tr>
<tr>
<th>9</th>
<td>Drained organic soils (CO2)</td>
</tr>
<tr>
<th>10</th>
<td>Drained organic soils (N2O)</td>
</tr>
<tr>
<th>11</th>
<td>On-farm energy use</td>
</tr>
<tr>
<th>12</th>
<td>Forestland</td>
</tr>
<tr>
<th>13</th>
<td>Net Forest conversion</td>
</tr>
<tr>
<th>14</th>
<td>Savanna fires</td>
</tr>
<tr>
<th>15</th>
<td>Fires in organic soils</td>
</tr>
<tr>
<th>16</th>
<td>Forest fires</td>
</tr>
<tr>
<th>17</th>
<td>Fires in humid tropical forests</td>
</tr>
<tr>
<th>18</th>
<td>Agrifood Systems Waste Disposal</td>
</tr>
<tr>
<th>19</th>
<td>Fertilizers Manufacturing</td>
</tr>
<tr>
<th>20</th>
<td>Food Retail</td>
</tr>
<tr>
<th>21</th>
<td>Food Household Consumption</td>
</tr>
<tr>
<th>22</th>
<td>Food Transport</td>
</tr>
<tr>
<th>23</th>
<td>Energy</td>
</tr>
<tr>
<th>24</th>
<td>IPPU</td>
</tr>
<tr>
<th>25</th>
<td>Waste</td>
</tr>
<tr>
<th>26</th>
<td>Other</td>
</tr>
<tr>
<th>27</th>
<td>Agrifood systems</td>
</tr>
<tr>
<th>28</th>
<td>Farm gate</td>
</tr>
<tr>
<th>29</th>
<td>Land-use change</td>
</tr>
<tr>
<th>30</th>
<td>Pre- and post-production</td>
</tr>
<tr>
<th>31</th>
<td>Emissions on agricultural land</td>
</tr>
<tr>
<th>32</th>
<td>Emissions from crops</td>
</tr>
<tr>
<th>33</th>
<td>Emissions from livestock</td>
</tr>
<tr>
<th>34</th>
<td>IPCC Agriculture</td>
</tr>
<tr>
<th>35</th>
<td>Agricultural Soils</td>
</tr>
<tr>
<th>36</th>
<td>LULUCF</td>
</tr>
<tr>
<th>37</th>
<td>AFOLU</td>
</tr>
<tr>
<th>38</th>
<td>All sectors with LULUCF</td>
</tr>
<tr>
<th>39</th>
<td>All sectors without LULUCF</td>
</tr>
<tr>
<th>40</th>
<td>Pesticides Manufacturing</td>
</tr>
<tr>
<th>41</th>
<td>Food Processing</td>
</tr>
<tr>
<th>42</th>
<td>Food Packaging</td>
</tr>
<tr>
<th>43</th>
<td>International bunkers</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
 Valors nics de la columna 'Element':
Total nics: 9 (mostrant com a mxim 50)
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Element</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Direct emissions (N2O)</td>
</tr>
<tr>
<th>1</th>
<td>Indirect emissions (N2O)</td>
</tr>
<tr>
<th>2</th>
<td>Emissions (N2O)</td>
</tr>
<tr>
<th>3</th>
<td>Emissions (CO2eq) from N2O (AR5)</td>
</tr>
<tr>
<th>4</th>
<td>Emissions (CO2eq) (AR5)</td>
</tr>
<tr>
<th>5</th>
<td>Emissions (CH4)</td>
</tr>
<tr>
<th>6</th>
<td>Emissions (CO2eq) from CH4 (AR5)</td>
</tr>
<tr>
<th>7</th>
<td>Emissions (CO2)</td>
</tr>
<tr>
<th>8</th>
<td>Emissions (CO2eq) from F-gases (AR5)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
 Valors nics de la columna 'Source':
Total nics: 2 (mostrant com a mxim 50)
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Source</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>FAO TIER 1</td>
</tr>
<tr>
<th>1</th>
<td>UNFCCC</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre> Altres dataframes de Emissions_Totals:

 Contingut de Emissions_Totals_E_AreaCodes:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>M49 Code</th>
<th>Area</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
</tr>
<tr>
<th>1</th>
<td>5100</td>
<td>'002</td>
<td>Africa</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>'008</td>
<td>Albania</td>
</tr>
<tr>
<th>3</th>
<td>4</td>
<td>'012</td>
<td>Algeria</td>
</tr>
<tr>
<th>4</th>
<td>5</td>
<td>'016</td>
<td>American Samoa</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>


 Contingut de Emissions_Totals_E_Elements:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Element Code</th>
<th>Element</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>7234</td>
<td>Direct emissions (N2O)</td>
</tr>
<tr>
<th>1</th>
<td>7225</td>
<td>Emissions (CH4)</td>
</tr>
<tr>
<th>2</th>
<td>7273</td>
<td>Emissions (CO2)</td>
</tr>
<tr>
<th>3</th>
<td>723113</td>
<td>Emissions (CO2eq) (AR5)</td>
</tr>
<tr>
<th>4</th>
<td>724413</td>
<td>Emissions (CO2eq) from CH4 (AR5)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>


 Contingut de Emissions_Totals_E_Flags:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Flag</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>A</td>
<td>Official figure</td>
</tr>
<tr>
<th>1</th>
<td>E</td>
<td>Estimated value</td>
</tr>
<tr>
<th>2</th>
<td>F</td>
<td>Forecast value</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>


 Contingut de Emissions_Totals_E_ItemCodes:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Item Code</th>
<th>CPC Code</th>
<th>Item</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>


 Contingut de Emissions_Totals_E_Sources:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Source Code</th>
<th>Source</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>3050</td>
<td>FAO TIER 1</td>
</tr>
<tr>
<th>1</th>
<td>3051</td>
<td>UNFCCC</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>

</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=20802d1e">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Creaci%C3%B3-de-emissions_df">Creaci de <code>emissions_df</code><a class="anchor-link" href="#Creaci%C3%B3-de-emissions_df"></a></h3><p>Creem el dataframe de Emissions basat en el dataset principal de Emissions_Totals.</p>
<h4 id="Justificaci%C3%B3-de-la-selecci%C3%B3-d%E2%80%99Items,-Elements-i-Font-del-domini-Emissions-Totals">Justificaci de la selecci dItems, Elements i Font del domini <em>Emissions Totals</em><a class="anchor-link" href="#Justificaci%C3%B3-de-la-selecci%C3%B3-d%E2%80%99Items,-Elements-i-Font-del-domini-Emissions-Totals"></a></h4><p>En el domini dEmissions Totals, el volum dinformaci disponible s molt ampli i inclou emissions agrcoles, forestals, energtiques, industrials i daltres sectors dels sistemes alimentaris.</p>
<h5 id="1.-Selecci%C3%B3-d%E2%80%99Items-(categories-d%E2%80%99emissions)">1. Selecci dItems (categories demissions)<a class="anchor-link" href="#1.-Selecci%C3%B3-d%E2%80%99Items-(categories-d%E2%80%99emissions)"></a></h5><p>Shan seleccionat els tems directament atribubles a lactivitat agrcola segons la metodologia del <strong>IPCC</strong> i les prctiques estndard de la FAO:</p>
<ul>
<li><strong>Enteric Fermentation</strong><br/>
Emissions de CH derivades de la digesti de rumiants.</li>
<li><strong>Manure Management</strong><br/>
Emissions de CH i NO derivades del tractament i emmagatzematge del fem.</li>
<li><strong>Synthetic Fertilizers</strong><br/>
Emissions de NO provinents de laplicaci dadobs sinttics.</li>
<li><strong>Agricultural Soils</strong><br/>
Emissions de NO associades a lactivitat biogeoqumica del sl agrcola.</li>
<li><strong>Rice Cultivation</strong><br/>
Emissions de CH en arrossars inundats.</li>
<li><strong>Crop Residues</strong><br/>
Emissions derivades de la descomposici de residus vegetals.</li>
<li><strong>Emissions from livestock</strong><br/>
Indicador agregat per representar limpacte total del sector ramader.</li>
</ul>
<p>Aquests set tems cobreixen de forma completa les fonts demissions prpiament agrcoles en el sentit IPCC. Shan excls categories com <em>Energy</em>, <em>Waste</em>, <em>Land-use change</em>, <em>Forest fires</em>, <em>AFOLU</em>, <em>IPCC Agriculture</em>, o emissions industrials i logstiques (<em>Food processing</em>, <em>Transport</em>, <em>Packaging</em>), ja que no formen part del nucli de lactivitat agrcola estricta, barregen mltiples sectors o generen duplicacions dinformaci.</p>
<p>Source: <a href="https://www.ipcc.ch/languages-2/spanish/">https://www.ipcc.ch/languages-2/spanish/</a></p>
<h5 id="2.-Selecci%C3%B3-d%E2%80%99Elements-(tipus-d%E2%80%99emissi%C3%B3)">2. Selecci dElements (tipus demissi)<a class="anchor-link" href="#2.-Selecci%C3%B3-d%E2%80%99Elements-(tipus-d%E2%80%99emissi%C3%B3)"></a></h5><p>Sha seleccionat nicament:</p>
<ul>
<li><strong>Emissions (COeq) (AR5)</strong></li>
</ul>
<p>Aquesta elecci es justifica perqu:</p>
<ol>
<li><strong>COeq</strong> integra CH i NO en una nica mtrica comparable utilitzant els factors de potencial descalfament global del <strong>IPCC AR5</strong>.</li>
<li>Evita la necessitat de gestionar columnes mltiples per contaminant, reduint la dimensionalitat del conjunt de dades.</li>
<li>s lestndard ms utilitzat en informes internacionals de poltica climtica i estudis de sostenibilitat agrcola.</li>
</ol>
<p>Elements com <em>Direct emissions (NO)</em>, <em>Emissions (CH)</em> o <em>Emissions (CO)</em> shan descartat per ser redundants o massa especfics.</p>
<p>Source: <a href="https://www.ipcc.ch/assessment-report/ar5/">https://www.ipcc.ch/assessment-report/ar5/</a></p>
<h5 id="3.-Selecci%C3%B3-de-Font-(Source)">3. Selecci de Font (Source)<a class="anchor-link" href="#3.-Selecci%C3%B3-de-Font-(Source)"></a></h5><p>Entre les dues fonts disponibles:</p>
<ul>
<li><strong>FAO TIER 1</strong></li>
<li><strong>UNFCCC</strong></li>
</ul>
<p>Sha seleccionat <strong>FAO TIER 1</strong> per oferir una metodologia harmonitzada i consistent derivada de les guies del IPCC.</p>
<p><strong>Transformacions realitzades:</strong></p>
<ul>
<li>S'han eliminat les columnes <code>Note</code> i <code>Flag</code> (informaci no rellevant per a l'anlisi)</li>
<li>S'han renombrat les columnes per claredat: <code>Item</code>  <code>emission_category</code>, <code>Element</code>  <code>emission_metric</code></li>
<li>S'han filtrat els items per incloure noms les categories demissi agrcoles segents:<ul>
<li>Enteric Fermentation</li>
<li>Manure Management</li>
<li>Synthetic Fertilizers</li>
<li>Agricultural Soils</li>
<li>Rice Cultivation</li>
<li>Crop Residues</li>
<li>Emissions from livestock</li>
</ul>
</li>
<li>S'ha filtrat l'element per incloure noms: <code>Emissions (CO2eq) (AR5)</code></li>
<li>S'ha filtrat per quedar-se amb la font FAO TIER 1.</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=0f80415d">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[35]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">key</span> <span class="o">=</span> <span class="s1">'Emissions_Totals'</span>
<span class="n">df_name</span> <span class="o">=</span> <span class="s1">'emissions_df'</span>
<span class="n">column_mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'Item Code'</span><span class="p">:</span> <span class="s1">'emission_category_code'</span><span class="p">,</span>
    <span class="s1">'Item'</span><span class="p">:</span> <span class="s1">'emission_category'</span><span class="p">,</span>
    <span class="s1">'Element Code'</span><span class="p">:</span> <span class="s1">'emission_metric_code'</span><span class="p">,</span>
    <span class="s1">'Element'</span><span class="p">:</span> <span class="s1">'emission_metric'</span>
<span class="p">}</span>

<span class="c1"># Definir les categories ditem i elements a conservar segons els criteris exposats</span>
<span class="n">values_to_keep</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'emission_category'</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">"Enteric Fermentation"</span><span class="p">,</span>
        <span class="s2">"Manure Management"</span><span class="p">,</span>
        <span class="s2">"Synthetic Fertilizers"</span><span class="p">,</span>
        <span class="s2">"Agricultural Soils"</span><span class="p">,</span>
        <span class="s2">"Rice Cultivation"</span><span class="p">,</span>
        <span class="s2">"Crop Residues"</span><span class="p">,</span>
        <span class="s2">"Emissions from livestock"</span>
    <span class="p">],</span>
    <span class="s1">'emission_metric'</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">"Emissions (CO2eq) (AR5)"</span>
    <span class="p">],</span>
    <span class="s1">'Source'</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">"FAO TIER 1"</span>
    <span class="p">]</span>
<span class="p">}</span>


<span class="c1"># Crear el dataframe filtrat</span>
<span class="n">emissions_df</span> <span class="o">=</span> <span class="n">crear_df_faostat_filtrat</span><span class="p">(</span>
    <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
    <span class="n">df_name</span><span class="o">=</span><span class="n">df_name</span><span class="p">,</span>
    <span class="n">column_mapping</span><span class="o">=</span><span class="n">column_mapping</span><span class="p">,</span>
    <span class="n">values_to_keep</span><span class="o">=</span><span class="n">values_to_keep</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Creaci de emissions_df

Valors diferents de 'Unit':
emission_category         emission_metric          Source    
Agricultural Soils        Emissions (CO2eq) (AR5)  FAO TIER 1    [kt]
Crop Residues             Emissions (CO2eq) (AR5)  FAO TIER 1    [kt]
Emissions from livestock  Emissions (CO2eq) (AR5)  FAO TIER 1    [kt]
Enteric Fermentation      Emissions (CO2eq) (AR5)  FAO TIER 1    [kt]
Manure Management         Emissions (CO2eq) (AR5)  FAO TIER 1    [kt]
Rice Cultivation          Emissions (CO2eq) (AR5)  FAO TIER 1    [kt]
Synthetic Fertilizers     Emissions (CO2eq) (AR5)  FAO TIER 1    [kt]
Name: Unit, dtype: object

Dimensions finals: 97,415 files x 13 columnes

Columnes finals (13):
   1. Area Code
   2. Area Code (M49)
   3. Area
   4. emission_category_code
   5. emission_category
   6. emission_metric_code
   7. emission_metric
   8. Year Code
   9. Year
  10. Source Code
  11. Source
  12. Unit
  13. Value

Primeres files de emissions_df:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>emission_category_code</th>
<th>emission_category</th>
<th>emission_metric_code</th>
<th>emission_metric</th>
<th>Year Code</th>
<th>Year</th>
<th>Source Code</th>
<th>Source</th>
<th>Unit</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<th>260</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>5064</td>
<td>Crop Residues</td>
<td>723113</td>
<td>Emissions (CO2eq) (AR5)</td>
<td>1961</td>
<td>1961</td>
<td>3050</td>
<td>FAO TIER 1</td>
<td>kt</td>
<td>284.4510</td>
</tr>
<tr>
<th>261</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>5064</td>
<td>Crop Residues</td>
<td>723113</td>
<td>Emissions (CO2eq) (AR5)</td>
<td>1962</td>
<td>1962</td>
<td>3050</td>
<td>FAO TIER 1</td>
<td>kt</td>
<td>286.6240</td>
</tr>
<tr>
<th>262</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>5064</td>
<td>Crop Residues</td>
<td>723113</td>
<td>Emissions (CO2eq) (AR5)</td>
<td>1963</td>
<td>1963</td>
<td>3050</td>
<td>FAO TIER 1</td>
<td>kt</td>
<td>267.3585</td>
</tr>
<tr>
<th>263</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>5064</td>
<td>Crop Residues</td>
<td>723113</td>
<td>Emissions (CO2eq) (AR5)</td>
<td>1964</td>
<td>1964</td>
<td>3050</td>
<td>FAO TIER 1</td>
<td>kt</td>
<td>288.3200</td>
</tr>
<tr>
<th>264</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>5064</td>
<td>Crop Residues</td>
<td>723113</td>
<td>Emissions (CO2eq) (AR5)</td>
<td>1965</td>
<td>1965</td>
<td>3050</td>
<td>FAO TIER 1</td>
<td>kt</td>
<td>291.4470</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
Resum de valors nics:
  - emission_category nics: 7 a ['Agricultural Soils', 'Crop Residues', 'Emissions from livestock', 'Enteric Fermentation', 'Manure Management', 'Rice Cultivation', 'Synthetic Fertilizers']
  - emission_metric nics: 1 a ['Emissions (CO2eq) (AR5)']
  - Source nics: 1 a ['FAO TIER 1']
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=a0ef5d4b">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Pivot-de-emissions_df">Pivot de <code>emissions_df</code><a class="anchor-link" href="#Pivot-de-emissions_df"></a></h3>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=88efacb2">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[36]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Crear la columna pivot_col segons les instruccions</span>
<span class="n">emissions_df</span><span class="p">[</span><span class="s2">"pivot_col"</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">"Value_"</span>
    <span class="o">+</span> <span class="n">emissions_df</span><span class="p">[</span><span class="s2">"emission_category_code"</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
    <span class="o">+</span> <span class="s2">"_"</span>
    <span class="o">+</span> <span class="n">emissions_df</span><span class="p">[</span><span class="s2">"emission_category"</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">" "</span><span class="p">,</span> <span class="s2">"_"</span><span class="p">)</span>
    <span class="o">+</span> <span class="s2">"_CO2eq_AR5_kt_FAO_TIER_1"</span>
<span class="p">)</span>

<span class="n">emissions_pivot</span> <span class="o">=</span> <span class="n">pivot_faostat_df</span><span class="p">(</span><span class="n">emissions_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Year Code</th>
<th>Year</th>
<th>Value_1709_agricultural_soils_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5058_enteric_fermentation_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5059_manure_management_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5060_rice_cultivation_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5061_synthetic_fertilizers_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5064_crop_residues_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5085_emissions_from_livestock_CO2eq_AR5_kt_FAO_TIER_1</th>
</tr>
</thead>
<tbody>
<tr>
<th>10788</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1961</td>
<td>1961</td>
<td>6961.4440</td>
<td>14814.5032</td>
<td>4186.0065</td>
<td>873.5328</td>
<td>1805.2595</td>
<td>646.3615</td>
<td>23510.3355</td>
</tr>
<tr>
<th>10789</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1962</td>
<td>1962</td>
<td>7032.3315</td>
<td>14564.3120</td>
<td>4227.3978</td>
<td>889.6216</td>
<td>1906.3305</td>
<td>752.9975</td>
<td>23164.7133</td>
</tr>
<tr>
<th>10790</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1963</td>
<td>1963</td>
<td>6851.4160</td>
<td>14277.2840</td>
<td>4273.5225</td>
<td>884.8224</td>
<td>1837.5630</td>
<td>761.6100</td>
<td>22803.0495</td>
</tr>
<tr>
<th>10791</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1964</td>
<td>1964</td>
<td>6870.8670</td>
<td>14158.4716</td>
<td>4257.4815</td>
<td>904.4112</td>
<td>2008.7265</td>
<td>682.2955</td>
<td>22595.7981</td>
</tr>
<tr>
<th>10792</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1965</td>
<td>1965</td>
<td>6907.9140</td>
<td>14010.2284</td>
<td>3734.4260</td>
<td>832.5800</td>
<td>2122.7560</td>
<td>718.4415</td>
<td>21811.3709</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=63754171">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Merge-de-emissions_df-amb-el-dataframe-principal">Merge de <code>emissions_df</code> amb el dataframe principal<a class="anchor-link" href="#Merge-de-emissions_df-amb-el-dataframe-principal"></a></h3><p>Un cop creat el pivot, farem el merge amb el dataframe principal utilitzant la funci <code>merge_agri_dataframes</code>.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=27ee1c73">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[37]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Un cop creat emissions_pivot, fem el merge utilitzant la funci generalitzada</span>
<span class="n">agri_emissions_df</span> <span class="o">=</span> <span class="n">merge_agri_dataframes</span><span class="p">(</span>
    <span class="n">df_initial</span><span class="o">=</span><span class="n">agri_landcover_df</span><span class="p">,</span>
    <span class="n">df_to_merge</span><span class="o">=</span><span class="n">emissions_pivot</span><span class="p">,</span>
    <span class="n">df_name_initial</span><span class="o">=</span><span class="s2">"agri_landcover_df"</span><span class="p">,</span>
    <span class="n">df_name_to_merge</span><span class="o">=</span><span class="s2">"emissions_pivot"</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Nombre de files de agri_landcover_df: 12729
Nombre de columnes de agri_landcover_df: 27
Nombre de files de emissions_pivot: 15919
Nombre de columnes de emissions_pivot: 12
Nombre final de files del resultat: 12729
Nombre final de columnes del resultat: 34
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Year Code</th>
<th>Year</th>
<th>Value_nutrient_3102_N_Agricultural_Use_t</th>
<th>Value_nutrient_3102_N_Use_per_area_of_cropland_kg/ha</th>
<th>Value_nutrient_3102_N_Use_per_capita_kg/cap</th>
<th>Value_nutrient_3102_N_Use_per_value_of_agricultural_production_g/Int$</th>
<th>Value_nutrient_3103_P2O5_Agricultural_Use_t</th>
<th>Value_nutrient_3103_P2O5_Use_per_area_of_cropland_kg/ha</th>
<th>Value_nutrient_3103_P2O5_Use_per_capita_kg/cap</th>
<th>Value_nutrient_3103_P2O5_Use_per_value_of_agricultural_production_g/Int$</th>
<th>Value_nutrient_3104_K2O_Agricultural_Use_t</th>
<th>Value_nutrient_3104_K2O_Use_per_area_of_cropland_kg/ha</th>
<th>Value_nutrient_3104_K2O_Use_per_capita_kg/cap</th>
<th>Value_nutrient_3104_K2O_Use_per_value_of_agricultural_production_g/Int$</th>
<th>Value_6601_land_area_ha</th>
<th>Value_6610_agricultural_land_ha</th>
<th>Value_6620_cropland_ha</th>
<th>Value_6621_arable_land_ha</th>
<th>Value_6650_permanent_crops_ha</th>
<th>Value_6655_permanent_meadows_and_pastures_ha</th>
<th>Value_pesticide_agricultural_use_t</th>
<th>Value_6971_herbaceous_crops_ha</th>
<th>Value_6974_tree-covered_areas_ha</th>
<th>Value_6983_grassland_ha</th>
<th>Value_1709_agricultural_soils_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5058_enteric_fermentation_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5059_manure_management_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5060_rice_cultivation_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5061_synthetic_fertilizers_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5064_crop_residues_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5085_emissions_from_livestock_CO2eq_AR5_kt_FAO_TIER_1</th>
</tr>
</thead>
<tbody>
<tr>
<th>8697</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>2020</td>
<td>2020</td>
<td>1059299.0</td>
<td>63.64</td>
<td>22.22</td>
<td>18.35</td>
<td>486673.0</td>
<td>29.24</td>
<td>10.21</td>
<td>8.43</td>
<td>399489.0</td>
<td>24.0</td>
<td>8.38</td>
<td>6.92</td>
<td>49955664.5</td>
<td>26142638.1</td>
<td>16646395.1</td>
<td>11639398.1</td>
<td>5006997.0</td>
<td>9496243.0</td>
<td>75775.0</td>
<td>15384230.0</td>
<td>12553120.0</td>
<td>7383290.0</td>
<td>13578.229</td>
<td>17162.2304</td>
<td>11289.9885</td>
<td>1440.2696</td>
<td>5844.8665</td>
<td>1548.395</td>
<td>34564.6029</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=5a42db5d">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="An%C3%A0lisi-del-dataset-Employment-Indicators">Anlisi del dataset Employment Indicators<a class="anchor-link" href="#An%C3%A0lisi-del-dataset-Employment-Indicators"></a></h3><p>Analitzem el dataset de Employment Indicators per veure quina informaci cont i com podem integrar-la al dataframe final.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=0409cb07">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[38]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Analitzar el dataset de Employment Indicators</span>
<span class="n">analitzar_dataset_faostat</span><span class="p">(</span><span class="s1">'Employment_Indicators_Agriculture'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Anlisi del dataset: Employment_Indicators_Agriculture

Dataframe principal (Employment_Indicators_Agriculture_E_All_Data_(Normalized)):
Dimensions: 188,070 files x 17 columnes

 Columnes (17):
   1. Area Code
   2. Area Code (M49)
   3. Area
   4. Source Code
   5. Source
   6. Indicator Code
   7. Indicator
   8. Sex Code
   9. Sex
  10. Element Code
  11. Element
  12. Year Code
  13. Year
  14. Unit
  15. Value
  16. Flag
  17. Note

 Primeres files del dataframe principal:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Source Code</th>
<th>Source</th>
<th>Indicator Code</th>
<th>Indicator</th>
<th>Sex Code</th>
<th>Sex</th>
<th>Element Code</th>
<th>Element</th>
<th>Year Code</th>
<th>Year</th>
<th>Unit</th>
<th>Value</th>
<th>Flag</th>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3044</td>
<td>FAO Model</td>
<td>21160</td>
<td>Total employment in agrifood systems (AFS)</td>
<td>1</td>
<td>Total</td>
<td>6199</td>
<td>Value</td>
<td>2000</td>
<td>2000</td>
<td>1000 No</td>
<td>3367.93</td>
<td>E</td>
<td>Modelled FAO</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3044</td>
<td>FAO Model</td>
<td>21160</td>
<td>Total employment in agrifood systems (AFS)</td>
<td>1</td>
<td>Total</td>
<td>6199</td>
<td>Value</td>
<td>2001</td>
<td>2001</td>
<td>1000 No</td>
<td>3333.57</td>
<td>E</td>
<td>Modelled FAO</td>
</tr>
<tr>
<th>2</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3044</td>
<td>FAO Model</td>
<td>21160</td>
<td>Total employment in agrifood systems (AFS)</td>
<td>1</td>
<td>Total</td>
<td>6199</td>
<td>Value</td>
<td>2002</td>
<td>2002</td>
<td>1000 No</td>
<td>3508.97</td>
<td>E</td>
<td>Modelled FAO</td>
</tr>
<tr>
<th>3</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3044</td>
<td>FAO Model</td>
<td>21160</td>
<td>Total employment in agrifood systems (AFS)</td>
<td>1</td>
<td>Total</td>
<td>6199</td>
<td>Value</td>
<td>2003</td>
<td>2003</td>
<td>1000 No</td>
<td>3721.40</td>
<td>E</td>
<td>Modelled FAO</td>
</tr>
<tr>
<th>4</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3044</td>
<td>FAO Model</td>
<td>21160</td>
<td>Total employment in agrifood systems (AFS)</td>
<td>1</td>
<td>Total</td>
<td>6199</td>
<td>Value</td>
<td>2004</td>
<td>2004</td>
<td>1000 No</td>
<td>3803.91</td>
<td>E</td>
<td>Modelled FAO</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
 Valors nics de la columna 'Element':
Total nics: 1 (mostrant com a mxim 50)
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Element</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Value</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
 Valors nics de la columna 'Indicator':
Total nics: 30 (mostrant com a mxim 50)
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Indicator</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Total employment in agrifood systems (AFS)</td>
</tr>
<tr>
<th>1</th>
<td>Total non-agricultural AFS employment</td>
</tr>
<tr>
<th>2</th>
<td>Share of AFS employment in total employment</td>
</tr>
<tr>
<th>3</th>
<td>Share of agricultural employment in total AFS employment</td>
</tr>
<tr>
<th>4</th>
<td>Share of non-agricultural AFS employment in total AFS employment</td>
</tr>
<tr>
<th>5</th>
<td>Share of non-agricultural AFS employment in total employment</td>
</tr>
<tr>
<th>6</th>
<td>Employment in agriculture by age, total (15+)</td>
</tr>
<tr>
<th>7</th>
<td>Employment in agriculture by age, 15 to 24</td>
</tr>
<tr>
<th>8</th>
<td>Employment in agriculture by age, 25 to 54</td>
</tr>
<tr>
<th>9</th>
<td>Employment in agriculture by age, 55 to 64</td>
</tr>
<tr>
<th>10</th>
<td>Employment in agriculture by age, 65+</td>
</tr>
<tr>
<th>11</th>
<td>Employment in agriculture by status of employment, total</td>
</tr>
<tr>
<th>12</th>
<td>Employment in agriculture by status of employment, employees</td>
</tr>
<tr>
<th>13</th>
<td>Employment in agriculture by status of employment, self-employed</td>
</tr>
<tr>
<th>14</th>
<td>Employment in agriculture by status of employment, workers not classified</td>
</tr>
<tr>
<th>15</th>
<td>Employment in fishing and aquaculture</td>
</tr>
<tr>
<th>16</th>
<td>Employment in crop and animal production, hunting and related service activities</td>
</tr>
<tr>
<th>17</th>
<td>Mean weekly hours actually worked per employed person in agriculture</td>
</tr>
<tr>
<th>18</th>
<td>Mean weekly hours actually worked per employee in agriculture</td>
</tr>
<tr>
<th>19</th>
<td>Share of employment in agriculture in total employment</td>
</tr>
<tr>
<th>20</th>
<td>Share of females in total employment in agriculture</td>
</tr>
<tr>
<th>21</th>
<td>Share of employees in agriculture in total employees</td>
</tr>
<tr>
<th>22</th>
<td>Share of female employees in total employees in agriculture</td>
</tr>
<tr>
<th>23</th>
<td>Employment in agriculture - ILO modelled estimates</td>
</tr>
<tr>
<th>24</th>
<td>Share of employment in agriculture in total employment - ILO Modelled Estimates</td>
</tr>
<tr>
<th>25</th>
<td>Agriculture value added per worker (constant 2015 US$)</td>
</tr>
<tr>
<th>26</th>
<td>Employment in forestry and logging</td>
</tr>
<tr>
<th>27</th>
<td>Share of employment in crop and animal production, hunting and related service activities</td>
</tr>
<tr>
<th>28</th>
<td>Share of employment in forestry and logging</td>
</tr>
<tr>
<th>29</th>
<td>Share of employment in fishing and aquaculture</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
 Valors nics de la columna 'Source':
Total nics: 12 (mostrant com a mxim 50)
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Source</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>FAO Model</td>
</tr>
<tr>
<th>1</th>
<td>Household income and expenditure survey</td>
</tr>
<tr>
<th>2</th>
<td>ILO - ILO Modelled Estimates</td>
</tr>
<tr>
<th>3</th>
<td>ILO - Modelled Estimates; FAOSTAT - Value added (2015 US$)</td>
</tr>
<tr>
<th>4</th>
<td>Labour force survey</td>
</tr>
<tr>
<th>5</th>
<td>Employment surveys</td>
</tr>
<tr>
<th>6</th>
<td>Official estimates</td>
</tr>
<tr>
<th>7</th>
<td>Population census</td>
</tr>
<tr>
<th>8</th>
<td>Administrative records</td>
</tr>
<tr>
<th>9</th>
<td>Establishment census</td>
</tr>
<tr>
<th>10</th>
<td>Household survey</td>
</tr>
<tr>
<th>11</th>
<td>SNA - National Accounts</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre> Altres dataframes de Employment_Indicators_Agriculture:

 Contingut de Employment_Indicators_Agriculture_E_AreaCodes:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>M49 Code</th>
<th>Area</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
</tr>
<tr>
<th>1</th>
<td>5100</td>
<td>'002</td>
<td>Africa</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>'008</td>
<td>Albania</td>
</tr>
<tr>
<th>3</th>
<td>4</td>
<td>'012</td>
<td>Algeria</td>
</tr>
<tr>
<th>4</th>
<td>5</td>
<td>'016</td>
<td>American Samoa</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>


 Contingut de Employment_Indicators_Agriculture_E_Elements:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Element Code</th>
<th>Element</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>6121</td>
<td>Value</td>
</tr>
<tr>
<th>1</th>
<td>6173</td>
<td>Value</td>
</tr>
<tr>
<th>2</th>
<td>6199</td>
<td>Value</td>
</tr>
<tr>
<th>3</th>
<td>6228</td>
<td>Value</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>


 Contingut de Employment_Indicators_Agriculture_E_Flags:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Flag</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>E</td>
<td>Estimated value</td>
</tr>
<tr>
<th>1</th>
<td>X</td>
<td>Figure from external organization</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>


 Contingut de Employment_Indicators_Agriculture_E_Indicators:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Indicator Code</th>
<th>Indicator</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>21085</td>
<td>Agriculture value added per worker (constant 2015 US$)</td>
</tr>
<tr>
<th>1</th>
<td>21144</td>
<td>Employment in agriculture - ILO modelled estimates</td>
</tr>
<tr>
<th>2</th>
<td>21145</td>
<td>Employment in agriculture by age</td>
</tr>
<tr>
<th>3</th>
<td>21088</td>
<td>Employment in agriculture by age; 15 to 24</td>
</tr>
<tr>
<th>4</th>
<td>21089</td>
<td>Employment in agriculture by age; 25 to 54</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>


 Contingut de Employment_Indicators_Agriculture_E_Sexs:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Sex Code</th>
<th>Sex</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>3</td>
<td>Female</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>Male</td>
</tr>
<tr>
<th>2</th>
<td>1</td>
<td>Total</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>


 Contingut de Employment_Indicators_Agriculture_E_Sources:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Source Code</th>
<th>Source</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>3012</td>
<td>Administrative insurance records</td>
</tr>
<tr>
<th>1</th>
<td>3014</td>
<td>Administrative population register</td>
</tr>
<tr>
<th>2</th>
<td>3015</td>
<td>Administrative records</td>
</tr>
<tr>
<th>3</th>
<td>3018</td>
<td>Employment surveys</td>
</tr>
<tr>
<th>4</th>
<td>3019</td>
<td>Establishment census</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>

</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=f2df935d">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Creaci%C3%B3-de-employment_df">Creaci de <code>employment_df</code><a class="anchor-link" href="#Creaci%C3%B3-de-employment_df"></a></h3><p>Creem el dataframe de Employment Indicators basat en el dataset principal de Employment_Indicators_Agriculture.</p>
<p>El conjunt de dades d'ocupaci agrcola presenta una gran varietat dindicadors provinents de fonts diferents (ILO, FAO, enquestes nacionals, censos, etc.), amb metodologies i cobertures molt desiguals. Per tal dobtenir un conjunt de dades coherent, interpretable i til per analitzar la relaci entre activitat agrcola, productivitat, s del sl i clima, s imprescindible reduir drsticament el nombre dindicadors i seleccionar nicament aquells que siguin robusts, comparables i rellevants a escala global.</p>
<p>La selecci final consta de cinc indicadors, cadascun aportant informaci complementria i essencial per entendre les dinmiques laborals del sector agrcola.</p>
<ol>
<li><strong>Employment in agriculture  ILO modelled estimates</strong><br/>
Aquest s lindicador central per a un estudi dagricultura. Les estimacions modelitzades de lILO proporcionen dades harmonitzades, consistents i comparables entre pasos i al llarg del temps, evitant els problemes derivats de les fortes diferncies metodolgiques dels censos i enquestes nacionals. s la mesura estndard utilitzada en estudis internacionals per quantificar la m dobra agrcola activa.</li>
</ol>
<p>Source: <a href="https://ilostat.ilo.org/methods/concepts-and-definitions/ilo-modelled-estimates/">https://ilostat.ilo.org/methods/concepts-and-definitions/ilo-modelled-estimates/</a></p>
<ol start="2">
<li><p><strong>Share of employment in agriculture in total employment  ILO modelled estimates</strong><br/>
La proporci de treballadors ocupats en el sector agrcola, tamb harmonitzada per lILO, permet analitzar el pes del sector en leconomia de cada pas. Aquest indicador s fonamental per estudiar processos de transformaci estructural, desenvolupament econmic i especialitzaci productiva. s especialment til per comparar pasos amb dimensions de poblaci molt diferents.</p>
</li>
<li><p><strong>Agriculture value added per worker (constant 2015 US$)</strong><br/>
Aquest indicador mesura la productivitat laboral agrcola i s clau per entendre la relaci entre rendiment econmic, inputs agrcoles (com fertilitzants i pesticides) i condicions climtiques. Aporta una dimensi econmica que enriqueix enormement l'anlisi, permetent contextualitzar els nivells de desenvolupament i eficincia del sector agrcola de cada pas.</p>
</li>
<li><p><strong>Employment in crop and animal production, hunting and related service activities</strong><br/>
Aquest indicador desglossa locupaci estrictament agrcola de forma ms precisa, excloent sectors parallels com la pesca o la silvicultura. Aporta granularitat sense perdre coherncia i permet distingir el nucli central de lactivitat agrcola dins del conjunt ms ampli dels sistemes alimentaris.</p>
</li>
</ol>
<p>La selecci proposada prioritza coherncia, comparabilitat internacional i rellevncia directa per a lestudi de la relaci entre agricultura, clima i productivitat i redueix la complexitat del domini, originalment amb 30 indicadors.</p>
<p>Aquest enfocament garanteix un conjunt de dades final molt ms slid, interpretable i alineat amb els objectius de la prctica.</p>
<p><strong>Transformacions realitzades:</strong></p>
<ul>
<li>Eliminem les columnes <code>Note</code> i <code>Flag</code> (informaci no utilitzable per a l'anlisi)</li>
<li>Renombrem columnes per a millor claredat</li>
<li>Filtrar valors.</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=854fb795">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[39]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Crear employment_df utilitzant la funci generalitzada</span>
<span class="n">key</span> <span class="o">=</span> <span class="s1">'Employment_Indicators_Agriculture'</span>
<span class="n">df_name</span> <span class="o">=</span> <span class="s1">'employment_df'</span>
<span class="n">column_mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'Indicator Code'</span><span class="p">:</span> <span class="s1">'employment_indicator_code'</span><span class="p">,</span>
    <span class="s1">'Indicator'</span><span class="p">:</span> <span class="s1">'employment_indicator'</span><span class="p">,</span>
    <span class="s1">'Element Code'</span><span class="p">:</span> <span class="s1">'employment_metric_code'</span><span class="p">,</span>
    <span class="s1">'Element'</span><span class="p">:</span> <span class="s1">'employment_metric'</span><span class="p">,</span>
    <span class="s1">'Source Code'</span><span class="p">:</span> <span class="s1">'employment_source_code'</span><span class="p">,</span>
    <span class="s1">'Source'</span><span class="p">:</span> <span class="s1">'employment_source'</span><span class="p">,</span>
    <span class="s1">'Sex Code'</span><span class="p">:</span> <span class="s1">'employment_sex_code'</span><span class="p">,</span>
    <span class="s1">'Sex'</span><span class="p">:</span> <span class="s1">'employment_sex'</span>
<span class="p">}</span>
<span class="n">values_to_keep</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'employment_indicator'</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">'Employment in agriculture - ILO modelled estimates'</span><span class="p">,</span>
        <span class="s1">'Share of employment in agriculture in total employment - ILO Modelled Estimates'</span><span class="p">,</span>
        <span class="s1">'Agriculture value added per worker (constant 2015 US$)'</span><span class="p">,</span>
        <span class="s1">'Employment in crop and animal production, hunting and related service activities'</span>
    <span class="p">]</span>
<span class="p">}</span>

<span class="n">employment_df</span> <span class="o">=</span> <span class="n">crear_df_faostat_filtrat</span><span class="p">(</span>
    <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
    <span class="n">df_name</span><span class="o">=</span><span class="n">df_name</span><span class="p">,</span>
    <span class="n">column_mapping</span><span class="o">=</span><span class="n">column_mapping</span><span class="p">,</span>
    <span class="n">values_to_keep</span><span class="o">=</span><span class="n">values_to_keep</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Creaci de employment_df

Valors diferents de 'Unit':
employment_indicator
Agriculture value added per worker (constant 2015 US$)                                  [USD]
Employment in agriculture - ILO modelled estimates                                  [1000 No]
Employment in crop and animal production, hunting and related service activities    [1000 No]
Share of employment in agriculture in total employment - ILO Modelled Estimates           [%]
Name: Unit, dtype: object

Dimensions finals: 55,800 files x 15 columnes

Columnes finals (15):
   1. Area Code
   2. Area Code (M49)
   3. Area
   4. employment_source_code
   5. employment_source
   6. employment_indicator_code
   7. employment_indicator
   8. employment_sex_code
   9. employment_sex
  10. employment_metric_code
  11. employment_metric
  12. Year Code
  13. Year
  14. Unit
  15. Value

Primeres files de employment_df:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>employment_source_code</th>
<th>employment_source</th>
<th>employment_indicator_code</th>
<th>employment_indicator</th>
<th>employment_sex_code</th>
<th>employment_sex</th>
<th>employment_metric_code</th>
<th>employment_metric</th>
<th>Year Code</th>
<th>Year</th>
<th>Unit</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<th>234</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3021</td>
<td>Household income and expenditure survey</td>
<td>21111</td>
<td>Employment in crop and animal production, hunting and related service activities</td>
<td>1</td>
<td>Total</td>
<td>6199</td>
<td>Value</td>
<td>2014</td>
<td>2014</td>
<td>1000 No</td>
<td>2824.35</td>
</tr>
<tr>
<th>235</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3021</td>
<td>Household income and expenditure survey</td>
<td>21111</td>
<td>Employment in crop and animal production, hunting and related service activities</td>
<td>1</td>
<td>Total</td>
<td>6199</td>
<td>Value</td>
<td>2017</td>
<td>2017</td>
<td>1000 No</td>
<td>2737.94</td>
</tr>
<tr>
<th>236</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3021</td>
<td>Household income and expenditure survey</td>
<td>21111</td>
<td>Employment in crop and animal production, hunting and related service activities</td>
<td>2</td>
<td>Male</td>
<td>6199</td>
<td>Value</td>
<td>2014</td>
<td>2014</td>
<td>1000 No</td>
<td>1870.42</td>
</tr>
<tr>
<th>237</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3021</td>
<td>Household income and expenditure survey</td>
<td>21111</td>
<td>Employment in crop and animal production, hunting and related service activities</td>
<td>2</td>
<td>Male</td>
<td>6199</td>
<td>Value</td>
<td>2017</td>
<td>2017</td>
<td>1000 No</td>
<td>1834.38</td>
</tr>
<tr>
<th>238</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3021</td>
<td>Household income and expenditure survey</td>
<td>21111</td>
<td>Employment in crop and animal production, hunting and related service activities</td>
<td>3</td>
<td>Female</td>
<td>6199</td>
<td>Value</td>
<td>2014</td>
<td>2014</td>
<td>1000 No</td>
<td>953.93</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
Resum de valors nics:
  - employment_indicator nics: 4 a ['Agriculture value added per worker (constant 2015 US$)', 'Employment in agriculture - ILO modelled estimates', 'Employment in crop and animal production, hunting and related service activities', 'Share of employment in agriculture in total employment - ILO Modelled Estimates']
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=53af5c61">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[40]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">employment_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">"employment_indicator"</span><span class="p">)[</span><span class="s2">"employment_source"</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[40]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain" tabindex="0">
<pre>employment_indicator
Agriculture value added per worker (constant 2015 US$)                                                                     [ILO - Modelled Estimates; FAOSTAT - Value added (2015 US$)]
Employment in agriculture - ILO modelled estimates                                                                                                       [ILO - ILO Modelled Estimates]
Employment in crop and animal production, hunting and related service activities    [Household income and expenditure survey, Labour force survey, Population census, Household survey]
Share of employment in agriculture in total employment - ILO Modelled Estimates                                                                          [ILO - ILO Modelled Estimates]
Name: employment_source, dtype: object</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=51192924">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Com que les fonts sn niques per cada indicador, no cal afegir-les a la columna.</p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=a748de6d">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Pivot-de-employment_df">Pivot de <code>employment_df</code><a class="anchor-link" href="#Pivot-de-employment_df"></a></h3>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=22f78f65">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[41]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Convertir "1000 No" a "No" multiplicant el valor per 1000</span>
<span class="n">mask_1000no</span> <span class="o">=</span> <span class="n">employment_df</span><span class="p">[</span><span class="s1">'Unit'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'1000 No'</span>
<span class="n">employment_df</span><span class="p">[</span><span class="s1">'Value'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask_1000no</span><span class="p">,</span> <span class="n">employment_df</span><span class="p">[</span><span class="s1">'Value'</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">employment_df</span><span class="p">[</span><span class="s1">'Value'</span><span class="p">])</span>
<span class="n">employment_df</span><span class="p">[</span><span class="s1">'Unit'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask_1000no</span><span class="p">,</span> <span class="s1">'No'</span><span class="p">,</span> <span class="n">employment_df</span><span class="p">[</span><span class="s1">'Unit'</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Unitats desprs de la conversi:"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">employment_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">"employment_indicator"</span><span class="p">)[</span><span class="s2">"Unit"</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>

<span class="c1"># Crear la columna pivot_col amb el format especificat</span>
<span class="n">employment_df</span><span class="p">[</span><span class="s2">"pivot_col"</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">"Value_"</span>
    <span class="o">+</span> <span class="n">employment_df</span><span class="p">[</span><span class="s2">"employment_indicator_code"</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
    <span class="o">+</span> <span class="s2">"_"</span>
    <span class="o">+</span> <span class="n">employment_df</span><span class="p">[</span><span class="s2">"employment_indicator"</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">','</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">''</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'('</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">')'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'$'</span><span class="p">,</span> <span class="s1">'usd'</span><span class="p">)</span>
    <span class="o">+</span> <span class="s2">"_"</span>
    <span class="o">+</span> <span class="n">employment_df</span><span class="p">[</span><span class="s2">"employment_sex"</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="o">+</span> <span class="s2">"_"</span>
    <span class="o">+</span> <span class="n">employment_df</span><span class="p">[</span><span class="s2">"Unit"</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Pivotar el dataframe</span>
<span class="n">employment_pivot</span> <span class="o">=</span> <span class="n">pivot_faostat_df</span><span class="p">(</span><span class="n">employment_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
Unitats desprs de la conversi:
employment_indicator
Agriculture value added per worker (constant 2015 US$)                              [USD]
Employment in agriculture - ILO modelled estimates                                   [No]
Employment in crop and animal production, hunting and related service activities     [No]
Share of employment in agriculture in total employment - ILO Modelled Estimates       [%]
Name: Unit, dtype: object
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Year Code</th>
<th>Year</th>
<th>Value_21085_agriculture_value_added_per_worker_constant_2015_ususd_total_USD</th>
<th>Value_21111_employment_in_crop_and_animal_production_hunting_and_related_service_activities_female_No</th>
<th>Value_21111_employment_in_crop_and_animal_production_hunting_and_related_service_activities_male_No</th>
<th>Value_21111_employment_in_crop_and_animal_production_hunting_and_related_service_activities_total_No</th>
<th>Value_21144_employment_in_agriculture_-_ilo_modelled_estimates_female_No</th>
<th>Value_21144_employment_in_agriculture_-_ilo_modelled_estimates_male_No</th>
<th>Value_21144_employment_in_agriculture_-_ilo_modelled_estimates_total_No</th>
<th>Value_21156_share_of_employment_in_agriculture_in_total_employment_-_ilo_modelled_estimates_female_%</th>
<th>Value_21156_share_of_employment_in_agriculture_in_total_employment_-_ilo_modelled_estimates_male_%</th>
<th>Value_21156_share_of_employment_in_agriculture_in_total_employment_-_ilo_modelled_estimates_total_%</th>
</tr>
</thead>
<tbody>
<tr>
<th>4889</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1991</td>
<td>1991</td>
<td>15467.34</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>372790.0</td>
<td>1042140.0</td>
<td>1414920.0</td>
<td>8.9</td>
<td>11.5</td>
<td>10.7</td>
</tr>
<tr>
<th>4890</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1992</td>
<td>1992</td>
<td>17262.18</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>365660.0</td>
<td>914910.0</td>
<td>1280570.0</td>
<td>8.6</td>
<td>10.3</td>
<td>9.7</td>
</tr>
<tr>
<th>4891</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1993</td>
<td>1993</td>
<td>18362.87</td>
<td>321660.0</td>
<td>758830.0</td>
<td>1080300.0</td>
<td>337150.0</td>
<td>900650.0</td>
<td>1237800.0</td>
<td>8.1</td>
<td>10.6</td>
<td>9.8</td>
</tr>
<tr>
<th>4892</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1994</td>
<td>1994</td>
<td>18133.86</td>
<td>299220.0</td>
<td>740890.0</td>
<td>1039940.0</td>
<td>312650.0</td>
<td>881460.0</td>
<td>1194100.0</td>
<td>7.4</td>
<td>10.5</td>
<td>9.5</td>
</tr>
<tr>
<th>4893</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1995</td>
<td>1995</td>
<td>17478.29</td>
<td>296710.0</td>
<td>721190.0</td>
<td>1018100.0</td>
<td>311670.0</td>
<td>851310.0</td>
<td>1162980.0</td>
<td>7.1</td>
<td>9.9</td>
<td>9.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=b8cd8406">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Merge-de-employment_df-amb-el-dataframe-principal">Merge de <code>employment_df</code> amb el dataframe principal<a class="anchor-link" href="#Merge-de-employment_df-amb-el-dataframe-principal"></a></h3><p>Un cop creat el pivot, farem el merge amb el dataframe principal utilitzant la funci <code>merge_agri_dataframes</code>.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=252ec2e8">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[42]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Fer el merge utilitzant la funci generalitzada</span>
<span class="n">agri_employment_df</span> <span class="o">=</span> <span class="n">merge_agri_dataframes</span><span class="p">(</span>
    <span class="n">df_initial</span><span class="o">=</span><span class="n">agri_emissions_df</span><span class="p">,</span>
    <span class="n">df_to_merge</span><span class="o">=</span><span class="n">employment_pivot</span><span class="p">,</span>
    <span class="n">df_name_initial</span><span class="o">=</span><span class="s2">"agri_emissions_df"</span><span class="p">,</span>
    <span class="n">df_name_to_merge</span><span class="o">=</span><span class="s2">"employment_pivot"</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Nombre de files de agri_emissions_df: 12729
Nombre de columnes de agri_emissions_df: 34
Nombre de files de employment_pivot: 7431
Nombre de columnes de employment_pivot: 15
Nombre final de files del resultat: 12729
Nombre final de columnes del resultat: 44
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Year Code</th>
<th>Year</th>
<th>Value_nutrient_3102_N_Agricultural_Use_t</th>
<th>Value_nutrient_3102_N_Use_per_area_of_cropland_kg/ha</th>
<th>Value_nutrient_3102_N_Use_per_capita_kg/cap</th>
<th>Value_nutrient_3102_N_Use_per_value_of_agricultural_production_g/Int$</th>
<th>Value_nutrient_3103_P2O5_Agricultural_Use_t</th>
<th>Value_nutrient_3103_P2O5_Use_per_area_of_cropland_kg/ha</th>
<th>Value_nutrient_3103_P2O5_Use_per_capita_kg/cap</th>
<th>Value_nutrient_3103_P2O5_Use_per_value_of_agricultural_production_g/Int$</th>
<th>Value_nutrient_3104_K2O_Agricultural_Use_t</th>
<th>Value_nutrient_3104_K2O_Use_per_area_of_cropland_kg/ha</th>
<th>Value_nutrient_3104_K2O_Use_per_capita_kg/cap</th>
<th>Value_nutrient_3104_K2O_Use_per_value_of_agricultural_production_g/Int$</th>
<th>Value_6601_land_area_ha</th>
<th>Value_6610_agricultural_land_ha</th>
<th>Value_6620_cropland_ha</th>
<th>Value_6621_arable_land_ha</th>
<th>Value_6650_permanent_crops_ha</th>
<th>Value_6655_permanent_meadows_and_pastures_ha</th>
<th>Value_pesticide_agricultural_use_t</th>
<th>Value_6971_herbaceous_crops_ha</th>
<th>Value_6974_tree-covered_areas_ha</th>
<th>Value_6983_grassland_ha</th>
<th>Value_1709_agricultural_soils_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5058_enteric_fermentation_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5059_manure_management_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5060_rice_cultivation_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5061_synthetic_fertilizers_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5064_crop_residues_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5085_emissions_from_livestock_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_21085_agriculture_value_added_per_worker_constant_2015_ususd_total_USD</th>
<th>Value_21111_employment_in_crop_and_animal_production_hunting_and_related_service_activities_female_No</th>
<th>Value_21111_employment_in_crop_and_animal_production_hunting_and_related_service_activities_male_No</th>
<th>Value_21111_employment_in_crop_and_animal_production_hunting_and_related_service_activities_total_No</th>
<th>Value_21144_employment_in_agriculture_-_ilo_modelled_estimates_female_No</th>
<th>Value_21144_employment_in_agriculture_-_ilo_modelled_estimates_male_No</th>
<th>Value_21144_employment_in_agriculture_-_ilo_modelled_estimates_total_No</th>
<th>Value_21156_share_of_employment_in_agriculture_in_total_employment_-_ilo_modelled_estimates_female_%</th>
<th>Value_21156_share_of_employment_in_agriculture_in_total_employment_-_ilo_modelled_estimates_male_%</th>
<th>Value_21156_share_of_employment_in_agriculture_in_total_employment_-_ilo_modelled_estimates_total_%</th>
</tr>
</thead>
<tbody>
<tr>
<th>8697</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>2020</td>
<td>2020</td>
<td>1059299.0</td>
<td>63.64</td>
<td>22.22</td>
<td>18.35</td>
<td>486673.0</td>
<td>29.24</td>
<td>10.21</td>
<td>8.43</td>
<td>399489.0</td>
<td>24.0</td>
<td>8.38</td>
<td>6.92</td>
<td>49955664.5</td>
<td>26142638.1</td>
<td>16646395.1</td>
<td>11639398.1</td>
<td>5006997.0</td>
<td>9496243.0</td>
<td>75775.0</td>
<td>15384230.0</td>
<td>12553120.0</td>
<td>7383290.0</td>
<td>13578.229</td>
<td>17162.2304</td>
<td>11289.9885</td>
<td>1440.2696</td>
<td>5844.8665</td>
<td>1548.395</td>
<td>34564.6029</td>
<td>43474.11</td>
<td>165150.0</td>
<td>532600.0</td>
<td>697820.0</td>
<td>171200.0</td>
<td>605510.0</td>
<td>776710.0</td>
<td>1.9</td>
<td>5.7</td>
<td>4.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=d5a72838">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="An%C3%A0lisi-del-dataset-Population">Anlisi del dataset Population<a class="anchor-link" href="#An%C3%A0lisi-del-dataset-Population"></a></h3><p>Analitzem el dataset de Population per veure quina informaci cont i com podem integrar-la al dataframe final.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=2a97712f">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[43]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Analitzar el dataset de Population</span>
<span class="n">analitzar_dataset_faostat</span><span class="p">(</span><span class="s1">'Population'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Anlisi del dataset: Population

Dataframe principal (Population_E_All_Data_(Normalized)):
Dimensions: 168,404 files x 13 columnes

 Columnes (13):
   1. Area Code
   2. Area Code (M49)
   3. Area
   4. Item Code
   5. Item
   6. Element Code
   7. Element
   8. Year Code
   9. Year
  10. Unit
  11. Value
  12. Flag
  13. Note

 Primeres files del dataframe principal:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Item Code</th>
<th>Item</th>
<th>Element Code</th>
<th>Element</th>
<th>Year Code</th>
<th>Year</th>
<th>Unit</th>
<th>Value</th>
<th>Flag</th>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3010</td>
<td>Population - Est. &amp; Proj.</td>
<td>511</td>
<td>Total Population - Both sexes</td>
<td>1950</td>
<td>1950</td>
<td>1000 No</td>
<td>7776.176</td>
<td>X</td>
<td>NaN</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3010</td>
<td>Population - Est. &amp; Proj.</td>
<td>511</td>
<td>Total Population - Both sexes</td>
<td>1951</td>
<td>1951</td>
<td>1000 No</td>
<td>7879.339</td>
<td>X</td>
<td>NaN</td>
</tr>
<tr>
<th>2</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3010</td>
<td>Population - Est. &amp; Proj.</td>
<td>511</td>
<td>Total Population - Both sexes</td>
<td>1952</td>
<td>1952</td>
<td>1000 No</td>
<td>7987.783</td>
<td>X</td>
<td>NaN</td>
</tr>
<tr>
<th>3</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3010</td>
<td>Population - Est. &amp; Proj.</td>
<td>511</td>
<td>Total Population - Both sexes</td>
<td>1953</td>
<td>1953</td>
<td>1000 No</td>
<td>8096.698</td>
<td>X</td>
<td>NaN</td>
</tr>
<tr>
<th>4</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3010</td>
<td>Population - Est. &amp; Proj.</td>
<td>511</td>
<td>Total Population - Both sexes</td>
<td>1954</td>
<td>1954</td>
<td>1000 No</td>
<td>8207.950</td>
<td>X</td>
<td>NaN</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
 Valors nics de la columna 'Item':
Total nics: 1 (mostrant com a mxim 50)
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Item</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Population - Est. &amp; Proj.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
 Valors nics de la columna 'Element':
Total nics: 5 (mostrant com a mxim 50)
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Element</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Total Population - Both sexes</td>
</tr>
<tr>
<th>1</th>
<td>Total Population - Male</td>
</tr>
<tr>
<th>2</th>
<td>Total Population - Female</td>
</tr>
<tr>
<th>3</th>
<td>Rural population</td>
</tr>
<tr>
<th>4</th>
<td>Urban population</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre> Altres dataframes de Population:

 Contingut de Population_E_AreaCodes:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>M49 Code</th>
<th>Area</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
</tr>
<tr>
<th>1</th>
<td>5100</td>
<td>'002</td>
<td>Africa</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>'008</td>
<td>Albania</td>
</tr>
<tr>
<th>3</th>
<td>4</td>
<td>'012</td>
<td>Algeria</td>
</tr>
<tr>
<th>4</th>
<td>5</td>
<td>'016</td>
<td>American Samoa</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>


 Contingut de Population_E_Elements:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Element Code</th>
<th>Element</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>551</td>
<td>Rural population</td>
</tr>
<tr>
<th>1</th>
<td>511</td>
<td>Total Population - Both sexes</td>
</tr>
<tr>
<th>2</th>
<td>513</td>
<td>Total Population - Female</td>
</tr>
<tr>
<th>3</th>
<td>512</td>
<td>Total Population - Male</td>
</tr>
<tr>
<th>4</th>
<td>561</td>
<td>Urban population</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>


 Contingut de Population_E_Flags:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Flag</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>E</td>
<td>Estimated value</td>
</tr>
<tr>
<th>1</th>
<td>X</td>
<td>Figure from external organization</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>


 Contingut de Population_E_ItemCodes:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Item Code</th>
<th>CPC Code</th>
<th>Item</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>

</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=727f4e4a">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Creaci%C3%B3-de-population_df">Creaci de <code>population_df</code><a class="anchor-link" href="#Creaci%C3%B3-de-population_df"></a></h3><p>Creem el dataframe de Population basat en el dataset principal de Population.</p>
<p>Del domini Population hem seleccionat els indicadors de poblaci total i la seva desagregaci per sexe (mascul/femen) i ubicaci (rural/urb). Aquests indicadors sn essencials per contextualitzar la producci agrcola i l's de recursos en relaci amb la pressi demogrfica de cada pas. La informaci demogrfica permet analitzar la seguretat alimentria, l'eficincia productiva per capita i les dinmiques de desenvolupament rural-urb.</p>
<p><strong>Transformacions realitzades:</strong></p>
<ul>
<li>Eliminem les columnes <code>Note</code> i <code>Flag</code> (informaci no utilitzable per a l'anlisi)</li>
<li>Renombrem columnes per a millor claredat: <code>Element</code> a <code>population_type</code></li>
<li>Filtrar per elements: Total Population - Both sexes, Total Population - Female, Total Population - Male, Rural Population, Urban Population</li>
<li>Convertir de 1000 No a No (multiplicar per 1000)</li>
<li>Calcular percentatges sobre la poblaci total</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=9cfb19a7">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[44]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Crear population_df utilitzant la funci generalitzada</span>
<span class="n">key</span> <span class="o">=</span> <span class="s1">'Population'</span>
<span class="n">df_name</span> <span class="o">=</span> <span class="s1">'population_df'</span>
<span class="n">column_mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'Element Code'</span><span class="p">:</span> <span class="s1">'population_type_code'</span><span class="p">,</span>
    <span class="s1">'Element'</span><span class="p">:</span> <span class="s1">'population_type'</span>
<span class="p">}</span>
<span class="n">values_to_keep</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'population_type'</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">'Total Population - Both sexes'</span><span class="p">,</span>
        <span class="s1">'Total Population - Female'</span><span class="p">,</span>
        <span class="s1">'Total Population - Male'</span><span class="p">,</span>
        <span class="s1">'Rural population'</span><span class="p">,</span>
        <span class="s1">'Urban population'</span>
    <span class="p">]</span>
<span class="p">}</span>

<span class="n">population_df</span> <span class="o">=</span> <span class="n">crear_df_faostat_filtrat</span><span class="p">(</span>
    <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
    <span class="n">df_name</span><span class="o">=</span><span class="n">df_name</span><span class="p">,</span>
    <span class="n">column_mapping</span><span class="o">=</span><span class="n">column_mapping</span><span class="p">,</span>
    <span class="n">values_to_keep</span><span class="o">=</span><span class="n">values_to_keep</span>
<span class="p">)</span>

<span class="c1"># Convertir de 1000 No a No</span>
<span class="n">population_df</span><span class="p">[</span><span class="s1">'Value'</span><span class="p">]</span> <span class="o">=</span> <span class="n">population_df</span><span class="p">[</span><span class="s1">'Value'</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1000</span>
<span class="n">population_df</span><span class="p">[</span><span class="s1">'Unit'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'No'</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Valors convertits de 1000 No a No (multiplicats per 1000)"</span><span class="p">)</span>

<span class="c1"># Em vist a l'anlisi que no necessitem l'Item Code ni Item, per tant el descartem.</span>
<span class="n">population_df</span> <span class="o">=</span> <span class="n">population_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'Item Code'</span><span class="p">,</span> <span class="s1">'Item'</span><span class="p">])</span>

<span class="n">display</span><span class="p">(</span><span class="n">population_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Creaci de population_df
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
Valors diferents de 'Unit':
population_type
Rural population                 [1000 No]
Total Population - Both sexes    [1000 No]
Total Population - Female        [1000 No]
Total Population - Male          [1000 No]
Urban population                 [1000 No]
Name: Unit, dtype: object

Dimensions finals: 168,404 files x 11 columnes

Columnes finals (11):
   1. Area Code
   2. Area Code (M49)
   3. Area
   4. Item Code
   5. Item
   6. population_type_code
   7. population_type
   8. Year Code
   9. Year
  10. Unit
  11. Value

Primeres files de population_df:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Item Code</th>
<th>Item</th>
<th>population_type_code</th>
<th>population_type</th>
<th>Year Code</th>
<th>Year</th>
<th>Unit</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3010</td>
<td>Population - Est. &amp; Proj.</td>
<td>511</td>
<td>Total Population - Both sexes</td>
<td>1950</td>
<td>1950</td>
<td>1000 No</td>
<td>7776.176</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3010</td>
<td>Population - Est. &amp; Proj.</td>
<td>511</td>
<td>Total Population - Both sexes</td>
<td>1951</td>
<td>1951</td>
<td>1000 No</td>
<td>7879.339</td>
</tr>
<tr>
<th>2</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3010</td>
<td>Population - Est. &amp; Proj.</td>
<td>511</td>
<td>Total Population - Both sexes</td>
<td>1952</td>
<td>1952</td>
<td>1000 No</td>
<td>7987.783</td>
</tr>
<tr>
<th>3</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3010</td>
<td>Population - Est. &amp; Proj.</td>
<td>511</td>
<td>Total Population - Both sexes</td>
<td>1953</td>
<td>1953</td>
<td>1000 No</td>
<td>8096.698</td>
</tr>
<tr>
<th>4</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>3010</td>
<td>Population - Est. &amp; Proj.</td>
<td>511</td>
<td>Total Population - Both sexes</td>
<td>1954</td>
<td>1954</td>
<td>1000 No</td>
<td>8207.950</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
Resum de valors nics:
  - population_type nics: 5 a ['Rural population', 'Total Population - Both sexes', 'Total Population - Female', 'Total Population - Male', 'Urban population']

Valors convertits de 1000 No a No (multiplicats per 1000)
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>population_type_code</th>
<th>population_type</th>
<th>Year Code</th>
<th>Year</th>
<th>Unit</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>511</td>
<td>Total Population - Both sexes</td>
<td>1950</td>
<td>1950</td>
<td>No</td>
<td>7776176.0</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>511</td>
<td>Total Population - Both sexes</td>
<td>1951</td>
<td>1951</td>
<td>No</td>
<td>7879339.0</td>
</tr>
<tr>
<th>2</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>511</td>
<td>Total Population - Both sexes</td>
<td>1952</td>
<td>1952</td>
<td>No</td>
<td>7987783.0</td>
</tr>
<tr>
<th>3</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>511</td>
<td>Total Population - Both sexes</td>
<td>1953</td>
<td>1953</td>
<td>No</td>
<td>8096698.0</td>
</tr>
<tr>
<th>4</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>511</td>
<td>Total Population - Both sexes</td>
<td>1954</td>
<td>1954</td>
<td>No</td>
<td>8207950.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=938ab1a6">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Pivot-de-population_df">Pivot de <code>population_df</code><a class="anchor-link" href="#Pivot-de-population_df"></a></h3><p>Realitzem el pivot per tenir una columna per cada tipus de poblaci i calculem els percentatges.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=68df6edd">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[45]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Crear la columna pivot_col</span>
<span class="n">population_df</span><span class="p">[</span><span class="s1">'pivot_col'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">population_df</span><span class="p">[</span><span class="s1">'population_type'</span><span class="p">]</span>
    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'Total Population - '</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'Both sexes'</span><span class="p">,</span> <span class="s1">'Total'</span><span class="p">)</span>
    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span>
    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="p">)</span>

<span class="c1"># Pivotem el dataframe utilitzant la funci generalitzada</span>
<span class="n">population_pivot</span> <span class="o">=</span> <span class="n">pivot_faostat_df</span><span class="p">(</span><span class="n">population_df</span><span class="p">)</span>

<span class="c1"># Calcular percentatges sobre la poblaci total</span>
<span class="n">population_pivot</span><span class="p">[</span><span class="s1">'female_population_%'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">population_pivot</span><span class="p">[</span><span class="s1">'female'</span><span class="p">]</span> <span class="o">/</span> <span class="n">population_pivot</span><span class="p">[</span><span class="s1">'total'</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">population_pivot</span><span class="p">[</span><span class="s1">'male_population_%'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">population_pivot</span><span class="p">[</span><span class="s1">'male'</span><span class="p">]</span> <span class="o">/</span> <span class="n">population_pivot</span><span class="p">[</span><span class="s1">'total'</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">population_pivot</span><span class="p">[</span><span class="s1">'rural_population_%'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">population_pivot</span><span class="p">[</span><span class="s1">'rural_population'</span><span class="p">]</span> <span class="o">/</span> <span class="n">population_pivot</span><span class="p">[</span><span class="s1">'total'</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">population_pivot</span><span class="p">[</span><span class="s1">'urban_population_%'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">population_pivot</span><span class="p">[</span><span class="s1">'urban_population'</span><span class="p">]</span> <span class="o">/</span> <span class="n">population_pivot</span><span class="p">[</span><span class="s1">'total'</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Renombrar la columna total i eliminar les columnes absolutes que no necessitem</span>
<span class="n">population_pivot</span> <span class="o">=</span> <span class="n">population_pivot</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">'total'</span><span class="p">:</span> <span class="s1">'total_population_No'</span><span class="p">})</span>
<span class="n">population_pivot</span> <span class="o">=</span> <span class="n">population_pivot</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'female'</span><span class="p">,</span> <span class="s1">'male'</span><span class="p">,</span> <span class="s1">'rural_population'</span><span class="p">,</span> <span class="s1">'urban_population'</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Columnes finals de population_pivot:"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">population_pivot</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Primeres files:"</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">population_pivot</span><span class="p">[</span><span class="n">population_pivot</span><span class="p">[</span><span class="s1">'Area'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'Spain'</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Year Code</th>
<th>Year</th>
<th>female</th>
<th>male</th>
<th>rural_population</th>
<th>total</th>
<th>urban_population</th>
</tr>
</thead>
<tbody>
<tr>
<th>26382</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1950</td>
<td>1950</td>
<td>14567665.0</td>
<td>13509384.0</td>
<td>13496009.0</td>
<td>28077049.0</td>
<td>14573726.0</td>
</tr>
<tr>
<th>26383</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1951</td>
<td>1951</td>
<td>14626971.0</td>
<td>13587889.0</td>
<td>13462062.0</td>
<td>28214860.0</td>
<td>14781573.0</td>
</tr>
<tr>
<th>26384</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1952</td>
<td>1952</td>
<td>14713128.0</td>
<td>13692914.0</td>
<td>13422112.0</td>
<td>28406041.0</td>
<td>15020261.0</td>
</tr>
<tr>
<th>26385</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1953</td>
<td>1953</td>
<td>14816229.0</td>
<td>13816468.0</td>
<td>13389000.0</td>
<td>28632697.0</td>
<td>15269669.0</td>
</tr>
<tr>
<th>26386</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1954</td>
<td>1954</td>
<td>14919205.0</td>
<td>13938623.0</td>
<td>13359555.0</td>
<td>28857828.0</td>
<td>15527794.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
Columnes finals de population_pivot:
['Area Code', 'Area Code (M49)', 'Area', 'Year Code', 'Year', 'total_population_No', 'female_population_%', 'male_population_%', 'rural_population_%', 'urban_population_%']

Primeres files:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Year Code</th>
<th>Year</th>
<th>total_population_No</th>
<th>female_population_%</th>
<th>male_population_%</th>
<th>rural_population_%</th>
<th>urban_population_%</th>
</tr>
</thead>
<tbody>
<tr>
<th>26382</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1950</td>
<td>1950</td>
<td>28077049.0</td>
<td>51.884602</td>
<td>48.115398</td>
<td>48.067762</td>
<td>51.906189</td>
</tr>
<tr>
<th>26383</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1951</td>
<td>1951</td>
<td>28214860.0</td>
<td>51.841374</td>
<td>48.158626</td>
<td>47.712666</td>
<td>52.389319</td>
</tr>
<tr>
<th>26384</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1952</td>
<td>1952</td>
<td>28406041.0</td>
<td>51.795771</td>
<td>48.204232</td>
<td>47.250907</td>
<td>52.876995</td>
</tr>
<tr>
<th>26385</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1953</td>
<td>1953</td>
<td>28632697.0</td>
<td>51.745838</td>
<td>48.254162</td>
<td>46.761225</td>
<td>53.329482</td>
</tr>
<tr>
<th>26386</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>1954</td>
<td>1954</td>
<td>28857828.0</td>
<td>51.698988</td>
<td>48.301012</td>
<td>46.294388</td>
<td>53.807910</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=4bbcac32">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Merge-de-population_df-amb-el-dataframe-principal">Merge de <code>population_df</code> amb el dataframe principal<a class="anchor-link" href="#Merge-de-population_df-amb-el-dataframe-principal"></a></h3><p>Un cop creat el pivot amb els percentatges, farem el merge amb el dataframe principal utilitzant la funci <code>merge_agri_dataframes</code>.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=76cdbf3c">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[46]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Fer el merge utilitzant la funci generalitzada</span>
<span class="n">agri_population_df</span> <span class="o">=</span> <span class="n">merge_agri_dataframes</span><span class="p">(</span>
    <span class="n">df_initial</span><span class="o">=</span><span class="n">agri_employment_df</span><span class="p">,</span>
    <span class="n">df_to_merge</span><span class="o">=</span><span class="n">population_pivot</span><span class="p">,</span>
    <span class="n">df_name_initial</span><span class="o">=</span><span class="s2">"agri_employment_df"</span><span class="p">,</span>
    <span class="n">df_name_to_merge</span><span class="o">=</span><span class="s2">"population_pivot"</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Nombre de files de agri_employment_df: 12729
Nombre de columnes de agri_employment_df: 44
Nombre de files de population_pivot: 39174
Nombre de columnes de population_pivot: 10
Nombre final de files del resultat: 12729
Nombre final de columnes del resultat: 49
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Year Code</th>
<th>Year</th>
<th>Value_nutrient_3102_N_Agricultural_Use_t</th>
<th>Value_nutrient_3102_N_Use_per_area_of_cropland_kg/ha</th>
<th>Value_nutrient_3102_N_Use_per_capita_kg/cap</th>
<th>Value_nutrient_3102_N_Use_per_value_of_agricultural_production_g/Int$</th>
<th>Value_nutrient_3103_P2O5_Agricultural_Use_t</th>
<th>Value_nutrient_3103_P2O5_Use_per_area_of_cropland_kg/ha</th>
<th>Value_nutrient_3103_P2O5_Use_per_capita_kg/cap</th>
<th>Value_nutrient_3103_P2O5_Use_per_value_of_agricultural_production_g/Int$</th>
<th>Value_nutrient_3104_K2O_Agricultural_Use_t</th>
<th>Value_nutrient_3104_K2O_Use_per_area_of_cropland_kg/ha</th>
<th>Value_nutrient_3104_K2O_Use_per_capita_kg/cap</th>
<th>Value_nutrient_3104_K2O_Use_per_value_of_agricultural_production_g/Int$</th>
<th>Value_6601_land_area_ha</th>
<th>Value_6610_agricultural_land_ha</th>
<th>Value_6620_cropland_ha</th>
<th>Value_6621_arable_land_ha</th>
<th>Value_6650_permanent_crops_ha</th>
<th>Value_6655_permanent_meadows_and_pastures_ha</th>
<th>Value_pesticide_agricultural_use_t</th>
<th>Value_6971_herbaceous_crops_ha</th>
<th>Value_6974_tree-covered_areas_ha</th>
<th>Value_6983_grassland_ha</th>
<th>Value_1709_agricultural_soils_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5058_enteric_fermentation_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5059_manure_management_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5060_rice_cultivation_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5061_synthetic_fertilizers_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5064_crop_residues_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5085_emissions_from_livestock_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_21085_agriculture_value_added_per_worker_constant_2015_ususd_total_USD</th>
<th>Value_21111_employment_in_crop_and_animal_production_hunting_and_related_service_activities_female_No</th>
<th>Value_21111_employment_in_crop_and_animal_production_hunting_and_related_service_activities_male_No</th>
<th>Value_21111_employment_in_crop_and_animal_production_hunting_and_related_service_activities_total_No</th>
<th>Value_21144_employment_in_agriculture_-_ilo_modelled_estimates_female_No</th>
<th>Value_21144_employment_in_agriculture_-_ilo_modelled_estimates_male_No</th>
<th>Value_21144_employment_in_agriculture_-_ilo_modelled_estimates_total_No</th>
<th>Value_21156_share_of_employment_in_agriculture_in_total_employment_-_ilo_modelled_estimates_female_%</th>
<th>Value_21156_share_of_employment_in_agriculture_in_total_employment_-_ilo_modelled_estimates_male_%</th>
<th>Value_21156_share_of_employment_in_agriculture_in_total_employment_-_ilo_modelled_estimates_total_%</th>
<th>total_population_No</th>
<th>female_population_%</th>
<th>male_population_%</th>
<th>rural_population_%</th>
<th>urban_population_%</th>
</tr>
</thead>
<tbody>
<tr>
<th>8697</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>2020</td>
<td>2020</td>
<td>1059299.0</td>
<td>63.64</td>
<td>22.22</td>
<td>18.35</td>
<td>486673.0</td>
<td>29.24</td>
<td>10.21</td>
<td>8.43</td>
<td>399489.0</td>
<td>24.0</td>
<td>8.38</td>
<td>6.92</td>
<td>49955664.5</td>
<td>26142638.1</td>
<td>16646395.1</td>
<td>11639398.1</td>
<td>5006997.0</td>
<td>9496243.0</td>
<td>75775.0</td>
<td>15384230.0</td>
<td>12553120.0</td>
<td>7383290.0</td>
<td>13578.229</td>
<td>17162.2304</td>
<td>11289.9885</td>
<td>1440.2696</td>
<td>5844.8665</td>
<td>1548.395</td>
<td>34564.6029</td>
<td>43474.11</td>
<td>165150.0</td>
<td>532600.0</td>
<td>697820.0</td>
<td>171200.0</td>
<td>605510.0</td>
<td>776710.0</td>
<td>1.9</td>
<td>5.7</td>
<td>4.0</td>
<td>47679489.0</td>
<td>50.886131</td>
<td>49.113869</td>
<td>18.699198</td>
<td>78.741484</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=30f20f96">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=6689d6a1">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="An%C3%A0lisi-dels-datasets-clim%C3%A0tics">Anlisi dels datasets climtics<a class="anchor-link" href="#An%C3%A0lisi-dels-datasets-clim%C3%A0tics"></a></h2><p>Un cop construts els dataframes agrcoles amb informaci de producci, preus, fertilitzants, s del sl, pesticides, cobertura terrestre, emissions i ocupaci, s essencial integrar dades climtiques per analitzar la relaci entre l'agricultura i el canvi climtic.</p>
<p>Els datasets climtics que analitzarem sn:</p>
<ol>
<li><strong>Climate_Indicators_Annual_Mean_Global_Surface_Temperature</strong>: Temperatura superficial global anual</li>
<li><strong>World_Development_Indicators</strong>: Indicadors de desenvolupament mundial (incloent clima)</li>
<li><strong>annual_mean_historical_pr</strong>: Precipitaci mitjana anual histrica</li>
<li><strong>annual_mean_historical_tas</strong>: Temperatura mitjana anual histrica</li>
</ol>
<p>Aquests datasets ens permetran:</p>
<ul>
<li>Contextualitzar la producci agrcola amb les condicions climtiques de cada pas</li>
<li>Analitzar l'impacte del canvi climtic en la productivitat i les prctiques agrcoles</li>
<li>Identificar patrons de correlaci entre variables climtiques i agrcoles</li>
<li>Avaluar la vulnerabilitat dels sistemes agrcoles als canvis ambientals</li>
</ul>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=ffca75dd">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Definici%C3%B3-de-funci%C3%B3-per-analitzar-datasets-clim%C3%A0tics">Definici de funci per analitzar datasets climtics<a class="anchor-link" href="#Definici%C3%B3-de-funci%C3%B3-per-analitzar-datasets-clim%C3%A0tics"></a></h3>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=fad137c8">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[47]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">analitzar_climate_df</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">df_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">cols_to_show_unique</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Funci per analitzar un dataset climtic.</span>
<span class="sd">    </span>
<span class="sd">    Mostra:</span>
<span class="sd">    - Dimensions del dataframe</span>
<span class="sd">    - Head() del dataframe</span>
<span class="sd">    - Valors nics de les columnes especificades</span>
<span class="sd">    </span>
<span class="sd">    Parmetres:</span>
<span class="sd">    -----------</span>
<span class="sd">    df : pd.DataFrame</span>
<span class="sd">        Dataframe a analitzar</span>
<span class="sd">    df_name : str</span>
<span class="sd">        Nom del dataframe (per als prints)</span>
<span class="sd">    cols_to_show_unique : list[str]</span>
<span class="sd">        Llista de columnes per mostrar valors nics</span>
<span class="sd">        </span>
<span class="sd">    Retorna:</span>
<span class="sd">    --------</span>
<span class="sd">    pd.DataFrame</span>
<span class="sd">        Dataframe processat (amb header fixat si cal)</span>
<span class="sd">    """</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Anlisi del dataset: </span><span class="si">{</span><span class="n">df_name</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    
    <span class="c1"># Mostrar dimensions</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Dimensions: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> files x </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> columnes"</span><span class="p">)</span>
    
    <span class="c1"># Mostrar columnes</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Columnes (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2">):"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  </span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">2d</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    
    <span class="c1"># Mostrar head</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Primeres files de </span><span class="si">{</span><span class="n">df_name</span><span class="si">}</span><span class="s2">:"</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
    
    <span class="c1"># Mostrar valors nics de les columnes especificades</span>
    <span class="k">if</span> <span class="n">cols_to_show_unique</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols_to_show_unique</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">unique_values</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Valors nics de la columna '</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">':"</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Total nics: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">unique_values</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_values</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">20</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Valors: </span><span class="si">{</span><span class="nb">sorted</span><span class="p">(</span><span class="n">unique_values</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Primers 20 valors: </span><span class="si">{</span><span class="nb">sorted</span><span class="p">(</span><span class="n">unique_values</span><span class="p">)[:</span><span class="mi">20</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">La columna '</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">' no existeix al dataframe"</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">df</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=fbe3e1eb">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="An%C3%A0lisi-de-Climate_Indicators_Annual_Mean_Global_Surface_Temperature">Anlisi de Climate_Indicators_Annual_Mean_Global_Surface_Temperature<a class="anchor-link" href="#An%C3%A0lisi-de-Climate_Indicators_Annual_Mean_Global_Surface_Temperature"></a></h3>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=aa2c9a94">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[48]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Analitzar Climate_Indicators amb fix de header</span>
<span class="n">df_name</span> <span class="o">=</span> <span class="s2">"Climate_Indicators_Annual_Mean_Global_Surface_Temperature"</span>
<span class="n">climate_indicators_df</span> <span class="o">=</span> <span class="n">analitzar_climate_df</span><span class="p">(</span>
    <span class="n">df</span><span class="o">=</span><span class="n">data_dict</span><span class="p">[</span><span class="s2">"climate_data"</span><span class="p">][</span><span class="n">df_name</span><span class="p">],</span>
    <span class="n">df_name</span><span class="o">=</span><span class="n">df_name</span><span class="p">,</span>
    <span class="n">cols_to_show_unique</span><span class="o">=</span><span class="p">[</span><span class="s1">'Indicator'</span><span class="p">,</span> <span class="s1">'Unit'</span><span class="p">,</span> <span class="s1">'Source'</span><span class="p">,</span> <span class="s1">'CTS Name'</span><span class="p">,</span> <span class="s1">'CTS Full Descriptor'</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Anlisi del dataset: Climate_Indicators_Annual_Mean_Global_Surface_Temperature

Dimensions: 231 files x 74 columnes

Columnes (74):
   1. ObjectId
   2. Country
   3. ISO2
   4. ISO3
   5. Indicator
   6. Unit
   7. Source
   8. CTS Code
   9. CTS Name
  10. CTS Full Descriptor
  11. 1961
  12. 1962
  13. 1963
  14. 1964
  15. 1965
  16. 1966
  17. 1967
  18. 1968
  19. 1969
  20. 1970
  21. 1971
  22. 1972
  23. 1973
  24. 1974
  25. 1975
  26. 1976
  27. 1977
  28. 1978
  29. 1979
  30. 1980
  31. 1981
  32. 1982
  33. 1983
  34. 1984
  35. 1985
  36. 1986
  37. 1987
  38. 1988
  39. 1989
  40. 1990
  41. 1991
  42. 1992
  43. 1993
  44. 1994
  45. 1995
  46. 1996
  47. 1997
  48. 1998
  49. 1999
  50. 2000
  51. 2001
  52. 2002
  53. 2003
  54. 2004
  55. 2005
  56. 2006
  57. 2007
  58. 2008
  59. 2009
  60. 2010
  61. 2011
  62. 2012
  63. 2013
  64. 2014
  65. 2015
  66. 2016
  67. 2017
  68. 2018
  69. 2019
  70. 2020
  71. 2021
  72. 2022
  73. 2023
  74. 2024

Primeres files de Climate_Indicators_Annual_Mean_Global_Surface_Temperature:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>ObjectId</th>
<th>Country</th>
<th>ISO2</th>
<th>ISO3</th>
<th>Indicator</th>
<th>Unit</th>
<th>Source</th>
<th>CTS Code</th>
<th>CTS Name</th>
<th>CTS Full Descriptor</th>
<th>1961</th>
<th>1962</th>
<th>1963</th>
<th>1964</th>
<th>1965</th>
<th>1966</th>
<th>1967</th>
<th>1968</th>
<th>1969</th>
<th>1970</th>
<th>1971</th>
<th>1972</th>
<th>1973</th>
<th>1974</th>
<th>1975</th>
<th>1976</th>
<th>1977</th>
<th>1978</th>
<th>1979</th>
<th>1980</th>
<th>1981</th>
<th>1982</th>
<th>1983</th>
<th>1984</th>
<th>1985</th>
<th>1986</th>
<th>1987</th>
<th>1988</th>
<th>1989</th>
<th>1990</th>
<th>1991</th>
<th>1992</th>
<th>1993</th>
<th>1994</th>
<th>1995</th>
<th>1996</th>
<th>1997</th>
<th>1998</th>
<th>1999</th>
<th>2000</th>
<th>2001</th>
<th>2002</th>
<th>2003</th>
<th>2004</th>
<th>2005</th>
<th>2006</th>
<th>2007</th>
<th>2008</th>
<th>2009</th>
<th>2010</th>
<th>2011</th>
<th>2012</th>
<th>2013</th>
<th>2014</th>
<th>2015</th>
<th>2016</th>
<th>2017</th>
<th>2018</th>
<th>2019</th>
<th>2020</th>
<th>2021</th>
<th>2022</th>
<th>2023</th>
<th>2024</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>Afghanistan, Islamic Rep. of</td>
<td>AF</td>
<td>AFG</td>
<td>Temperature change with respect to a baseline climatology, corresponding to the period 1951-1980</td>
<td>Degree Celsius</td>
<td>Food and Agriculture Organization of the United Nations (FAO). 2022. FAOSTAT Climate Change, Climate Indicators, Temperature change. License: CC BY-NC-SA 3.0 IGO. Extracted from:https://www.fao.org/faostat/en/#data/ET.</td>
<td>ECCS</td>
<td>Surface Temperature Change</td>
<td>Environment, Climate Change, Climate and Weather, Surface Temperature Change</td>
<td>-0.096</td>
<td>-0.143</td>
<td>0.848</td>
<td>-0.762</td>
<td>-0.233</td>
<td>0.239</td>
<td>-0.355</td>
<td>-0.402</td>
<td>-0.528</td>
<td>0.828</td>
<td>0.628</td>
<td>-1.116</td>
<td>0.240</td>
<td>-0.484</td>
<td>-0.469</td>
<td>-0.292</td>
<td>0.478</td>
<td>0.028</td>
<td>0.335</td>
<td>0.585</td>
<td>0.479</td>
<td>-0.356</td>
<td>0.147</td>
<td>0.129</td>
<td>0.250</td>
<td>-0.129</td>
<td>0.380</td>
<td>0.918</td>
<td>-0.124</td>
<td>0.786</td>
<td>-0.149</td>
<td>-0.262</td>
<td>0.175</td>
<td>0.461</td>
<td>0.405</td>
<td>-0.119</td>
<td>0.425</td>
<td>0.577</td>
<td>1.167</td>
<td>1.000</td>
<td>1.276</td>
<td>1.355</td>
<td>0.552</td>
<td>1.422</td>
<td>0.419</td>
<td>1.799</td>
<td>0.699</td>
<td>0.732</td>
<td>0.958</td>
<td>1.666</td>
<td>1.455</td>
<td>0.267</td>
<td>1.385</td>
<td>0.484</td>
<td>1.139</td>
<td>1.588</td>
<td>1.630</td>
<td>1.597</td>
<td>0.951</td>
<td>0.552</td>
<td>1.418</td>
<td>1.967</td>
<td>1.748</td>
<td>2.188</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>Africa</td>
<td>NaN</td>
<td>AFRTMP</td>
<td>Temperature change with respect to a baseline climatology, corresponding to the period 1951-1980</td>
<td>Degree Celsius</td>
<td>Food and Agriculture Organization of the United Nations (FAO). 2022. FAOSTAT Climate Change, Climate Indicators, Temperature change. License: CC BY-NC-SA 3.0 IGO. Extracted from:https://www.fao.org/faostat/en/#data/ET.</td>
<td>ECCS</td>
<td>Surface Temperature Change</td>
<td>Environment, Climate Change, Climate and Weather, Surface Temperature Change</td>
<td>-0.015</td>
<td>-0.033</td>
<td>0.069</td>
<td>-0.149</td>
<td>-0.194</td>
<td>0.142</td>
<td>-0.212</td>
<td>-0.225</td>
<td>0.359</td>
<td>0.219</td>
<td>-0.205</td>
<td>0.000</td>
<td>0.376</td>
<td>-0.235</td>
<td>-0.237</td>
<td>-0.259</td>
<td>0.233</td>
<td>0.076</td>
<td>0.436</td>
<td>0.368</td>
<td>0.111</td>
<td>0.230</td>
<td>0.422</td>
<td>0.331</td>
<td>0.295</td>
<td>0.293</td>
<td>0.684</td>
<td>0.615</td>
<td>0.007</td>
<td>0.584</td>
<td>0.394</td>
<td>0.101</td>
<td>0.395</td>
<td>0.426</td>
<td>0.564</td>
<td>0.541</td>
<td>0.586</td>
<td>0.977</td>
<td>0.648</td>
<td>0.484</td>
<td>0.668</td>
<td>0.899</td>
<td>1.028</td>
<td>0.851</td>
<td>1.100</td>
<td>0.947</td>
<td>0.817</td>
<td>0.725</td>
<td>0.973</td>
<td>1.510</td>
<td>0.906</td>
<td>0.758</td>
<td>1.009</td>
<td>1.011</td>
<td>1.195</td>
<td>1.385</td>
<td>1.158</td>
<td>1.150</td>
<td>1.290</td>
<td>1.177</td>
<td>1.400</td>
<td>1.014</td>
<td>1.485</td>
<td>1.750</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>Albania</td>
<td>AL</td>
<td>ALB</td>
<td>Temperature change with respect to a baseline climatology, corresponding to the period 1951-1980</td>
<td>Degree Celsius</td>
<td>Food and Agriculture Organization of the United Nations (FAO). 2022. FAOSTAT Climate Change, Climate Indicators, Temperature change. License: CC BY-NC-SA 3.0 IGO. Extracted from:https://www.fao.org/faostat/en/#data/ET.</td>
<td>ECCS</td>
<td>Surface Temperature Change</td>
<td>Environment, Climate Change, Climate and Weather, Surface Temperature Change</td>
<td>0.643</td>
<td>0.351</td>
<td>0.089</td>
<td>-0.154</td>
<td>-0.377</td>
<td>0.565</td>
<td>-0.071</td>
<td>0.085</td>
<td>-0.009</td>
<td>-0.114</td>
<td>-0.208</td>
<td>-0.088</td>
<td>-0.313</td>
<td>-0.147</td>
<td>-0.223</td>
<td>-0.698</td>
<td>0.526</td>
<td>-0.824</td>
<td>0.196</td>
<td>-0.418</td>
<td>-0.351</td>
<td>0.174</td>
<td>-0.120</td>
<td>-0.267</td>
<td>-0.098</td>
<td>0.574</td>
<td>-0.105</td>
<td>0.379</td>
<td>-0.056</td>
<td>0.797</td>
<td>-0.277</td>
<td>0.087</td>
<td>0.068</td>
<td>1.314</td>
<td>-0.187</td>
<td>-0.039</td>
<td>0.079</td>
<td>0.795</td>
<td>0.686</td>
<td>1.065</td>
<td>1.547</td>
<td>0.513</td>
<td>1.026</td>
<td>0.472</td>
<td>0.200</td>
<td>0.402</td>
<td>1.377</td>
<td>1.020</td>
<td>0.944</td>
<td>1.241</td>
<td>1.136</td>
<td>1.559</td>
<td>1.392</td>
<td>1.332</td>
<td>1.702</td>
<td>1.608</td>
<td>1.239</td>
<td>2.155</td>
<td>1.797</td>
<td>1.627</td>
<td>1.719</td>
<td>1.701</td>
<td>2.299</td>
<td>2.925</td>
</tr>
<tr>
<th>3</th>
<td>4</td>
<td>Algeria</td>
<td>DZ</td>
<td>DZA</td>
<td>Temperature change with respect to a baseline climatology, corresponding to the period 1951-1980</td>
<td>Degree Celsius</td>
<td>Food and Agriculture Organization of the United Nations (FAO). 2022. FAOSTAT Climate Change, Climate Indicators, Temperature change. License: CC BY-NC-SA 3.0 IGO. Extracted from:https://www.fao.org/faostat/en/#data/ET.</td>
<td>ECCS</td>
<td>Surface Temperature Change</td>
<td>Environment, Climate Change, Climate and Weather, Surface Temperature Change</td>
<td>0.154</td>
<td>0.105</td>
<td>0.072</td>
<td>0.248</td>
<td>-0.104</td>
<td>0.424</td>
<td>0.000</td>
<td>-0.065</td>
<td>0.275</td>
<td>0.111</td>
<td>-0.391</td>
<td>-0.356</td>
<td>-0.030</td>
<td>-0.506</td>
<td>-0.570</td>
<td>-0.816</td>
<td>0.539</td>
<td>0.054</td>
<td>0.691</td>
<td>0.244</td>
<td>0.218</td>
<td>0.396</td>
<td>0.545</td>
<td>0.025</td>
<td>0.532</td>
<td>0.330</td>
<td>1.030</td>
<td>1.397</td>
<td>0.450</td>
<td>1.339</td>
<td>0.103</td>
<td>-0.232</td>
<td>0.643</td>
<td>0.828</td>
<td>0.689</td>
<td>0.923</td>
<td>1.112</td>
<td>1.163</td>
<td>1.510</td>
<td>0.862</td>
<td>1.889</td>
<td>1.288</td>
<td>1.621</td>
<td>1.024</td>
<td>1.293</td>
<td>1.432</td>
<td>1.254</td>
<td>1.219</td>
<td>0.969</td>
<td>2.272</td>
<td>1.407</td>
<td>1.171</td>
<td>1.213</td>
<td>1.705</td>
<td>1.134</td>
<td>1.761</td>
<td>1.506</td>
<td>1.203</td>
<td>1.240</td>
<td>2.006</td>
<td>2.424</td>
<td>1.804</td>
<td>2.303</td>
<td>2.824</td>
</tr>
<tr>
<th>4</th>
<td>5</td>
<td>American Samoa</td>
<td>AS</td>
<td>ASM</td>
<td>Temperature change with respect to a baseline climatology, corresponding to the period 1951-1980</td>
<td>Degree Celsius</td>
<td>Food and Agriculture Organization of the United Nations (FAO). 2022. FAOSTAT Climate Change, Climate Indicators, Temperature change. License: CC BY-NC-SA 3.0 IGO. Extracted from:https://www.fao.org/faostat/en/#data/ET.</td>
<td>ECCS</td>
<td>Surface Temperature Change</td>
<td>Environment, Climate Change, Climate and Weather, Surface Temperature Change</td>
<td>0.075</td>
<td>-0.047</td>
<td>0.161</td>
<td>-0.146</td>
<td>-0.538</td>
<td>0.210</td>
<td>-0.339</td>
<td>-0.164</td>
<td>0.153</td>
<td>-0.023</td>
<td>-0.449</td>
<td>-0.042</td>
<td>0.357</td>
<td>-0.271</td>
<td>-0.080</td>
<td>-0.139</td>
<td>0.187</td>
<td>0.124</td>
<td>0.372</td>
<td>0.362</td>
<td>0.190</td>
<td>0.289</td>
<td>0.322</td>
<td>0.286</td>
<td>0.264</td>
<td>0.403</td>
<td>0.360</td>
<td>0.513</td>
<td>0.149</td>
<td>0.505</td>
<td>0.645</td>
<td>0.363</td>
<td>-0.041</td>
<td>0.236</td>
<td>0.788</td>
<td>0.803</td>
<td>NaN</td>
<td>NaN</td>
<td>0.264</td>
<td>0.660</td>
<td>0.938</td>
<td>1.185</td>
<td>0.739</td>
<td>0.285</td>
<td>0.934</td>
<td>0.536</td>
<td>0.969</td>
<td>0.561</td>
<td>0.875</td>
<td>1.007</td>
<td>0.704</td>
<td>0.734</td>
<td>1.026</td>
<td>0.898</td>
<td>0.738</td>
<td>1.268</td>
<td>1.163</td>
<td>0.917</td>
<td>1.268</td>
<td>1.159</td>
<td>0.997</td>
<td>0.984</td>
<td>1.010</td>
<td>1.588</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
Valors nics de la columna 'Indicator':
Total nics: 1
Valors: ['Temperature change with respect to a baseline climatology, corresponding to the period 1951-1980']

Valors nics de la columna 'Unit':
Total nics: 1
Valors: ['Degree Celsius']

Valors nics de la columna 'Source':
Total nics: 1
Valors: ['Food and Agriculture Organization of the United Nations (FAO). 2022. FAOSTAT Climate Change, Climate Indicators, Temperature change. License: CC BY-NC-SA 3.0 IGO. Extracted from:\xa0https://www.fao.org/faostat/en/#data/ET.']

Valors nics de la columna 'CTS Name':
Total nics: 1
Valors: ['Surface Temperature Change']

Valors nics de la columna 'CTS Full Descriptor':
Total nics: 1
Valors: ['Environment, Climate Change, Climate and Weather, Surface Temperature Change']
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=8449adb3">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Transformaci%C3%B3-de-Climate_Indicators_Annual_Mean_Global_Surface_Temperature">Transformaci de Climate_Indicators_Annual_Mean_Global_Surface_Temperature<a class="anchor-link" href="#Transformaci%C3%B3-de-Climate_Indicators_Annual_Mean_Global_Surface_Temperature"></a></h3><p>Transformem el dataframe per eliminar columnes amb valors nics i fer unpivot de les columnes d'anys per tenir una estructura ms til per al merge final.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=107bab3a">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[49]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Identificar columnes amb valors nics per eliminar-les</span>
<span class="n">cols_to_drop</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'ObjectId'</span><span class="p">]</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">climate_indicators_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">climate_indicators_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">cols_to_drop</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Columna '</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">' t un nic valor: </span><span class="si">{</span><span class="n">climate_indicators_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Columnes a eliminar: </span><span class="si">{</span><span class="n">cols_to_drop</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Mantenir noms les columnes necessries: Country, ISO2, ISO3 i les columnes d'anys</span>
<span class="n">cols_to_keep</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Country'</span><span class="p">,</span> <span class="s1">'ISO2'</span><span class="p">,</span> <span class="s1">'ISO3'</span><span class="p">]</span>
<span class="c1"># Identificar columnes d'anys (columnes numriques que no sn les que volem mantenir)</span>
<span class="n">year_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">climate_indicators_df</span><span class="o">.</span><span class="n">columns</span> 
             <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cols_to_keep</span> <span class="o">+</span> <span class="n">cols_to_drop</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Columnes d'anys identificades: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">year_cols</span><span class="p">)</span><span class="si">}</span><span class="s2"> columnes"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Primers anys: </span><span class="si">{</span><span class="n">year_cols</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">year_cols</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">year_cols</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Crear dataframe amb noms les columnes necessries</span>
<span class="n">climate_indicators_clean</span> <span class="o">=</span> <span class="n">climate_indicators_df</span><span class="p">[</span><span class="n">cols_to_keep</span> <span class="o">+</span> <span class="n">year_cols</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Fer unpivot (melt) de les columnes d'anys</span>
<span class="n">climate_indicators_melted</span> <span class="o">=</span> <span class="n">climate_indicators_clean</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span>
    <span class="n">id_vars</span><span class="o">=</span><span class="n">cols_to_keep</span><span class="p">,</span>
    <span class="n">value_vars</span><span class="o">=</span><span class="n">year_cols</span><span class="p">,</span>
    <span class="n">var_name</span><span class="o">=</span><span class="s1">'Year'</span><span class="p">,</span>
    <span class="n">value_name</span><span class="o">=</span><span class="s1">'surface_temperature_change_celsius'</span>
<span class="p">)</span>

<span class="c1"># Convertir Year a numric</span>
<span class="n">climate_indicators_melted</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">climate_indicators_melted</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span>

<span class="c1"># Eliminar files amb valors NaN</span>
<span class="n">climate_indicators_melted</span> <span class="o">=</span> <span class="n">climate_indicators_melted</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">'surface_temperature_change_celsius'</span><span class="p">,</span> <span class="s1">'Year'</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Dimensions desprs de la transformaci: </span><span class="si">{</span><span class="n">climate_indicators_melted</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> files x </span><span class="si">{</span><span class="n">climate_indicators_melted</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> columnes"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Columnes finals: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">climate_indicators_melted</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Primeres files:"</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">climate_indicators_melted</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Columna 'Indicator' t un nic valor: Temperature change with respect to a baseline climatology, corresponding to the period 1951-1980
Columna 'Unit' t un nic valor: Degree Celsius
Columna 'Source' t un nic valor: Food and Agriculture Organization of the United Nations (FAO). 2022. FAOSTAT Climate Change, Climate Indicators, Temperature change. License: CC BY-NC-SA 3.0 IGO. Extracted from:https://www.fao.org/faostat/en/#data/ET.
Columna 'CTS Code' t un nic valor: ECCS
Columna 'CTS Name' t un nic valor: Surface Temperature Change
Columna 'CTS Full Descriptor' t un nic valor: Environment, Climate Change, Climate and Weather, Surface Temperature Change

Columnes a eliminar: ['ObjectId', 'Indicator', 'Unit', 'Source', 'CTS Code', 'CTS Name', 'CTS Full Descriptor']

Columnes d'anys identificades: 64 columnes
Primers anys: ['1961', '1962', '1963', '1964', '1965', '1966', '1967', '1968', '1969', '1970']

Dimensions desprs de la transformaci: 13,267 files x 5 columnes

Columnes finals: ['Country', 'ISO2', 'ISO3', 'Year', 'surface_temperature_change_celsius']

Primeres files:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Country</th>
<th>ISO2</th>
<th>ISO3</th>
<th>Year</th>
<th>surface_temperature_change_celsius</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Afghanistan, Islamic Rep. of</td>
<td>AF</td>
<td>AFG</td>
<td>1961</td>
<td>-0.096</td>
</tr>
<tr>
<th>1</th>
<td>Africa</td>
<td>NaN</td>
<td>AFRTMP</td>
<td>1961</td>
<td>-0.015</td>
</tr>
<tr>
<th>2</th>
<td>Albania</td>
<td>AL</td>
<td>ALB</td>
<td>1961</td>
<td>0.643</td>
</tr>
<tr>
<th>3</th>
<td>Algeria</td>
<td>DZ</td>
<td>DZA</td>
<td>1961</td>
<td>0.154</td>
</tr>
<tr>
<th>4</th>
<td>American Samoa</td>
<td>AS</td>
<td>ASM</td>
<td>1961</td>
<td>0.075</td>
</tr>
<tr>
<th>5</th>
<td>Americas</td>
<td>NaN</td>
<td>AMETMP</td>
<td>1961</td>
<td>0.058</td>
</tr>
<tr>
<th>6</th>
<td>Andorra, Principality of</td>
<td>AD</td>
<td>AND</td>
<td>1961</td>
<td>0.736</td>
</tr>
<tr>
<th>7</th>
<td>Angola</td>
<td>AO</td>
<td>AGO</td>
<td>1961</td>
<td>0.033</td>
</tr>
<tr>
<th>8</th>
<td>Anguilla</td>
<td>AI</td>
<td>AIA</td>
<td>1961</td>
<td>-0.029</td>
</tr>
<tr>
<th>9</th>
<td>Antigua and Barbuda</td>
<td>AG</td>
<td>ATG</td>
<td>1961</td>
<td>0.013</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=d8245f7f">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="An%C3%A0lisi-de-World_Development_Indicators">Anlisi de World_Development_Indicators<a class="anchor-link" href="#An%C3%A0lisi-de-World_Development_Indicators"></a></h3>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=5652cfde">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Transformaci%C3%B3-de-World_Development_Indicators">Transformaci de World_Development_Indicators<a class="anchor-link" href="#Transformaci%C3%B3-de-World_Development_Indicators"></a></h3><p>Transformem el dataframe per tenir una estructura til amb indicadors agrcoles per pas i any. Eliminem registres no vlids, fem unpivot de les columnes d'anys i pivotem per tenir una columna per cada indicador.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=385d0158">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[50]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Analitzar World_Development_Indicators</span>
<span class="n">wdi_df</span> <span class="o">=</span> <span class="n">analitzar_climate_df</span><span class="p">(</span>
    <span class="n">df</span><span class="o">=</span><span class="n">data_dict</span><span class="p">[</span><span class="s2">"climate_data"</span><span class="p">][</span><span class="s2">"World_Development_Indicators"</span><span class="p">],</span>
    <span class="n">df_name</span><span class="o">=</span><span class="s2">"World_Development_Indicators"</span><span class="p">,</span>
    <span class="n">cols_to_show_unique</span><span class="o">=</span><span class="p">[</span><span class="s1">'Series Name'</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Anlisi del dataset: World_Development_Indicators

Dimensions: 1,875 files x 69 columnes

Columnes (69):
   1. Country Name
   2. Country Code
   3. Series Name
   4. Series Code
   5. 1960 [YR1960]
   6. 1961 [YR1961]
   7. 1962 [YR1962]
   8. 1963 [YR1963]
   9. 1964 [YR1964]
  10. 1965 [YR1965]
  11. 1966 [YR1966]
  12. 1967 [YR1967]
  13. 1968 [YR1968]
  14. 1969 [YR1969]
  15. 1970 [YR1970]
  16. 1971 [YR1971]
  17. 1972 [YR1972]
  18. 1973 [YR1973]
  19. 1974 [YR1974]
  20. 1975 [YR1975]
  21. 1976 [YR1976]
  22. 1977 [YR1977]
  23. 1978 [YR1978]
  24. 1979 [YR1979]
  25. 1980 [YR1980]
  26. 1981 [YR1981]
  27. 1982 [YR1982]
  28. 1983 [YR1983]
  29. 1984 [YR1984]
  30. 1985 [YR1985]
  31. 1986 [YR1986]
  32. 1987 [YR1987]
  33. 1988 [YR1988]
  34. 1989 [YR1989]
  35. 1990 [YR1990]
  36. 1991 [YR1991]
  37. 1992 [YR1992]
  38. 1993 [YR1993]
  39. 1994 [YR1994]
  40. 1995 [YR1995]
  41. 1996 [YR1996]
  42. 1997 [YR1997]
  43. 1998 [YR1998]
  44. 1999 [YR1999]
  45. 2000 [YR2000]
  46. 2001 [YR2001]
  47. 2002 [YR2002]
  48. 2003 [YR2003]
  49. 2004 [YR2004]
  50. 2005 [YR2005]
  51. 2006 [YR2006]
  52. 2007 [YR2007]
  53. 2008 [YR2008]
  54. 2009 [YR2009]
  55. 2010 [YR2010]
  56. 2011 [YR2011]
  57. 2012 [YR2012]
  58. 2013 [YR2013]
  59. 2014 [YR2014]
  60. 2015 [YR2015]
  61. 2016 [YR2016]
  62. 2017 [YR2017]
  63. 2018 [YR2018]
  64. 2019 [YR2019]
  65. 2020 [YR2020]
  66. 2021 [YR2021]
  67. 2022 [YR2022]
  68. 2023 [YR2023]
  69. 2024 [YR2024]

Primeres files de World_Development_Indicators:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Country Name</th>
<th>Country Code</th>
<th>Series Name</th>
<th>Series Code</th>
<th>1960 [YR1960]</th>
<th>1961 [YR1961]</th>
<th>1962 [YR1962]</th>
<th>1963 [YR1963]</th>
<th>1964 [YR1964]</th>
<th>1965 [YR1965]</th>
<th>1966 [YR1966]</th>
<th>1967 [YR1967]</th>
<th>1968 [YR1968]</th>
<th>1969 [YR1969]</th>
<th>1970 [YR1970]</th>
<th>1971 [YR1971]</th>
<th>1972 [YR1972]</th>
<th>1973 [YR1973]</th>
<th>1974 [YR1974]</th>
<th>1975 [YR1975]</th>
<th>1976 [YR1976]</th>
<th>1977 [YR1977]</th>
<th>1978 [YR1978]</th>
<th>1979 [YR1979]</th>
<th>1980 [YR1980]</th>
<th>1981 [YR1981]</th>
<th>1982 [YR1982]</th>
<th>1983 [YR1983]</th>
<th>1984 [YR1984]</th>
<th>1985 [YR1985]</th>
<th>1986 [YR1986]</th>
<th>1987 [YR1987]</th>
<th>1988 [YR1988]</th>
<th>1989 [YR1989]</th>
<th>1990 [YR1990]</th>
<th>1991 [YR1991]</th>
<th>1992 [YR1992]</th>
<th>1993 [YR1993]</th>
<th>1994 [YR1994]</th>
<th>1995 [YR1995]</th>
<th>1996 [YR1996]</th>
<th>1997 [YR1997]</th>
<th>1998 [YR1998]</th>
<th>1999 [YR1999]</th>
<th>2000 [YR2000]</th>
<th>2001 [YR2001]</th>
<th>2002 [YR2002]</th>
<th>2003 [YR2003]</th>
<th>2004 [YR2004]</th>
<th>2005 [YR2005]</th>
<th>2006 [YR2006]</th>
<th>2007 [YR2007]</th>
<th>2008 [YR2008]</th>
<th>2009 [YR2009]</th>
<th>2010 [YR2010]</th>
<th>2011 [YR2011]</th>
<th>2012 [YR2012]</th>
<th>2013 [YR2013]</th>
<th>2014 [YR2014]</th>
<th>2015 [YR2015]</th>
<th>2016 [YR2016]</th>
<th>2017 [YR2017]</th>
<th>2018 [YR2018]</th>
<th>2019 [YR2019]</th>
<th>2020 [YR2020]</th>
<th>2021 [YR2021]</th>
<th>2022 [YR2022]</th>
<th>2023 [YR2023]</th>
<th>2024 [YR2024]</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Afghanistan</td>
<td>AFG</td>
<td>Agriculture, forestry, and fishing, value added (% of GDP)</td>
<td>NV.AGR.TOTL.ZS</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>38.6278918638443</td>
<td>37.4188554431481</td>
<td>29.7210671376957</td>
<td>31.114854912062</td>
<td>28.6359685844686</td>
<td>30.1050113574013</td>
<td>24.8922700059742</td>
<td>29.2975010547259</td>
<td>26.2100685374552</td>
<td>23.7436639877543</td>
<td>24.390873626371</td>
<td>22.8106627361766</td>
<td>22.1370413719574</td>
<td>20.6343227166798</td>
<td>25.7403140364582</td>
<td>26.4201990834448</td>
<td>22.0428967527575</td>
<td>25.7739707394105</td>
<td>29.9755825210461</td>
<td>33.5976188725451</td>
<td>33.7014323213923</td>
<td>34.7432471445174</td>
<td>..</td>
</tr>
<tr>
<th>1</th>
<td>Afghanistan</td>
<td>AFG</td>
<td>Agriculture, forestry, and fishing, value added (annual % growth)</td>
<td>NV.AGR.TOTL.KD.ZG</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>2.7983102944344</td>
<td>-22.2363560541923</td>
<td>17.6981031760703</td>
<td>-5.10925115291374</td>
<td>14.7004462834181</td>
<td>-14.9163297643984</td>
<td>44.5629549189029</td>
<td>-6.3751344936499</td>
<td>-7.59232353439185</td>
<td>18.2247894586686</td>
<td>0.00526741377919393</td>
<td>-0.10070510676627</td>
<td>-5.65721785186237</td>
<td>5.97175186192254</td>
<td>6.41105900151825</td>
<td>-4.41531136727946</td>
<td>17.4598248147288</td>
<td>5.9423403878575</td>
<td>-9.7806339651292</td>
<td>-6.56407790334215</td>
<td>2.22486704408989</td>
<td>..</td>
</tr>
<tr>
<th>2</th>
<td>Afghanistan</td>
<td>AFG</td>
<td>Agriculture, forestry, and fishing, value added (constant 2015 US$)</td>
<td>NV.AGR.TOTL.KD</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>3251434260.06993</td>
<td>3342419479.68623</td>
<td>2599187183.35852</td>
<td>3059194012.80851</td>
<td>2902892107.43922</td>
<td>3329630202.35891</td>
<td>2832971581.44005</td>
<td>4095427430.14251</td>
<td>3834338423.38109</td>
<td>3543223044.8745</td>
<td>4188967984.85391</td>
<td>4189188635.13075</td>
<td>4184969908.2431</td>
<td>3948217043.4989</td>
<td>4183994768.30679</td>
<td>4452233141.52337</td>
<td>4255653185.52791</td>
<td>4998682776.44351</td>
<td>5295721521.92899</td>
<td>4777766384.05654</td>
<td>4464150076.56738</td>
<td>4563471480.41964</td>
<td>..</td>
</tr>
<tr>
<th>3</th>
<td>Afghanistan</td>
<td>AFG</td>
<td>Agricultural irrigated land (% of total agricultural land)</td>
<td>AG.LND.IRIG.AG.ZS</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>..</td>
<td>5.66212461965868</td>
<td>4.61762370997618</td>
<td>7.26428043501214</td>
<td>5.49989453701751</td>
<td>5.83906954664135</td>
<td>6.08546557636508</td>
<td>5.93975840059081</td>
<td>5.77856313957168</td>
<td>4.84228294123853</td>
<td>5.00039560091779</td>
<td>5.39100619807464</td>
<td>5.46499973624519</td>
<td>5.51833289369559</td>
<td>5.74254814033237</td>
<td>5.71089422316012</td>
<td>6.4811395410182</td>
<td>5.99050382484833</td>
<td>5.1223362273086</td>
<td>6.00631412786109</td>
<td>6.50692976274372</td>
<td>6.32161407355206</td>
<td>5.82830892908412</td>
<td>5.97911638157204</td>
<td>..</td>
</tr>
<tr>
<th>4</th>
<td>Afghanistan</td>
<td>AFG</td>
<td>Agricultural land (% of land area)</td>
<td>AG.LND.AGRI.ZS</td>
<td>..</td>
<td>57.878355794735</td>
<td>57.9550158686353</td>
<td>58.0316759425356</td>
<td>58.1160020238259</td>
<td>58.123668031216</td>
<td>58.1926620977263</td>
<td>58.2294589331984</td>
<td>58.2309921346764</td>
<td>58.2555233583245</td>
<td>58.2708553731046</td>
<td>58.3168514174448</td>
<td>58.3352498351808</td>
<td>58.3370896769544</td>
<td>58.3387761985803</td>
<td>58.3387761985803</td>
<td>58.3383162381369</td>
<td>58.3383162381369</td>
<td>58.3383162381369</td>
<td>58.3367830366588</td>
<td>58.3367830366588</td>
<td>58.3429158425709</td>
<td>58.3444490440489</td>
<td>58.3444490440489</td>
<td>58.3444490440489</td>
<td>58.3444490440489</td>
<td>58.3444490440489</td>
<td>58.3306502307468</td>
<td>58.3229842233568</td>
<td>58.3229842233568</td>
<td>58.3229842233568</td>
<td>58.3076522085767</td>
<td>58.3076522085767</td>
<td>58.1604648666881</td>
<td>57.9749474878494</td>
<td>57.8982874139491</td>
<td>57.889088205081</td>
<td>57.9473498612453</td>
<td>58.0592735691397</td>
<td>57.8998206154271</td>
<td>57.9458166597673</td>
<td>57.9473498612453</td>
<td>57.9396838538552</td>
<td>58.0838047927878</td>
<td>58.1512656578201</td>
<td>58.134400441562</td>
<td>58.123668031216</td>
<td>58.129800837128</td>
<td>58.132867240084</td>
<td>58.132867240084</td>
<td>58.134400441562</td>
<td>58.131334038606</td>
<td>58.129800837128</td>
<td>58.123668031216</td>
<td>58.123668031216</td>
<td>58.123668031216</td>
<td>58.123668031216</td>
<td>58.123668031216</td>
<td>58.2769881790166</td>
<td>58.2769881790166</td>
<td>58.7415482268525</td>
<td>58.7415482268525</td>
<td>58.7415482268525</td>
<td>58.4395075356853</td>
<td>..</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
Valors nics de la columna 'Series Name':
Total nics: 8
Valors: ['Agricultural irrigated land (% of total agricultural land)', 'Agricultural land (% of land area)', 'Agriculture, forestry, and fishing, value added (% of GDP)', 'Agriculture, forestry, and fishing, value added (annual % growth)', 'Agriculture, forestry, and fishing, value added (constant 2015 US$)', 'Arable land (% of land area)', 'Arable land (hectares per person)', 'Indicator Name']
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=d790c18f">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[51]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Eliminar registres on Series Name = 'Indicator Name'</span>
<span class="n">wdi_clean</span> <span class="o">=</span> <span class="n">wdi_df</span><span class="p">[</span><span class="n">wdi_df</span><span class="p">[</span><span class="s1">'Series Name'</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">'Indicator Name'</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Registres eliminats: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">wdi_df</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">wdi_clean</span><span class="p">)</span><span class="si">}</span><span class="s2"> (Series Name = 'Indicator Name')"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Registres restants: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">wdi_clean</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Identificar columnes d'anys (formato "1960 [YR1960]")</span>
<span class="n">year_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">wdi_clean</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="s1">'[YR'</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">col</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Columnes d'anys identificades: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">year_cols</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Columnes a mantenir com id_vars</span>
<span class="n">id_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Country Name'</span><span class="p">,</span> <span class="s1">'Country Code'</span><span class="p">,</span> <span class="s1">'Series Name'</span><span class="p">,</span> <span class="s1">'Series Code'</span><span class="p">]</span>

<span class="c1"># Fer unpivot (melt) de les columnes d'anys</span>
<span class="n">wdi_melted</span> <span class="o">=</span> <span class="n">wdi_clean</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span>
    <span class="n">id_vars</span><span class="o">=</span><span class="n">id_cols</span><span class="p">,</span>
    <span class="n">value_vars</span><span class="o">=</span><span class="n">year_cols</span><span class="p">,</span>
    <span class="n">var_name</span><span class="o">=</span><span class="s1">'Year_Col'</span><span class="p">,</span>
    <span class="n">value_name</span><span class="o">=</span><span class="s1">'Value'</span>
<span class="p">)</span>

<span class="c1"># Extraure l'any del format "1960 [YR1960]"</span>
<span class="n">wdi_melted</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">]</span> <span class="o">=</span> <span class="n">wdi_melted</span><span class="p">[</span><span class="s1">'Year_Col'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="sa">r</span><span class="s1">'(\d</span><span class="si">{4}</span><span class="s1">)'</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">wdi_melted</span> <span class="o">=</span> <span class="n">wdi_melted</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'Year_Col'</span><span class="p">,</span> <span class="s1">'Series Code'</span><span class="p">])</span>

<span class="c1"># Convertir '..' a NaN</span>
<span class="n">wdi_melted</span><span class="p">[</span><span class="s1">'Value'</span><span class="p">]</span> <span class="o">=</span> <span class="n">wdi_melted</span><span class="p">[</span><span class="s1">'Value'</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'..'</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="n">wdi_melted</span> <span class="o">=</span> <span class="n">wdi_melted</span><span class="p">[</span>
    <span class="n">wdi_melted</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span>
<span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Convertir Value a numric</span>
<span class="n">wdi_melted</span><span class="p">[</span><span class="s1">'Value'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">wdi_melted</span><span class="p">[</span><span class="s1">'Value'</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span>
<span class="n">wdi_melted</span> <span class="o">=</span> <span class="n">wdi_melted</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">'Value'</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Dimensions desprs del melt: </span><span class="si">{</span><span class="n">wdi_melted</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> files x </span><span class="si">{</span><span class="n">wdi_melted</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> columnes"</span><span class="p">)</span>

<span class="c1"># Pivotar per Series Name per tenir una columna per cada indicador</span>
<span class="n">wdi_pivot</span> <span class="o">=</span> <span class="n">wdi_melted</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">'Country Name'</span><span class="p">,</span> <span class="s1">'Country Code'</span><span class="p">,</span> <span class="s1">'Year'</span><span class="p">],</span>
    <span class="n">columns</span><span class="o">=</span><span class="s1">'Series Name'</span><span class="p">,</span>
    <span class="n">values</span><span class="o">=</span><span class="s1">'Value'</span><span class="p">,</span>
    <span class="n">aggfunc</span><span class="o">=</span><span class="s1">'first'</span>
<span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Dimensions desprs del pivot: </span><span class="si">{</span><span class="n">wdi_pivot</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> files x </span><span class="si">{</span><span class="n">wdi_pivot</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> columnes"</span><span class="p">)</span>

<span class="c1"># Renombrar columnes segons el format especificat</span>
<span class="n">column_mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'Country Name'</span><span class="p">:</span> <span class="s1">'Country'</span><span class="p">,</span>
    <span class="s1">'Country Code'</span><span class="p">:</span> <span class="s1">'ISO3'</span><span class="p">,</span>
    <span class="s1">'Agricultural irrigated land (</span><span class="si">% o</span><span class="s1">f total agricultural land)'</span><span class="p">:</span> <span class="s1">'agricultural_irrigated_land_%_of_total_agri_land'</span><span class="p">,</span>
    <span class="s1">'Agricultural land (</span><span class="si">% o</span><span class="s1">f land area)'</span><span class="p">:</span> <span class="s1">'agricultural_land_%_total_land'</span><span class="p">,</span>
    <span class="s1">'Arable land (</span><span class="si">% o</span><span class="s1">f land area)'</span><span class="p">:</span> <span class="s1">'arable_land_%_total_land'</span><span class="p">,</span>
    <span class="s1">'Arable land (hectares per person)'</span><span class="p">:</span> <span class="s1">'arable_land_ha_per_person'</span><span class="p">,</span>
    <span class="s1">'Agriculture, forestry, and fishing, value added (</span><span class="si">% o</span><span class="s1">f GDP)'</span><span class="p">:</span> <span class="s1">'agriculture_forestry_fishing_value_added_%_GDP'</span><span class="p">,</span>
    <span class="s1">'Agriculture, forestry, and fishing, value added (annual </span><span class="si">% g</span><span class="s1">rowth)'</span><span class="p">:</span> <span class="s1">'agriculture_forestry_fishing_value_added_%_annual_growth'</span><span class="p">,</span>
    <span class="s1">'Agriculture, forestry, and fishing, value added (constant 2015 US$)'</span><span class="p">:</span> <span class="s1">'agriculture_forestry_fishing_value_added_constant_2015_US$'</span>
<span class="p">}</span>

<span class="n">wdi_final</span> <span class="o">=</span> <span class="n">wdi_pivot</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">column_mapping</span><span class="p">)</span>

<span class="c1"># Seleccionar noms les columnes que volem mantenir</span>
<span class="n">cols_to_keep</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">'ISO3'</span><span class="p">,</span>
    <span class="s1">'Year'</span><span class="p">,</span>
    <span class="s1">'agricultural_irrigated_land_%_of_total_agri_land'</span><span class="p">,</span>
    <span class="s1">'agricultural_land_%_total_land'</span><span class="p">,</span>
    <span class="s1">'arable_land_%_total_land'</span><span class="p">,</span>
    <span class="s1">'arable_land_ha_per_person'</span><span class="p">,</span>
    <span class="s1">'agriculture_forestry_fishing_value_added_%_GDP'</span><span class="p">,</span>
    <span class="s1">'agriculture_forestry_fishing_value_added_%_annual_growth'</span><span class="p">,</span>
    <span class="s1">'agriculture_forestry_fishing_value_added_%_constant_2015_US$'</span>
<span class="p">]</span>

<span class="c1"># Mantenir noms les columnes que existeixen</span>
<span class="n">cols_to_keep</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols_to_keep</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">wdi_final</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
<span class="n">wdi_final</span> <span class="o">=</span> <span class="n">wdi_final</span><span class="p">[</span><span class="n">cols_to_keep</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Dimensions finals: </span><span class="si">{</span><span class="n">wdi_final</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> files x </span><span class="si">{</span><span class="n">wdi_final</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> columnes"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Columnes finals: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">wdi_final</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Primeres files:"</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">wdi_final</span><span class="p">[(</span><span class="n">wdi_final</span><span class="p">[</span><span class="s1">'ISO3'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'ESP'</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">wdi_final</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">2015</span><span class="p">)]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Registres eliminats: 1 (Series Name = 'Indicator Name')
Registres restants: 1874

Columnes d'anys identificades: 65

Dimensions desprs del melt: 77,768 files x 5 columnes

Dimensions desprs del pivot: 15,603 files x 10 columnes

Dimensions finals: 15,603 files x 8 columnes

Columnes finals: ['ISO3', 'Year', 'agricultural_irrigated_land_%_of_total_agri_land', 'agricultural_land_%_total_land', 'arable_land_%_total_land', 'arable_land_ha_per_person', 'agriculture_forestry_fishing_value_added_%_GDP', 'agriculture_forestry_fishing_value_added_%_annual_growth']

Primeres files:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>Series Name</th>
<th>ISO3</th>
<th>Year</th>
<th>agricultural_irrigated_land_%_of_total_agri_land</th>
<th>agricultural_land_%_total_land</th>
<th>arable_land_%_total_land</th>
<th>arable_land_ha_per_person</th>
<th>agriculture_forestry_fishing_value_added_%_GDP</th>
<th>agriculture_forestry_fishing_value_added_%_annual_growth</th>
</tr>
</thead>
<tbody>
<tr>
<th>13076</th>
<td>ESP</td>
<td>2015.0</td>
<td>13.539857</td>
<td>53.189062</td>
<td>24.573101</td>
<td>0.264490</td>
<td>2.723270</td>
<td>4.831547</td>
</tr>
<tr>
<th>13077</th>
<td>ESP</td>
<td>2016.0</td>
<td>13.759770</td>
<td>52.577247</td>
<td>24.695895</td>
<td>0.265555</td>
<td>2.815221</td>
<td>4.503758</td>
</tr>
<tr>
<th>13078</th>
<td>ESP</td>
<td>2017.0</td>
<td>13.933547</td>
<td>52.638714</td>
<td>24.529741</td>
<td>0.263119</td>
<td>2.803447</td>
<td>-3.486742</td>
</tr>
<tr>
<th>13079</th>
<td>ESP</td>
<td>2018.0</td>
<td>14.145419</td>
<td>52.408210</td>
<td>23.787368</td>
<td>0.254035</td>
<td>2.701283</td>
<td>4.193773</td>
</tr>
<tr>
<th>13080</th>
<td>ESP</td>
<td>2019.0</td>
<td>14.726331</td>
<td>52.458492</td>
<td>23.644962</td>
<td>0.250694</td>
<td>2.519801</td>
<td>-2.770201</td>
</tr>
<tr>
<th>13081</th>
<td>ESP</td>
<td>2020.0</td>
<td>14.767737</td>
<td>52.331679</td>
<td>23.299456</td>
<td>0.245767</td>
<td>2.784680</td>
<td>-1.979426</td>
</tr>
<tr>
<th>13082</th>
<td>ESP</td>
<td>2021.0</td>
<td>14.899014</td>
<td>52.484894</td>
<td>23.112438</td>
<td>0.243447</td>
<td>2.768249</td>
<td>7.044045</td>
</tr>
<tr>
<th>13083</th>
<td>ESP</td>
<td>2022.0</td>
<td>14.256450</td>
<td>53.357281</td>
<td>23.394513</td>
<td>0.244643</td>
<td>2.309576</td>
<td>-20.267380</td>
</tr>
<tr>
<th>13084</th>
<td>ESP</td>
<td>2023.0</td>
<td>15.115416</td>
<td>49.575327</td>
<td>23.007434</td>
<td>0.237792</td>
<td>2.499726</td>
<td>6.449810</td>
</tr>
<tr>
<th>13085</th>
<td>ESP</td>
<td>2024.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2.539037</td>
<td>8.260702</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=153de3b6">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="An%C3%A0lisi-de-annual_mean_historical_pr-(Precipitaci%C3%B3)">Anlisi de annual_mean_historical_pr (Precipitaci)<a class="anchor-link" href="#An%C3%A0lisi-de-annual_mean_historical_pr-(Precipitaci%C3%B3)"></a></h3>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=6be15a24">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[52]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Analitzar annual_mean_historical_pr (precipitaci)</span>
<span class="n">pr_df</span> <span class="o">=</span> <span class="n">analitzar_climate_df</span><span class="p">(</span>
    <span class="n">df</span><span class="o">=</span><span class="n">data_dict</span><span class="p">[</span><span class="s2">"climate_data"</span><span class="p">][</span><span class="s2">"annual_mean_historical_pr"</span><span class="p">],</span>
    <span class="n">df_name</span><span class="o">=</span><span class="s2">"annual_mean_historical_pr"</span><span class="p">,</span>
    <span class="n">cols_to_show_unique</span><span class="o">=</span><span class="p">[],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Anlisi del dataset: annual_mean_historical_pr

Dimensions: 246 files x 126 columnes

Columnes (126):
   1. code
   2. name
   3. 1901-07
   4. 1902-07
   5. 1903-07
   6. 1904-07
   7. 1905-07
   8. 1906-07
   9. 1907-07
  10. 1908-07
  11. 1909-07
  12. 1910-07
  13. 1911-07
  14. 1912-07
  15. 1913-07
  16. 1914-07
  17. 1915-07
  18. 1916-07
  19. 1917-07
  20. 1918-07
  21. 1919-07
  22. 1920-07
  23. 1921-07
  24. 1922-07
  25. 1923-07
  26. 1924-07
  27. 1925-07
  28. 1926-07
  29. 1927-07
  30. 1928-07
  31. 1929-07
  32. 1930-07
  33. 1931-07
  34. 1932-07
  35. 1933-07
  36. 1934-07
  37. 1935-07
  38. 1936-07
  39. 1937-07
  40. 1938-07
  41. 1939-07
  42. 1940-07
  43. 1941-07
  44. 1942-07
  45. 1943-07
  46. 1944-07
  47. 1945-07
  48. 1946-07
  49. 1947-07
  50. 1948-07
  51. 1949-07
  52. 1950-07
  53. 1951-07
  54. 1952-07
  55. 1953-07
  56. 1954-07
  57. 1955-07
  58. 1956-07
  59. 1957-07
  60. 1958-07
  61. 1959-07
  62. 1960-07
  63. 1961-07
  64. 1962-07
  65. 1963-07
  66. 1964-07
  67. 1965-07
  68. 1966-07
  69. 1967-07
  70. 1968-07
  71. 1969-07
  72. 1970-07
  73. 1971-07
  74. 1972-07
  75. 1973-07
  76. 1974-07
  77. 1975-07
  78. 1976-07
  79. 1977-07
  80. 1978-07
  81. 1979-07
  82. 1980-07
  83. 1981-07
  84. 1982-07
  85. 1983-07
  86. 1984-07
  87. 1985-07
  88. 1986-07
  89. 1987-07
  90. 1988-07
  91. 1989-07
  92. 1990-07
  93. 1991-07
  94. 1992-07
  95. 1993-07
  96. 1994-07
  97. 1995-07
  98. 1996-07
  99. 1997-07
  100. 1998-07
  101. 1999-07
  102. 2000-07
  103. 2001-07
  104. 2002-07
  105. 2003-07
  106. 2004-07
  107. 2005-07
  108. 2006-07
  109. 2007-07
  110. 2008-07
  111. 2009-07
  112. 2010-07
  113. 2011-07
  114. 2012-07
  115. 2013-07
  116. 2014-07
  117. 2015-07
  118. 2016-07
  119. 2017-07
  120. 2018-07
  121. 2019-07
  122. 2020-07
  123. 2021-07
  124. 2022-07
  125. 2023-07
  126. 2024-07

Primeres files de annual_mean_historical_pr:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>code</th>
<th>name</th>
<th>1901-07</th>
<th>1902-07</th>
<th>1903-07</th>
<th>1904-07</th>
<th>1905-07</th>
<th>1906-07</th>
<th>1907-07</th>
<th>1908-07</th>
<th>1909-07</th>
<th>1910-07</th>
<th>1911-07</th>
<th>1912-07</th>
<th>1913-07</th>
<th>1914-07</th>
<th>1915-07</th>
<th>1916-07</th>
<th>1917-07</th>
<th>1918-07</th>
<th>1919-07</th>
<th>1920-07</th>
<th>1921-07</th>
<th>1922-07</th>
<th>1923-07</th>
<th>1924-07</th>
<th>1925-07</th>
<th>1926-07</th>
<th>1927-07</th>
<th>1928-07</th>
<th>1929-07</th>
<th>1930-07</th>
<th>1931-07</th>
<th>1932-07</th>
<th>1933-07</th>
<th>1934-07</th>
<th>1935-07</th>
<th>1936-07</th>
<th>1937-07</th>
<th>1938-07</th>
<th>1939-07</th>
<th>1940-07</th>
<th>1941-07</th>
<th>1942-07</th>
<th>1943-07</th>
<th>1944-07</th>
<th>1945-07</th>
<th>1946-07</th>
<th>1947-07</th>
<th>1948-07</th>
<th>1949-07</th>
<th>1950-07</th>
<th>1951-07</th>
<th>1952-07</th>
<th>1953-07</th>
<th>1954-07</th>
<th>1955-07</th>
<th>1956-07</th>
<th>1957-07</th>
<th>1958-07</th>
<th>1959-07</th>
<th>1960-07</th>
<th>1961-07</th>
<th>1962-07</th>
<th>1963-07</th>
<th>1964-07</th>
<th>1965-07</th>
<th>1966-07</th>
<th>1967-07</th>
<th>1968-07</th>
<th>1969-07</th>
<th>1970-07</th>
<th>1971-07</th>
<th>1972-07</th>
<th>1973-07</th>
<th>1974-07</th>
<th>1975-07</th>
<th>1976-07</th>
<th>1977-07</th>
<th>1978-07</th>
<th>1979-07</th>
<th>1980-07</th>
<th>1981-07</th>
<th>1982-07</th>
<th>1983-07</th>
<th>1984-07</th>
<th>1985-07</th>
<th>1986-07</th>
<th>1987-07</th>
<th>1988-07</th>
<th>1989-07</th>
<th>1990-07</th>
<th>1991-07</th>
<th>1992-07</th>
<th>1993-07</th>
<th>1994-07</th>
<th>1995-07</th>
<th>1996-07</th>
<th>1997-07</th>
<th>1998-07</th>
<th>1999-07</th>
<th>2000-07</th>
<th>2001-07</th>
<th>2002-07</th>
<th>2003-07</th>
<th>2004-07</th>
<th>2005-07</th>
<th>2006-07</th>
<th>2007-07</th>
<th>2008-07</th>
<th>2009-07</th>
<th>2010-07</th>
<th>2011-07</th>
<th>2012-07</th>
<th>2013-07</th>
<th>2014-07</th>
<th>2015-07</th>
<th>2016-07</th>
<th>2017-07</th>
<th>2018-07</th>
<th>2019-07</th>
<th>2020-07</th>
<th>2021-07</th>
<th>2022-07</th>
<th>2023-07</th>
<th>2024-07</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ABW</td>
<td>Aruba (Neth.)</td>
<td>420.90</td>
<td>420.90</td>
<td>420.90</td>
<td>420.90</td>
<td>420.90</td>
<td>420.90</td>
<td>420.90</td>
<td>420.90</td>
<td>420.90</td>
<td>420.90</td>
<td>569.70</td>
<td>487.00</td>
<td>413.30</td>
<td>393.80</td>
<td>379.90</td>
<td>442.30</td>
<td>447.70</td>
<td>434.30</td>
<td>253.30</td>
<td>324.10</td>
<td>363.10</td>
<td>503.10</td>
<td>367.70</td>
<td>574.00</td>
<td>275.70</td>
<td>446.40</td>
<td>624.10</td>
<td>486.30</td>
<td>342.80</td>
<td>305.50</td>
<td>498.50</td>
<td>475.70</td>
<td>535.40</td>
<td>439.20</td>
<td>483.30</td>
<td>455.90</td>
<td>558.60</td>
<td>544.80</td>
<td>430.10</td>
<td>288.40</td>
<td>218.80</td>
<td>620.70</td>
<td>443.20</td>
<td>479.40</td>
<td>305.10</td>
<td>378.80</td>
<td>314.10</td>
<td>310.70</td>
<td>438.50</td>
<td>574.50</td>
<td>393.00</td>
<td>375.00</td>
<td>306.40</td>
<td>380.30</td>
<td>535.60</td>
<td>599.50</td>
<td>303.80</td>
<td>219.20</td>
<td>274.40</td>
<td>376.50</td>
<td>403.50</td>
<td>342.20</td>
<td>477.00</td>
<td>328.20</td>
<td>373.90</td>
<td>667.60</td>
<td>350.00</td>
<td>316.50</td>
<td>617.10</td>
<td>612.20</td>
<td>298.70</td>
<td>455.90</td>
<td>446.40</td>
<td>384.60</td>
<td>513.50</td>
<td>261.40</td>
<td>217.70</td>
<td>300.60</td>
<td>563.80</td>
<td>311.60</td>
<td>648.30</td>
<td>334.80</td>
<td>272.90</td>
<td>413.00</td>
<td>641.30</td>
<td>354.20</td>
<td>391.50</td>
<td>591.20</td>
<td>362.10</td>
<td>463.20</td>
<td>310.40</td>
<td>383.60</td>
<td>290.60</td>
<td>367.60</td>
<td>383.90</td>
<td>501.80</td>
<td>254.30</td>
<td>426.20</td>
<td>707.50</td>
<td>484.30</td>
<td>346.30</td>
<td>266.80</td>
<td>392.90</td>
<td>643.20</td>
<td>658.10</td>
<td>500.80</td>
<td>418.10</td>
<td>624.20</td>
<td>333.30</td>
<td>697.90</td>
<td>684.30</td>
<td>357.10</td>
<td>327.60</td>
<td>282.40</td>
<td>281.30</td>
<td>440.50</td>
<td>375.60</td>
<td>467.20</td>
<td>218.30</td>
<td>394.20</td>
<td>420.90</td>
<td>420.90</td>
<td>415.40</td>
<td>444.80</td>
</tr>
<tr>
<th>1</th>
<td>AFG</td>
<td>Afghanistan</td>
<td>289.67</td>
<td>269.70</td>
<td>331.11</td>
<td>315.35</td>
<td>285.52</td>
<td>305.15</td>
<td>314.33</td>
<td>332.24</td>
<td>301.74</td>
<td>316.70</td>
<td>313.92</td>
<td>310.50</td>
<td>296.92</td>
<td>360.02</td>
<td>281.05</td>
<td>292.44</td>
<td>197.97</td>
<td>307.63</td>
<td>324.47</td>
<td>313.30</td>
<td>304.11</td>
<td>315.73</td>
<td>338.86</td>
<td>381.61</td>
<td>258.26</td>
<td>321.97</td>
<td>264.55</td>
<td>287.12</td>
<td>289.35</td>
<td>307.49</td>
<td>383.95</td>
<td>303.98</td>
<td>339.24</td>
<td>342.76</td>
<td>328.14</td>
<td>303.70</td>
<td>318.28</td>
<td>319.73</td>
<td>355.71</td>
<td>297.51</td>
<td>319.02</td>
<td>358.89</td>
<td>351.29</td>
<td>314.75</td>
<td>345.01</td>
<td>252.41</td>
<td>268.91</td>
<td>301.61</td>
<td>297.93</td>
<td>295.53</td>
<td>330.10</td>
<td>326.03</td>
<td>383.89</td>
<td>343.19</td>
<td>295.31</td>
<td>363.04</td>
<td>443.93</td>
<td>326.60</td>
<td>368.82</td>
<td>363.89</td>
<td>345.95</td>
<td>277.44</td>
<td>351.40</td>
<td>335.61</td>
<td>377.70</td>
<td>295.40</td>
<td>380.33</td>
<td>357.10</td>
<td>372.29</td>
<td>242.56</td>
<td>201.95</td>
<td>415.69</td>
<td>285.06</td>
<td>313.66</td>
<td>337.12</td>
<td>375.29</td>
<td>310.99</td>
<td>306.62</td>
<td>351.83</td>
<td>357.34</td>
<td>365.37</td>
<td>429.05</td>
<td>319.31</td>
<td>276.26</td>
<td>248.02</td>
<td>329.15</td>
<td>316.73</td>
<td>334.57</td>
<td>324.80</td>
<td>361.26</td>
<td>429.73</td>
<td>403.99</td>
<td>329.92</td>
<td>337.75</td>
<td>313.38</td>
<td>330.82</td>
<td>333.33</td>
<td>372.40</td>
<td>315.96</td>
<td>240.34</td>
<td>233.14</td>
<td>311.86</td>
<td>343.45</td>
<td>312.42</td>
<td>374.20</td>
<td>349.02</td>
<td>321.83</td>
<td>290.55</td>
<td>390.40</td>
<td>297.47</td>
<td>321.52</td>
<td>374.70</td>
<td>368.17</td>
<td>305.86</td>
<td>407.70</td>
<td>368.40</td>
<td>307.58</td>
<td>274.83</td>
<td>396.28</td>
<td>395.26</td>
<td>232.26</td>
<td>300.98</td>
<td>292.42</td>
<td>355.05</td>
</tr>
<tr>
<th>2</th>
<td>AGO</td>
<td>Angola</td>
<td>1021.18</td>
<td>1038.05</td>
<td>1060.13</td>
<td>980.71</td>
<td>978.53</td>
<td>1067.39</td>
<td>1019.09</td>
<td>1024.27</td>
<td>1155.25</td>
<td>1053.63</td>
<td>978.89</td>
<td>1143.70</td>
<td>984.00</td>
<td>889.28</td>
<td>928.09</td>
<td>1102.03</td>
<td>982.84</td>
<td>1011.10</td>
<td>1012.73</td>
<td>1031.54</td>
<td>1062.74</td>
<td>993.81</td>
<td>1209.13</td>
<td>1092.34</td>
<td>1072.55</td>
<td>1088.60</td>
<td>1014.75</td>
<td>957.96</td>
<td>1012.23</td>
<td>882.28</td>
<td>1043.35</td>
<td>923.49</td>
<td>1074.49</td>
<td>1154.88</td>
<td>1054.82</td>
<td>1020.31</td>
<td>1158.03</td>
<td>1047.37</td>
<td>1020.68</td>
<td>1003.97</td>
<td>932.48</td>
<td>980.97</td>
<td>983.41</td>
<td>1182.40</td>
<td>1109.45</td>
<td>976.63</td>
<td>1102.93</td>
<td>992.31</td>
<td>991.60</td>
<td>1171.69</td>
<td>1221.16</td>
<td>1053.58</td>
<td>1001.30</td>
<td>1119.38</td>
<td>1086.43</td>
<td>1041.11</td>
<td>1167.36</td>
<td>911.78</td>
<td>1087.92</td>
<td>1173.81</td>
<td>1236.29</td>
<td>1135.08</td>
<td>1117.91</td>
<td>959.81</td>
<td>996.79</td>
<td>1133.91</td>
<td>1199.32</td>
<td>1126.73</td>
<td>1220.30</td>
<td>965.98</td>
<td>999.10</td>
<td>984.89</td>
<td>1064.23</td>
<td>1094.06</td>
<td>1041.18</td>
<td>1105.11</td>
<td>1111.27</td>
<td>1045.71</td>
<td>1123.22</td>
<td>941.74</td>
<td>886.16</td>
<td>975.57</td>
<td>947.99</td>
<td>964.94</td>
<td>987.32</td>
<td>1134.70</td>
<td>995.33</td>
<td>1091.41</td>
<td>971.60</td>
<td>1035.04</td>
<td>1078.69</td>
<td>930.54</td>
<td>1034.39</td>
<td>984.49</td>
<td>955.04</td>
<td>989.76</td>
<td>1079.46</td>
<td>1029.85</td>
<td>1060.74</td>
<td>1053.39</td>
<td>1043.69</td>
<td>1076.96</td>
<td>1022.52</td>
<td>1059.90</td>
<td>1011.95</td>
<td>1083.29</td>
<td>1045.72</td>
<td>1061.30</td>
<td>1062.04</td>
<td>1039.62</td>
<td>1087.00</td>
<td>1071.80</td>
<td>1004.39</td>
<td>1052.57</td>
<td>993.92</td>
<td>1013.76</td>
<td>1070.29</td>
<td>1056.66</td>
<td>1063.28</td>
<td>1066.74</td>
<td>1058.24</td>
<td>1057.69</td>
<td>1053.24</td>
<td>1027.80</td>
</tr>
<tr>
<th>3</th>
<td>AIA</td>
<td>Anguilla (U.K.)</td>
<td>1227.30</td>
<td>1096.20</td>
<td>1028.90</td>
<td>1072.00</td>
<td>1097.20</td>
<td>1018.00</td>
<td>970.40</td>
<td>1033.70</td>
<td>1120.90</td>
<td>1114.50</td>
<td>1102.60</td>
<td>944.60</td>
<td>1003.60</td>
<td>1026.60</td>
<td>1065.90</td>
<td>1132.00</td>
<td>947.40</td>
<td>956.30</td>
<td>1044.70</td>
<td>976.10</td>
<td>1014.60</td>
<td>1010.10</td>
<td>890.50</td>
<td>1053.60</td>
<td>912.10</td>
<td>957.80</td>
<td>1094.80</td>
<td>1207.50</td>
<td>962.40</td>
<td>922.90</td>
<td>1327.30</td>
<td>1178.80</td>
<td>1148.50</td>
<td>1011.60</td>
<td>994.20</td>
<td>1181.30</td>
<td>895.10</td>
<td>1092.40</td>
<td>962.10</td>
<td>1055.40</td>
<td>1014.70</td>
<td>1139.50</td>
<td>1050.30</td>
<td>1072.70</td>
<td>898.50</td>
<td>940.70</td>
<td>888.50</td>
<td>1083.20</td>
<td>1090.40</td>
<td>1102.50</td>
<td>990.30</td>
<td>1219.50</td>
<td>978.50</td>
<td>1122.70</td>
<td>1034.20</td>
<td>1087.60</td>
<td>848.80</td>
<td>1221.00</td>
<td>937.30</td>
<td>1273.80</td>
<td>1038.90</td>
<td>1021.10</td>
<td>980.40</td>
<td>780.50</td>
<td>1081.70</td>
<td>945.70</td>
<td>684.00</td>
<td>839.60</td>
<td>1258.20</td>
<td>1208.70</td>
<td>952.20</td>
<td>827.80</td>
<td>806.10</td>
<td>975.10</td>
<td>1061.30</td>
<td>809.80</td>
<td>1012.60</td>
<td>877.50</td>
<td>1530.40</td>
<td>762.70</td>
<td>1165.40</td>
<td>954.80</td>
<td>991.10</td>
<td>1118.80</td>
<td>976.10</td>
<td>1036.50</td>
<td>1271.40</td>
<td>1090.80</td>
<td>1104.70</td>
<td>963.20</td>
<td>825.80</td>
<td>1181.60</td>
<td>846.40</td>
<td>762.10</td>
<td>905.40</td>
<td>953.50</td>
<td>898.20</td>
<td>1312.50</td>
<td>1131.20</td>
<td>742.00</td>
<td>1042.50</td>
<td>998.60</td>
<td>1169.20</td>
<td>1224.10</td>
<td>1321.00</td>
<td>1377.30</td>
<td>1034.70</td>
<td>1305.00</td>
<td>956.90</td>
<td>1305.00</td>
<td>1137.20</td>
<td>848.50</td>
<td>1172.00</td>
<td>1163.60</td>
<td>629.30</td>
<td>1088.40</td>
<td>1154.20</td>
<td>949.40</td>
<td>990.00</td>
<td>1040.50</td>
<td>891.50</td>
<td>920.00</td>
<td>1055.40</td>
<td>1391.20</td>
</tr>
<tr>
<th>4</th>
<td>ALA</td>
<td>ALA</td>
<td>365.26</td>
<td>475.98</td>
<td>569.30</td>
<td>482.47</td>
<td>522.82</td>
<td>448.91</td>
<td>493.67</td>
<td>443.21</td>
<td>497.91</td>
<td>566.17</td>
<td>470.40</td>
<td>612.85</td>
<td>453.41</td>
<td>365.59</td>
<td>536.12</td>
<td>573.41</td>
<td>431.40</td>
<td>504.28</td>
<td>496.70</td>
<td>416.81</td>
<td>442.13</td>
<td>484.47</td>
<td>565.09</td>
<td>525.90</td>
<td>503.08</td>
<td>465.78</td>
<td>609.54</td>
<td>553.19</td>
<td>524.95</td>
<td>559.38</td>
<td>485.90</td>
<td>534.23</td>
<td>397.13</td>
<td>582.40</td>
<td>611.84</td>
<td>605.70</td>
<td>580.94</td>
<td>527.51</td>
<td>448.27</td>
<td>456.38</td>
<td>409.35</td>
<td>426.03</td>
<td>577.72</td>
<td>657.67</td>
<td>566.27</td>
<td>500.56</td>
<td>359.77</td>
<td>500.22</td>
<td>521.70</td>
<td>556.87</td>
<td>416.68</td>
<td>539.62</td>
<td>428.44</td>
<td>613.25</td>
<td>430.70</td>
<td>430.19</td>
<td>578.54</td>
<td>509.29</td>
<td>412.50</td>
<td>665.10</td>
<td>568.84</td>
<td>526.15</td>
<td>453.64</td>
<td>394.10</td>
<td>514.08</td>
<td>532.43</td>
<td>583.72</td>
<td>523.58</td>
<td>461.57</td>
<td>457.41</td>
<td>424.53</td>
<td>432.40</td>
<td>455.86</td>
<td>653.00</td>
<td>406.35</td>
<td>398.87</td>
<td>581.80</td>
<td>462.90</td>
<td>538.80</td>
<td>608.99</td>
<td>633.61</td>
<td>461.85</td>
<td>532.34</td>
<td>607.43</td>
<td>504.63</td>
<td>606.18</td>
<td>490.42</td>
<td>540.85</td>
<td>439.91</td>
<td>602.09</td>
<td>524.93</td>
<td>536.24</td>
<td>486.35</td>
<td>512.75</td>
<td>529.14</td>
<td>441.35</td>
<td>534.70</td>
<td>570.25</td>
<td>533.38</td>
<td>571.19</td>
<td>536.73</td>
<td>423.97</td>
<td>463.72</td>
<td>497.70</td>
<td>511.88</td>
<td>511.76</td>
<td>531.58</td>
<td>618.52</td>
<td>499.07</td>
<td>507.85</td>
<td>501.28</td>
<td>666.67</td>
<td>448.09</td>
<td>505.73</td>
<td>515.64</td>
<td>479.44</td>
<td>574.75</td>
<td>398.05</td>
<td>567.85</td>
<td>559.32</td>
<td>511.74</td>
<td>474.19</td>
<td>619.12</td>
<td>540.49</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=1d4f4c10">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[53]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Crear el dataframe a partir del diccionari</span>
<span class="n">pr_raw_df</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="s2">"climate_data"</span><span class="p">][</span><span class="s2">"annual_mean_historical_pr"</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Reanomenar columnes 'name' a 'Country' i 'code' a 'ISO3'</span>
<span class="n">pr_raw_df</span> <span class="o">=</span> <span class="n">pr_raw_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">'name'</span><span class="p">:</span> <span class="s1">'Country'</span><span class="p">,</span> <span class="s1">'code'</span><span class="p">:</span> <span class="s1">'ISO3'</span><span class="p">})</span>

<span class="c1"># Identificar les columnes d'anys (format 'YYYY-07')</span>
<span class="n">any_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">pr_raw_df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="s1">'-07'</span> <span class="ow">in</span> <span class="n">col</span><span class="p">]</span>

<span class="c1"># Fer el melt per transformar els anys a files</span>
<span class="n">pr_long_df</span> <span class="o">=</span> <span class="n">pr_raw_df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span>
    <span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">'Country'</span><span class="p">,</span> <span class="s1">'ISO3'</span><span class="p">],</span>
    <span class="n">value_vars</span><span class="o">=</span><span class="n">any_cols</span><span class="p">,</span>
    <span class="n">var_name</span><span class="o">=</span><span class="s1">'Year'</span><span class="p">,</span>
    <span class="n">value_name</span><span class="o">=</span><span class="s1">'prec_mm_per_year'</span>
<span class="p">)</span>

<span class="c1"># Netejar la columna de l'any, traient el sufix '-07' i convertint a int</span>
<span class="n">pr_long_df</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pr_long_df</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'-07'</span><span class="p">,</span> <span class="s1">''</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="c1"># Reordenar les columnes per claredat</span>
<span class="n">pr_long_df</span> <span class="o">=</span> <span class="n">pr_long_df</span><span class="p">[[</span><span class="s1">'ISO3'</span><span class="p">,</span> <span class="s1">'Year'</span><span class="p">,</span> <span class="s1">'prec_mm_per_year'</span><span class="p">]]</span>

<span class="c1"># Mostrar algunes files com a exemple</span>
<span class="n">display</span><span class="p">(</span><span class="n">pr_long_df</span><span class="p">[(</span><span class="n">pr_long_df</span><span class="p">[</span><span class="s1">'ISO3'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'ESP'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pr_long_df</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">2015</span><span class="p">)]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>ISO3</th>
<th>Year</th>
<th>prec_mm_per_year</th>
</tr>
</thead>
<tbody>
<tr>
<th>28111</th>
<td>ESP</td>
<td>2015</td>
<td>489.87</td>
</tr>
<tr>
<th>28357</th>
<td>ESP</td>
<td>2016</td>
<td>647.87</td>
</tr>
<tr>
<th>28603</th>
<td>ESP</td>
<td>2017</td>
<td>465.42</td>
</tr>
<tr>
<th>28849</th>
<td>ESP</td>
<td>2018</td>
<td>791.86</td>
</tr>
<tr>
<th>29095</th>
<td>ESP</td>
<td>2019</td>
<td>557.29</td>
</tr>
<tr>
<th>29341</th>
<td>ESP</td>
<td>2020</td>
<td>635.25</td>
</tr>
<tr>
<th>29587</th>
<td>ESP</td>
<td>2021</td>
<td>613.49</td>
</tr>
<tr>
<th>29833</th>
<td>ESP</td>
<td>2022</td>
<td>556.80</td>
</tr>
<tr>
<th>30079</th>
<td>ESP</td>
<td>2023</td>
<td>526.62</td>
</tr>
<tr>
<th>30325</th>
<td>ESP</td>
<td>2024</td>
<td>663.34</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=c755ba29">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="An%C3%A0lisi-de-annual_mean_historical_tas-(Temperatura)">Anlisi de annual_mean_historical_tas (Temperatura)<a class="anchor-link" href="#An%C3%A0lisi-de-annual_mean_historical_tas-(Temperatura)"></a></h3>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=55ad4c28">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[54]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Analitzar annual_mean_historical_tas (temperatura)</span>
<span class="n">tas_df</span> <span class="o">=</span> <span class="n">analitzar_climate_df</span><span class="p">(</span>
    <span class="n">df</span><span class="o">=</span><span class="n">data_dict</span><span class="p">[</span><span class="s2">"climate_data"</span><span class="p">][</span><span class="s2">"annual_mean_historical_tas"</span><span class="p">],</span>
    <span class="n">df_name</span><span class="o">=</span><span class="s2">"annual_mean_historical_tas"</span><span class="p">,</span>
    <span class="n">cols_to_show_unique</span><span class="o">=</span><span class="p">[],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Anlisi del dataset: annual_mean_historical_tas

Dimensions: 246 files x 126 columnes

Columnes (126):
   1. code
   2. name
   3. 1901-07
   4. 1902-07
   5. 1903-07
   6. 1904-07
   7. 1905-07
   8. 1906-07
   9. 1907-07
  10. 1908-07
  11. 1909-07
  12. 1910-07
  13. 1911-07
  14. 1912-07
  15. 1913-07
  16. 1914-07
  17. 1915-07
  18. 1916-07
  19. 1917-07
  20. 1918-07
  21. 1919-07
  22. 1920-07
  23. 1921-07
  24. 1922-07
  25. 1923-07
  26. 1924-07
  27. 1925-07
  28. 1926-07
  29. 1927-07
  30. 1928-07
  31. 1929-07
  32. 1930-07
  33. 1931-07
  34. 1932-07
  35. 1933-07
  36. 1934-07
  37. 1935-07
  38. 1936-07
  39. 1937-07
  40. 1938-07
  41. 1939-07
  42. 1940-07
  43. 1941-07
  44. 1942-07
  45. 1943-07
  46. 1944-07
  47. 1945-07
  48. 1946-07
  49. 1947-07
  50. 1948-07
  51. 1949-07
  52. 1950-07
  53. 1951-07
  54. 1952-07
  55. 1953-07
  56. 1954-07
  57. 1955-07
  58. 1956-07
  59. 1957-07
  60. 1958-07
  61. 1959-07
  62. 1960-07
  63. 1961-07
  64. 1962-07
  65. 1963-07
  66. 1964-07
  67. 1965-07
  68. 1966-07
  69. 1967-07
  70. 1968-07
  71. 1969-07
  72. 1970-07
  73. 1971-07
  74. 1972-07
  75. 1973-07
  76. 1974-07
  77. 1975-07
  78. 1976-07
  79. 1977-07
  80. 1978-07
  81. 1979-07
  82. 1980-07
  83. 1981-07
  84. 1982-07
  85. 1983-07
  86. 1984-07
  87. 1985-07
  88. 1986-07
  89. 1987-07
  90. 1988-07
  91. 1989-07
  92. 1990-07
  93. 1991-07
  94. 1992-07
  95. 1993-07
  96. 1994-07
  97. 1995-07
  98. 1996-07
  99. 1997-07
  100. 1998-07
  101. 1999-07
  102. 2000-07
  103. 2001-07
  104. 2002-07
  105. 2003-07
  106. 2004-07
  107. 2005-07
  108. 2006-07
  109. 2007-07
  110. 2008-07
  111. 2009-07
  112. 2010-07
  113. 2011-07
  114. 2012-07
  115. 2013-07
  116. 2014-07
  117. 2015-07
  118. 2016-07
  119. 2017-07
  120. 2018-07
  121. 2019-07
  122. 2020-07
  123. 2021-07
  124. 2022-07
  125. 2023-07
  126. 2024-07

Primeres files de annual_mean_historical_tas:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>code</th>
<th>name</th>
<th>1901-07</th>
<th>1902-07</th>
<th>1903-07</th>
<th>1904-07</th>
<th>1905-07</th>
<th>1906-07</th>
<th>1907-07</th>
<th>1908-07</th>
<th>1909-07</th>
<th>1910-07</th>
<th>1911-07</th>
<th>1912-07</th>
<th>1913-07</th>
<th>1914-07</th>
<th>1915-07</th>
<th>1916-07</th>
<th>1917-07</th>
<th>1918-07</th>
<th>1919-07</th>
<th>1920-07</th>
<th>1921-07</th>
<th>1922-07</th>
<th>1923-07</th>
<th>1924-07</th>
<th>1925-07</th>
<th>1926-07</th>
<th>1927-07</th>
<th>1928-07</th>
<th>1929-07</th>
<th>1930-07</th>
<th>1931-07</th>
<th>1932-07</th>
<th>1933-07</th>
<th>1934-07</th>
<th>1935-07</th>
<th>1936-07</th>
<th>1937-07</th>
<th>1938-07</th>
<th>1939-07</th>
<th>1940-07</th>
<th>1941-07</th>
<th>1942-07</th>
<th>1943-07</th>
<th>1944-07</th>
<th>1945-07</th>
<th>1946-07</th>
<th>1947-07</th>
<th>1948-07</th>
<th>1949-07</th>
<th>1950-07</th>
<th>1951-07</th>
<th>1952-07</th>
<th>1953-07</th>
<th>1954-07</th>
<th>1955-07</th>
<th>1956-07</th>
<th>1957-07</th>
<th>1958-07</th>
<th>1959-07</th>
<th>1960-07</th>
<th>1961-07</th>
<th>1962-07</th>
<th>1963-07</th>
<th>1964-07</th>
<th>1965-07</th>
<th>1966-07</th>
<th>1967-07</th>
<th>1968-07</th>
<th>1969-07</th>
<th>1970-07</th>
<th>1971-07</th>
<th>1972-07</th>
<th>1973-07</th>
<th>1974-07</th>
<th>1975-07</th>
<th>1976-07</th>
<th>1977-07</th>
<th>1978-07</th>
<th>1979-07</th>
<th>1980-07</th>
<th>1981-07</th>
<th>1982-07</th>
<th>1983-07</th>
<th>1984-07</th>
<th>1985-07</th>
<th>1986-07</th>
<th>1987-07</th>
<th>1988-07</th>
<th>1989-07</th>
<th>1990-07</th>
<th>1991-07</th>
<th>1992-07</th>
<th>1993-07</th>
<th>1994-07</th>
<th>1995-07</th>
<th>1996-07</th>
<th>1997-07</th>
<th>1998-07</th>
<th>1999-07</th>
<th>2000-07</th>
<th>2001-07</th>
<th>2002-07</th>
<th>2003-07</th>
<th>2004-07</th>
<th>2005-07</th>
<th>2006-07</th>
<th>2007-07</th>
<th>2008-07</th>
<th>2009-07</th>
<th>2010-07</th>
<th>2011-07</th>
<th>2012-07</th>
<th>2013-07</th>
<th>2014-07</th>
<th>2015-07</th>
<th>2016-07</th>
<th>2017-07</th>
<th>2018-07</th>
<th>2019-07</th>
<th>2020-07</th>
<th>2021-07</th>
<th>2022-07</th>
<th>2023-07</th>
<th>2024-07</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ABW</td>
<td>Aruba (Neth.)</td>
<td>28.22</td>
<td>27.79</td>
<td>27.89</td>
<td>27.62</td>
<td>27.68</td>
<td>27.58</td>
<td>27.56</td>
<td>27.46</td>
<td>27.52</td>
<td>27.52</td>
<td>27.59</td>
<td>27.65</td>
<td>27.48</td>
<td>27.57</td>
<td>28.35</td>
<td>28.10</td>
<td>27.80</td>
<td>27.82</td>
<td>27.63</td>
<td>27.50</td>
<td>27.65</td>
<td>27.52</td>
<td>27.94</td>
<td>28.10</td>
<td>27.82</td>
<td>28.35</td>
<td>27.84</td>
<td>28.00</td>
<td>27.82</td>
<td>27.98</td>
<td>28.31</td>
<td>28.51</td>
<td>28.37</td>
<td>28.49</td>
<td>28.18</td>
<td>28.41</td>
<td>28.34</td>
<td>28.04</td>
<td>28.29</td>
<td>28.84</td>
<td>29.02</td>
<td>28.74</td>
<td>28.20</td>
<td>28.12</td>
<td>27.94</td>
<td>28.07</td>
<td>28.65</td>
<td>28.28</td>
<td>28.03</td>
<td>27.57</td>
<td>28.24</td>
<td>28.50</td>
<td>28.38</td>
<td>27.88</td>
<td>27.81</td>
<td>27.77</td>
<td>28.30</td>
<td>28.97</td>
<td>28.48</td>
<td>28.67</td>
<td>28.37</td>
<td>28.33</td>
<td>28.46</td>
<td>28.35</td>
<td>28.26</td>
<td>28.51</td>
<td>28.12</td>
<td>28.28</td>
<td>28.83</td>
<td>28.47</td>
<td>28.03</td>
<td>28.62</td>
<td>28.71</td>
<td>28.09</td>
<td>28.11</td>
<td>28.05</td>
<td>28.66</td>
<td>28.76</td>
<td>28.65</td>
<td>29.17</td>
<td>28.79</td>
<td>28.66</td>
<td>29.16</td>
<td>28.38</td>
<td>28.25</td>
<td>28.31</td>
<td>29.00</td>
<td>28.47</td>
<td>28.15</td>
<td>28.07</td>
<td>28.66</td>
<td>28.94</td>
<td>28.95</td>
<td>29.02</td>
<td>29.23</td>
<td>28.89</td>
<td>29.19</td>
<td>29.54</td>
<td>28.85</td>
<td>28.70</td>
<td>29.11</td>
<td>29.10</td>
<td>29.26</td>
<td>28.89</td>
<td>28.95</td>
<td>28.89</td>
<td>28.90</td>
<td>28.59</td>
<td>29.01</td>
<td>29.22</td>
<td>28.66</td>
<td>29.15</td>
<td>29.39</td>
<td>29.46</td>
<td>29.67</td>
<td>29.68</td>
<td>29.27</td>
<td>28.97</td>
<td>29.37</td>
<td>29.41</td>
<td>29.06</td>
<td>28.88</td>
<td>29.45</td>
<td>29.63</td>
</tr>
<tr>
<th>1</th>
<td>AFG</td>
<td>Afghanistan</td>
<td>12.78</td>
<td>12.98</td>
<td>11.81</td>
<td>12.13</td>
<td>12.02</td>
<td>12.50</td>
<td>11.89</td>
<td>12.21</td>
<td>12.71</td>
<td>12.22</td>
<td>12.02</td>
<td>12.50</td>
<td>12.47</td>
<td>13.05</td>
<td>13.63</td>
<td>12.11</td>
<td>12.79</td>
<td>12.17</td>
<td>12.18</td>
<td>11.37</td>
<td>12.19</td>
<td>12.81</td>
<td>11.87</td>
<td>12.06</td>
<td>12.72</td>
<td>12.46</td>
<td>12.44</td>
<td>11.85</td>
<td>11.66</td>
<td>11.57</td>
<td>11.78</td>
<td>11.90</td>
<td>12.14</td>
<td>11.57</td>
<td>11.85</td>
<td>12.39</td>
<td>11.77</td>
<td>12.53</td>
<td>12.64</td>
<td>13.17</td>
<td>13.72</td>
<td>12.78</td>
<td>12.06</td>
<td>12.83</td>
<td>12.10</td>
<td>12.71</td>
<td>13.28</td>
<td>12.60</td>
<td>11.75</td>
<td>11.41</td>
<td>12.25</td>
<td>12.39</td>
<td>12.74</td>
<td>12.05</td>
<td>12.91</td>
<td>12.36</td>
<td>11.48</td>
<td>13.00</td>
<td>12.38</td>
<td>12.23</td>
<td>12.65</td>
<td>12.33</td>
<td>13.21</td>
<td>11.63</td>
<td>12.59</td>
<td>12.86</td>
<td>12.29</td>
<td>12.31</td>
<td>12.11</td>
<td>13.10</td>
<td>13.06</td>
<td>11.17</td>
<td>12.68</td>
<td>11.88</td>
<td>12.18</td>
<td>12.17</td>
<td>13.12</td>
<td>12.78</td>
<td>12.74</td>
<td>13.05</td>
<td>13.13</td>
<td>12.09</td>
<td>12.95</td>
<td>12.39</td>
<td>12.96</td>
<td>12.48</td>
<td>13.12</td>
<td>13.57</td>
<td>12.43</td>
<td>13.25</td>
<td>12.70</td>
<td>12.42</td>
<td>12.71</td>
<td>12.95</td>
<td>13.10</td>
<td>12.63</td>
<td>12.95</td>
<td>13.33</td>
<td>13.80</td>
<td>13.59</td>
<td>13.93</td>
<td>13.78</td>
<td>13.27</td>
<td>13.92</td>
<td>13.34</td>
<td>13.81</td>
<td>13.50</td>
<td>13.46</td>
<td>13.72</td>
<td>14.09</td>
<td>13.50</td>
<td>13.06</td>
<td>13.92</td>
<td>13.17</td>
<td>13.75</td>
<td>14.27</td>
<td>13.86</td>
<td>14.13</td>
<td>13.81</td>
<td>13.15</td>
<td>14.31</td>
<td>14.46</td>
<td>14.61</td>
<td>14.24</td>
</tr>
<tr>
<th>2</th>
<td>AGO</td>
<td>Angola</td>
<td>21.32</td>
<td>21.36</td>
<td>21.37</td>
<td>21.28</td>
<td>21.32</td>
<td>21.20</td>
<td>21.22</td>
<td>21.29</td>
<td>21.31</td>
<td>21.35</td>
<td>21.41</td>
<td>21.36</td>
<td>21.37</td>
<td>21.29</td>
<td>21.30</td>
<td>21.28</td>
<td>21.33</td>
<td>21.17</td>
<td>21.22</td>
<td>21.32</td>
<td>21.32</td>
<td>21.42</td>
<td>21.31</td>
<td>21.38</td>
<td>21.22</td>
<td>21.28</td>
<td>21.28</td>
<td>21.47</td>
<td>21.32</td>
<td>21.31</td>
<td>21.47</td>
<td>21.26</td>
<td>21.43</td>
<td>21.52</td>
<td>21.36</td>
<td>21.24</td>
<td>21.32</td>
<td>21.37</td>
<td>21.42</td>
<td>21.64</td>
<td>21.80</td>
<td>21.81</td>
<td>21.54</td>
<td>21.73</td>
<td>21.50</td>
<td>21.38</td>
<td>21.53</td>
<td>21.25</td>
<td>21.83</td>
<td>21.50</td>
<td>21.40</td>
<td>21.60</td>
<td>21.28</td>
<td>21.22</td>
<td>21.25</td>
<td>21.17</td>
<td>21.53</td>
<td>21.36</td>
<td>21.47</td>
<td>21.48</td>
<td>21.19</td>
<td>21.20</td>
<td>21.23</td>
<td>21.20</td>
<td>21.25</td>
<td>21.45</td>
<td>21.21</td>
<td>21.29</td>
<td>21.47</td>
<td>21.51</td>
<td>21.34</td>
<td>21.33</td>
<td>21.57</td>
<td>21.13</td>
<td>21.30</td>
<td>21.06</td>
<td>21.52</td>
<td>21.31</td>
<td>21.57</td>
<td>21.50</td>
<td>21.41</td>
<td>21.44</td>
<td>21.78</td>
<td>21.70</td>
<td>21.63</td>
<td>21.49</td>
<td>21.97</td>
<td>21.72</td>
<td>21.55</td>
<td>21.73</td>
<td>21.55</td>
<td>21.69</td>
<td>21.58</td>
<td>21.65</td>
<td>21.93</td>
<td>21.71</td>
<td>21.84</td>
<td>22.09</td>
<td>21.59</td>
<td>21.67</td>
<td>21.84</td>
<td>21.95</td>
<td>22.01</td>
<td>21.78</td>
<td>22.14</td>
<td>21.58</td>
<td>21.56</td>
<td>21.53</td>
<td>21.69</td>
<td>21.87</td>
<td>21.49</td>
<td>21.56</td>
<td>21.56</td>
<td>21.56</td>
<td>21.70</td>
<td>21.94</td>
<td>21.82</td>
<td>21.66</td>
<td>21.81</td>
<td>21.73</td>
<td>21.73</td>
<td>21.62</td>
<td>21.56</td>
<td>21.71</td>
</tr>
<tr>
<th>3</th>
<td>AIA</td>
<td>Anguilla (U.K.)</td>
<td>27.18</td>
<td>26.77</td>
<td>26.80</td>
<td>26.33</td>
<td>26.69</td>
<td>26.44</td>
<td>26.10</td>
<td>26.24</td>
<td>26.19</td>
<td>26.23</td>
<td>26.15</td>
<td>26.49</td>
<td>25.94</td>
<td>26.30</td>
<td>26.94</td>
<td>26.51</td>
<td>26.06</td>
<td>26.24</td>
<td>26.42</td>
<td>26.16</td>
<td>26.02</td>
<td>25.97</td>
<td>26.63</td>
<td>27.01</td>
<td>26.38</td>
<td>27.03</td>
<td>26.80</td>
<td>26.72</td>
<td>26.27</td>
<td>26.53</td>
<td>27.20</td>
<td>27.20</td>
<td>26.89</td>
<td>26.65</td>
<td>26.55</td>
<td>26.83</td>
<td>27.00</td>
<td>26.60</td>
<td>26.80</td>
<td>27.33</td>
<td>27.36</td>
<td>27.45</td>
<td>26.88</td>
<td>27.09</td>
<td>26.62</td>
<td>26.78</td>
<td>26.99</td>
<td>27.02</td>
<td>26.71</td>
<td>26.58</td>
<td>26.68</td>
<td>26.83</td>
<td>26.74</td>
<td>26.49</td>
<td>26.47</td>
<td>26.30</td>
<td>26.72</td>
<td>27.26</td>
<td>26.93</td>
<td>27.01</td>
<td>26.79</td>
<td>26.83</td>
<td>26.98</td>
<td>26.90</td>
<td>26.82</td>
<td>26.99</td>
<td>26.70</td>
<td>26.89</td>
<td>27.36</td>
<td>27.07</td>
<td>26.65</td>
<td>26.86</td>
<td>26.94</td>
<td>26.71</td>
<td>26.68</td>
<td>26.61</td>
<td>27.13</td>
<td>27.06</td>
<td>27.12</td>
<td>27.52</td>
<td>27.46</td>
<td>27.16</td>
<td>27.74</td>
<td>27.24</td>
<td>27.32</td>
<td>27.43</td>
<td>28.07</td>
<td>27.68</td>
<td>27.35</td>
<td>27.67</td>
<td>27.62</td>
<td>27.64</td>
<td>27.80</td>
<td>27.66</td>
<td>27.86</td>
<td>27.67</td>
<td>27.99</td>
<td>28.35</td>
<td>27.80</td>
<td>27.77</td>
<td>27.96</td>
<td>28.17</td>
<td>28.12</td>
<td>27.77</td>
<td>28.08</td>
<td>27.84</td>
<td>27.83</td>
<td>27.44</td>
<td>27.80</td>
<td>28.17</td>
<td>27.76</td>
<td>27.84</td>
<td>27.97</td>
<td>27.99</td>
<td>28.23</td>
<td>28.16</td>
<td>27.96</td>
<td>27.69</td>
<td>28.08</td>
<td>28.10</td>
<td>27.97</td>
<td>27.82</td>
<td>28.29</td>
<td>28.72</td>
</tr>
<tr>
<th>4</th>
<td>ALA</td>
<td>ALA</td>
<td>5.39</td>
<td>3.43</td>
<td>5.29</td>
<td>4.72</td>
<td>5.17</td>
<td>5.70</td>
<td>4.55</td>
<td>4.88</td>
<td>4.33</td>
<td>5.93</td>
<td>5.98</td>
<td>4.86</td>
<td>5.98</td>
<td>6.29</td>
<td>3.79</td>
<td>4.79</td>
<td>4.43</td>
<td>5.13</td>
<td>4.50</td>
<td>5.77</td>
<td>5.87</td>
<td>4.28</td>
<td>4.39</td>
<td>4.77</td>
<td>5.59</td>
<td>4.97</td>
<td>4.88</td>
<td>4.55</td>
<td>4.48</td>
<td>6.39</td>
<td>4.18</td>
<td>5.53</td>
<td>5.28</td>
<td>6.96</td>
<td>5.75</td>
<td>5.78</td>
<td>5.95</td>
<td>6.66</td>
<td>5.97</td>
<td>3.53</td>
<td>3.53</td>
<td>3.07</td>
<td>6.34</td>
<td>5.86</td>
<td>5.73</td>
<td>5.25</td>
<td>4.72</td>
<td>5.60</td>
<td>6.64</td>
<td>5.71</td>
<td>5.61</td>
<td>4.52</td>
<td>6.26</td>
<td>5.00</td>
<td>4.76</td>
<td>3.85</td>
<td>5.23</td>
<td>4.53</td>
<td>6.33</td>
<td>5.15</td>
<td>6.25</td>
<td>4.45</td>
<td>4.47</td>
<td>5.09</td>
<td>4.41</td>
<td>4.17</td>
<td>5.60</td>
<td>5.22</td>
<td>4.76</td>
<td>3.94</td>
<td>5.30</td>
<td>5.73</td>
<td>5.77</td>
<td>6.03</td>
<td>6.76</td>
<td>4.67</td>
<td>4.92</td>
<td>4.61</td>
<td>4.36</td>
<td>4.58</td>
<td>4.70</td>
<td>5.43</td>
<td>5.87</td>
<td>5.77</td>
<td>3.48</td>
<td>4.67</td>
<td>3.55</td>
<td>5.57</td>
<td>6.88</td>
<td>6.93</td>
<td>5.97</td>
<td>6.47</td>
<td>5.55</td>
<td>5.94</td>
<td>5.78</td>
<td>4.72</td>
<td>6.11</td>
<td>5.46</td>
<td>6.51</td>
<td>6.97</td>
<td>6.00</td>
<td>6.45</td>
<td>6.08</td>
<td>6.18</td>
<td>6.43</td>
<td>6.90</td>
<td>6.73</td>
<td>7.07</td>
<td>6.18</td>
<td>4.61</td>
<td>6.70</td>
<td>5.90</td>
<td>6.32</td>
<td>7.05</td>
<td>6.87</td>
<td>6.36</td>
<td>6.18</td>
<td>6.94</td>
<td>6.95</td>
<td>7.78</td>
<td>6.27</td>
<td>6.92</td>
<td>6.66</td>
<td>7.30</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=ae7957fe">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>En aquest cas s el mateix format que l'anterior</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=5ea69089">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[55]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Crear el dataframe a partir del diccionari per temperatura (en catal)</span>
<span class="n">tas_raw_df</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="s2">"climate_data"</span><span class="p">][</span><span class="s2">"annual_mean_historical_tas"</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Reanomenar columnes 'name' a 'Country' i 'code' a 'ISO3'</span>
<span class="n">tas_raw_df</span> <span class="o">=</span> <span class="n">tas_raw_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">'name'</span><span class="p">:</span> <span class="s1">'Country'</span><span class="p">,</span> <span class="s1">'code'</span><span class="p">:</span> <span class="s1">'ISO3'</span><span class="p">})</span>

<span class="c1"># Identificar columnes d'anys (format 'YYYY-07')</span>
<span class="n">year_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">tas_raw_df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="s1">'-07'</span> <span class="ow">in</span> <span class="n">col</span><span class="p">]</span>

<span class="c1"># Fer el melt per transformar els anys a files</span>
<span class="n">tas_long_df</span> <span class="o">=</span> <span class="n">tas_raw_df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span>
    <span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">'Country'</span><span class="p">,</span> <span class="s1">'ISO3'</span><span class="p">],</span>
    <span class="n">value_vars</span><span class="o">=</span><span class="n">year_cols</span><span class="p">,</span>
    <span class="n">var_name</span><span class="o">=</span><span class="s1">'Year'</span><span class="p">,</span>
    <span class="n">value_name</span><span class="o">=</span><span class="s1">'mean_annual_tas_deg_celsius'</span>
<span class="p">)</span>

<span class="c1"># Netejar la columna de l'any, traient el '-07' i assegurant que sigui int</span>
<span class="n">tas_long_df</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">]</span> <span class="o">=</span> <span class="n">tas_long_df</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'-07'</span><span class="p">,</span> <span class="s1">''</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="c1"># Reordenar columnes per claredat</span>
<span class="n">tas_long_df</span> <span class="o">=</span> <span class="n">tas_long_df</span><span class="p">[[</span><span class="s1">'ISO3'</span><span class="p">,</span> <span class="s1">'Year'</span><span class="p">,</span> <span class="s1">'mean_annual_tas_deg_celsius'</span><span class="p">]]</span>

<span class="c1"># Mostrar algunes files com a exemple</span>
<span class="n">display</span><span class="p">(</span><span class="n">tas_long_df</span><span class="p">[(</span><span class="n">tas_long_df</span><span class="p">[</span><span class="s1">'ISO3'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'ESP'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">tas_long_df</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">2015</span><span class="p">)]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>ISO3</th>
<th>Year</th>
<th>mean_annual_tas_deg_celsius</th>
</tr>
</thead>
<tbody>
<tr>
<th>28111</th>
<td>ESP</td>
<td>2015</td>
<td>14.52</td>
</tr>
<tr>
<th>28357</th>
<td>ESP</td>
<td>2016</td>
<td>14.40</td>
</tr>
<tr>
<th>28603</th>
<td>ESP</td>
<td>2017</td>
<td>14.69</td>
</tr>
<tr>
<th>28849</th>
<td>ESP</td>
<td>2018</td>
<td>14.11</td>
</tr>
<tr>
<th>29095</th>
<td>ESP</td>
<td>2019</td>
<td>14.37</td>
</tr>
<tr>
<th>29341</th>
<td>ESP</td>
<td>2020</td>
<td>14.77</td>
</tr>
<tr>
<th>29587</th>
<td>ESP</td>
<td>2021</td>
<td>14.44</td>
</tr>
<tr>
<th>29833</th>
<td>ESP</td>
<td>2022</td>
<td>15.16</td>
</tr>
<tr>
<th>30079</th>
<td>ESP</td>
<td>2023</td>
<td>15.16</td>
</tr>
<tr>
<th>30325</th>
<td>ESP</td>
<td>2024</td>
<td>15.10</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=cd4da4b0">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[56]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Utilitzar els dataframes ja processats anteriorment</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Verificant els dataframes processats disponibles..."</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">resumeix_dataframe</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">nom</span><span class="p">,</span> <span class="n">col_any</span><span class="o">=</span><span class="s1">'Year'</span><span class="p">,</span> <span class="n">col_pais</span><span class="o">=</span><span class="s1">'ISO3'</span><span class="p">):</span>
    <span class="n">df</span><span class="p">[</span><span class="n">col_any</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col_any</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">any_min</span><span class="p">,</span> <span class="n">any_max</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col_any</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="n">col_any</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="si">{</span><span class="n">nom</span><span class="si">}</span><span class="s2">:"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"   Dimensions: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> files x </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> columnes"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"   Columnes: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"   Rang d'anys: </span><span class="si">{</span><span class="n">any_min</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">any_max</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"   Pasos nics: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="n">col_pais</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># 1. Climate Indicators</span>
<span class="n">climate_indicators</span> <span class="o">=</span> <span class="n">climate_indicators_melted</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">resumeix_dataframe</span><span class="p">(</span><span class="n">climate_indicators</span><span class="p">,</span> <span class="s2">"1. climate_indicators_melted"</span><span class="p">)</span>

<span class="c1"># 2. World Development Indicators</span>
<span class="n">wdi</span> <span class="o">=</span> <span class="n">wdi_final</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">resumeix_dataframe</span><span class="p">(</span><span class="n">wdi</span><span class="p">,</span> <span class="s2">"2. wdi_final"</span><span class="p">)</span>

<span class="c1"># 3. Precipitaci</span>
<span class="n">pr</span> <span class="o">=</span> <span class="n">pr_long_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">resumeix_dataframe</span><span class="p">(</span><span class="n">pr</span><span class="p">,</span> <span class="s2">"3. pr_long_df"</span><span class="p">)</span>

<span class="c1"># 4. Temperatura</span>
<span class="n">tas</span> <span class="o">=</span> <span class="n">tas_long_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">resumeix_dataframe</span><span class="p">(</span><span class="n">tas</span><span class="p">,</span> <span class="s2">"4. tas_long_df"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Verificant els dataframes processats disponibles...

1. climate_indicators_melted:
   Dimensions: 13,267 files x 5 columnes
   Columnes: ['Country', 'ISO2', 'ISO3', 'Year', 'surface_temperature_change_celsius']
   Rang d'anys: 1961 - 2024
   Pasos nics: 231

2. wdi_final:
   Dimensions: 15,603 files x 8 columnes
   Columnes: ['ISO3', 'Year', 'agricultural_irrigated_land_%_of_total_agri_land', 'agricultural_land_%_total_land', 'arable_land_%_total_land', 'arable_land_ha_per_person', 'agriculture_forestry_fishing_value_added_%_GDP', 'agriculture_forestry_fishing_value_added_%_annual_growth']
   Rang d'anys: 1960 - 2024
   Pasos nics: 261

3. pr_long_df:
   Dimensions: 30,504 files x 3 columnes
   Columnes: ['ISO3', 'Year', 'prec_mm_per_year']
   Rang d'anys: 1901 - 2024
   Pasos nics: 246

4. tas_long_df:
   Dimensions: 30,504 files x 3 columnes
   Columnes: ['ISO3', 'Year', 'mean_annual_tas_deg_celsius']
   Rang d'anys: 1901 - 2024
   Pasos nics: 246
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=cc8ba78a">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[57]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Filtrarem tots els dataframes per tal que noms quedin els anys posteriors a 1960</span>
<span class="n">any_min</span> <span class="o">=</span> <span class="mi">1961</span>  <span class="c1"># ja que majoritriament 1961 s l'any mnim consistent que em vist anteriorment</span>

<span class="n">climate_indicators</span> <span class="o">=</span> <span class="n">climate_indicators</span><span class="p">[</span><span class="n">climate_indicators</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">any_min</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">wdi</span> <span class="o">=</span> <span class="n">wdi</span><span class="p">[</span><span class="n">wdi</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">any_min</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pr</span> <span class="o">=</span> <span class="n">pr</span><span class="p">[</span><span class="n">pr</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">any_min</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">tas</span> <span class="o">=</span> <span class="n">tas</span><span class="p">[</span><span class="n">tas</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">any_min</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">S'han filtrat tots els dataframes perqu noms incloguin anys de </span><span class="si">{</span><span class="n">any_min</span><span class="si">}</span><span class="s2"> endavant."</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
S'han filtrat tots els dataframes perqu noms incloguin anys de 1961 endavant.
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=492d72c9">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[58]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Merge seqencial dels 4 datasets climtics</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Iniciant merge seqencial dels datasets climtics..."</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">merge_dataframes</span><span class="p">(</span>
    <span class="n">base_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> 
    <span class="n">df_to_add</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> 
    <span class="n">cols_to_merge</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> 
    <span class="n">suffix_right</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">''</span><span class="p">,</span> 
    <span class="n">custom_cols</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Fa un merge entre dos dataframes segons les columnes indicades.</span>
<span class="sd">    Si es passa custom_cols, noms es seleccionen aquestes columnes de df_to_add.</span>
<span class="sd">    Per defecte, el sufix per a columnes coincidents es pot personalitzar amb suffix_right.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">custom_cols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">df_to_add_filtered</span> <span class="o">=</span> <span class="n">df_to_add</span><span class="p">[</span><span class="n">custom_cols</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df_to_add_filtered</span> <span class="o">=</span> <span class="n">df_to_add</span>
    <span class="n">merged_df</span> <span class="o">=</span> <span class="n">base_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
        <span class="n">df_to_add_filtered</span><span class="p">,</span>
        <span class="n">on</span><span class="o">=</span><span class="n">cols_to_merge</span><span class="p">,</span>
        <span class="n">how</span><span class="o">=</span><span class="s1">'outer'</span><span class="p">,</span>
        <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s1">''</span><span class="p">,</span> <span class="n">suffix_right</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  Resultat: </span><span class="si">{</span><span class="n">merged_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> files x </span><span class="si">{</span><span class="n">merged_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> columnes"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">merged_df</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Merge 1: Climate_Indicators + World_Development_Indicators"</span><span class="p">)</span>
<span class="n">climate_country_year_df</span> <span class="o">=</span> <span class="n">merge_dataframes</span><span class="p">(</span>
    <span class="n">climate_indicators</span><span class="p">,</span>
    <span class="n">wdi</span><span class="p">,</span>
    <span class="n">cols_to_merge</span><span class="o">=</span><span class="p">[</span><span class="s1">'ISO3'</span><span class="p">,</span> <span class="s1">'Year'</span><span class="p">],</span>
    <span class="n">suffix_right</span><span class="o">=</span><span class="s1">'_wdi'</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Merge 2: + Precipitaci (pr_long_df)"</span><span class="p">)</span>
<span class="n">climate_country_year_df</span> <span class="o">=</span> <span class="n">merge_dataframes</span><span class="p">(</span>
    <span class="n">climate_country_year_df</span><span class="p">,</span>
    <span class="n">pr</span><span class="p">,</span>
    <span class="n">cols_to_merge</span><span class="o">=</span><span class="p">[</span><span class="s1">'ISO3'</span><span class="p">,</span> <span class="s1">'Year'</span><span class="p">],</span>
    <span class="n">custom_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">'ISO3'</span><span class="p">,</span> <span class="s1">'Year'</span><span class="p">,</span> <span class="s1">'prec_mm_per_year'</span><span class="p">]</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Merge 3: + Temperatura (tas_long_df)"</span><span class="p">)</span>
<span class="n">climate_country_year_df</span> <span class="o">=</span> <span class="n">merge_dataframes</span><span class="p">(</span>
    <span class="n">climate_country_year_df</span><span class="p">,</span>
    <span class="n">tas</span><span class="p">,</span>
    <span class="n">cols_to_merge</span><span class="o">=</span><span class="p">[</span><span class="s1">'ISO3'</span><span class="p">,</span> <span class="s1">'Year'</span><span class="p">],</span>
    <span class="n">custom_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">'ISO3'</span><span class="p">,</span> <span class="s1">'Year'</span><span class="p">,</span> <span class="s1">'mean_annual_tas_deg_celsius'</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Consolidar columna Country (pot haver-hi duplicats de diferents fonts)</span>
<span class="k">if</span> <span class="s1">'Country'</span> <span class="ow">in</span> <span class="n">climate_country_year_df</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="s1">'Country_wdi'</span> <span class="ow">in</span> <span class="n">climate_country_year_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">climate_country_year_df</span><span class="p">[</span><span class="s1">'Country'</span><span class="p">]</span> <span class="o">=</span> <span class="n">climate_country_year_df</span><span class="p">[</span><span class="s1">'Country'</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">climate_country_year_df</span><span class="p">[</span><span class="s1">'Country_wdi'</span><span class="p">])</span>
    <span class="n">climate_country_year_df</span> <span class="o">=</span> <span class="n">climate_country_year_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'Country_wdi'</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'ignore'</span><span class="p">)</span>

<span class="c1"># Ordenar per ISO3 i Year</span>
<span class="n">climate_country_year_df</span> <span class="o">=</span> <span class="n">climate_country_year_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">'ISO3'</span><span class="p">,</span> <span class="s1">'Year'</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Dataframe final climate_country_year_df:"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  Dimensions: </span><span class="si">{</span><span class="n">climate_country_year_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> files x </span><span class="si">{</span><span class="n">climate_country_year_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> columnes"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  Rang d'anys: </span><span class="si">{</span><span class="n">climate_country_year_df</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">climate_country_year_df</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  Nombre de pasos: </span><span class="si">{</span><span class="n">climate_country_year_df</span><span class="p">[</span><span class="s1">'ISO3'</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Columnes (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">climate_country_year_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2">):"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">climate_country_year_df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  </span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">2d</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Primeres files:"</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">climate_country_year_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Exemple per un pas (Spain - ESP):"</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">climate_country_year_df</span><span class="p">[(</span><span class="n">climate_country_year_df</span><span class="p">[</span><span class="s1">'ISO3'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'ESP'</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">climate_country_year_df</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">2015</span><span class="p">)]</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Iniciant merge seqencial dels datasets climtics...

Merge 1: Climate_Indicators + World_Development_Indicators
  Resultat: 17,117 files x 11 columnes

Merge 2: + Precipitaci (pr_long_df)
  Resultat: 19,299 files x 12 columnes

Merge 3: + Temperatura (tas_long_df)
  Resultat: 19,299 files x 13 columnes

Dataframe final climate_country_year_df:
  Dimensions: 19,299 files x 13 columnes
  Rang d'anys: 1961 - 2024
  Nombre de pasos: 303

Columnes (13):
   1. Country
   2. ISO2
   3. ISO3
   4. Year
   5. surface_temperature_change_celsius
   6. agricultural_irrigated_land_%_of_total_agri_land
   7. agricultural_land_%_total_land
   8. arable_land_%_total_land
   9. arable_land_ha_per_person
  10. agriculture_forestry_fishing_value_added_%_GDP
  11. agriculture_forestry_fishing_value_added_%_annual_growth
  12. prec_mm_per_year
  13. mean_annual_tas_deg_celsius

Primeres files:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Country</th>
<th>ISO2</th>
<th>ISO3</th>
<th>Year</th>
<th>surface_temperature_change_celsius</th>
<th>agricultural_irrigated_land_%_of_total_agri_land</th>
<th>agricultural_land_%_total_land</th>
<th>arable_land_%_total_land</th>
<th>arable_land_ha_per_person</th>
<th>agriculture_forestry_fishing_value_added_%_GDP</th>
<th>agriculture_forestry_fishing_value_added_%_annual_growth</th>
<th>prec_mm_per_year</th>
<th>mean_annual_tas_deg_celsius</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Aruba, Kingdom of the Netherlands</td>
<td>AW</td>
<td>ABW</td>
<td>1961</td>
<td>-0.343</td>
<td>NaN</td>
<td>11.111111</td>
<td>11.111111</td>
<td>0.035985</td>
<td>NaN</td>
<td>NaN</td>
<td>403.5</td>
<td>28.37</td>
</tr>
<tr>
<th>1</th>
<td>Aruba, Kingdom of the Netherlands</td>
<td>AW</td>
<td>ABW</td>
<td>1962</td>
<td>-0.046</td>
<td>NaN</td>
<td>11.111111</td>
<td>11.111111</td>
<td>0.035511</td>
<td>NaN</td>
<td>NaN</td>
<td>342.2</td>
<td>28.33</td>
</tr>
<tr>
<th>2</th>
<td>Aruba, Kingdom of the Netherlands</td>
<td>AW</td>
<td>ABW</td>
<td>1963</td>
<td>-0.132</td>
<td>NaN</td>
<td>11.111111</td>
<td>11.111111</td>
<td>0.035086</td>
<td>NaN</td>
<td>NaN</td>
<td>477.0</td>
<td>28.46</td>
</tr>
<tr>
<th>3</th>
<td>Aruba, Kingdom of the Netherlands</td>
<td>AW</td>
<td>ABW</td>
<td>1964</td>
<td>0.122</td>
<td>NaN</td>
<td>11.111111</td>
<td>11.111111</td>
<td>0.034711</td>
<td>NaN</td>
<td>NaN</td>
<td>328.2</td>
<td>28.35</td>
</tr>
<tr>
<th>4</th>
<td>Aruba, Kingdom of the Netherlands</td>
<td>AW</td>
<td>ABW</td>
<td>1965</td>
<td>-0.330</td>
<td>NaN</td>
<td>11.111111</td>
<td>11.111111</td>
<td>0.034370</td>
<td>NaN</td>
<td>NaN</td>
<td>373.9</td>
<td>28.26</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
Exemple per un pas (Spain - ESP):
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Country</th>
<th>ISO2</th>
<th>ISO3</th>
<th>Year</th>
<th>surface_temperature_change_celsius</th>
<th>agricultural_irrigated_land_%_of_total_agri_land</th>
<th>agricultural_land_%_total_land</th>
<th>arable_land_%_total_land</th>
<th>arable_land_ha_per_person</th>
<th>agriculture_forestry_fishing_value_added_%_GDP</th>
<th>agriculture_forestry_fishing_value_added_%_annual_growth</th>
<th>prec_mm_per_year</th>
<th>mean_annual_tas_deg_celsius</th>
</tr>
</thead>
<tbody>
<tr>
<th>5364</th>
<td>Spain</td>
<td>ES</td>
<td>ESP</td>
<td>2015</td>
<td>1.443</td>
<td>13.539857</td>
<td>53.189062</td>
<td>24.573101</td>
<td>0.264490</td>
<td>2.723270</td>
<td>4.831547</td>
<td>489.87</td>
<td>14.52</td>
</tr>
<tr>
<th>5365</th>
<td>Spain</td>
<td>ES</td>
<td>ESP</td>
<td>2016</td>
<td>1.628</td>
<td>13.759770</td>
<td>52.577247</td>
<td>24.695895</td>
<td>0.265555</td>
<td>2.815221</td>
<td>4.503758</td>
<td>647.87</td>
<td>14.40</td>
</tr>
<tr>
<th>5366</th>
<td>Spain</td>
<td>ES</td>
<td>ESP</td>
<td>2017</td>
<td>1.950</td>
<td>13.933547</td>
<td>52.638714</td>
<td>24.529741</td>
<td>0.263119</td>
<td>2.803447</td>
<td>-3.486742</td>
<td>465.42</td>
<td>14.69</td>
</tr>
<tr>
<th>5367</th>
<td>Spain</td>
<td>ES</td>
<td>ESP</td>
<td>2018</td>
<td>1.058</td>
<td>14.145419</td>
<td>52.408210</td>
<td>23.787368</td>
<td>0.254035</td>
<td>2.701283</td>
<td>4.193773</td>
<td>791.86</td>
<td>14.11</td>
</tr>
<tr>
<th>5368</th>
<td>Spain</td>
<td>ES</td>
<td>ESP</td>
<td>2019</td>
<td>1.437</td>
<td>14.726331</td>
<td>52.458492</td>
<td>23.644962</td>
<td>0.250694</td>
<td>2.519801</td>
<td>-2.770201</td>
<td>557.29</td>
<td>14.37</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=16c3a302">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="Merge-final-entre-climate_country_year_df-i-agri_population_df-per-formar-agri_country_year_df">Merge final entre <code>climate_country_year_df</code> i <code>agri_population_df</code> per formar <code>agri_country_year_df</code><a class="anchor-link" href="#Merge-final-entre-climate_country_year_df-i-agri_population_df-per-formar-agri_country_year_df"></a></h2>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=e10611cd">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[59]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Sets de pases en ambos dataframes</span>
<span class="n">agri_countries</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">agri_population_df</span><span class="p">[</span><span class="s1">'Area'</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="n">climate_countries</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">climate_country_year_df</span><span class="p">[</span><span class="s1">'Country'</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>

<span class="c1"># Pases presentes en ambos</span>
<span class="n">intersection</span> <span class="o">=</span> <span class="n">agri_countries</span> <span class="o">&amp;</span> <span class="n">climate_countries</span>
<span class="c1"># Pases solo en agri_population_df</span>
<span class="n">only_agri</span> <span class="o">=</span> <span class="n">agri_countries</span> <span class="o">-</span> <span class="n">climate_countries</span>
<span class="c1"># Pases solo en climate_country_year_df</span>
<span class="n">only_climate</span> <span class="o">=</span> <span class="n">climate_countries</span> <span class="o">-</span> <span class="n">agri_countries</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Pases en ambos dataframes: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">intersection</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Pases solo en agri_population_df: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">only_agri</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Pases solo en climate_country_year_df: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">only_climate</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Pases solo en agri_population_df:"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">only_agri</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Pases solo en climate_country_year_df:"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">only_climate</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Pases en ambos dataframes: 143
Pases solo en agri_population_df: 103
Pases solo en climate_country_year_df: 88

Pases solo en agri_population_df:
['Afghanistan', 'Armenia', 'Aruba', 'Australia and New Zealand', 'Azerbaijan', 'Bahamas', 'Bahrain', 'Belarus', 'Belgium-Luxembourg', 'Bermuda', 'Bolivia (Plurinational State of)', 'Caribbean', 'Central African Republic', 'Central America', 'Central Asia', 'China', 'China, Hong Kong SAR', 'China, Taiwan Province of', 'China, mainland', 'Comoros', 'Congo', 'Croatia', 'Czechia', 'Czechoslovakia', "Cte d'Ivoire", "Democratic People's Republic of Korea", 'Democratic Republic of the Congo', 'Dominican Republic', 'Eastern Africa', 'Eastern Asia', 'Eastern Europe', 'Egypt', 'Equatorial Guinea', 'Eritrea', 'Estonia', 'Eswatini', 'Ethiopia', 'Ethiopia PDR', 'European Union (27)', 'Fiji', 'French Guiana', 'Gambia', 'Iran (Islamic Republic of)', 'Kazakhstan', 'Kyrgyzstan', 'Land Locked Developing Countries (LLDCs)', "Lao People's Democratic Republic", 'Least Developed Countries (LDCs)', 'Lesotho', 'Low Income Food Deficit Countries (LIFDCs)', 'Madagascar', 'Mauritania', 'Melanesia', 'Micronesia', 'Micronesia (Federated States of)', 'Middle Africa', 'Mozambique', 'Nauru', 'Net Food Importing Developing Countries (NFIDCs)', 'Netherlands (Kingdom of the)', 'North Macedonia', 'Northern Africa', 'Northern America', 'Northern Europe', 'Palau', 'Palestine', 'Poland', 'Polynesia', 'Republic of Korea', 'Republic of Moldova', 'Runion', 'Saint Kitts and Nevis', 'Saint Lucia', 'Saint Vincent and the Grenadines', 'Sao Tome and Principe', 'Serbia', 'Serbia and Montenegro', 'Slovakia', 'Slovenia', 'Small Island Developing States (SIDS)', 'South America', 'South Sudan', 'South-eastern Asia', 'Southern Africa', 'Southern Asia', 'Southern Europe', 'Sudan (former)', 'Syrian Arab Republic', 'Tajikistan', 'Timor-Leste', 'Trkiye', 'USSR', 'United Kingdom of Great Britain and Northern Ireland', 'United Republic of Tanzania', 'United States of America', 'Uzbekistan', 'Venezuela (Bolivarian Republic of)', 'Viet Nam', 'Western Africa', 'Western Asia', 'Western Europe', 'Yemen', 'Yugoslav SFR']

Pases solo en climate_country_year_df:
['Afghanistan, Islamic Rep. of', 'American Samoa', 'Andorra, Principality of', 'Anguilla', 'Armenia, Rep. of', 'Aruba, Kingdom of the Netherlands', 'Azerbaijan, Rep. of', 'Bahamas, The', 'Bahrain, Kingdom of', 'Belarus, Rep. of', 'Bolivia', 'British Virgin Islands', 'Cayman Islands', 'Central African Rep.', 'China, P.R.: Hong Kong', 'China, P.R.: Macao', 'China, P.R.: Mainland', 'Comoros, Union of the', 'Congo, Dem. Rep. of the', 'Congo, Rep. of', 'Croatia, Rep. of', 'Czech Rep.', 'Dominican Rep.', 'Egypt, Arab Rep. of', 'Equatorial Guinea, Rep. of', 'Eritrea, The State of', 'Estonia, Rep. of', 'Eswatini, Kingdom of', 'Ethiopia, The Federal Dem. Rep. of', 'Falkland Islands (Malvinas)', 'Fiji, Rep. of', 'Gambia, The', 'Gibraltar', 'Guiana, French', 'Holy See', 'Iran, Islamic Rep. of', 'Isle of Man', 'Kazakhstan, Rep. of', "Korea, Dem. People's Rep. of", 'Korea, Rep. of', 'Kyrgyz Rep.', "Lao People's Dem. Rep.", 'Lesotho, Kingdom of', 'Liechtenstein', 'Madagascar, Rep. of', 'Marshall Islands, Rep. of the', 'Mauritania, Islamic Rep. of', 'Mayotte', 'Micronesia, Federated States of', 'Moldova, Rep. of', 'Monaco', 'Montserrat', 'Mozambique, Rep. of', 'Nauru, Rep. of', 'Netherlands, The', 'Norfolk Island', 'North Macedonia, Republic of ', 'Palau, Rep. of', 'Pitcairn Islands', 'Poland, Rep. of', 'Saint Pierre and Miquelon', 'San Marino, Rep. of', 'Serbia, Rep. of', 'Slovak Rep.', 'Slovenia, Rep. of', 'South Sudan, Rep. of', 'St. Kitts and Nevis', 'St. Lucia', 'St. Vincent and the Grenadines', 'Svalbard Jan Mayen Islands', 'Syrian Arab Rep.', 'So Tom and Prncipe, Dem. Rep. of', 'Taiwan Province of China', 'Tajikistan, Rep. of', 'Tanzania, United Rep. of', 'Timor-Leste, Dem. Rep. of', 'Tokelau', 'Turks and Caicos Islands', 'United Kingdom', 'United States', 'United States Virgin Islands', 'Uzbekistan, Rep. of', 'Venezuela, Rep. Bolivariana de', 'Vietnam', 'Wallis and Futuna Islands', 'West Bank and Gaza', 'Western Sahara', 'Yemen, Rep. of']
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=620e7386">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="%C3%9As-de-country_converter-per-harmonitzar-codis-de-pa%C3%AFsos">s de country_converter per harmonitzar codis de pasos<a class="anchor-link" href="#%C3%9As-de-country_converter-per-harmonitzar-codis-de-pa%C3%AFsos"></a></h3><p>En lloc d'intentar harmonitzar manualment els noms de pasos, utilitzarem la llibreria <code>country_converter</code> per convertir els noms de pasos a codis ISO3 estandarditzats, que ja existeixen al dataframe climtic.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=b5b183cd">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[60]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">clean_agri_dataframe_and_add_iso3</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">country_col</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">'Area'</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Neteja un dataframe agrcola i afegeix la columna ISO3.</span>
<span class="sd">    </span>
<span class="sd">    Operacions realitzades:</span>
<span class="sd">    1. Mapeja noms de pasos amb variants conegudes</span>
<span class="sd">    2. Elimina registres d'agrupacions no-geogrfiques</span>
<span class="sd">    3. Converteix noms de pasos a codis ISO3 utilitzant country_converter</span>
<span class="sd">    </span>
<span class="sd">    Parmetres:</span>
<span class="sd">    -----------</span>
<span class="sd">    df : pd.DataFrame</span>
<span class="sd">        Dataframe agrcola amb columna de pasos</span>
<span class="sd">    country_col : str</span>
<span class="sd">        Nom de la columna que cont els noms de pasos (default: 'Area')</span>
<span class="sd">        </span>
<span class="sd">    Retorna:</span>
<span class="sd">    --------</span>
<span class="sd">    pd.DataFrame</span>
<span class="sd">        Dataframe netejat amb columna ISO3 afegida</span>
<span class="sd">    """</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Dimensions inicials: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> files"</span><span class="p">)</span>
    
    <span class="c1"># 1. Mapatges de noms de pasos</span>
    <span class="n">country_mappings</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">'Australia and New Zealand'</span><span class="p">:</span> <span class="s1">'Australia'</span><span class="p">,</span>
        <span class="s1">'Belgium-Luxembourg'</span><span class="p">:</span> <span class="s1">'Belgium'</span><span class="p">,</span>
        <span class="s1">'China, Hong Kong SAR'</span><span class="p">:</span> <span class="s1">'Hong Kong'</span><span class="p">,</span>
        <span class="s1">'China, Taiwan Province of'</span><span class="p">:</span> <span class="s1">'Taiwan'</span><span class="p">,</span>
        <span class="s1">'China, mainland'</span><span class="p">:</span> <span class="s1">'China'</span><span class="p">,</span>
        <span class="s1">'Serbia and Montenegro'</span><span class="p">:</span> <span class="s1">'Serbia'</span><span class="p">,</span>
        <span class="s1">'United Kingdom of Great Britain and Northern Ireland'</span><span class="p">:</span> <span class="s1">'United Kingdom'</span>
    <span class="p">}</span>
    
    <span class="n">df</span><span class="p">[</span><span class="n">country_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">country_col</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">country_mappings</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Aplicats </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">country_mappings</span><span class="p">)</span><span class="si">}</span><span class="s2"> mapatges de noms de pasos"</span><span class="p">)</span>
    
    <span class="c1"># 2. Eliminar agrupacions no-countries</span>
    <span class="n">areas_to_remove</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">'Low Income Food Deficit Countries (LIFDCs)'</span><span class="p">,</span>
        <span class="s1">'Least Developed Countries (LDCs)'</span><span class="p">,</span>
        <span class="s1">'Net Food Importing Developing Countries (NFIDCs)'</span><span class="p">,</span>
        <span class="s1">'Small Island Developing States (SIDS)'</span><span class="p">,</span>
        <span class="s1">'Yugoslav SFR'</span><span class="p">,</span>
        <span class="s1">'USSR'</span><span class="p">,</span>
        <span class="s1">'World'</span><span class="p">,</span>
        <span class="s1">'Africa'</span><span class="p">,</span>
        <span class="s1">'Eastern Africa'</span><span class="p">,</span>
        <span class="s1">'Middle Africa'</span><span class="p">,</span>
        <span class="s1">'Northern Africa'</span><span class="p">,</span>
        <span class="s1">'Western Africa'</span><span class="p">,</span>
        <span class="s1">'Americas'</span><span class="p">,</span>
        <span class="s1">'Northern America'</span><span class="p">,</span>
        <span class="s1">'Central America'</span><span class="p">,</span>
        <span class="s1">'Caribbean'</span><span class="p">,</span>
        <span class="s1">'South America'</span><span class="p">,</span>
        <span class="s1">'Asia'</span><span class="p">,</span>
        <span class="s1">'Central Asia'</span><span class="p">,</span>
        <span class="s1">'Eastern Asia'</span><span class="p">,</span>
        <span class="s1">'Southern Asia'</span><span class="p">,</span>
        <span class="s1">'South-eastern Asia'</span><span class="p">,</span>
        <span class="s1">'Western Asia'</span><span class="p">,</span>
        <span class="s1">'Europe'</span><span class="p">,</span>
        <span class="s1">'Eastern Europe'</span><span class="p">,</span>
        <span class="s1">'Northern Europe'</span><span class="p">,</span>
        <span class="s1">'Southern Europe'</span><span class="p">,</span>
        <span class="s1">'Western Europe'</span><span class="p">,</span>
        <span class="s1">'Oceania'</span><span class="p">,</span>
        <span class="s1">'Melanesia'</span><span class="p">,</span>
        <span class="s1">'Polynesia'</span><span class="p">,</span>
        <span class="s1">'European Union (27)'</span><span class="p">,</span>
        <span class="s1">'Land Locked Developing Countries (LLDCs)'</span><span class="p">,</span>
    <span class="p">]</span>
    
    <span class="n">initial_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="n">country_col</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">areas_to_remove</span><span class="p">)]</span>
    <span class="n">removed_count</span> <span class="o">=</span> <span class="n">initial_count</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Eliminats </span><span class="si">{</span><span class="n">removed_count</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> registres d'agrupacions no-geogrfiques"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  Dimensions desprs de neteja: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> files"</span><span class="p">)</span>
    
    <span class="c1"># 3. Convertir a ISO3 utilitzant country_converter</span>
    <span class="n">countries_unique</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">country_col</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Convertint </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">countries_unique</span><span class="p">)</span><span class="si">}</span><span class="s2"> pasos nics a codis ISO3..."</span><span class="p">)</span>
    
    <span class="n">iso3_codes</span> <span class="o">=</span> <span class="n">coco</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="n">countries_unique</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="s1">'ISO3'</span><span class="p">)</span>
    <span class="n">country_to_iso3</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">countries_unique</span><span class="p">,</span> <span class="n">iso3_codes</span><span class="p">))</span>
    
    <span class="n">df</span><span class="p">[</span><span class="s1">'ISO3'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">country_col</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">country_to_iso3</span><span class="p">)</span>
    
    <span class="c1"># Estadstiques de conversi</span>
    <span class="n">successful</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'ISO3'</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">failed</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'ISO3'</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">unique_iso3</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'ISO3'</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Conversions exitoses: </span><span class="si">{</span><span class="n">successful</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> files (</span><span class="si">{</span><span class="n">unique_iso3</span><span class="si">}</span><span class="s2"> codis ISO3 nics)"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">failed</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Conversions fallides: </span><span class="si">{</span><span class="n">failed</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> files"</span><span class="p">)</span>
        <span class="n">failed_countries</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">'ISO3'</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()][</span><span class="n">country_col</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  Pasos no convertits: </span><span class="si">{</span><span class="nb">sorted</span><span class="p">(</span><span class="n">failed_countries</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">df</span>


<span class="k">def</span><span class="w"> </span><span class="nf">clean_climate_dataframe</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">country_col</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">'Country'</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Neteja un dataframe climtic eliminant sufixos redundants i variants de noms.</span>
<span class="sd">    </span>
<span class="sd">    Operacions realitzades:</span>
<span class="sd">    1. Elimina text desprs de coma (e.g., ", Islamic Rep. of")</span>
<span class="sd">    2. Elimina text entre parntesis</span>
<span class="sd">    3. Neteja espais extra</span>
<span class="sd">    </span>
<span class="sd">    Parmetres:</span>
<span class="sd">    -----------</span>
<span class="sd">    df : pd.DataFrame</span>
<span class="sd">        Dataframe climtic amb columna de pasos</span>
<span class="sd">    country_col : str</span>
<span class="sd">        Nom de la columna que cont els noms de pasos (default: 'Country')</span>
<span class="sd">        </span>
<span class="sd">    Retorna:</span>
<span class="sd">    --------</span>
<span class="sd">    pd.DataFrame</span>
<span class="sd">        Dataframe amb noms de pasos netejats</span>
<span class="sd">    """</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Dimensions inicials: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> files"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Pasos nics inicials: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="n">country_col</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">country_col</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">'N/A'</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">country_col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"La columna '</span><span class="si">{</span><span class="n">country_col</span><span class="si">}</span><span class="s2">' no existeix al dataframe"</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df</span>
    
    <span class="c1"># 1. Eliminar text desprs de coma (e.g., "Afghanistan, Islamic Rep. of"  "Afghanistan")</span>
    <span class="n">df</span><span class="p">[</span><span class="n">country_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">country_col</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">','</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="c1"># 2. Eliminar text entre parntesis</span>
    <span class="n">df</span><span class="p">[</span><span class="n">country_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">country_col</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s1">'\s*\([^)]*\)'</span><span class="p">,</span> <span class="s1">''</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># 3. Neteja espais extra</span>
    <span class="n">df</span><span class="p">[</span><span class="n">country_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">country_col</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Noms de pasos netejats"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  Pasos nics desprs de neteja: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="n">country_col</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">df</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=cefa0665">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Aplicaci%C3%B3-de-la-neteja-als-dataframes-agr%C3%ADcoles">Aplicaci de la neteja als dataframes agrcoles<a class="anchor-link" href="#Aplicaci%C3%B3-de-la-neteja-als-dataframes-agr%C3%ADcoles"></a></h3><p>Apliquem la funci de neteja i conversi a ISO3 als dataframes agrcoles <code>agri_population_df</code> i <code>agri_prices_df</code>.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=6867bdb3">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[61]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Netejar agri_population_df i afegir ISO3</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Nateja de agri_population_df"</span><span class="p">)</span>
<span class="n">agri_population_df_cleaned</span> <span class="o">=</span> <span class="n">clean_agri_dataframe_and_add_iso3</span><span class="p">(</span><span class="n">agri_population_df</span><span class="p">,</span> <span class="n">country_col</span><span class="o">=</span><span class="s1">'Area'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2"> agri_population_df netejat i amb columna ISO3 afegida</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">agri_population_df_cleaned</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Nateja de agri_population_df
Dimensions inicials: 12,729 files
Aplicats 7 mapatges de noms de pasos
Eliminats 1,972 registres d'agrupacions no-geogrfiques
  Dimensions desprs de neteja: 10,757 files

Convertint 209 pasos nics a codis ISO3...
Conversions exitoses: 10,757 files (204 codis ISO3 nics)

 agri_population_df netejat i amb columna ISO3 afegida

</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Year Code</th>
<th>Year</th>
<th>Value_nutrient_3102_N_Agricultural_Use_t</th>
<th>Value_nutrient_3102_N_Use_per_area_of_cropland_kg/ha</th>
<th>Value_nutrient_3102_N_Use_per_capita_kg/cap</th>
<th>Value_nutrient_3102_N_Use_per_value_of_agricultural_production_g/Int$</th>
<th>Value_nutrient_3103_P2O5_Agricultural_Use_t</th>
<th>Value_nutrient_3103_P2O5_Use_per_area_of_cropland_kg/ha</th>
<th>Value_nutrient_3103_P2O5_Use_per_capita_kg/cap</th>
<th>Value_nutrient_3103_P2O5_Use_per_value_of_agricultural_production_g/Int$</th>
<th>Value_nutrient_3104_K2O_Agricultural_Use_t</th>
<th>Value_nutrient_3104_K2O_Use_per_area_of_cropland_kg/ha</th>
<th>Value_nutrient_3104_K2O_Use_per_capita_kg/cap</th>
<th>Value_nutrient_3104_K2O_Use_per_value_of_agricultural_production_g/Int$</th>
<th>Value_6601_land_area_ha</th>
<th>Value_6610_agricultural_land_ha</th>
<th>Value_6620_cropland_ha</th>
<th>Value_6621_arable_land_ha</th>
<th>Value_6650_permanent_crops_ha</th>
<th>Value_6655_permanent_meadows_and_pastures_ha</th>
<th>Value_pesticide_agricultural_use_t</th>
<th>Value_6971_herbaceous_crops_ha</th>
<th>Value_6974_tree-covered_areas_ha</th>
<th>Value_6983_grassland_ha</th>
<th>Value_1709_agricultural_soils_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5058_enteric_fermentation_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5059_manure_management_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5060_rice_cultivation_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5061_synthetic_fertilizers_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5064_crop_residues_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5085_emissions_from_livestock_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_21085_agriculture_value_added_per_worker_constant_2015_ususd_total_USD</th>
<th>Value_21111_employment_in_crop_and_animal_production_hunting_and_related_service_activities_female_No</th>
<th>Value_21111_employment_in_crop_and_animal_production_hunting_and_related_service_activities_male_No</th>
<th>Value_21111_employment_in_crop_and_animal_production_hunting_and_related_service_activities_total_No</th>
<th>Value_21144_employment_in_agriculture_-_ilo_modelled_estimates_female_No</th>
<th>Value_21144_employment_in_agriculture_-_ilo_modelled_estimates_male_No</th>
<th>Value_21144_employment_in_agriculture_-_ilo_modelled_estimates_total_No</th>
<th>Value_21156_share_of_employment_in_agriculture_in_total_employment_-_ilo_modelled_estimates_female_%</th>
<th>Value_21156_share_of_employment_in_agriculture_in_total_employment_-_ilo_modelled_estimates_male_%</th>
<th>Value_21156_share_of_employment_in_agriculture_in_total_employment_-_ilo_modelled_estimates_total_%</th>
<th>total_population_No</th>
<th>female_population_%</th>
<th>male_population_%</th>
<th>rural_population_%</th>
<th>urban_population_%</th>
<th>ISO3</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>'051</td>
<td>Armenia</td>
<td>1992</td>
<td>1992</td>
<td>15000.0</td>
<td>31.06</td>
<td>4.20</td>
<td>NaN</td>
<td>5000.0</td>
<td>10.35</td>
<td>1.4</td>
<td>NaN</td>
<td>5000.0</td>
<td>10.35</td>
<td>1.4</td>
<td>NaN</td>
<td>2847000.0</td>
<td>1170000.0</td>
<td>483000.0</td>
<td>423000.0</td>
<td>60000.0</td>
<td>687000.0</td>
<td>8.0</td>
<td>822810.0</td>
<td>711050.0</td>
<td>669040.0</td>
<td>544.8665</td>
<td>751.2400</td>
<td>64.0145</td>
<td>NaN</td>
<td>82.7595</td>
<td>25.8905</td>
<td>1251.4710</td>
<td>1704.51</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>485460.0</td>
<td>335990.0</td>
<td>821450.0</td>
<td>64.6</td>
<td>40.6</td>
<td>52.1</td>
<td>3571861.0</td>
<td>52.165160</td>
<td>47.834840</td>
<td>31.924927</td>
<td>64.462083</td>
<td>ARM</td>
</tr>
<tr>
<th>1</th>
<td>1</td>
<td>'051</td>
<td>Armenia</td>
<td>1993</td>
<td>1993</td>
<td>15000.0</td>
<td>30.43</td>
<td>4.34</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2847000.0</td>
<td>1181000.0</td>
<td>493000.0</td>
<td>433000.0</td>
<td>60000.0</td>
<td>688000.0</td>
<td>8.0</td>
<td>825000.0</td>
<td>711110.0</td>
<td>669070.0</td>
<td>473.5815</td>
<td>671.5772</td>
<td>40.3445</td>
<td>NaN</td>
<td>82.7595</td>
<td>27.6395</td>
<td>1075.0777</td>
<td>1729.96</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>443950.0</td>
<td>317270.0</td>
<td>761220.0</td>
<td>65.3</td>
<td>41.4</td>
<td>52.7</td>
<td>3453332.0</td>
<td>52.238041</td>
<td>47.761988</td>
<td>32.521374</td>
<td>64.865672</td>
<td>ARM</td>
</tr>
<tr>
<th>2</th>
<td>1</td>
<td>'051</td>
<td>Armenia</td>
<td>1994</td>
<td>1994</td>
<td>7000.0</td>
<td>14.00</td>
<td>2.08</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2847000.0</td>
<td>1200000.0</td>
<td>500000.0</td>
<td>435000.0</td>
<td>65000.0</td>
<td>700000.0</td>
<td>23.0</td>
<td>817000.0</td>
<td>711170.0</td>
<td>669080.0</td>
<td>418.9650</td>
<td>661.9620</td>
<td>40.2040</td>
<td>NaN</td>
<td>38.6370</td>
<td>22.6045</td>
<td>1059.8630</td>
<td>865.49</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>424800.0</td>
<td>301260.0</td>
<td>726060.0</td>
<td>65.7</td>
<td>41.6</td>
<td>52.9</td>
<td>3364610.0</td>
<td>52.292242</td>
<td>47.707758</td>
<td>32.857746</td>
<td>64.736329</td>
<td>ARM</td>
</tr>
<tr>
<th>3</th>
<td>1</td>
<td>'051</td>
<td>Armenia</td>
<td>1995</td>
<td>1995</td>
<td>7000.0</td>
<td>14.17</td>
<td>2.12</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2847000.0</td>
<td>1244000.0</td>
<td>494000.0</td>
<td>435000.0</td>
<td>59000.0</td>
<td>750000.0</td>
<td>24.0</td>
<td>845520.0</td>
<td>661750.0</td>
<td>689880.0</td>
<td>413.6385</td>
<td>653.4080</td>
<td>40.1943</td>
<td>NaN</td>
<td>38.6370</td>
<td>23.3730</td>
<td>1045.2308</td>
<td>919.58</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>410500.0</td>
<td>299810.0</td>
<td>710310.0</td>
<td>66.0</td>
<td>41.9</td>
<td>53.1</td>
<td>3307581.0</td>
<td>52.322165</td>
<td>47.677865</td>
<td>33.016637</td>
<td>64.255116</td>
<td>ARM</td>
</tr>
<tr>
<th>4</th>
<td>1</td>
<td>'051</td>
<td>Armenia</td>
<td>1996</td>
<td>1996</td>
<td>8000.0</td>
<td>15.81</td>
<td>2.44</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2847000.0</td>
<td>1306000.0</td>
<td>506000.0</td>
<td>450000.0</td>
<td>56000.0</td>
<td>800000.0</td>
<td>32.0</td>
<td>854370.0</td>
<td>658510.0</td>
<td>690990.0</td>
<td>423.1520</td>
<td>652.5484</td>
<td>39.9250</td>
<td>NaN</td>
<td>44.1490</td>
<td>27.8780</td>
<td>1043.6012</td>
<td>973.21</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>388190.0</td>
<td>296400.0</td>
<td>684590.0</td>
<td>66.3</td>
<td>42.2</td>
<td>53.2</td>
<td>3278735.0</td>
<td>52.326675</td>
<td>47.673325</td>
<td>33.065618</td>
<td>63.563569</td>
<td>ARM</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=4426552c">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[62]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Netejar agri_prices_df i afegir ISO3</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Nateja de agri_prices_df"</span><span class="p">)</span>
<span class="n">agri_prices_df_cleaned</span> <span class="o">=</span> <span class="n">clean_agri_dataframe_and_add_iso3</span><span class="p">(</span><span class="n">agri_prices_df</span><span class="p">,</span> <span class="n">country_col</span><span class="o">=</span><span class="s1">'Area'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2"> agri_prices_df netejat i amb columna ISO3 afegida</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">agri_prices_df_cleaned</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Nateja de agri_prices_df
Dimensions inicials: 4,116,252 files
Aplicats 7 mapatges de noms de pasos
Eliminats 989,642 registres d'agrupacions no-geogrfiques
  Dimensions desprs de neteja: 3,126,610 files

Convertint 208 pasos nics a codis ISO3...
Conversions exitoses: 3,126,610 files (203 codis ISO3 nics)

 agri_prices_df netejat i amb columna ISO3 afegida

</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Item Code</th>
<th>Item Code (CPC)</th>
<th>Item</th>
<th>Element Code</th>
<th>Element</th>
<th>Year Code</th>
<th>Year</th>
<th>Unit</th>
<th>Value</th>
<th>Flag</th>
<th>Flag_Description</th>
<th>Value_LCU/tonne</th>
<th>Value_SLC/tonne</th>
<th>Value_USD/tonne</th>
<th>ISO3</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>221</td>
<td>'01371</td>
<td>Almonds, in shell</td>
<td>5312</td>
<td>Area harvested</td>
<td>1961</td>
<td>1961</td>
<td>ha</td>
<td>0.0</td>
<td>A</td>
<td>Official figure</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>AFG</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>221</td>
<td>'01371</td>
<td>Almonds, in shell</td>
<td>5312</td>
<td>Area harvested</td>
<td>1962</td>
<td>1962</td>
<td>ha</td>
<td>0.0</td>
<td>A</td>
<td>Official figure</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>AFG</td>
</tr>
<tr>
<th>2</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>221</td>
<td>'01371</td>
<td>Almonds, in shell</td>
<td>5312</td>
<td>Area harvested</td>
<td>1963</td>
<td>1963</td>
<td>ha</td>
<td>0.0</td>
<td>A</td>
<td>Official figure</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>AFG</td>
</tr>
<tr>
<th>3</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>221</td>
<td>'01371</td>
<td>Almonds, in shell</td>
<td>5312</td>
<td>Area harvested</td>
<td>1964</td>
<td>1964</td>
<td>ha</td>
<td>0.0</td>
<td>A</td>
<td>Official figure</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>AFG</td>
</tr>
<tr>
<th>4</th>
<td>2</td>
<td>'004</td>
<td>Afghanistan</td>
<td>221</td>
<td>'01371</td>
<td>Almonds, in shell</td>
<td>5312</td>
<td>Area harvested</td>
<td>1965</td>
<td>1965</td>
<td>ha</td>
<td>0.0</td>
<td>A</td>
<td>Official figure</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>AFG</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=cf710822">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[63]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">agri_prices_df_cleaned</span><span class="p">[(</span><span class="n">agri_prices_df_cleaned</span><span class="p">[</span><span class="s1">'ISO3'</span><span class="p">]</span><span class="o">==</span><span class="s1">'ESP'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">agri_prices_df_cleaned</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">2015</span><span class="p">)]</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Item Code</th>
<th>Item Code (CPC)</th>
<th>Item</th>
<th>Element Code</th>
<th>Element</th>
<th>Year Code</th>
<th>Year</th>
<th>Unit</th>
<th>Value</th>
<th>Flag</th>
<th>Flag_Description</th>
<th>Value_LCU/tonne</th>
<th>Value_SLC/tonne</th>
<th>Value_USD/tonne</th>
<th>ISO3</th>
</tr>
</thead>
<tbody>
<tr>
<th>2561783</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>221</td>
<td>'01371</td>
<td>Almonds, in shell</td>
<td>5312</td>
<td>Area harvested</td>
<td>2015</td>
<td>2015</td>
<td>ha</td>
<td>548604.0</td>
<td>A</td>
<td>Official figure</td>
<td>1854.8</td>
<td>1854.8</td>
<td>2057.1</td>
<td>ESP</td>
</tr>
<tr>
<th>2561784</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>221</td>
<td>'01371</td>
<td>Almonds, in shell</td>
<td>5312</td>
<td>Area harvested</td>
<td>2016</td>
<td>2016</td>
<td>ha</td>
<td>583673.0</td>
<td>A</td>
<td>Official figure</td>
<td>1728.2</td>
<td>1728.2</td>
<td>1911.7</td>
<td>ESP</td>
</tr>
<tr>
<th>2561785</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>221</td>
<td>'01371</td>
<td>Almonds, in shell</td>
<td>5312</td>
<td>Area harvested</td>
<td>2017</td>
<td>2017</td>
<td>ha</td>
<td>633562.0</td>
<td>A</td>
<td>Official figure</td>
<td>1462.3</td>
<td>1462.3</td>
<td>1651.9</td>
<td>ESP</td>
</tr>
<tr>
<th>2561786</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>221</td>
<td>'01371</td>
<td>Almonds, in shell</td>
<td>5312</td>
<td>Area harvested</td>
<td>2018</td>
<td>2018</td>
<td>ha</td>
<td>657770.0</td>
<td>A</td>
<td>Official figure</td>
<td>1143.8</td>
<td>1143.8</td>
<td>1350.8</td>
<td>ESP</td>
</tr>
<tr>
<th>2561787</th>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>221</td>
<td>'01371</td>
<td>Almonds, in shell</td>
<td>5312</td>
<td>Area harvested</td>
<td>2019</td>
<td>2019</td>
<td>ha</td>
<td>687230.0</td>
<td>A</td>
<td>Official figure</td>
<td>1331.6</td>
<td>1331.6</td>
<td>1490.7</td>
<td>ESP</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=33a7f0fe">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Aplicaci%C3%B3-de-la-neteja-al-dataframe-clim%C3%A0tic">Aplicaci de la neteja al dataframe climtic<a class="anchor-link" href="#Aplicaci%C3%B3-de-la-neteja-al-dataframe-clim%C3%A0tic"></a></h3><p>Apliquem la funci de neteja al dataframe climtic <code>climate_country_year_df</code> per eliminar sufixos redundants.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=f7cf8756">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[64]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Netejar climate_country_year_df i afegir ISO3</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Nateja de climate_country_year_df"</span><span class="p">)</span>
<span class="n">climate_country_year_df_cleaned</span> <span class="o">=</span> <span class="n">clean_climate_dataframe</span><span class="p">(</span><span class="n">climate_country_year_df</span><span class="p">,</span> <span class="n">country_col</span><span class="o">=</span><span class="s1">'Country'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2"> climate_country_year_df netejat</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">climate_country_year_df_cleaned</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Nateja de climate_country_year_df
Dimensions inicials: 19,299 files
Pasos nics inicials: 231
Noms de pasos netejats
  Pasos nics desprs de neteja: 227

 climate_country_year_df netejat

</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Country</th>
<th>ISO2</th>
<th>ISO3</th>
<th>Year</th>
<th>surface_temperature_change_celsius</th>
<th>agricultural_irrigated_land_%_of_total_agri_land</th>
<th>agricultural_land_%_total_land</th>
<th>arable_land_%_total_land</th>
<th>arable_land_ha_per_person</th>
<th>agriculture_forestry_fishing_value_added_%_GDP</th>
<th>agriculture_forestry_fishing_value_added_%_annual_growth</th>
<th>prec_mm_per_year</th>
<th>mean_annual_tas_deg_celsius</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Aruba</td>
<td>AW</td>
<td>ABW</td>
<td>1961</td>
<td>-0.343</td>
<td>NaN</td>
<td>11.111111</td>
<td>11.111111</td>
<td>0.035985</td>
<td>NaN</td>
<td>NaN</td>
<td>403.5</td>
<td>28.37</td>
</tr>
<tr>
<th>1</th>
<td>Aruba</td>
<td>AW</td>
<td>ABW</td>
<td>1962</td>
<td>-0.046</td>
<td>NaN</td>
<td>11.111111</td>
<td>11.111111</td>
<td>0.035511</td>
<td>NaN</td>
<td>NaN</td>
<td>342.2</td>
<td>28.33</td>
</tr>
<tr>
<th>2</th>
<td>Aruba</td>
<td>AW</td>
<td>ABW</td>
<td>1963</td>
<td>-0.132</td>
<td>NaN</td>
<td>11.111111</td>
<td>11.111111</td>
<td>0.035086</td>
<td>NaN</td>
<td>NaN</td>
<td>477.0</td>
<td>28.46</td>
</tr>
<tr>
<th>3</th>
<td>Aruba</td>
<td>AW</td>
<td>ABW</td>
<td>1964</td>
<td>0.122</td>
<td>NaN</td>
<td>11.111111</td>
<td>11.111111</td>
<td>0.034711</td>
<td>NaN</td>
<td>NaN</td>
<td>328.2</td>
<td>28.35</td>
</tr>
<tr>
<th>4</th>
<td>Aruba</td>
<td>AW</td>
<td>ABW</td>
<td>1965</td>
<td>-0.330</td>
<td>NaN</td>
<td>11.111111</td>
<td>11.111111</td>
<td>0.034370</td>
<td>NaN</td>
<td>NaN</td>
<td>373.9</td>
<td>28.26</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=080245d3">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="Construcci%C3%B3-del-dataframe-final-integrat:-agri_country_year_df">Construcci del dataframe final integrat: <code>agri_country_year_df</code><a class="anchor-link" href="#Construcci%C3%B3-del-dataframe-final-integrat:-agri_country_year_df"></a></h2><p>Amb l'objectiu de crear un dataframe nic que integri tota la informaci agrcola i climtica a nivell de <strong>pas x any</strong>, preparat per a la visualitzaci i exploraci de dades, fem:</p>
<ol>
<li><p><strong>Dataframe base</strong>: <code>agri_population_df_cleaned</code></p>
<ul>
<li>Cont tota la informaci agrcola processada: producci, fertilitzants, s del sl, pesticides, cobertura terrestre, emissions, ocupaci i poblaci</li>
<li>Aquest ser el dataframe principal ja que cont les dades ms crtiques per a l'anlisi agrcola</li>
</ul>
</li>
<li><p><strong>Dataframe complementari</strong>: <code>climate_country_year_df_cleaned</code></p>
<ul>
<li>Cont informaci climtica i indicadors de desenvolupament</li>
</ul>
</li>
<li><p><strong>Tipus de merge</strong>: <strong>LEFT JOIN</strong></p>
<ul>
<li>Preservem tots els registres agrcoles (pas x any)</li>
<li>Afegim informaci climtica quan estigui disponible</li>
<li>Si no hi ha dades climtiques per un pas/any especfic, els valors quedaran com NaN</li>
</ul>
</li>
<li><p><strong>Claus de merge</strong>: <code>ISO3</code> + <code>Year</code></p>
<ul>
<li>Ambds dataframes ja tenen aquests camps harmonitzats</li>
<li>Garanteix la mxima compatibilitat entre fonts de dades</li>
</ul>
</li>
</ol>
<h3 id="Resultat-final">Resultat final<a class="anchor-link" href="#Resultat-final"></a></h3><p>El dataframe <code>agri_country_year_df</code> ser guardat com a CSV a <code>data/visualization_input/agri_country_year_df.csv</code> i contindr tota la informaci necessria per a la visualitzaci de dades.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=4b922005">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[66]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 1. Reordenar columnes de agri_population_df_cleaned per tenir ISO3 com a primera columna</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">1. Reordenant columnes de agri_population_df..."</span><span class="p">)</span>
<span class="c1"># Obtenir totes les columnes</span>
<span class="n">all_cols_agri</span> <span class="o">=</span> <span class="n">agri_population_df_cleaned</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Crear nova ordre: ISO3, Area Code, Area Code (M49), Area, Year Code, Year, resta</span>
<span class="n">priority_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'ISO3'</span><span class="p">,</span> <span class="s1">'Area Code'</span><span class="p">,</span> <span class="s1">'Area Code (M49)'</span><span class="p">,</span> <span class="s1">'Area'</span><span class="p">,</span> <span class="s1">'Year Code'</span><span class="p">,</span> <span class="s1">'Year'</span><span class="p">]</span>
<span class="n">other_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">all_cols_agri</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">priority_cols</span><span class="p">]</span>
<span class="n">new_order_agri</span> <span class="o">=</span> <span class="n">priority_cols</span> <span class="o">+</span> <span class="n">other_cols</span>

<span class="c1"># Reordenar</span>
<span class="n">agri_population_df_cleaned</span> <span class="o">=</span> <span class="n">agri_population_df_cleaned</span><span class="p">[</span><span class="n">new_order_agri</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Columnes reordenades"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  Primeres columnes: </span><span class="si">{</span><span class="n">agri_population_df_cleaned</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  Dimensions: </span><span class="si">{</span><span class="n">agri_population_df_cleaned</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> files x </span><span class="si">{</span><span class="n">agri_population_df_cleaned</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> columnes"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
1. Reordenant columnes de agri_population_df...
Columnes reordenades
  Primeres columnes: ['ISO3', 'Area Code', 'Area Code (M49)', 'Area', 'Year Code', 'Year', 'Value_nutrient_3102_N_Agricultural_Use_t', 'Value_nutrient_3102_N_Use_per_area_of_cropland_kg/ha', 'Value_nutrient_3102_N_Use_per_capita_kg/cap', 'Value_nutrient_3102_N_Use_per_value_of_agricultural_production_g/Int$']
  Dimensions: 10,757 files x 50 columnes
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=c491dcaa">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[67]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 2. Seleccionar noms les columnes rellevants de climate_country_year_df_cleaned (eliminant 'Country' i 'ISO2')</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">2. Seleccionant columnes climtiques rellevants: eliminar 'Country' i 'ISO2'..."</span><span class="p">)</span>

<span class="n">climate_country_year_df_for_merge</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">climate_country_year_df_cleaned</span>
    <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'Country'</span><span class="p">,</span> <span class="s1">'ISO2'</span><span class="p">])</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  Dimensions: </span><span class="si">{</span><span class="n">climate_country_year_df_for_merge</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> files x </span><span class="si">{</span><span class="n">climate_country_year_df_for_merge</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> columnes"</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">climate_country_year_df_for_merge</span><span class="p">[(</span><span class="n">climate_country_year_df_for_merge</span><span class="p">[</span><span class="s1">'ISO3'</span><span class="p">]</span><span class="o">==</span><span class="s1">'ESP'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">climate_country_year_df_for_merge</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">2015</span><span class="p">)]</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
2. Seleccionant columnes climtiques rellevants: eliminar 'Country' i 'ISO2'...
  Dimensions: 19,299 files x 11 columnes
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>ISO3</th>
<th>Year</th>
<th>surface_temperature_change_celsius</th>
<th>agricultural_irrigated_land_%_of_total_agri_land</th>
<th>agricultural_land_%_total_land</th>
<th>arable_land_%_total_land</th>
<th>arable_land_ha_per_person</th>
<th>agriculture_forestry_fishing_value_added_%_GDP</th>
<th>agriculture_forestry_fishing_value_added_%_annual_growth</th>
<th>prec_mm_per_year</th>
<th>mean_annual_tas_deg_celsius</th>
</tr>
</thead>
<tbody>
<tr>
<th>5364</th>
<td>ESP</td>
<td>2015</td>
<td>1.443</td>
<td>13.539857</td>
<td>53.189062</td>
<td>24.573101</td>
<td>0.264490</td>
<td>2.723270</td>
<td>4.831547</td>
<td>489.87</td>
<td>14.52</td>
</tr>
<tr>
<th>5365</th>
<td>ESP</td>
<td>2016</td>
<td>1.628</td>
<td>13.759770</td>
<td>52.577247</td>
<td>24.695895</td>
<td>0.265555</td>
<td>2.815221</td>
<td>4.503758</td>
<td>647.87</td>
<td>14.40</td>
</tr>
<tr>
<th>5366</th>
<td>ESP</td>
<td>2017</td>
<td>1.950</td>
<td>13.933547</td>
<td>52.638714</td>
<td>24.529741</td>
<td>0.263119</td>
<td>2.803447</td>
<td>-3.486742</td>
<td>465.42</td>
<td>14.69</td>
</tr>
<tr>
<th>5367</th>
<td>ESP</td>
<td>2018</td>
<td>1.058</td>
<td>14.145419</td>
<td>52.408210</td>
<td>23.787368</td>
<td>0.254035</td>
<td>2.701283</td>
<td>4.193773</td>
<td>791.86</td>
<td>14.11</td>
</tr>
<tr>
<th>5368</th>
<td>ESP</td>
<td>2019</td>
<td>1.437</td>
<td>14.726331</td>
<td>52.458492</td>
<td>23.644962</td>
<td>0.250694</td>
<td>2.519801</td>
<td>-2.770201</td>
<td>557.29</td>
<td>14.37</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=acd18f48">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[68]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 3. Fer el merge (LEFT JOIN) entre agri_population_df_cleaned i climate_country_year_df_for_merge</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">3. Realitzant merge LEFT JOIN (agri_population_df_cleaned + climate_country_year_df)..."</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"   Claus de merge: ISO3 + Year"</span><span class="p">)</span>

<span class="n">agri_country_year_df</span> <span class="o">=</span> <span class="n">agri_population_df_cleaned</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">climate_country_year_df_for_merge</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">'ISO3'</span><span class="p">,</span> <span class="s1">'Year'</span><span class="p">],</span>
    <span class="n">how</span><span class="o">=</span><span class="s1">'left'</span><span class="p">,</span>
    <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s1">''</span><span class="p">,</span> <span class="s1">'_climate'</span><span class="p">)</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2"> Merge completat!"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  Dimensions finals: </span><span class="si">{</span><span class="n">agri_country_year_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> files x </span><span class="si">{</span><span class="n">agri_country_year_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> columnes"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  Rang d'anys: </span><span class="si">{</span><span class="n">agri_country_year_df</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">agri_country_year_df</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  Pasos nics (ISO3): </span><span class="si">{</span><span class="n">agri_country_year_df</span><span class="p">[</span><span class="s1">'ISO3'</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">agri_country_year_df</span><span class="p">[(</span><span class="n">agri_country_year_df</span><span class="p">[</span><span class="s1">'ISO3'</span><span class="p">]</span><span class="o">==</span><span class="s1">'ESP'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">agri_country_year_df</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">2015</span><span class="p">)]</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
3. Realitzant merge LEFT JOIN (agri_population_df_cleaned + climate_country_year_df)...
   Claus de merge: ISO3 + Year

 Merge completat!
  Dimensions finals: 10,757 files x 59 columnes
  Rang d'anys: 1961 - 2023
  Pasos nics (ISO3): 204
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>ISO3</th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Year Code</th>
<th>Year</th>
<th>Value_nutrient_3102_N_Agricultural_Use_t</th>
<th>Value_nutrient_3102_N_Use_per_area_of_cropland_kg/ha</th>
<th>Value_nutrient_3102_N_Use_per_capita_kg/cap</th>
<th>Value_nutrient_3102_N_Use_per_value_of_agricultural_production_g/Int$</th>
<th>Value_nutrient_3103_P2O5_Agricultural_Use_t</th>
<th>Value_nutrient_3103_P2O5_Use_per_area_of_cropland_kg/ha</th>
<th>Value_nutrient_3103_P2O5_Use_per_capita_kg/cap</th>
<th>Value_nutrient_3103_P2O5_Use_per_value_of_agricultural_production_g/Int$</th>
<th>Value_nutrient_3104_K2O_Agricultural_Use_t</th>
<th>Value_nutrient_3104_K2O_Use_per_area_of_cropland_kg/ha</th>
<th>Value_nutrient_3104_K2O_Use_per_capita_kg/cap</th>
<th>Value_nutrient_3104_K2O_Use_per_value_of_agricultural_production_g/Int$</th>
<th>Value_6601_land_area_ha</th>
<th>Value_6610_agricultural_land_ha</th>
<th>Value_6620_cropland_ha</th>
<th>Value_6621_arable_land_ha</th>
<th>Value_6650_permanent_crops_ha</th>
<th>Value_6655_permanent_meadows_and_pastures_ha</th>
<th>Value_pesticide_agricultural_use_t</th>
<th>Value_6971_herbaceous_crops_ha</th>
<th>Value_6974_tree-covered_areas_ha</th>
<th>Value_6983_grassland_ha</th>
<th>Value_1709_agricultural_soils_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5058_enteric_fermentation_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5059_manure_management_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5060_rice_cultivation_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5061_synthetic_fertilizers_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5064_crop_residues_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_5085_emissions_from_livestock_CO2eq_AR5_kt_FAO_TIER_1</th>
<th>Value_21085_agriculture_value_added_per_worker_constant_2015_ususd_total_USD</th>
<th>Value_21111_employment_in_crop_and_animal_production_hunting_and_related_service_activities_female_No</th>
<th>Value_21111_employment_in_crop_and_animal_production_hunting_and_related_service_activities_male_No</th>
<th>Value_21111_employment_in_crop_and_animal_production_hunting_and_related_service_activities_total_No</th>
<th>Value_21144_employment_in_agriculture_-_ilo_modelled_estimates_female_No</th>
<th>Value_21144_employment_in_agriculture_-_ilo_modelled_estimates_male_No</th>
<th>Value_21144_employment_in_agriculture_-_ilo_modelled_estimates_total_No</th>
<th>Value_21156_share_of_employment_in_agriculture_in_total_employment_-_ilo_modelled_estimates_female_%</th>
<th>Value_21156_share_of_employment_in_agriculture_in_total_employment_-_ilo_modelled_estimates_male_%</th>
<th>Value_21156_share_of_employment_in_agriculture_in_total_employment_-_ilo_modelled_estimates_total_%</th>
<th>total_population_No</th>
<th>female_population_%</th>
<th>male_population_%</th>
<th>rural_population_%</th>
<th>urban_population_%</th>
<th>surface_temperature_change_celsius</th>
<th>agricultural_irrigated_land_%_of_total_agri_land</th>
<th>agricultural_land_%_total_land</th>
<th>arable_land_%_total_land</th>
<th>arable_land_ha_per_person</th>
<th>agriculture_forestry_fishing_value_added_%_GDP</th>
<th>agriculture_forestry_fishing_value_added_%_annual_growth</th>
<th>prec_mm_per_year</th>
<th>mean_annual_tas_deg_celsius</th>
</tr>
</thead>
<tbody>
<tr>
<th>8692</th>
<td>ESP</td>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>2015</td>
<td>2015</td>
<td>1068103.0</td>
<td>62.14</td>
<td>22.88</td>
<td>21.80</td>
<td>411763.0</td>
<td>23.96</td>
<td>8.82</td>
<td>8.40</td>
<td>380303.0</td>
<td>22.13</td>
<td>8.15</td>
<td>7.76</td>
<td>49966100.0</td>
<td>26576500.0</td>
<td>17187890.0</td>
<td>12278220.0</td>
<td>4909670.0</td>
<td>9388610.0</td>
<td>77217.0</td>
<td>15811420.0</td>
<td>12416050.0</td>
<td>7421200.0</td>
<td>13078.1740</td>
<td>16830.1000</td>
<td>10081.3283</td>
<td>1542.3016</td>
<td>5893.4410</td>
<td>1180.7605</td>
<td>32843.4268</td>
<td>43719.25</td>
<td>164900.0</td>
<td>513750.0</td>
<td>678710.0</td>
<td>171510.0</td>
<td>576230.0</td>
<td>747750.0</td>
<td>2.1</td>
<td>5.8</td>
<td>4.1</td>
<td>46683686.0</td>
<td>50.776556</td>
<td>49.223444</td>
<td>20.273048</td>
<td>79.114271</td>
<td>1.443</td>
<td>13.539857</td>
<td>53.189062</td>
<td>24.573101</td>
<td>0.264490</td>
<td>2.723270</td>
<td>4.831547</td>
<td>489.87</td>
<td>14.52</td>
</tr>
<tr>
<th>8693</th>
<td>ESP</td>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>2016</td>
<td>2016</td>
<td>982155.0</td>
<td>57.66</td>
<td>21.02</td>
<td>18.79</td>
<td>414974.0</td>
<td>24.36</td>
<td>8.88</td>
<td>7.94</td>
<td>379007.0</td>
<td>22.25</td>
<td>8.11</td>
<td>7.25</td>
<td>49956400.0</td>
<td>26265700.0</td>
<td>17033010.0</td>
<td>12337180.0</td>
<td>4695830.0</td>
<td>9232690.0</td>
<td>76941.0</td>
<td>16007000.0</td>
<td>12471940.0</td>
<td>7406250.0</td>
<td>12845.3715</td>
<td>16825.0824</td>
<td>10290.7095</td>
<td>1542.0468</td>
<td>5419.2235</td>
<td>1400.3660</td>
<td>33069.7589</td>
<td>43519.53</td>
<td>170860.0</td>
<td>541230.0</td>
<td>712020.0</td>
<td>178970.0</td>
<td>608060.0</td>
<td>787030.0</td>
<td>2.1</td>
<td>5.9</td>
<td>4.2</td>
<td>46732771.0</td>
<td>50.811040</td>
<td>49.188960</td>
<td>19.993972</td>
<td>79.181778</td>
<td>1.628</td>
<td>13.759770</td>
<td>52.577247</td>
<td>24.695895</td>
<td>0.265555</td>
<td>2.815221</td>
<td>4.503758</td>
<td>647.87</td>
<td>14.40</td>
</tr>
<tr>
<th>8694</th>
<td>ESP</td>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>2017</td>
<td>2017</td>
<td>1079321.0</td>
<td>63.54</td>
<td>23.03</td>
<td>21.54</td>
<td>436452.0</td>
<td>25.70</td>
<td>9.31</td>
<td>8.71</td>
<td>389629.0</td>
<td>22.94</td>
<td>8.31</td>
<td>7.78</td>
<td>49954735.0</td>
<td>26295530.0</td>
<td>16985167.0</td>
<td>12253767.0</td>
<td>4731400.0</td>
<td>9310363.0</td>
<td>71987.0</td>
<td>15908920.0</td>
<td>12503870.0</td>
<td>7393520.0</td>
<td>13074.0135</td>
<td>17027.1360</td>
<td>10481.0101</td>
<td>1518.5072</td>
<td>5955.3450</td>
<td>1001.4085</td>
<td>33554.8101</td>
<td>39514.38</td>
<td>186670.0</td>
<td>563050.0</td>
<td>749790.0</td>
<td>196340.0</td>
<td>638770.0</td>
<td>835120.0</td>
<td>2.3</td>
<td>6.1</td>
<td>4.4</td>
<td>46868596.0</td>
<td>50.847262</td>
<td>49.152735</td>
<td>19.701717</td>
<td>79.201013</td>
<td>1.950</td>
<td>13.933547</td>
<td>52.638714</td>
<td>24.529741</td>
<td>0.263119</td>
<td>2.803447</td>
<td>-3.486742</td>
<td>465.42</td>
<td>14.69</td>
</tr>
<tr>
<th>8695</th>
<td>ESP</td>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>2018</td>
<td>2018</td>
<td>1033494.0</td>
<td>61.63</td>
<td>21.95</td>
<td>17.85</td>
<td>425960.0</td>
<td>25.40</td>
<td>9.05</td>
<td>7.36</td>
<td>414675.0</td>
<td>24.73</td>
<td>8.81</td>
<td>7.16</td>
<td>49960347.9</td>
<td>26183323.9</td>
<td>16770363.9</td>
<td>11884251.9</td>
<td>4886112.0</td>
<td>9412960.0</td>
<td>73121.0</td>
<td>15597160.0</td>
<td>12553290.0</td>
<td>7377370.0</td>
<td>12637.0815</td>
<td>16996.4900</td>
<td>10184.3688</td>
<td>1481.9000</td>
<td>5702.4820</td>
<td>1450.7955</td>
<td>32594.7293</td>
<td>42991.80</td>
<td>183140.0</td>
<td>560130.0</td>
<td>743270.0</td>
<td>191850.0</td>
<td>633320.0</td>
<td>825170.0</td>
<td>2.2</td>
<td>5.9</td>
<td>4.2</td>
<td>47092821.0</td>
<td>50.871336</td>
<td>49.128664</td>
<td>19.388051</td>
<td>79.135357</td>
<td>1.058</td>
<td>14.145419</td>
<td>52.408210</td>
<td>23.787368</td>
<td>0.254035</td>
<td>2.701283</td>
<td>4.193773</td>
<td>791.86</td>
<td>14.11</td>
</tr>
<tr>
<th>8696</th>
<td>ESP</td>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>2019</td>
<td>2019</td>
<td>1011251.0</td>
<td>60.34</td>
<td>21.32</td>
<td>19.29</td>
<td>479846.0</td>
<td>28.63</td>
<td>10.12</td>
<td>9.15</td>
<td>369058.0</td>
<td>22.02</td>
<td>7.78</td>
<td>7.04</td>
<td>49957003.6</td>
<td>26206690.6</td>
<td>16759806.6</td>
<td>11812314.6</td>
<td>4947492.0</td>
<td>9446884.0</td>
<td>75190.0</td>
<td>15505760.0</td>
<td>12555860.0</td>
<td>7380330.0</td>
<td>12260.8610</td>
<td>17053.0612</td>
<td>10311.1779</td>
<td>1458.7580</td>
<td>5579.7605</td>
<td>1190.6450</td>
<td>32782.0874</td>
<td>41247.68</td>
<td>177600.0</td>
<td>552250.0</td>
<td>729780.0</td>
<td>185260.0</td>
<td>624370.0</td>
<td>809620.0</td>
<td>2.0</td>
<td>5.7</td>
<td>4.0</td>
<td>47435119.0</td>
<td>50.881129</td>
<td>49.118869</td>
<td>19.027965</td>
<td>78.876393</td>
<td>1.437</td>
<td>14.726331</td>
<td>52.458492</td>
<td>23.644962</td>
<td>0.250694</td>
<td>2.519801</td>
<td>-2.770201</td>
<td>557.29</td>
<td>14.37</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=eb7c5840">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[69]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 4. Guardem el dataframe final com a CSV</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Guardant el dataframe final"</span><span class="p">)</span>

<span class="c1"># Creem el directori</span>
<span class="n">output_dir</span> <span class="o">=</span> <span class="s1">'../data/visualization_input'</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Guardem el dataframe com a CSV</span>
<span class="n">output_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="s1">'agri_country_year_df.csv'</span><span class="p">)</span>
<span class="n">agri_country_year_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Guardant el dataframe final
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=90897f42">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="Processament-i-exportaci%C3%B3-de-agri_prices_df_cleaned">Processament i exportaci de <code>agri_prices_df_cleaned</code><a class="anchor-link" href="#Processament-i-exportaci%C3%B3-de-agri_prices_df_cleaned"></a></h2><p>El dataframe <code>agri_prices_df_cleaned</code> cont informaci de producci i preus agrcoles i ramaders per pas x producte x any. Aquest dataframe tamb s rellevant per a la visualitzaci, ja que permet analitzar:</p>
<ul>
<li>L'evoluci dels preus dels productes agrcoles al llarg del temps</li>
<li>Comparacions entre pasos per a productes especfics</li>
<li>La relaci entre preus i condicions climtiques</li>
<li>Impactes econmics de la producci agrcola</li>
<li>Altres informacions rellevants particulars de cada producte a cada pais</li>
<li>Impactes en l'agrucultura i ramaderia de cada producte</li>
</ul>
<p>A diferncia de <code>agri_country_year_df</code> (que s a nivell pas x any), aquest dataframe s a nivell pas x producte x any, per aix es guardar com un fitxer separat per facilitar la seva utilitzaci en visualitzacions especfiques per producte.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=1d8573f3">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[70]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Reordenar columnes de agri_prices_df_cleaned per tenir ISO3 com a primera columna</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Preparant agri_prices_df_cleaned per exportar"</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Reordenant columnes..."</span><span class="p">)</span>
<span class="c1"># Obtenir totes les columnes</span>
<span class="n">all_cols_prices</span> <span class="o">=</span> <span class="n">agri_prices_df_cleaned</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">priority_cols_prices</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">'ISO3'</span><span class="p">,</span> 
    <span class="s1">'Area Code'</span><span class="p">,</span> 
    <span class="s1">'Area Code (M49)'</span><span class="p">,</span> 
    <span class="s1">'Area'</span><span class="p">,</span> 
    <span class="s1">'Year Code'</span><span class="p">,</span> 
    <span class="s1">'Year'</span><span class="p">,</span>
    <span class="s1">'Item Code'</span><span class="p">,</span> 
    <span class="s1">'Item Code (CPC)'</span><span class="p">,</span> 
    <span class="s1">'Item'</span><span class="p">,</span> 
<span class="p">]</span>
<span class="n">other_cols_prices</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">all_cols_prices</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">priority_cols_prices</span><span class="p">]</span>
<span class="n">new_order_prices</span> <span class="o">=</span> <span class="n">priority_cols_prices</span> <span class="o">+</span> <span class="n">other_cols_prices</span>

<span class="c1"># Reordenar</span>
<span class="n">agri_prices_df_cleaned</span> <span class="o">=</span> <span class="n">agri_prices_df_cleaned</span><span class="p">[</span><span class="n">new_order_prices</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Columnes reordenades"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  Primeres columnes: </span><span class="si">{</span><span class="n">agri_prices_df_cleaned</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="mi">12</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  Dimensions: </span><span class="si">{</span><span class="n">agri_prices_df_cleaned</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> files x </span><span class="si">{</span><span class="n">agri_prices_df_cleaned</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> columnes"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  Pasos nics (ISO3): </span><span class="si">{</span><span class="n">agri_prices_df_cleaned</span><span class="p">[</span><span class="s1">'ISO3'</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  Productes nics: </span><span class="si">{</span><span class="n">agri_prices_df_cleaned</span><span class="p">[</span><span class="s1">'Item'</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  Rang d'anys: </span><span class="si">{</span><span class="n">agri_prices_df_cleaned</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">agri_prices_df_cleaned</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Primeres files:"</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">agri_prices_df_cleaned</span><span class="p">[(</span><span class="n">agri_prices_df_cleaned</span><span class="p">[</span><span class="s1">'ISO3'</span><span class="p">]</span><span class="o">==</span><span class="s1">'ESP'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">agri_prices_df_cleaned</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">2015</span><span class="p">)]</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Preparant agri_prices_df_cleaned per exportar

Reordenant columnes...
Columnes reordenades
  Primeres columnes: ['ISO3', 'Area Code', 'Area Code (M49)', 'Area', 'Year Code', 'Year', 'Item Code', 'Item Code (CPC)', 'Item', 'Element Code', 'Element', 'Unit']
  Dimensions: 3,126,610 files x 18 columnes
  Pasos nics (ISO3): 203
  Productes nics: 302
  Rang d'anys: 1961 - 2023

Primeres files:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>ISO3</th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Year Code</th>
<th>Year</th>
<th>Item Code</th>
<th>Item Code (CPC)</th>
<th>Item</th>
<th>Element Code</th>
<th>Element</th>
<th>Unit</th>
<th>Value</th>
<th>Flag</th>
<th>Flag_Description</th>
<th>Value_LCU/tonne</th>
<th>Value_SLC/tonne</th>
<th>Value_USD/tonne</th>
</tr>
</thead>
<tbody>
<tr>
<th>2561783</th>
<td>ESP</td>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>2015</td>
<td>2015</td>
<td>221</td>
<td>'01371</td>
<td>Almonds, in shell</td>
<td>5312</td>
<td>Area harvested</td>
<td>ha</td>
<td>548604.0</td>
<td>A</td>
<td>Official figure</td>
<td>1854.8</td>
<td>1854.8</td>
<td>2057.1</td>
</tr>
<tr>
<th>2561784</th>
<td>ESP</td>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>2016</td>
<td>2016</td>
<td>221</td>
<td>'01371</td>
<td>Almonds, in shell</td>
<td>5312</td>
<td>Area harvested</td>
<td>ha</td>
<td>583673.0</td>
<td>A</td>
<td>Official figure</td>
<td>1728.2</td>
<td>1728.2</td>
<td>1911.7</td>
</tr>
<tr>
<th>2561785</th>
<td>ESP</td>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>2017</td>
<td>2017</td>
<td>221</td>
<td>'01371</td>
<td>Almonds, in shell</td>
<td>5312</td>
<td>Area harvested</td>
<td>ha</td>
<td>633562.0</td>
<td>A</td>
<td>Official figure</td>
<td>1462.3</td>
<td>1462.3</td>
<td>1651.9</td>
</tr>
<tr>
<th>2561786</th>
<td>ESP</td>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>2018</td>
<td>2018</td>
<td>221</td>
<td>'01371</td>
<td>Almonds, in shell</td>
<td>5312</td>
<td>Area harvested</td>
<td>ha</td>
<td>657770.0</td>
<td>A</td>
<td>Official figure</td>
<td>1143.8</td>
<td>1143.8</td>
<td>1350.8</td>
</tr>
<tr>
<th>2561787</th>
<td>ESP</td>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>2019</td>
<td>2019</td>
<td>221</td>
<td>'01371</td>
<td>Almonds, in shell</td>
<td>5312</td>
<td>Area harvested</td>
<td>ha</td>
<td>687230.0</td>
<td>A</td>
<td>Official figure</td>
<td>1331.6</td>
<td>1331.6</td>
<td>1490.7</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=91be1259">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[71]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">agri_prices_df_cleaned</span><span class="p">[[</span><span class="s1">'Element'</span><span class="p">,</span> <span class="s1">'Unit'</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">'Element'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[71]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Element</th>
<th>Unit</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Area harvested</td>
<td>ha</td>
</tr>
<tr>
<th>3427</th>
<td>Laying</td>
<td>1000 An</td>
</tr>
<tr>
<th>8725</th>
<td>Milk Animals</td>
<td>An</td>
</tr>
<tr>
<th>1479</th>
<td>Producing Animals/Slaughtered</td>
<td>An</td>
</tr>
<tr>
<th>4435</th>
<td>Producing Animals/Slaughtered</td>
<td>1000 An</td>
</tr>
<tr>
<th>111</th>
<td>Production</td>
<td>t</td>
</tr>
<tr>
<th>3364</th>
<td>Production</td>
<td>1000 No</td>
</tr>
<tr>
<th>716</th>
<td>Stocks</td>
<td>An</td>
</tr>
<tr>
<th>1666</th>
<td>Stocks</td>
<td>1000 An</td>
</tr>
<tr>
<th>15538</th>
<td>Stocks</td>
<td>No</td>
</tr>
<tr>
<th>63</th>
<td>Yield</td>
<td>kg/ha</td>
</tr>
<tr>
<th>3175</th>
<td>Yield</td>
<td>No/An</td>
</tr>
<tr>
<th>3238</th>
<td>Yield/Carcass Weight</td>
<td>g/An</td>
</tr>
<tr>
<th>3931</th>
<td>Yield/Carcass Weight</td>
<td>kg/An</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=75831223">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Observem que, com ja haviem mencionat a l'inici de la prctica no podem fer pivot de les columnes per la varietat que tenim, no obstant, el que si que podem fer es estandaritzar les unitats.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=f8ccb543">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[72]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">agri_prices_df_cleaned</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1">#  Cas "1000 &lt;unit&gt;"</span>
<span class="n">mask_1000</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'Unit'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">'1000 '</span><span class="p">,</span> <span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">df</span><span class="p">[</span><span class="s1">'Value'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="n">mask_1000</span><span class="p">,</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">'Value'</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">'Value'</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">df</span><span class="p">[</span><span class="s1">'Unit'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="n">mask_1000</span><span class="p">,</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">'Unit'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'1000 '</span><span class="p">,</span> <span class="s1">''</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">'Unit'</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Cas "g/An", convertir a "kg/An"</span>
<span class="n">mask_g_an</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'Unit'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'g/An'</span>

<span class="n">df</span><span class="p">[</span><span class="s1">'Value'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="n">mask_g_an</span><span class="p">,</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">'Value'</span><span class="p">]</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">'Value'</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">df</span><span class="p">[</span><span class="s1">'Unit'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="n">mask_g_an</span><span class="p">,</span>
    <span class="s1">'kg/An'</span><span class="p">,</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">'Unit'</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Resultat final</span>
<span class="n">agri_prices_df_to_save</span> <span class="o">=</span> <span class="n">df</span>
<span class="n">display</span><span class="p">(</span><span class="n">agri_prices_df_to_save</span><span class="p">[</span>
    <span class="p">(</span><span class="n">agri_prices_df_to_save</span><span class="p">[</span><span class="s1">'Unit'</span><span class="p">]</span><span class="o">==</span><span class="s1">'kg/An'</span><span class="p">)</span>
    <span class="o">&amp;</span><span class="p">(</span><span class="n">agri_prices_df_to_save</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">2015</span><span class="p">)</span>
    <span class="o">&amp;</span><span class="p">(</span><span class="n">agri_prices_df_to_save</span><span class="p">[</span><span class="s1">'ISO3'</span><span class="p">]</span><span class="o">==</span><span class="s1">'ESP'</span><span class="p">)</span>
    <span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>ISO3</th>
<th>Area Code</th>
<th>Area Code (M49)</th>
<th>Area</th>
<th>Year Code</th>
<th>Year</th>
<th>Item Code</th>
<th>Item Code (CPC)</th>
<th>Item</th>
<th>Element Code</th>
<th>Element</th>
<th>Unit</th>
<th>Value</th>
<th>Flag</th>
<th>Flag_Description</th>
<th>Value_LCU/tonne</th>
<th>Value_SLC/tonne</th>
<th>Value_USD/tonne</th>
</tr>
</thead>
<tbody>
<tr>
<th>2569060</th>
<td>ESP</td>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>2015</td>
<td>2015</td>
<td>1091</td>
<td>'0232</td>
<td>Eggs from other birds in shell, fresh, n.e.c.</td>
<td>5424</td>
<td>Yield/Carcass Weight</td>
<td>kg/An</td>
<td>47.905</td>
<td>E</td>
<td>Estimated value</td>
<td>823.1</td>
<td>823.1</td>
<td>912.9</td>
</tr>
<tr>
<th>2569061</th>
<td>ESP</td>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>2016</td>
<td>2016</td>
<td>1091</td>
<td>'0232</td>
<td>Eggs from other birds in shell, fresh, n.e.c.</td>
<td>5424</td>
<td>Yield/Carcass Weight</td>
<td>kg/An</td>
<td>45.500</td>
<td>E</td>
<td>Estimated value</td>
<td>708.3</td>
<td>708.3</td>
<td>783.5</td>
</tr>
<tr>
<th>2569062</th>
<td>ESP</td>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>2017</td>
<td>2017</td>
<td>1091</td>
<td>'0232</td>
<td>Eggs from other birds in shell, fresh, n.e.c.</td>
<td>5424</td>
<td>Yield/Carcass Weight</td>
<td>kg/An</td>
<td>45.263</td>
<td>E</td>
<td>Estimated value</td>
<td>608.4</td>
<td>608.4</td>
<td>687.3</td>
</tr>
<tr>
<th>2571055</th>
<td>ESP</td>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>2015</td>
<td>2015</td>
<td>1062</td>
<td>'0231</td>
<td>Hen eggs in shell, fresh</td>
<td>5424</td>
<td>Yield/Carcass Weight</td>
<td>kg/An</td>
<td>16.832</td>
<td>A</td>
<td>Official figure</td>
<td>1346.3</td>
<td>1346.3</td>
<td>1493.2</td>
</tr>
<tr>
<th>2571056</th>
<td>ESP</td>
<td>203</td>
<td>'724</td>
<td>Spain</td>
<td>2016</td>
<td>2016</td>
<td>1062</td>
<td>'0231</td>
<td>Hen eggs in shell, fresh</td>
<td>5424</td>
<td>Yield/Carcass Weight</td>
<td>kg/An</td>
<td>17.253</td>
<td>A</td>
<td>Official figure</td>
<td>1158.5</td>
<td>1158.5</td>
<td>1281.5</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=1c3ccb12">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[73]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Guardar agri_prices_df_to_save com a CSV</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Guardant agri_prices_df_to_save..."</span><span class="p">)</span>

<span class="c1"># Guardar com a CSV</span>
<span class="n">output_file_prices</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="s1">'agri_production_and_prices_df.csv'</span><span class="p">)</span>
<span class="n">agri_prices_df_to_save</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_file_prices</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Guardat a </span><span class="si">{</span><span class="n">output_file_prices</span><span class="si">}</span><span class="s2">..."</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Guardant agri_prices_df_to_save...
Guardat a ../data/visualization_input/agri_production_and_prices_df.csv...
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=28516743">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
</div>
</div>
</div>
</div>
</main>
</body>
</html>
